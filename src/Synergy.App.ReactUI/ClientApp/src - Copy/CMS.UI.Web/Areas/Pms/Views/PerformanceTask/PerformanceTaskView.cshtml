@inject IStringLocalizer<CMS.UI.Web.Areas.Pms.Controllers.PerformanceTaskController> Resource
@using CMS.Data.Model
@using CMS.UI.ViewModel
@using Kendo.Mvc.UI
@using CMS.Common

@inject CMS.Common.IUserContext _userContext

@model TeamWorkloadViewModel
@{
    //Layout = "~/Areas/CMS/Views/Shared/_LayoutCms.cshtml";
    Layout = null;
}

@*<link href="~/css/EGOV/DashBoardStyles.css" rel="stylesheet" asp-append-version="true" />*@

<style>
    .fancytree-icon {
        display: none !important;
    }
    .listViewDoc {
        border: none;
        border-radius: 6px;
        overflow-x: hidden;
    }

    input.largerCheckbox {
        width: 15px;
        height: 20px;
        background-color: #2196F3;
    }

    .board {
        border: none;
        overflow-x: scroll;
        display: flex;
    }

    .card_task {
        border-color: #209EB8;
    }

    .newtask {
        background-color: black;
        color: #fff;
    }

    .tasklist {
        background-color: #209EB8;
        color: #fff;
        border-radius: 0px 0px 3px 3px;
    }

    .taskname {
        /*color: #1D6EF4;*/
        color: black;
    }

    .drp-user-photo {
        height: 50px;
        width: 50px;
        border-radius: 30px;
    }

    .drp-user-photo1 {
        height: 50px;
        width: 50px;
        border-radius: 30px;
    }
    .drp-user-photo2 {
        height: 30px;
        width: 30px;
        border-radius: 30px;
    }

    #board > .k-listview-content {
        display: flex;
    }

    #Competencyboard > .k-listview-content {
        display: flex;
    }

    #allboard > .k-listview-content {
        display: flex;
    }

    #developmentboard > .k-listview-content {
        display: flex;
    }

    .k-listview-content {
        overflow: unset;
    }

    #listView {
        padding: 10px 5px;
        margin-bottom: -1px;
        min-height: 510px;
    }


    .scrollbtn {
        background-color: #4E4D4D;
        color: white;
        border: 1px solid #FFFFFF;
        box-shadow: 0px 2px 2px rgb(0 0 0 / 25%);
        border-radius: 2px;
    }

    .k-treeview-lines {
        overflow-x: scroll;
        width: 100%;
    }

    .product {
        /* float: left;*/
        position: relative;
        /*  width: 50px;*/
        margin: 0 5px 5px;
        padding-left: 5px;
        padding-top: 10px;
        /* cursor:pointer;*/
    }


    .TASK_STATUS_DRAFT {
        background-color: #17a2b8;
        color: #fff;
    }

    .TASK_STATUS_INPROGRESS {
        background-color: #007bff;
        color: #fff;
    }

    .TASK_STATUS_OVERDUE {
        background-color: #ffc107;
        color: #fff;
    }

    .TASK_STATUS_COMPLETE {
        background-color: #28a745;
        color: #fff;
    }

    .Rejected {
        background-color: #dc3545;
        color: #fff;
    }

    .Canceled {
        background-color: #343a40;
        color: #fff;
    }

    .k-link {
        color: black;
    }

        .k-link:hover {
            color: black;
            font-weight: bold;
        }
    #treeviewscss {
        margin-top: 30px;
        margin-left: 28px;
    }

</style>

<script>


    

    function OnSelect(e) {
        //
        e.preventDefault();

    }
    var splitter = $('.splitter-container').height(200).split({
        orientation: 'vertical',
        limit: 10,
        position: '20%', // if there is no percentage it interpret it as pixels
        onDrag: function (event) {
            console.log(splitter.position());
        }
    });

    function OnPhotoError(obj) {
        // alert("test");
        obj.onerror = null;

        obj.src = '/images/profile.jpg';


    }

</script>

<script>
    var selecteduid;
    var selectedstatus;
    var selectedoid;
    var selectedcolumn;
    var selecteddateRange;
    var selectedfromDate;
    var selectedtoDate;
    var subtasktreeId;
    var subtasktreestatus;
    $(document).ready(function () {
        HideLoader($("#global-overlay"));
        selecteduid = [];
        selectedstatus = [];
        selectedoid = [];
        selectedfromDate = null;
        selectedtoDate = null;
        selectedcolumn = null;
        selecteddateRange = null;
        subtasktreeId = null;
        subtasktreestatus = null;
        window.parent.LoadPartailView1("/pms/PerformanceTask/PerformanceDetailsFilter?hideProject=true&stage=true", 'ProjectFilter');
        if ('@Model.TemplateCode' == "Competency") {
            $("#competency").show();
            $("#goal").hide();
            $("#development").hide();
            $("#all").hide();
        }
        else if ('@Model.TemplateCode' == "Development") {
            $("#development").show();
            $("#competency").hide();
            $("#goal").hide();
            $("#all").hide();
        }
        else if ('@Model.TemplateCode' == "All") {
            $("#all").show();
            $("#development").hide();
            $("#competency").hide();
            $("#goal").hide();
        }
        else {
            $("#goal").show();
            $("#competency").hide();
            $("#development").hide();
            $("#all").hide();
        }

        if ('@Model.PerformanceStage' != null && '@Model.PerformanceStage' != "") {
            $("#performancestage").show();
        }
        HideLoader($("#global-overlay"));
    });

    function onViewAll() {

        selecteduid=[];
        var search = filter();
        var listView = $("#board").data("kendoListView");
        listView.dataSource.read(search);
    }

    function OnViewS(status) {
        var search = filter(null,status);
        var listView = $("#board").data("kendoListView");
        listView.dataSource.read(search);
    }

    function filter() {

        return {
            filteruser: selecteduid,
            filterstatus: selectedstatus,
            ownerIds: selectedoid,
           // type: $("#Type").val(),
            column: selectedcolumn,
            dateRange: selecteddateRange,
            fromDate: selectedfromDate,
            toDate: selectedtoDate,
        };
    }
    function AddGoal() {
        var portalId = "";
        if (window.parent == "" || window.parent == undefined) {
            portalId = $("#GlobalPortalId").val();
        }
        else {
            portalId = window.parent.$("#GlobalPortalId").val();
        }
        var prms = encodeURIComponent('parentServiceId=' + '@Model.Id' + '&ownerUserId=@Model.PerformanceUser');

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterServiceCreate&source=Create&dataAction=Create&templateCodes=PMS_GOAL&portalId=' + portalId + '&prms=' + prms;
        LoadCmsPartialView(url, 'Service', true, 1000, 600, '@Html.Raw(Resource["CreateGoal"])');
        return false;
        //AddMaster();

    }
    function AddCompetencyMaster() {
        var win = GetMainWindow();
        win.iframeOpenUrl = '@Url.Action("SelectCategoryMaster", "PerformanceTask", new { @area = "Pms" })?templateCode=@Model.TemplateCode';
        win.OpenWindow({ Title: 'Create', Width: 1200, Height: 600 });
        return false;
    }
    function OnCloseCompetencyMaster(prms) {
        debugger
        //alert(prms.id + " " + prms.code + " " + prms.subject + " " + prms.description);
        var portalId = "";
        if (window.parent == "" || window.parent == undefined) {
            portalId = $("#GlobalPortalId").val();
        }
        else {
            portalId = window.parent.$("#GlobalPortalId").val();
        }
        var serprms = encodeURIComponent('parentServiceId=@Model.Id&subject=' + prms.subject + '&description=' + prms.description);
        var udfprms = encodeURIComponent('CompetencyMasterId=' + prms.id + '&ProficiencyLevelId=' + prms.proficlevelid + '&PmsTypeId=' + prms.PmsTypeId);
        var url = '/Cms/Page?lo=Popup&cbm=OnAfterServiceCreate&source=Create&dataAction=Create&templateCodes=PMS_COMPENTENCY&portalId=' + portalId + '&prms=' + serprms + '&udfs=' + udfprms;
        LoadCmsPartialView(url, 'Service', true, 1000, 600, '@Html.Raw(Resource["CreateCompetency"])');
        return false;
    }
    function AddCompetency() {
        var portalId = "";
        if (window.parent == "" || window.parent == undefined) {
            portalId = $("#GlobalPortalId").val();
        }
        else {
            portalId = window.parent.$("#GlobalPortalId").val();
        }
       var prms = encodeURIComponent( 'parentServiceId='+'@Model.Id' + '&ownerUserId=@Model.PerformanceUser');

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterServiceCreate&source=Create&dataAction=Create&templateCodes=PMS_COMPENTENCY&portalId=' + portalId + '&prms=' + prms;
        LoadCmsPartialView(url, 'Service', true, 1000, 600, '@Html.Raw(Resource["CreateCompetency"])');
        return false;
    }

      function AddDevelopment() {
         // var portalId = $('#GlobalPortalId').val();
          var portalId = "";
          if (window.parent == "" || window.parent == undefined) {
              portalId = $("#GlobalPortalId").val();
          }
          else {
              portalId = window.parent.$("#GlobalPortalId").val();
          }
       var prms = encodeURIComponent( 'parentServiceId='+'@Model.Id');

          var url = '/Cms/Page?lo=Popup&cbm=OnAfterServiceCreate&source=Create&dataAction=Create&templateCodes=PMS_DEVELOPMENT&portalId=' + portalId + '&prms=' + prms;
          LoadCmsPartialView(url, 'Service', true, 1000, 600, '@Html.Raw(Resource["CreateDevelopment"])');
        return false;
    }

    function AdjustWeightage() {


        var url = '/Pms/PerformanceBoard/GetGoals?PerformanceId=' +'@Model.Id&PerformanceStage=@Model.PerformanceStage&PerformanceUser=@Model.PerformanceUser';
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["AdjustWeightage"])', Width: 1200, Height: 600 });
        return false;
    }
        function AdjustCompetencyWeightage() {


        var url ='/Pms/PerformanceBoard/GetCompentency?PerformanceId='+'@Model.Id&PerformanceStage=@Model.PerformanceStage&PerformanceUser=@Model.PerformanceUser';
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
            win.OpenWindow({ Title: '@Html.Raw(Resource["AdjustWeightage"])', Width: 1200, Height: 600 });
        return false;
    }

    function AdjustDevelopementWeightage() {


        var url ='/Pms/PerformanceBoard/GetCompentency?PerformanceId='+'@Model.Id';
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["AdjustWeightage"])', Width: 1200, Height: 600 });
        return false;
    }

    function OnTask(Id) {
        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + Id);
        // var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&pageName=PerformanceGoalTask&portalId=' + portalId + '&prms=' + prms;
       // var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=PMS_GOAL_ADHOC_TASK&portalId=' + portalId + '&prms=' + prms;
        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
          var win = GetMainWindow();
          win.iframeOpenUrl = url;
          win.OpenWindow({ Title: '@Html.Raw(Resource["CreateTask"])', Width: 1200, Height: 600 });
           // LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Task');
            return false;
    }
    function OnCompetencyTask(Id) {
        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + Id);
       // var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=PMS_COMPENTENCY_ADHOC_TASK&portalId=' + portalId + '&prms=' + prms;
        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["CreateCompetencyTask"])', Width: 1200, Height: 600 });

        return false;
    }

    function OnDevelopmentTask(Id) {

        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + Id);
        //var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=PMS_DEVELOPMENT_ADHOC_TASK&portalId=' + portalId + '&prms=' + prms;
        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["CreateDevelopmentTask"])', Width: 1200, Height: 600 });

        return false;
    }

    function OnAllTask(Id, TemplateCode) {
      //  alert(TemplateCode);
        var tempcode = "GeneralPMSAdhocTask";
        //if (TemplateCode == "PMS_GOAL") {
        //    tempcode = "PMS_GOAL_ADHOC_TASK";
        //}
        //else if (TemplateCode == "PMS_COMPENTENCY") {
        //    tempcode = "PMS_COMPENTENCY_ADHOC_TASK";
        //}
        //else if (TemplateCode == "PMS_DEVELOPMENT") {
        //    tempcode = "PMS_DEVELOPMENT_ADHOC_TASK";
        //}
        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + Id);
        // var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&pageName=PerformanceGoalTask&portalId=' + portalId + '&prms=' + prms;
        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=' + tempcode+'&portalId=' + portalId + '&prms=' + prms;
          var win = GetMainWindow();
          win.iframeOpenUrl = url;
          win.OpenWindow({ Title: '@Html.Raw(Resource["CreateTask"])', Width: 1200, Height: 600 });
           // LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Task');
            return false;
    }

    function OnAfterTaskCreate(service) {
        var search = filter();
        var listView = $("#board").data("kendoListView");
        var listView1 = $("#Competencyboard").data("kendoListView");
        var listView2 = $("#developmentboard").data("kendoListView");
        var listView3 = $("#allboard").data("kendoListView");
        listView.dataSource.read(search);
        listView1.dataSource.read(search);
        listView2.dataSource.read(search);
        listView3.dataSource.read(search);
        getSubtaskTreeView(subtasktreeId, null);
       // var treeview = $("#SubtaskTreeView").data("kendoTreeView").dataSource.read({ taskId: subtasktreeId });
     //   window.parent.LoadPartailView1("/pms/PerformanceTask/PerformanceTaskView?ProjectId=" + '@Model.Id' + "&type="+'@Model.TemplateCode', 'Project-content');
    }
    function OnAfterServiceCreate(service) {
        var search = filter();
        var listView = $("#board").data("kendoListView");
        var listView1 = $("#Competencyboard").data("kendoListView");
        var listView2 = $("#developmentboard").data("kendoListView");
        var listView3 = $("#allboard").data("kendoListView");
        listView2.dataSource.read(search);
        listView.dataSource.read(search);
        listView3.dataSource.read(search);
        listView1.dataSource.read(search);
        getSubtaskTreeView(subtasktreeId, null);
      //  $("#SubtaskTreeView").data("kendoTreeView").dataSource.read({ taskId: subtasktreeId });
    // window.parent.LoadPartailView1("/pms/PerformanceTask/PerformanceTaskView?ProjectId=" + '@Model.Id' + "&type="+'@Model.TemplateCode', 'Project-content');

    }


    function SubGoalTask(parentTaskId, projectid) {
        var portalId = $('#GlobalPortalId').val();
         var prms = encodeURIComponent('parentServiceId=' + projectid + '&parentTaskId=' + parentTaskId);

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
         var win = GetMainWindow();
         win.iframeOpenUrl = url;
         win.OpenWindow({ Title: '@Html.Raw(Resource["CreateSubtask"])', Width: 1200, Height: 600 });
            //LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Sub Task');
            return false;
    }
    function SubCompetencyTask(parentTaskId, projectid) {

        var portalId = $('#GlobalPortalId').val();
         var prms = encodeURIComponent('parentServiceId=' + projectid + '&parentTaskId=' + parentTaskId);

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
         var win = GetMainWindow();
         win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["CreateSubtask"])', Width: 1200, Height: 600 });
           // LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Sub Task');
            return false;
    }

    function SubDevelopmentTask(parentTaskId, projectid) {

        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + projectid + '&parentTaskId=' + parentTaskId);

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=GeneralPMSAdhocTask&portalId=' + portalId + '&prms=' + prms;
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["CreateSubtask"])', Width: 1200, Height: 600 });
        // LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Sub Task');
        return false;
    }

    function SubAllTask(parentTaskId, projectid, TemplateCode) {

       // alert(TemplateCode);
        var tempcode = "GeneralPMSAdhocTask";
            //if (TemplateCode == "PMS_GOAL") {
            //    tempcode = "PMS_GOAL_ADHOC_TASK";
            //}
            //else if (TemplateCode == "PMS_COMPENTENCY") {
            //    tempcode = "PMS_COMPENTENCY_ADHOC_TASK";
            //}
            //else if (TemplateCode == "PMS_DEVELOPMENT") {
            //    tempcode = "PMS_DEVELOPMENT_ADHOC_TASK";
            //}
        var portalId = $('#GlobalPortalId').val();
        var prms = encodeURIComponent('parentServiceId=' + projectid + '&parentTaskId=' + parentTaskId);

        var url = '/Cms/Page?lo=Popup&cbm=OnAfterTaskCreate&source=Create&dataAction=Create&templateCodes=' + tempcode+'&portalId=' + portalId + '&prms=' + prms;
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["CreateSubtask"])', Width: 1200, Height: 600 });
        // LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Sub Task');
        return false;
    }

    function EditGoalTask(Id,status,code) {

        var portalId = $('#GlobalPortalId').val();
        var url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=View&templateCodes=' + code+'&portalId=' + portalId + '&recordId=' + Id;

        if (status == 'TASK_STATUS_DRAFT') {
            url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=Edit&templateCodes=' + code +'&portalId=' + portalId + '&recordId=' + Id;
        }

         var win = GetMainWindow();
         win.iframeOpenUrl = url;
         win.OpenWindow({ Title: '@Html.Raw(Resource["ViewTask"])', Width: 1200, Height: 600 });
         return false;
    }
    function EditCompetencyTask(Id,status,code) {
      //  alert(Id);
        var portalId = $('#GlobalPortalId').val();

        var url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=View&templateCodes=' + code +'&portalId=' + portalId + '&recordId=' + Id;
        if (status == 'TASK_STATUS_DRAFT') {
            url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=Edit&templateCodes=' + code +'&portalId=' + portalId + '&recordId=' + Id;
        }

        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["ViewTask"])', Width: 1200, Height: 600 });
        return false;
    }

    function EditDevelopmentTask(Id,status,code) {
        var portalId = $('#GlobalPortalId').val();

        var url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=View&templateCodes=' + code +'&portalId=' + portalId + '&recordId=' + Id;

        if (status == 'TASK_STATUS_DRAFT') {
            url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=Edit&templateCodes=' + code +'&portalId=' + portalId + '&recordId=' + Id;
        }
        var win = GetMainWindow();
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: '@Html.Raw(Resource["ViewTask"])', Width: 1200, Height: 600 });
        return false;
    }

       function EditAllTask(Id,status,TemplateCode) {
          // alert(TemplateCode);
           var tempcode = TemplateCode;
           //if (TemplateCode == "PMS_GOAL") {
           //    tempcode = "PMS_GOAL_ADHOC_TASK";
           //}
           //else if (TemplateCode == "PMS_COMPENTENCY") {
           //    tempcode = "PMS_COMPENTENCY_ADHOC_TASK";
           //}
           //else if (TemplateCode == "PMS_DEVELOPMENT") {
           //    tempcode = "PMS_DEVELOPMENT_ADHOC_TASK";
           //}
        var portalId = $('#GlobalPortalId').val();
           var url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=View&templateCodes=' + tempcode+'&portalId=' + portalId + '&recordId=' + Id;

        if (status == 'TASK_STATUS_DRAFT') {
            url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=Edit&templateCodes=' + tempcode +'&portalId=' + portalId + '&recordId=' + Id;
        }

         var win = GetMainWindow();
         win.iframeOpenUrl = url;
         win.OpenWindow({ Title: '@Html.Raw(Resource["ViewTask"])', Width: 1200, Height: 600 });
         return false;
    }
    function EditTask(Id, status, TemplateCode) {
          // alert(TemplateCode);
          var tempcode = TemplateCode;
           //if (TemplateCode == "PMS_GOAL") {
           //    tempcode = "PMS_GOAL_ADHOC_TASK";
           //}
           //else if (TemplateCode == "PMS_COMPENTENCY") {
           //    tempcode = "PMS_COMPENTENCY_ADHOC_TASK";
           //}
           //else if (TemplateCode == "PMS_DEVELOPMENT") {
           //    tempcode = "PMS_DEVELOPMENT_ADHOC_TASK";
           //}
        var portalId = $('#GlobalPortalId').val();
           var url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=View&templateCodes=' + tempcode+'&portalId=' + portalId + '&recordId=' + Id;

        if (status == 'TASK_STATUS_DRAFT') {
            url = '/Cms/Page?lo=Popup&popup=true&cbm=OnAfterTaskCreate&source=View&dataAction=Edit&templateCodes=' + tempcode +'&portalId=' + portalId + '&recordId=' + Id;
        }

         var win = GetMainWindow();
         win.iframeOpenUrl = url;
         win.OpenWindow({ Title: '@Html.Raw(Resource["ViewTask"])', Width: 1200, Height: 600 });
         return false;
    }

        function OnViewService(Id,templateCode) {
            /*var tempcode = TemplateCode;*/
            debugger;
        var portalId = $('#GlobalPortalId').val();
        var url = '/Cms/Page?lo=Popup&popup=true&source=View&dataAction=View&portalId=' + portalId + '&templateCodes=' + templateCode+'&recordId=' + Id;

         var win = GetMainWindow();
         win.iframeOpenUrl = url;
         win.OpenWindow({ Title: ' ', Width: 1200, Height: 600 });
         return false;
    }

    function OnProjectChange(id) {
        window.location.href = "/pmt/project/ProjectTeamWorkload?projectId=" + id;
    }


    var colors = ['#F56564', '#90D142', '#28BAF5', '#7551F5', '#5BA79F', '#7A8F9D', '#4F67B6'];
    function OnDataBoundDoc(arg) {
        var childDiv = document.getElementById('board').children;

        for (var i = 0; i < childDiv.length; i++) {
            childDiv[i].children[0].style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        }
    }

    $('#left').click(function () {
        event.preventDefault();
        $('#board').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#right').click(function () {
        event.preventDefault();
        $('#board').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });
    $('#left1').click(function () {
        event.preventDefault();
        $('#board').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#right1').click(function () {
        event.preventDefault();
        $('#board').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });


    $('#leftC').click(function () {
        event.preventDefault();

        $('#Competencyboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightC').click(function () {
        event.preventDefault();
        $('#Competencyboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });
    $('#leftC1').click(function () {
        event.preventDefault();

        $('#Competencyboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightC1').click(function () {
        event.preventDefault();

        $('#Competencyboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });

    $('#leftD').click(function () {
        event.preventDefault();

        $('#developmentboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightD').click(function () {
        event.preventDefault();
        $('#developmentboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });
    $('#leftD1').click(function () {
        event.preventDefault();

        $('#developmentboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightD1').click(function () {
        event.preventDefault();

        $('#developmentboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });

    $('#leftA').click(function () {
        event.preventDefault();

        $('#allboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightA').click(function () {
        event.preventDefault();
        $('#allboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });
    $('#leftA1').click(function () {
        event.preventDefault();

        $('#allboard').animate({
            scrollLeft: "-=1075px"
        }, "slow");

    });

    $('#rightA1').click(function () {
        event.preventDefault();

        $('#allboard').animate({
            scrollLeft: "+=1075px"
        }, "slow");

    });


    //function onChange(e) {
    //    var data = this.dataSource.view();
    //    var selected = $.map(this.select(), function (item) {
    //        return data[$(item).index()].UserId;
    //    });
    //    //alert(selected);
    //    selecteduid = selected;
    //    var search = filter();
    //    var listView = $("#board").data("kendoListView");
    //    listView.dataSource.read(search);
    //    console.log("Selected: " + selected.length + " item(s), [" + selected.join(", ") + "]");
    //}

    //$("#sharelistView").on("mousedown", function (e) {
    //
    //    // get item if the user clicked on an item template
    //    var clickedItem = $(e.target).closest("div.product");

    //    // prevent click event for item elements
    //    clickedItem.on("click", function (e) {
    //        e.stopPropagation();
    //    });

    //    if (clickedItem.length > 0) {
    //        var listView = $("#sharelistView").getKendoListView();

    //        var selectedItems = listView.select();

    //        if (clickedItem.hasClass("k-state-selected")) {
    //            // if item is already selected - remove it from collection
    //            selectedItems.splice($.inArray(clickedItem[0], selectedItems), 1);
    //        } else {
    //            selectedItems.push(clickedItem);
    //        }

    //        // unbind "change" event to prevent multiple calls
    //        listView.unbind("change");
    //        listView.clearSelection();
    //        listView.bind("change", onChange);

    //        listView.select(selectedItems);
    //       // alert(selectedItems.item);
    //    }
    //});

    function onSearch() {

        selecteduid = [];
        selectedstatus = [];
        selecteduid = $("#Receiver").data("kendoMultiSelect").value();
        selectedstatus = $("#Status").data("kendoMultiSelect").value();
        selectedoid = $("#Sender").data("kendoMultiSelect").value();
        selectedfromDate = kendo.toString($("#FromDate").data("kendoDatePicker").value(), 'yyyy/MM/dd');
        selectedtoDate = kendo.toString($("#ToDate").data("kendoDatePicker").value(), 'yyyy/MM/dd');
        selectedcolumn = $("#Column").data("kendoDropDownList").value();
        selecteddateRange = $("#DateType").data("kendoDropDownList").value();
       // type = $("#Type").val();
        if (selecteduid.length > 0 || selectedstatus.length > 0 || selectedoid.length > 0 || selectedfromDate != null || selectedtoDate != null || selecteddateRange != "") {
            document.getElementById('filtertext').innerHTML = " Applied";
        }
        var search = {
            //projectIds: $("#Project").data("kendoMultiSelect").value(),
            filteruser: $("#Receiver").data("kendoMultiSelect").value(),
            ownerIds: $("#Sender").data("kendoMultiSelect").value(),
            filterstatus: $("#Status").data("kendoMultiSelect").value(),
            //filterSdate: kendo.toString($("#FromDate").data("kendoDatePicker").value(), 'yyyy/MM/dd'),
           // type: $("#Type").val(),
            column: $("#Column").data("kendoDropDownList").value(),
            dateRange: $("#DateType").data("kendoDropDownList").value(),
            fromDate: kendo.toString($("#FromDate").data("kendoDatePicker").value(), 'yyyy/MM/dd'),
            toDate: kendo.toString($("#ToDate").data("kendoDatePicker").value(), 'yyyy/MM/dd'),
            //toDate: kendo.toString($("#ToDate").data("kendoDatePicker").value(), 'yyyy/MM/dd'),
        };

       search = filter();
        $("#board").data("kendoListView").dataSource.read(search);
        $("#Competencyboard").data("kendoListView").dataSource.read(search);
    }
    function onReset() {
        selecteduid = [];
        selectedstatus = [];
        selectedoid = [];
        selectedfromDate = null;
        selectedtoDate = null;
        selectedcolumn = null;
        selecteddateRange = null;
        document.getElementById('filtertext').innerHTML = " Not Applied";
        window.parent.LoadPartailView1("/pms/PerformanceTask/ProjectDetailsFilter?hideProject=true&stage=true", 'ProjectFilter');
        $("#board").data("kendoListView").dataSource.read();
        $("#Competencyboard").data("kendoListView").dataSource.read();
    }

    $(document).ready(function () {
        $("#menu, #divmenu").mouseleave(function () {
            $("#menu").hide();
            HideLoader($("#global-overlay"));
        });
    });

    function OnClick(taskId, parentId) {
        //
        //alert(taskId);
        taskid = taskId;
        parentid = parentId;
        menu = $("#menu");
        menu.css({ top: event.pageY, left: event.pageX - 150 });
        menu.show();
    }

    function OnMenuClick(e) {
        var command = $(e.item).attr('id');

        if (command == "Open") {
            var portalId = $('#GlobalPortalId').val();
            var url = '/Cms/Page?source=Edit&dataAction=Edit&pageName=ProjectTask&portalId=' + portalId + '&recordId=' + taskid;
            LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Edit Task');
        }
        else if (command == "SubTask") {
            var portalId = $('#GlobalPortalId').val();
            var prms = encodeURIComponent('parentServiceId=' + parentid + '&parentTaskId=' + taskid);
            var url = '/Cms/Page?source=Create&dataAction=Create&pageName=ProjectTask&portalId=' + portalId + '&prms=' + prms;
            LoadCmsPartialView(url, 'Task', true, 1200, 650, 'Create Sub Task@Html.Raw(Resource["Create Goal"])');
        }
        $("#menu").hide();
    }

    function LoadTreeView(Id,Status) {

        subtasktreeId = Id;
        subtasktreestatus = Status;
        expandedItem = null;
        getSubtaskTreeView(Id, Status);
      //  $("#SubtaskTreeView").data('kendoTreeView').dataSource.read({ taskId: Id, status: Status });
    }
    var expandedItem = null;
    function onExpand(e) {
        expandedItem = this.dataItem(e.node);
        console.log(expandedItem);
    }
    function AddData() {

        //alert(subtasktreestatus);
        return { status: subtasktreestatus };
        //if (expandedItem == null) {
        //    return { id: null, status: null };
        //}
        //else {
        //    return { id: expandedItem.ParentId, status: subtasktreestatus};
        //}
    }

        function getSubtaskTreeView(taskId,status) {



                            $("#SubtaskTreeView").fancytree({
                                extensions: ["table"],
                                source: $.ajax({
                                    url: "/Pms/PerformanceTask/ReadSubTaskViewData?taskId=" + taskId + "&status" + status,
                                    dataType: "json"
                                }),
                                lazyLoad: function (event, data) {
                                    var node = data.node;
                                    // Issue an Ajax request to load child nodes
                                    data.result = {
                                        url: "/Pms/PerformanceTask/ReadSubTaskViewData",
                                        data: { id: node.key, taskId: taskId, status: status }
                                    }

                                },
                                renderNode: function (event, data) {
                                    // Optionally tweak data.node.span
                                    // debugger;
                                    //var node = data.node;
                                    //  node.renderTitle();
                                    var node = data.node,
                                        $tdList = $(node.tr).find(">td");
                                    // (index #0 is rendered by fancytree by adding the checkbox)
                                    //  $tdList.eq(0).text(node.data.NoteSubject).addClass("alignRight");
                                    // (index #2 is rendered by fancytree)
                                    var tasknm = "";
                                    if (node.data.TaskName != undefined) {
                                        tasknm = node.data.TaskName.substring(0, 5);
                                    }
                                    else {
                                        tasknm = node.data.TaskName;
                                    }
                                    var date = new Date(node.data.StartDate);
                                    var formatdate = date.getFullYear() + "." + (date.getMonth() + 1) + "." + date.getDate();
                                    var date1 = new Date(node.data.DueDate);
                                    var formatdate1 = date1.getFullYear() + "." + (date1.getMonth() + 1) + "." + date1.getDate();
                                    var data = "<div class='card card_task' style='min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;!important'>" +
                                        "<div class='row' style='padding:10px 50px 10px 10px;cursor:pointer;overflow-wrap:break-word !important;white-space:normal !important;' onclick='EditAllTask(\"" + node.data.id + "\",\"" + node.data.TaskStatusCode + "\",\"" + node.data.TemplateCode + "\")'>" +

                                        "<div class='col-10'>" +
                                        "<span style='font-size:16px;'>" + tasknm + " | </span>";
                                    if (node.data.UserName == null) {
                                        data += "<span style='font-size:14px;color:gray;'> No Assignee |</span>";
                                    }
                                    else {
                                        data += "<span style='font-size: 14px; color: gray;'>" + node.data.UserName.substring(0, 5) + " | </span>";
                                    }
                                    data += "<span style='font-size:14px;color:gray;'>" + formatdate + "-" + formatdate1 + " | </span>";

                                    data += "<span class='" + node.data.TaskStatus + "' style='font-size:14px;padding: 2px 6px 4px 6px;border-radius: 8px;' >" + node.data.TaskStatus + "</span> </div>";
                                    data += "<div class='col-2'>";
                                    if (node.data.PhotoId != null) {
                                        data += "<img class='drp-user-photo2' width='80' height='80' src='/cms/Document/GetImageMongo?id='" + node.data.PhotoId + "' onerror='OnPhotoError(this)' style='text-align: center;'>";
                                    }
                                    else {
                                        data += "<img class='drp-user-photo2' width='80' height='80' src='/images/profile.jpg' style='text-align: center;'>";
                                    }
                                    data += "</div></div>";

data += "<div class='row' style='padding: 0px 30px 10px 10px;'>";
data +="<div class='col-xs-2 col-md-2' style='margin-left:15px;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px' title='Total Sub Task Count'>";
 data += "<span style='font-size:16px;margin-left: -4px' >"+node.data.SubTaskCount+"</span></div>";

 data += "<div class='col-xs-2 col-md-2' style='margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px' title='Add Sub Task'>";
  if ('@ViewBag.UserId' == node.data.UserId || '@ViewBag.UserId' == node.data.RequestedByUserId || '@ViewBag.UserId' == node.data.ProjectOwnerId) {
      data += "<span style='font-size: 14px; font-weight: 600; margin-left: -6px; cursor: pointer;' onclick='SubAllTask(\"" + node.data.id + "\",\"" + node.data.ProjectId + "\",\"" + node.data.TemplateCode + "\")'><i class='fa fas fa-plus'></i></span>";
 }

data +=" </div></div></div>";
                                    $tdList.eq(1).html(data);
                                    // $tdList.eq(1).text(node.data.ServiceNo);
                                },
                                dblclick: function (event, data) {
                                    var node = data.node;
                                },
                                contextMenu: {
                                    menu: function (data) {
                                        debugger;
                                        return {
                                        }
                                    },
                                    actions: function (node, action, options) {
                                    }
                                }
                            });
                        }


    //function getlocalizedstring(key)
    //{
    //
    //    $.ajax({
    //        url: "/home/GetLocalizedString",
    //        context: document.body
    //    }).done(function () {
    //        $(this).addClass("done");
    //    });


    //}

    function ViewServiceList(status, tempCode, count) {
        debugger
        var user = $("#PerformanceUser").data("kendoDropDownList").value();
        var pserId = $("#Id").data("kendoDropDownList").value();
        if (count > 0) {
            var win = GetMainWindow();
            win.iframeOpenUrl = '/Cms/NtsService/ServiceListByFilters?userId=' + user + '&statusCodes=' + status + '&templateCodes=' + tempCode + '&parentServiceId=' + pserId;
            win.OpenWindow({ Title: 'Services', Width: 1200, Height: 600 });
            return false;
        }
        else {
            return false;
        }
    }
    function ViewTaskList(status, tempCode, count) {
        debugger;
        var user = $("#PerformanceUser").data("kendoDropDownList").value();
        var pserId = $("#Id").data("kendoDropDownList").value();
        if (count > 0) {
            var win = GetMainWindow();
            win.iframeOpenUrl = '/Cms/NtsTask/TaskListByFilters?userId=' + user + '&statusCodes=' + status + '&templateCodes=' + tempCode + '&parentServiceId=' + pserId;
            win.OpenWindow({ Title: 'Tasks', Width: 1200, Height: 600 });
            return false;
        }
        else {
            return false;
        }
    }
</script>




<script id="template_Sub" type="text/kendo-ui-template">
    <div class="row" style="display:flex;border-radius: 0px 0px 6px 6px;width:268px;padding:5px;" >
        <div class="col-md-10" style="cursor:pointer" onclick="EditGoalTask('#:item.id#')">
            <span style="color:black;font-size:16px;">#: item.TaskName # -

       #if(item.UserName==null){#
       No Assignee
    #}
    else{#
      #: item.UserName #
    #}#


    </span>
        </div>

        @*<div class="col-xs-2 col-md-2 col-sm-2">
            <span data-type="#:item.TaskType#" class="tree-menu1" onclick=OnClick('#:item.id#','#:item.parentId#')><i class="fa fa-ellipsis-h"></i></span>
        </div>*@

    </div>
</script>
<script id="template_Sub1" type="text/kendo-ui-template">
    <div class="row" style="display:flex;border-radius: 0px 0px 6px 6px;width:268px;padding:5px;">
        <div class="col-md-10" style="cursor:pointer" onclick="EditCompetencyTask('#:item.id#')">
            <span style="color:black;font-size:16px;">#: item.TaskName # -

     #if(item.UserName==null){#
       No Assignee
    #}
    else{#
      #: item.UserName #
    #}#

   </span>
        </div>

        @*<div class="col-xs-2 col-md-2 col-sm-2">
            <span data-type="#:item.TaskType#" class="tree-menu1" onclick=OnClick('#:item.id#','#:item.parentId#')><i class="fa fa-ellipsis-h"></i></span>
        </div>*@

    </div>
</script>

<script id="template_devSub1" type="text/kendo-ui-template">
    <div class="row" style="display:flex;border-radius: 0px 0px 6px 6px;width:268px;padding:5px;">
        <div class="col-md-10" style="cursor:pointer" onclick="EditDevelopmentTask('#:item.id#')">
            <span style="color:black;font-size:16px;">#: item.TaskName # -
    #if(item.UserName==null){#
       No Assignee
    #}
    else{#
      #: item.UserName #
    #}#



    </span>
        </div>

        @*<div class="col-xs-2 col-md-2 col-sm-2">
            <span data-type="#:item.TaskType#" class="tree-menu1" onclick=OnClick('#:item.id#','#:item.parentId#')><i class="fa fa-ellipsis-h"></i></span>
        </div>*@

    </div>
</script>



<script id="newtemplate_Doc1" type="text/kendo-ui-template">
    #if(TaskType == '2' || Code == 'PMS_GOAL_MID_YEAR_EMPLOYEE' || Code == 'PMS_GOAL_MID_YEAR_MANAGER' || Code == 'PMS_COMP_MID_YEAR_EMPLOYEE' || Code == 'PMS_COMP_MID_YEAR_MANAGER' || Code == 'GOAL_APPROVAL_TASK')
    {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;background:lightcyan;">
    #}
    else {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;">
    #}#

        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;" onclick="EditGoalTask('#=TaskId#','#=TaskStatusCode#','#=Code#')">

            <div class="col-xs-10 col-md-10">
                <span style="font-size:16px;float:left;">#=TaskName# &nbsp &nbsp</span></br>
   #if(UserName==null){#
     <span style="font-size:14px;color:gray;float:left;"> No Assignee</span></br>
    #}
    else{#
     <span style="font-size:14px;color:gray;float:left;"> #=UserName#</span></br>
    #}#
     <span style="font-size:14px;color:gray;float:left;"> #:kendo.toString(kendo.parseDate(StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(DueDate), 'yyyy.MM.dd')# </span></br>

    <span class="#=TaskStatusCode#" style="font-size:14px;float:left;padding: 2px 6px 4px 6px;border-radius: 8px;" >#=TaskStatus#</span>

    </div>

     <div class="col-xs-2 col-md-2">
              #if(PhotoId != null)
                            {#
                                <img class="drp-user-photo" width="80" height="80" src="/cms/Document/GetImageMongo?id=#=PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>
     @*<div class="row #=TaskStatus#" style="padding:10px 30px 10px 10px;cursor:pointer;">
           <span style="font-size:14px;margin-left:15px" >#=TaskStatus#</span>

    </div>*@
    <div class="row" style="padding:0px 30px 10px 10px;cursor:pointer;">
    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count" onclick="LoadTreeView('#=TaskId#',null)">
 <span style="font-size:16px;margin-left: -4px" >#=SubTaskCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;background:orange;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Pending Task" @*onclick="LoadTreeView('#=TaskId#','Pending')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=PendingCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:greenyellow;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Completed Task" @*onclick="LoadTreeView('#=TaskId#','Completed')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=TotalCompletedCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubGoalTask('#=TaskId#','#=ProjectId#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>



    </div>
        @*<div class="panel-footer #=TaskStatus#" style="padding:5px;">
            <span style="font-size:14px; cursor:pointer;" data-toggle="collapse" data-target=".demo-#=TaskId#" ><i class="fas fa-arrow-right"></i> @Html.Raw(SharedResource["Show"]) #=SubTaskCount# @Html.Raw(SharedResource["Task"])</span>

    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;float:right; cursor:pointer;" onclick="SubGoalTask('#=TaskId#','#=ProjectId#')">+ @Html.Raw(SharedResource["NewSubTask"])</span>#}#

    </div>*@


    </div>
</script>

<script id="template_Doc3" type="text/kendo-ui-template">
    #if(TaskType == '2' || Code == 'PMS_GOAL_MID_YEAR_EMPLOYEE' || Code == 'PMS_GOAL_MID_YEAR_MANAGER' || Code == 'PMS_COMP_MID_YEAR_EMPLOYEE' || Code == 'PMS_COMP_MID_YEAR_MANAGER' || Code == 'GOAL_APPROVAL_TASK')
    {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;background:lightcyan;">
    #}
    else {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;">
    #}#

        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;" onclick="EditCompetencyTask('#=TaskId#','#=TaskStatusCode#','#=Code#')">

            <div class="col-xs-10 col-md-10">
                <span style="font-size:16px;float:left;">#=TaskName# &nbsp &nbsp</span></br>
   #if(UserName==null){#
     <span style="font-size:14px;color:gray;float:left;"> No Assignee</span></br>
    #}
    else{#
     <span style="font-size:14px;color:gray;float:left;"> #=UserName#</span></br>
    #}#
     <span style="font-size:14px;color:gray;float:left;"> #:kendo.toString(kendo.parseDate(StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(DueDate), 'yyyy.MM.dd')# </span></br>

    <span class="#=TaskStatusCode#" style="font-size:14px;float:left;padding: 2px 6px 4px 6px;border-radius: 8px;" >#=TaskStatus#</span>

    </div>

     <div class="col-xs-2 col-md-2">
              #if(PhotoId != null)
                            {#
                                <img class="drp-user-photo" width="80" height="80" src="/cms/Document/GetImageMongo?id=#=PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>
     @*<div class="row #=TaskStatus#" style="padding:10px 30px 10px 10px;cursor:pointer;">
           <span style="font-size:14px;margin-left:15px" >#=TaskStatus#</span>

    </div>*@
    <div class="row" style="padding:0px 30px 10px 10px;cursor:pointer;" >
    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count" onclick="LoadTreeView('#=TaskId#')">
 <span style="font-size:16px;margin-left: -4px" >#=SubTaskCount# </span>
    </div>

   <div class="col-xs-2 col-md-2" style="margin-left:15px;background:orange;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Pending Task" @*onclick="LoadTreeView('#=TaskId#','Pending')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=PendingCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:greenyellow;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Completed Task" @*onclick="LoadTreeView('#=TaskId#','Completed')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=TotalCompletedCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubCompetencyTask('#=TaskId#','#=ProjectId#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>

    </div>
        @*<div class="panel-footer #=TaskStatus#" style="padding:5px;">
            <span style="font-size:14px; cursor:pointer;" data-toggle="collapse" data-target=".demo-#=TaskId#" ><i class="fas fa-arrow-right"></i> @Html.Raw(SharedResource["Show"]) #=SubTaskCount# @Html.Raw(SharedResource["Task"])</span>

    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;float:right; cursor:pointer;" onclick="SubGoalTask('#=TaskId#','#=ProjectId#')">+ @Html.Raw(SharedResource["NewSubTask"])</span>#}#

    </div>*@


    </div>
</script>

<script id="template_devDoc3" type="text/kendo-ui-template">
    #if(TaskType == '2' || Code == 'PMS_GOAL_MID_YEAR_EMPLOYEE' || Code == 'PMS_GOAL_MID_YEAR_MANAGER' || Code == 'PMS_COMP_MID_YEAR_EMPLOYEE' || Code == 'PMS_COMP_MID_YEAR_MANAGER' || Code == 'GOAL_APPROVAL_TASK')
    {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;background:lightcyan;">
    #}
    else {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;">
    #}#
        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;" onclick="EditDevelopmentTask('#=TaskId#','#=TaskStatusCode#','#=Code#')">

            <div class="col-xs-10 col-md-10">
                <span style="font-size:16px;float:left;">#=TaskName# &nbsp &nbsp</span></br>
   #if(UserName==null){#
     <span style="font-size:14px;color:gray;float:left;"> No Assignee</span></br>
    #}
    else{#
     <span style="font-size:14px;color:gray;float:left;"> #=UserName#</span></br>
    #}#
     <span style="font-size:14px;color:gray;float:left;"> #:kendo.toString(kendo.parseDate(StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(DueDate), 'yyyy.MM.dd')# </span></br>

    <span class="#=TaskStatusCode#" style="font-size:14px;float:left;padding: 2px 6px 4px 6px;border-radius: 8px;" >#=TaskStatus#</span>

    </div>

     <div class="col-xs-2 col-md-2">
              #if(PhotoId != null)
                            {#
                                <img class="drp-user-photo" width="80" height="80" src="/cms/Document/GetImageMongo?id=#=PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>

    <div class="row" style="padding:0px 30px 10px 10px;cursor:pointer;" >
    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count" onclick="LoadTreeView('#=TaskId#')">
 <span style="font-size:16px;margin-left: -4px" >#=SubTaskCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;background:orange;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Pending Task" @*onclick="LoadTreeView('#=TaskId#','Pending')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=PendingCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:greenyellow;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Completed Task" @*onclick="LoadTreeView('#=TaskId#','Completed')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=TotalCompletedCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubDevelopmentTask('#=TaskId#','#=ProjectId#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>

    </div>



    </div>
</script>


<script id="template_allDoc3" type="text/kendo-ui-template">
    #if(TaskType == '2' || Code == 'PMS_GOAL_MID_YEAR_EMPLOYEE' || Code == 'PMS_GOAL_MID_YEAR_MANAGER' || Code == 'PMS_COMP_MID_YEAR_EMPLOYEE' || Code == 'PMS_COMP_MID_YEAR_MANAGER' || Code == 'GOAL_APPROVAL_TASK')
    {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;background:lightcyan;">
    #}
    else {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;">
    #}#
        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;" onclick="EditTask('#=TaskId#','#=TaskStatusCode#','#=Code#')">

            <div class="col-xs-10 col-md-10">
                <span style="font-size:16px;float:left;">#=TaskName# &nbsp &nbsp</span></br>
   #if(UserName==null){#
     <span style="font-size:14px;color:gray;float:left;"> No Assignee</span></br>
    #}
    else{#
     <span style="font-size:14px;color:gray;float:left;"> #=UserName#</span></br>
    #}#
     <span style="font-size:14px;color:gray;float:left;"> #:kendo.toString(kendo.parseDate(StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(DueDate), 'yyyy.MM.dd')# </span></br>

    <span class="#=TaskStatusCode#" style="font-size:14px;float:left;padding: 2px 6px 4px 6px;border-radius: 8px;" >#=TaskStatus#</span>

    </div>

     <div class="col-xs-2 col-md-2">
              #if(PhotoId != null)
                            {#
                                <img class="drp-user-photo" width="80" height="80" src="/cms/Document/GetImageMongo?id=#=PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>

    <div class="row" style="padding:0px 30px 10px 10px;cursor:pointer;" >
    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count" onclick="LoadTreeView('#=TaskId#')">
 <span style="font-size:16px;margin-left: -4px" >#=SubTaskCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:orange;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Pending Task" @*onclick="LoadTreeView('#=TaskId#','Pending')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=PendingCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:greenyellow;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Completed Task" @*onclick="LoadTreeView('#=TaskId#','Completed')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=TotalCompletedCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
    #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubAllTask('#=TaskId#','#=ProjectId#','#=TemplateCode#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>

    </div>



    </div>
</script>
<div class="row hr-pad-top-10">
    @*<div class="col-md-6">
            <h4>
                Project Task By Status
            </h4>
        </div>*@
</div>

<style>
    .box {
        margin-top: 10px;
        /*float: left;*/
        flex-direction: unset;
    }
    .indiv-block-bg {
        /*background-color: #F5EBBC;*/
        height: 150px;
        /*width: 280px;*/
        /*width: 275px;*/
        border-radius: 20px;
        margin-left: 20px;
        overflow: hidden !important;
        border: 1px solid #e66c80;
        background-color: #FFF;
    }
    .tempheader {
        margin-right: -15px;
        margin-left: -15px;
    }
    .title-bg {
        background-color: #E66C80;
        padding: 6px 0 2px 20px;
        margin: 0;
        font-size: 16px;
        color: #fff;
        border-radius: 12px 12px 0 0;
        height: auto;
        font-weight: 500;
    }
    .type {
        font-weight: 500;
        font-size: 16px;
    }
    .sercount {
        margin-right: 0px !important;
        margin-left: 0px !important;
        cursor: pointer;
    }
    .amount {
        font-size: 25px;
        font-family: poppins;
        font-weight: 600;
        white-space: nowrap;
        margin: 12px 0;
        cursor: pointer;
        /*border-bottom: 4px solid #353535;*/
    }
</style>
<div class="row">

    <div class="col-md-3 col-sm-6">
        <div class="box indiv-block-bg">
            <div class="row tempheader">
                <div class="col">
                    <div class="title-bg"><label class="type">Goal</label></div>
                </div>
            </div>
            <div class="row sercount" style="margin-top:5px;padding:5px;">
                <div class="col-3 text-secondary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('', '@Model.GTemplateCode','@Model.GTotalCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.GTotalCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Total</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-primary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_INPROGRESS,SERVICE_STATUS_OVERDUE','@Model.GTemplateCode','@Model.GInProgressCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.GInProgressCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Pending</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-success stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_COMPLETE','@Model.GTemplateCode','@Model.GCompletedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.GCompletedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Completed</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-danger stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_CANCEL,SERVICE_STATUS_REJECT', '@Model.GTemplateCode','@Model.GRejectedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.GRejectedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Rejected</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6">
        <div class="box indiv-block-bg">
            <div class="row tempheader">
                <div class="col">
                    <div class="title-bg"><label class="type">Competency</label></div>
                </div>
            </div>
            <div class="row sercount" style="margin-top:5px;padding:5px;">
                <div class="col-3 text-secondary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('','@Model.CTemplateCode','@Model.CTotalCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.CTotalCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Total</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-primary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_INPROGRESS,SERVICE_STATUS_OVERDUE','@Model.CTemplateCode','@Model.CInProgressCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;;">
                            <label class="amount">@Model.CInProgressCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Pending</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-success stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_COMPLETE','@Model.CTemplateCode','@Model.CCompletedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.CCompletedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Completed</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-danger stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_CANCEL,SERVICE_STATUS_REJECT','@Model.CTemplateCode','@Model.CRejectedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.CRejectedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Rejected</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6">
        <div class="box indiv-block-bg">
            <div class="row tempheader">
                <div class="col">
                    <div class="title-bg"><label class="type">Development</label></div>
                </div>
            </div>
            <div class="row sercount" style="margin-top:5px;padding:5px;">
                <div class="col-3 text-secondary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('','@Model.DTemplateCode','@Model.DTotalCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.DTotalCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Total</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-primary stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_INPROGRESS,SERVICE_STATUS_OVERDUE','@Model.DTemplateCode','@Model.DInProgressCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.DInProgressCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Pending</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-success stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_COMPLETE','@Model.DTemplateCode','@Model.DCompletedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.DCompletedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Completed</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-danger stscount" style="text-align:center;cursor:pointer;" onclick="ViewServiceList('SERVICE_STATUS_CANCEL,SERVICE_STATUS_REJECT','@Model.DTemplateCode','@Model.DRejectedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.DRejectedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Rejected</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="col-md-3 col-sm-6">

        <div class="box indiv-block-bg">
            <div class="row tempheader">
                <div class="col">
                    <div class="title-bg"><label class="type">All Tasks</label></div>
                </div>
            </div>
            <div class="row sercount" style="margin-top:5px;padding:5px;">                
                <div class="col-3 text-secondary stscount" style="text-align:center;cursor:pointer;" onclick="ViewTaskList('','PMS_GOAL,PMS_COMPENTENCY,PMS_DEVELOPMENT','@Model.TaskTotalCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.TaskTotalCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500;">Pending</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-primary stscount" style="text-align:center;cursor:pointer;" onclick="ViewTaskList('TASK_STATUS_INPROGRESS,TASK_STATUS_OVERDUE','PMS_GOAL,PMS_COMPENTENCY,PMS_DEVELOPMENT','@Model.TaskPendingCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.TaskPendingCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;font-weight:500;cursor:pointer;">Pending</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-success stscount" style="text-align:center;cursor:pointer;" onclick="ViewTaskList('TASK_STATUS_COMPLETE','PMS_GOAL,PMS_COMPENTENCY,PMS_DEVELOPMENT','@Model.TaskCompletedCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.TaskCompletedCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Completed</label>
                        </div>
                    </div>
                </div>
                <div class="col-3 text-danger stscount" style="text-align:center;cursor:pointer;" onclick="ViewTaskList('TASK_STATUS_CANCEL,TASK_STATUS_REJECT','PMS_GOAL,PMS_COMPENTENCY,PMS_DEVELOPMENT','@Model.TaskCancelledCount');">
                    <div>
                        <div class="row-12" style="margin-top:-5px;">
                            <label class="amount">@Model.TaskCancelledCount</label>
                        </div>
                        <div class="row-12" style="margin-top:-10px;">
                            <label style="font-size:14px;cursor:pointer;font-weight:500">Rejected</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
<br />
<div id="ProjectFilter">

</div>

<div class="row" style="text-align:center;margin-left:15px;margin-top:20px;">

    <div class="col-3" >
        <div class="row" id="performancestage" style="margin-top:55px;display:none">        
     <div style="margin-left:10px;float:left;padding:5px;">
                 <div class="card text-center" style="min-height:30px!important;width:270px;background-color:silver; display:inline-flex;cursor:pointer;" onclick="OnViewService('@Model.PerformanceStageServiceId','PMS_PERFORMANCE_DOCUMENT_STAGE')">
       <div class="row">
            <div class="col-md-12">
                <span style="font-size: 20px;font-weight: 600;color:black;top:10px">@Model.PerformanceStageName</span>
    </div>
         <div class="col-md-12">
             <span style="font-size:15px;font-weight: 400;color:white;top:10px">@Model.PerformanceStageOwner</span>
    </div>
            </div>
    </div>

                 <div>
                     @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                                .Name("listViewStage")
                                .TagName("div")
                                .ClientTemplateId("template_stage")
                                .DataSource(dataSource => dataSource
                                .Ajax()
                                .Read(read => read.Action("ReadPerformanceStageTask", "PerformanceTask", new { @area = "PMS" , stageId = Model.PerformanceStage, performanceId=Model.Id, ownerUserId=Model.PerformanceUser}))
                                .PageSize(21)
                                )
                                .HtmlAttributes(new {  @style = "height:650px;" })

                      )

                     <script id="template_stage" type="text/kendo-ui-template">
    #if(TaskType == '2' || Code == 'PMS_GOAL_MID_YEAR_EMPLOYEE' || Code == 'PMS_GOAL_MID_YEAR_MANAGER' || Code == 'PMS_COMP_MID_YEAR_EMPLOYEE' || Code == 'PMS_COMP_MID_YEAR_MANAGER' || Code == 'GOAL_APPROVAL_TASK')
    {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;background:lightcyan;">
    #}
    else {#
        <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;">
    #}#
        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;" onclick="EditTask('#=TaskId#','#=TaskStatusCode#','#=Code#')">

            <div class="col-xs-10 col-md-10">
                <span style="font-size:16px;float:left;">#=TaskName# &nbsp &nbsp</span></br>
   #if(UserName==null){#
     <span style="font-size:14px;color:gray;float:left;"> No Assignee</span></br>
    #}
    else{#
     <span style="font-size:14px;color:gray;float:left;"> #=UserName#</span></br>
    #}#
     <span style="font-size:14px;color:gray;float:left;"> #:kendo.toString(kendo.parseDate(StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(DueDate), 'yyyy.MM.dd')# </span></br>

    <span class="#=TaskStatusCode#" style="font-size:14px;float:left;padding: 2px 6px 4px 6px;border-radius: 8px;" >#=TaskStatus#</span>

    </div>

     <div class="col-xs-2 col-md-2">
              #if(PhotoId != null)
                            {#
                                <img class="drp-user-photo" width="80" height="80" src="/cms/Document/GetImageMongo?id=#=PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>

    <div class="row" style="padding:0px 30px 10px 10px;cursor:pointer;" >
    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count" onclick="LoadTreeView('#=TaskId#')">
 <span style="font-size:16px;margin-left: -4px" >#=SubTaskCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:orange;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Pending Task" @*onclick="LoadTreeView('#=TaskId#','Pending')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=PendingCount# </span>
    </div>

      <div class="col-xs-2 col-md-2" style="margin-left:15px;background:greenyellow;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Completed Task" @*onclick="LoadTreeView('#=TaskId#','Completed')"*@>
 <span style="font-size:16px;margin-left: -4px" >#=TotalCompletedCount# </span>
    </div>

     <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
   #if ('@ViewBag.UserId' == UserId || '@ViewBag.UserId' == RequestedByUserId || '@ViewBag.UserId' == ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubAllTask('#=TaskId#','#=ProjectId#','#=TemplateCode#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>

    </div>



    </div>
                     </script>

                 </div>
         

            </div>

       

        </div>
    </div>

    <div class="col-6" id="goal">
        <div class="row">
            @*@if (ViewBag.UserId == Model.ProjectOwnerId || ViewBag.UserId == Model.RequestedByUserId)*@
            @if (Model.Id.IsNotNullAndNotEmpty())
            {
                <div class="row" style="margin-right:0;margin-left:auto;margin-bottom:10px;">
                    <button class="btn-primary" onclick="AddGoal()" style="margin-right:15px"><i class="fas fa-plus"></i>@Resource["AddGoal"]</button>

                    <button class="btn-primary" onclick="AdjustWeightage()"><i class="fas fa-plus"></i>@Resource["AdjustWeightage"]</button>

                </div>

            }


        </div>

        <div class="row">
            <div class="col-6">
                <button style="float:left" id="left" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                <button style="float:left" id="right" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="col-6">
                <button style="float:right" id="right1" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                <button style="float:right" id="left1" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
            </div>
        </div>

        <div class="row">




            @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                                .Name("listView")
                                .TagName("div")
                                .ClientTemplateId("template_Doc")
                                .DataSource(dataSource => dataSource
                                .Ajax()
                                .Read(read => read.Action("ReadGoalServiceData", "PerformanceTask", new { @area = "PMS" , performanceId = Model.Id, stageId = Model.PerformanceStage, performanceUser=Model.PerformanceUser }).Data("filter"))
                                .PageSize(21)
                                )
                                .HtmlAttributes(new { @Class = "board", @id = "board", @style = "height:650px;" })
                      //.Events(events => events.DataBound("OnDataBoundDoc"))

                      )

            <script id="template_Doc" type="text/kendo-ui-template">


     <div style="margin-left:10px;float:left;padding:5px;">
                 <div class="card text-center" style="min-height:30px!important;width:270px;background-color:silver; display:inline-flex;cursor:pointer;" onclick="OnViewService('#=id#','#=TemplateCode#')">
       <div class="row">
            <div class="col-md-12">
                <span style="font-size: 20px;font-weight: 600;color:black;top:10px">#=StageName#</span>
    </div>
         <div class="col-md-12">
                <span style="font-size:15px;font-weight: 400;color:white;top:10px">#=ProjectOwnerName#</span>
    </div>
            </div>
    </div>

    <div>
                    @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                            .Name("listView_#=id#")
                            .TagName("div")
                            .ClientTemplateId("newtemplate_Doc1")
                            .DataSource(dataSource => dataSource
                            .Ajax()
                            .Read(read => read.Action("ReadPerformanceTaskView", "PerformanceTask", new { Id = "#=id#", performanceUser = Model.PerformanceUser, @area= "PMS" }).Data("filter"))
                            .PageSize(21)
                            )
                            .HtmlAttributes(new { @Class = "listViewDoc" })
                            .ToClientTemplate()

                    )

                </div>
            #if('@ViewBag.UserId' == ProjectOwnerId || '@ViewBag.UserId' == RequestedByUserId){#
              <div class="row" style="margin-top:0px">
                    <div class="col-md-12">
                        <div class="panel-footer" style="width:270px;background-color:black;  top:10px;">
                            <span style="font-weight:500;color:white;cursor:pointer" onclick="OnTask('#=id#')"><i class="fas fa-plus"></i>@Html.Raw(SharedResource["AddTask"])</span>
                        </div>
                    </div>
                </div>
            #}#

            </div>

            </script>

        </div>
    </div>

    <div class="col-6" style="display:none" id="competency">

        <div class="row" @*style="padding:5px;"*@>
            <div class="row" style="margin-right:0;margin-left:auto;margin-bottom:10px;">

                @*@if (ViewBag.UserId == Model.ProjectOwnerId || ViewBag.UserId == Model.RequestedByUserId)*@
                @if (Model.Id.IsNotNullAndNotEmpty())
                {
                    @*<button class="btn-primary" onclick="AddCompetencyMaster()" style="margin-right: 15px;"><i class="fas fa-plus"></i>@Resource["AddCompetency"]</button>*@
                    <button class="btn-primary" onclick="AddCompetency()" style="margin-right: 15px;"><i class="fas fa-plus"></i>@Resource["AddCompetency"]</button>
                }
                <button class="btn-primary" onclick="AdjustCompetencyWeightage()"><i class="fas fa-plus"></i>@Resource["AdjustCompetencyWeightage"]</button>


            </div>

        </div>


        <div class="row">
            <div class="col-6">
                <button style="float:left" id="leftC" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                <button style="float:left" id="rightC" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="col-6">
                <button style="float:right" id="rightC1" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                <button style="float:right" id="leftC1" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
            </div>
        </div>


        <div class="row">
            @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                                .Name("listView1")
                                .TagName("div")
                                .ClientTemplateId("template_Doc2")
                                .DataSource(dataSource => dataSource
                                .Ajax()
                                .Read(read => read.Action("ReadCompetencyServiceData", "PerformanceTask", new { @area = "PMS" ,performanceId=Model.Id, stageId = Model.PerformanceStage, performanceUser = Model.PerformanceUser }).Data("filter"))
                                .PageSize(21)
                                )
                                .HtmlAttributes(new { @Class = "board", @id = "Competencyboard", @style = "height:650px;" })
                      //.Events(events => events.DataBound("OnDataBoundDoc"))

                      )
        </div>
        <script id="template_Doc2" type="text/kendo-ui-template">


     <div style="margin-left:10px;float:left;padding:5px;">
                 <div class="card text-center" style="min-height:30px!important;width:270px;background-color:silver; display:inline-flex;cursor:pointer;" onclick="OnViewService('#=id#','#=TemplateCode#')">
       <div class="row">
            <div class="col-md-12">
                <span style="font-size: 20px;font-weight: 600;color:black;top:10px">#=StageName#</span>
    </div>
         <div class="col-md-12">
                <span style="font-size:15px;font-weight: 400;color:white;top:10px">#=ProjectOwnerName#</span>
    </div>
            </div>
    </div>

    <div>
                    @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                            .Name("listView_#=id#")
                            .TagName("div")
                            .ClientTemplateId("template_Doc3")
                            .DataSource(dataSource => dataSource
                            .Ajax()
                            .Read(read => read.Action("ReadPerformanceTaskView", "PerformanceTask", new { Id = "#=id#", performanceUser = Model.PerformanceUser, @area = "PMS" }).Data("filter"))
                            .PageSize(21)
                            )
                            .HtmlAttributes(new { @Class = "listViewDoc" })
                            .ToClientTemplate()

                    )

                </div>
            #if('@ViewBag.UserId' == ProjectOwnerId || '@ViewBag.UserId' == RequestedByUserId){#
              <div class="row" style="margin-top:0px">
                    <div class="col-md-12">
                        <div class="panel-footer" style="width:270px;background-color:black;  top:10px;">
                            <span style="font-weight:500;color:white;cursor:pointer" onclick="OnCompetencyTask('#=id#')"><i class="fas fa-plus"></i> @Html.Raw(SharedResource["AddTask"])</span>
                        </div>
                    </div>
                </div>
            #}#

            </div>

        </script>


    </div>

    <div class="col-6" style="display:none" id="development">


        <div class="col-md-12">

            @*<div class="row-12" style="">
                    <button style="float:left" id="left" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                    <button style="float:right" id="right" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                </div>*@
            <div class="row">
                <div class="col-6">
                    <button style="float:left" id="leftD" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                    <button style="float:left" id="rightD" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="col-6">
                    <button style="float:right" id="rightD1" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                    <button style="float:right" id="leftD1" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                </div>
            </div>
            <br />



            @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                                .Name("listView2")
                                .TagName("div")
                                .ClientTemplateId("template_devDoc2")
                                .DataSource(dataSource => dataSource
                                .Ajax()
                                .Read(read => read.Action("ReadDevelopmentServiceData", "PerformanceTask", new { @area = "PMS" ,performanceId=Model.Id, stageId = Model.PerformanceStage, performanceUser = Model.PerformanceUser }).Data("filter"))
                                .PageSize(21)
                                )
                                .HtmlAttributes(new { @Class = "board", @id = "developmentboard", @style = "height:650px;" })
                      //.Events(events => events.DataBound("OnDataBoundDoc"))

                      )

            <script id="template_devDoc2" type="text/kendo-ui-template">


     <div style="margin-left:10px;float:left;padding:5px;">
                 <div class="card text-center" style="min-height:30px!important;width:270px;background-color:silver; display:inline-flex;cursor:pointer;" onclick="OnViewService('#=id#','#=TemplateCode#')">
       <div class="row">
            <div class="col-md-12">
                <span style="font-size: 20px;font-weight: 600;color:black;top:10px">#=StageName#</span>
    </div>
         <div class="col-md-12">
                <span style="font-size:15px;font-weight: 400;color:white;top:10px">#=ProjectOwnerName#</span>
    </div>
            </div>
    </div>

    <div>
                    @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                            .Name("listView_#=id#")
                            .TagName("div")
                            .ClientTemplateId("template_devDoc3")
                            .DataSource(dataSource => dataSource
                            .Ajax()
                            .Read(read => read.Action("ReadPerformanceTaskView", "PerformanceTask", new { Id = "#=id#", performanceUser = Model.PerformanceUser, @area = "PMS" }).Data("filter"))
                            .PageSize(21)
                            )
                            .HtmlAttributes(new { @Class = "listViewDoc" })
                            .ToClientTemplate()

                    )

                </div>
            #if('@ViewBag.UserId' == ProjectOwnerId || '@ViewBag.UserId' == RequestedByUserId){#
              <div class="row" style="margin-top:0px">
                    <div class="col-md-12">
                        <div class="panel-footer" style="width:270px;background-color:black;  top:10px;">
                            <span style="font-weight:500;color:white;cursor:pointer" onclick="OnDevelopmentTask('#=id#')"><i class="fas fa-plus"></i> @Html.Raw(SharedResource["AddTask"])</span>
                        </div>
                    </div>
                </div>
            #}#

            </div>

            </script>


        </div>
    </div>

    <div class="col-6" id="all" style="display:none">
        <div class="row">
            @*@if (ViewBag.UserId == Model.ProjectOwnerId || ViewBag.UserId == Model.RequestedByUserId)*@
            @if (Model.Id.IsNotNullAndNotEmpty())
            {
                <div class="row" style="margin-right:0;margin-left:auto;margin-bottom:10px;">
                    <button class="btn-primary" onclick="AddGoal()" style="margin-right:15px"><i class="fas fa-plus"></i>@Resource["AddGoal"]</button>

                    <button class="btn-primary" onclick="AdjustWeightage()" style="margin-right:15px"><i class="fas fa-plus"></i>@Resource["AdjustGoalWeightage"]</button>

                    <button class="btn-primary" onclick="AddCompetency()" style="margin-right: 15px;"><i class="fas fa-plus"></i>@Resource["AddCompetency"]</button>

                    <button class="btn-primary" onclick="AdjustCompetencyWeightage()"><i class="fas fa-plus"></i>@Resource["AdjustCompetencyWeightage"]</button>

                </div>



            }


        </div>

        <div class="row">
            <div class="col-6">
                <button style="float:left" id="leftA" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
                <button style="float:left" id="rightA" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
            </div>
            <div class="col-6">
                <button style="float:right" id="rightA1" class="scrollbtn"><i class="fas fa-chevron-right"></i></button>
                <button style="float:right" id="leftA1" class="scrollbtn"><i class="fas fa-chevron-left"></i></button>
            </div>
        </div>

        <div class="row">




            @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                                .Name("listViewall3")
                                .TagName("div")
                                .ClientTemplateId("template_Docall")
                                .DataSource(dataSource => dataSource
                                .Ajax()
                                .Read(read => read.Action("ReadAllServiceData", "PerformanceTask", new { @area = "PMS" , performanceId = Model.Id, stageId=Model.PerformanceStage, performanceUser = Model.PerformanceUser }).Data("filter"))
                                .PageSize(30)
                                )
                                .HtmlAttributes(new { @Class = "board", @id = "allboard", @style = "height:650px;" })
                      //.Events(events => events.DataBound("OnDataBoundDoc"))

                      )

            <script id="template_Docall" type="text/kendo-ui-template">


     <div style="margin-left:10px;float:left;padding:5px;">
                 <div class="card text-center" style="min-height:30px!important;width:270px;background-color:silver; display:inline-flex;cursor:pointer;" onclick="OnViewService('#=id#','#=TemplateCode#')">
       <div class="row">
            <div class="col-md-12">
                <span style="font-size: 20px;font-weight: 600;color:black;top:10px">#=StageName#</span>
    </div>
         <div class="col-md-12">
                <span style="font-size:15px;font-weight: 400;color:white;top:10px">#=ProjectOwnerName#</span>
    </div>
            </div>
    </div>

    <div>
                    @(Html.Kendo().ListView<TeamWorkloadViewModel>()
                            .Name("listViewall_#=id#")
                            .TagName("div")
                            .ClientTemplateId("template_allDoc3")
                            .DataSource(dataSource => dataSource
                            .Ajax()
                            .Read(read => read.Action("ReadPerformanceTaskView", "PerformanceTask", new { Id = "#=id#", performanceUser = Model.PerformanceUser, @area = "PMS" }).Data("filter"))
                            .PageSize(21)
                            )
                            .HtmlAttributes(new { @Class = "listViewall" })
                            .ToClientTemplate()

                    )

                </div>
            #if('@ViewBag.UserId' == ProjectOwnerId || '@ViewBag.UserId' == RequestedByUserId){#
              <div class="row" style="margin-top:0px">
                    <div class="col-md-12">
                        <div class="panel-footer" style="width:270px;background-color:black;  top:10px;">
                            <span style="font-weight:500;color:white;cursor:pointer" onclick="OnAllTask('#=id#','#=TemplateCode#')"><i class="fas fa-plus"></i>@Html.Raw(SharedResource["AddTask"])</span>
                        </div>
                    </div>
                </div>
            #}#

            </div>

            </script>

        </div>
    </div>

    <div class="col-3" style="margin-top:27px;display:none;" id="SubTree">
        <span class="card text-center" style="height:53px;width:270px;background-color:silver;display:inline-flex;font-size: 20px;font-weight: 600;color:black;top:40px">SubTasks List</span><br />
        <div id="treeviewscss">
           <table id="SubtaskTreeView" style="width:100%">
                <colgroup>
                    <col width="5">
                    <col width="200">
                   
                </colgroup>
                <thead>
                    <tr>
                        <th class="treeheader"><div id="ServiceNo"></div></th>
                        <th class="treeheader"><div id="Action"></div></th>
                       
                    </tr>
                </thead>
                <tbody>
                    <tr>                        
                        <td class="treebody"></td>
                        <td class="treebody"></td>
                    </tr>
                </tbody>
            </table>
                    
           
            @*@(Html.Kendo().TreeView()
        .Name("SubtaskTreeView").HtmlAttributes(new { @class = "treeview",@style="width:300px;" })
        .DataTextField("Name")
          .Events(x=>x.Select("onTreeViewSelect"))
         .TemplateId("ct-tv-template")
        .DataSource(dataSource => dataSource
             .Read(read => read.Action("ReadSubTaskViewData", "PerformanceTask", new { @area = "PMS"})/*.Data("AddData")*/)
            )
        )*@
        </div>

        <script id="ct-tv-template" type="text/kendo-ui-template">
             <div class="card card_task" style="min-height:100px!important;width:270px;margin-left:0px;margin-top:10px;!important">
        <div class="row" style="padding:10px 50px 10px 10px;cursor:pointer;overflow-wrap:break-word !important;white-space:normal !important;" onclick="EditAllTask('#:item.id#','#:item.TaskStatusCode#','#:item.Code#')">

            <div class="col-10">
                <span style="font-size:16px;">#: item.TaskName.substring(0,5) # | </span>
   #if(item.UserName==null){#
     <span style="font-size:14px;color:gray;"> No Assignee |</span>
    #}
    else{#
     <span style="font-size:14px;color:gray;"> #: item.UserName.substring(0,5)# | </span>
    #}#
     <span style="font-size:14px;color:gray;"> #:kendo.toString(kendo.parseDate(item.StartDate), 'yyyy.MM.dd')# - #:kendo.toString(kendo.parseDate(item.DueDate), 'yyyy.MM.dd')# | </span>

    <span class="#:item.TaskStatusCode#" style="font-size:14px;padding: 2px 6px 4px 6px;border-radius: 8px;" >#: item.TaskStatus#</span>
    </div>

     <div class="col-2">
              #if(item.PhotoId != null)
                            {#
                                <img class="drp-user-photo2" width="80" height="80" src="/cms/Document/GetImageMongo?id=#:item.PhotoId#" onerror="OnPhotoError(this)" style='text-align: center;'>
                             #}
                            else {#
                            <img class="drp-user-photo2" width="80" height="80" src='/images/profile.jpg' style='text-align: center;'>
                                #}#
            </div>

        </div>

    <div class="row" style="padding:0px 30px 10px 10px;">
    <div class="col-xs-2 col-md-2" style="margin-left:15px;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Total Sub Task Count">
 <span style="font-size:16px;margin-left: -4px" >#: item.SubTaskCount# </span>
    </div>

    <div class="col-xs-2 col-md-2" style="margin-left:15px;cursor:pointer;background: cadetblue;height: 25px;width: 25px;flex: 0;border-radius: 30px" title="Add Sub Task">
    #if ('@ViewBag.UserId' == item.UserId || '@ViewBag.UserId' == item.RequestedByUserId || '@ViewBag.UserId' == item.ProjectOwnerId) {# <span style="font-size:14px;font-weight:600;margin-left: -6px ;cursor:pointer;" onclick="SubAllTask('#:item.id#','#:item.ProjectId#','#:item.TemplateCode#')"><i class="fa fas fa-plus"></i></span>#}#

    </div>

    </div>



    </div>

        </script>
    </div>
</div>

<div id="divmenu">
    @(Html.Kendo().Menu()
                .Name("menu")
                .Orientation(MenuOrientation.Vertical)
                .Events(e => e.Select("OnMenuClick"))
                .HtmlAttributes(new { @class = "dropdown-menu", @style="width:120px;color:black;" })
                .Items(items =>
                {
                items.Add().Text("Open").HtmlAttributes(new { @id = "Open" });
                items.Add().Text("Create Sub Task").HtmlAttributes(new { @id = "SubTask" });

                })
        )
</div>




