
@*@using Kendo.Mvc.UI;*@
@using Synergy.App.ViewModel;
@using Synergy.App.Common;
@model PayPropertyTaxViewModel
@{
    Layout = "~/Areas/Core/Views/Shared/_PopupLayout.cshtml";

}

<style>
    .txt{
        color:black;
        font-weight:bold;
    }
    .pad-5{
        padding:5px;
    }

    #page-top {
        background-color: #fff;
        color: #4e4b4b;
    }
    .appstatus {
        border: 1px solid;
        padding: 2px 10px 2px 10px;
        background-color: green;
        color: #fff;
        border-radius: 10px;
    }

</style>
<script type="text/javascript">

    $(document).ready(function () {

        $("#UlbId").kendoDropDownList({
            dataTextField: "Name",
            dataValueField: "Id",
            value: "@Model.UlbId",
            autoBind: true,
            dataSource: {
                transport: {
                    read: {
                        url: "/cms/LOV/GetLOVIdNameList?lovType=PROP_COLONY",
                    }
                }
            }
        });

    });

    function Close() {
        win = GetMainWindow();
        win.CloseWindow();
    }

    function OnDownload(type) {
        document.getElementById('Otp').value = '';
        ShowLoader($('#ndcdownload'));
        $.ajax({
                type: "POST",
            url: "/property/NoDuesCertificate/SendOTP?serviceId=" + '@Model.PropertyServiceId',
            success: function (data) {
                
                if (data.success) {
                    document.getElementById("otp").style.display = "block";
                    if (type == "resend") {
                        document.getElementById('otpsuccessmsg').innerHTML = 'OTP Resent to your Mobile Number, Please enter and press Submit';
                        ShowNotification("OTP Resent Successfully", "success");
                    }
                    else {
                        ShowNotification("OTP Sent Successfully", "success");
                    }

                    HideLoader($('#ndcdownload'));
                    } else {
                    ShowNotification(data.error, "error");
                    HideLoader($('#ndcdownload'));
                    }

                },
                dataType: "json",
            });
    }

    //ShowLoader($('#calendarHoliday'));
    function ValidateOTP() {
        ShowLoader($('#ndcdownload'));
        var currentOTP = $('#Otp').val();
        if (currentOTP != null && currentOTP != "" && currentOTP != undefined) {
            $.ajax({
                type: "POST",
                url: "/property/NoDuesCertificate/ValidateOTP?serviceId=" + '@Model.PropertyServiceId' + '&curOtp=' + currentOTP,
                success: function (res) {
                
                    if (res.success) {
                    HideLoader($('#ndcdownload'));
                        kendo.alert(res.data.NDCAttachmentId);
                    } else {
                        ShowNotification(res.errormsg, "error");
                    HideLoader($('#ndcdownload'));
                    }

                },
                dataType: "json",
            });
        }
        else {
            kendo.alert("Please Enter OTP");
            HideLoader($('#ndcdownload'));
        }
    }


</script>


<div class="row-12" style="margin-left:15px;" id="ndcdownload">

    <div class="col-12">
        <div class="row">
            <div class="col-6 pad-10">
                ULB &nbsp;
                @*@(Html.Kendo().DropDownListFor(x=>x.UlbId)
                                .DataTextField("Name")
                                .DataValueField("Id")
                                .DataSource(source =>
                                {
                                    source.Read(read =>
                                    {
                                        read.Action("GetLOVIdNameList", "LOV", new { @area = "cms", lovType = "PROP_COLONY" });
                                    });
                                })
                                .HtmlAttributes(new { @class = "form-control" , @style="width:80%", @readonly = "readonly" })
                            )*@
                <input asp-for="UlbId" id="UlbId" class="form-control" style="width:80%;" readonly />

            </div>
            <div class="col-6 pad-10" style="margin-top:5px;">
                <label style="font-weight:500;">Property ID :<span style="color:black;font-weight:bold;">&nbsp; @(Html.DisplayFor(x => x.PropertyId))</span></label>
            </div>
        </div>
    </div>
    <br />
    <div class="col-12">
        <div class="row">
            <div class="col-md-10 col-sm-10 pad-10" style="background-color:#eaecec;">
                <div><h5 style="font-weight:800;color:black">Property Owner Details</h5></div>
                <hr />
                <div class="row pad-5">
                    <div class="col-3">Owner Name</div>
                    <div class="col-9 txt">: @Html.DisplayFor(x => x.OwnerName)</div>
                </div>
                <div class="row pad-5">
                    <div class="col-3">Colony</div>
                    <div class="col-9 txt">: @Html.DisplayFor(x => x.Colony)</div>
                </div>
                <div class="row pad-5">
                    <div class="col-3">City</div>
                    <div class="col-9 txt">: @Html.DisplayFor(x => x.CityName)</div>
                </div>
                <div class="row pad-5">
                    <div class="col-3">Mobile</div>
                    <div class="col-9 txt">: @Html.DisplayFor(x => x.Mobile)</div>
                </div>
                <div class="row pad-5">
                    <div class="col-3">Email ID</div>
                    <div class="col-9 txt">: @Html.DisplayFor(x => x.Email)</div>
                </div>
                <div class="row pad-5">
                    <div class="col-3">Application Status</div>
                    <div class="col-9">
                        <div class="row-12">: <span class="appstatus">New Application Registered</span></div>
                    </div>
                </div>
            </div>
            <div class="col-md-10 col-sm-10 pad-10">

            </div>
        </div>
    </div>

    <br />
    <button type="button" class="btn btn-primary" onclick="OnDownload();">Download No Dues Certificate</button>
    <br /><br />

    <div class="col-md-10 col-sm-10 pad-10" style="display:none;" id="otp">
        <div><i class="fas fa-check-circle" style="color:green;"></i><span id="otpsuccessmsg">&nbsp;OTP sent to your Mobile Number, Please enter and press Submit</span></div>
        
        <div style="padding:10px;background-color:#eaecec;margin-top:10px;">           
            <span style="display:flex">
                <input asp-for="Otp" type="text" class="form-control" placeholder="Enter OTP" required="required" autocomplete="off" style="width:35%;" />
                <button class="btn btn-primary" style="margin-left:10px;" onclick="ValidateOTP();">Submit OTP</button>
                <button class="btn btn-link" onclick="OnDownload('resend');">Resend</button>
            </span>
        </div>
    </div>
    @Html.HiddenFor(x => x.PropertyServiceId)        

</div>  

