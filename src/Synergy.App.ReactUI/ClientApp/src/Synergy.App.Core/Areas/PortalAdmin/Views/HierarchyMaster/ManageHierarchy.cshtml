@using Synergy.App.ViewModel
@using Synergy.App.Common
@*@using Kendo.Mvc.UI*@

@{
    ViewData["Title"] = "Manage User";
    Layout = "~/Areas/Core/Views/Shared/_PopupLayout.cshtml";
}

@model HierarchyMasterViewModel

<style>
    .k-switch-label-on, .k-switch-label-off {
        display: flex
    }

    .form-control {
        width: unset;
    }

    .required {
        color: red;
    }

    .avatar-myProfile {
        border-radius: 50%;
        height: 80px;
        width: 80px;
    }
</style>

<div class="row" style="margin-left:15px;">

    <form asp-area="PortalAdmin" asp-controller="HierarchyMaster" asp-action="ManageUser" method="post" class="form-horizontal">
        <div class="text-danger" asp-validation-summary="All"></div>
        <div class="row" style="padding:10px;">
            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <div>
                        <label for="HierarchyType">Hierarchy Type<span class="required">*</span></label>
                    </div>
                    @*@(Html.Kendo().DropDownListFor(x=>x.HierarchyType)
                    .DataTextField("Name")
                    .DataValueField("Id")
                    //.Events(e => e.Change("OnPageTypechange"))
                    .DataSource(source =>
                    {
                    source.Read(read =>
                    {
                        read.Action("GetEnumIdNameList", "Home", new { @area = "", enumType = "HierarchyTypeEnum" });
                    });
                    })
                    .Value(Model.Status.ToString())
                    .HtmlAttributes(new { @class="form-control", style = "width: 80%" })
        )*@
                    <input asp-for="HierarchyType" id="HierarchyType" class="form-control" style="width: 80%" />
                </div>
            </div>

            <div class="col-12 pad-10">
                @*<input asp-for="Name" type="text" class="form-control" placeholder="Name" required="required" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input asp-for="Name" type="text" class="form-control" placeholder="Hierarchy Name" required="required" autocomplete="off" style="width:80%" />
                    <label for="Name">Hierarchy Name <span class="required">*</span></label>
                </div>
            </div>

            <div class="col-12 pad-10">
                @*<input asp-for="Email" type="email" class="form-control" placeholder="Email" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input asp-for="Code" type="text" class="form-control" placeholder="Hierarchy Code" required="required" autocomplete="off" style="width:80%" />
                    <label for="Code">Hierarchy Code<span class="required">*</span></label>
                </div>
            </div>

            <div class="col-12 pad-10">
                @*<input asp-for="Password" type="password" class="form-control" placeholder="Password" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Description" class="form-control" placeholder="Description" autocomplete="off" required="required" style="width:80%" />
                    <label for="Description">Description</label>
                </div>
            </div>

            <div class="col-12 pad-10">
                @*<input asp-for="Password" type="password" class="form-control" placeholder="Password" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Level1Name" class="form-control" placeholder="Level1Name" autocomplete="off" style="width:80%" />
                    <label for="Level1Name">Level1Name</label>
                </div>
            </div>

            <div class="col-12 pad-10">
                @*<input asp-for="JobTitle" type="text" class="form-control" placeholder="Job Title" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Level2Name" class="form-control" placeholder="Level2Name" autocomplete="off" style="width:80%" />
                    <label for="Level2Name">Level2Name</label>
                </div>
            </div>


            <div class="col-12 pad-10">
                @*<input asp-for="JobTitle" type="text" class="form-control" placeholder="Job Title" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Level3Name" class="form-control" placeholder="Level3Name" autocomplete="off" style="width:80%" />
                    <label for="Level3Name">Level3Name</label>
                </div>
            </div>


            <div class="col-12 pad-10">
                @*<input asp-for="JobTitle" type="text" class="form-control" placeholder="Job Title" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Level4Name" class="form-control" placeholder="Level4Name" autocomplete="off" style="width:80%" />
                    <label for="Level4Name">Level4Name</label>
                </div>
            </div>


            <div class="col-12 pad-10">
                @*<input asp-for="JobTitle" type="text" class="form-control" placeholder="Job Title" autocomplete="off" width="300" />*@
                <div class="form-label-group">
                    <input type="text" asp-for="Level5Name" class="form-control" placeholder="Level5Name" autocomplete="off" style="width:80%" />
                    <label for="Level5Name">Level5Name</label>
                </div>
            </div>

            <div class="col-12 pad-10">
                <div class="form-label-group">

                    <input asp-for="SequenceOrder" type="number" class="form-control" placeholder="Enter Sequence Order" autocomplete="off" style="width:80%" />
                    <label for="SequenceOrder">Enter Sequence Order</label>
                </div>
            </div>

            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <input type="text" asp-for="RootNodeId" class="form-control" placeholder="RootNodeId" autocomplete="off" style="width:80%" />
                    <label for="RootNodeId">RootNodeId</label>
                </div>
            </div>

            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <div>
                        <label for="Status">Status</label>
                    </div>
                    @*@(Html.Kendo().DropDownListFor(x=>x.Status)
                    .DataTextField("Name")
                    .DataValueField("Id")
                    //.Events(e => e.Change("OnPageTypechange"))
                    .DataSource(source =>
                    {
                    source.Read(read =>
                    {
                        read.Action("GetEnumIdNameList", "Home", new { @area = "", enumType = "StatusEnum" });
                    });
                    })
                    .Value(Model.Status.ToString())
                    .HtmlAttributes(new { @class="form-control", style = "width: 80%" })
        )*@
                    <input asp-for="Status" id="Status" class="form-control" style="width: 80%" />
                </div>
            </div>



            <div class="cms-slidebar-footer">
                <input type="button" class="btn btn-light" value="Close" onclick="closeNavUser()" />
                <input type="submit" class="btn btn-primary" value="Save" />
            </div>

        </div>
        @Html.HiddenFor(x => x.Id)
        @Html.HiddenFor(x => x.DataAction)

    </form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        if ('@ViewBag.Success' == "True") {
          //
            closeNavUser();
            //window.parent.$("#Usergrid").data("kendoGrid").dataSource.read();
            window.parent.getPortalHierarchyData();
        }

         $("#HierarchyType").kendoDropDownList({
            dataTextField: "Name",
            dataValueField: "Id",

            value:'@Model.HierarchyType.ToString()',
            dataSource: {
                transport: {
                    read: {
                        url: "/Home/GetEnumIdNameList?enumType=HierarchyTypeEnum",
                    }
                }
            }
         });


        $("#Status").kendoDropDownList({
            dataTextField: "Name",
            dataValueField: "Id",

            value:'@Model.Status.ToString()',
            dataSource: {
                transport: {
                    read: {
                        url: "/Home/GetEnumIdNameList?enumType=StatusEnum",
                    }
                }
            }
        });
    });

    function closeNavUser() {
        
        var win = GetMainWindow();
        win.CloseWindow();
        return false;
    }

    function onFileUploadSuccess(e) {
        //
        if (e.response.success) {
            // alert(e.response.fileId);
            //console.log(e);
            // set file id to hdden fileid proprty
            $.ajax({
                url: "/user/ChangeUserProfilePhoto?photoId=" + e.response.fileId,
                type: "GET",
                contentType: "application/json",
                dataType: "JSON",
                success: function (response) {
                   //
                    $(".avatar-myProfile").attr("src", "/user/profilephoto?id=" + e.response.fileId);
                    $("#PhotoId").val(e.response.fileId);
                }
            });

        }
        else {
            //var msg = ExtractError(e.response.errors, true);
            //alert(msg);
        }
        return true;
    }
    function onProfileDel() {
        //
        //  $('#dlg_DeleteConfirmation').data("kendoDialog").open();

        if ( $("#PhotoId").val()!='') {
         //
            kendo.confirm("Are you sure that you want to proceed?").then(function () {
                confirmDelete();
            }, function () {

            });
        }

    }

    function confirmDelete() {
     //
        //        alert("Banner Delete");
        $(".avatar-myProfile").attr("src", "/images/200.png");
        $("#PhotoId").val('');
        var logoupload = $("#files").data("kendoUpload");
        //console.log(logoupload);
        logoupload.clearFile(function (file) { return true; });
    }
</script>

