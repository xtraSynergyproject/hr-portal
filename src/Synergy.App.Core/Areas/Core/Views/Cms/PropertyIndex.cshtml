@using Synergy.App.ViewModel;
@using Synergy.App.Common;

@{
    ViewData["Title"] = "Member list";
    Layout = null;
}


<script>
    $(function () {

        getData();

        $.contextMenu({
            selector: '#tree-menuBin11',
            trigger: 'left',
            build: function ($trigger, e) {


                var id = $trigger.data('idvalue');

                switch (0) {
                    case 0:
                        return {
                            callback: function (key, options) {
                                switch (key) {
                                    case 'edit':
                                        OnEdit(id);
                                        break;

                                    //case 'delete':
                                    //    OnDeleteHierarchy(id);
                                    //    break;

                                    default:
                                }
                            },
                            items: {
                                "view": { name: "View", icon: "fas fa-edit" },
                                "edit": { name: "Edit", icon: "fas fa-edit" },
                                "paytax": { name: "Pay Tax", icon: "fas fa-edit" },
                                "deregisterproperty": { name: "De register Property", icon: "fas fa-edit" },
                                "verifypaymentstatus": { name: "Verify payment status", icon: "fas fa-edit" },
                                "paymentpassbook": { name: "Payment passbook", icon: "fas fa-edit" },
                                "applyforemutation": { name: "Apply for e-mutation", icon: "fas fa-edit" },
                            }
                        };


                }
            }
        });
    });

    var columnDefs = [
       
        {
            field: "PersonFullName",
            headerName: "UPIC"
        },
        {
            field: "ProperyTypeName",
            headerName: "Property Type"
        },
        {
            field: "OwnerTypeName",
            headerName: "Owner Type"
        },
        {
            field: "Colony",
            headerName: "Address"
        },
        {
            field: "Status",
            headerName: "Status"
        },
        {
            field: "CreatedDate",
            headerName: "Registered On"
        },
        {
            headerName: "Actions",
            field: "Id",
            cellRenderer: params => {
                return "<div class='btn-group grid-menu' id='tree-menuBin11' data-idvalue='" + params.value + "' data-status=\"0\" data-noteid=\"#:NoteId#\" ><i class='fas fa-ellipsis-v'></i></div>"
            }
        }
    ];





    function getData() {
        document.getElementById("empdirgrid").innerHTML = "";
        gridConfig(
            "empdirgrid",
            "/cms/GetPropertyData",
            columnDefs,
            false,
            true,
            true,
            true,
            1,
            true,
            10);
    }

</script>

<div class="row">
    <div class="col-12">
        @*<br /><br />
        <button type='button' class='btn btn-primary'><i class='fa fas fa-plus'></i>&nbsp;New Property</button>*@
        <br /><br />
        <div id="empdirgrid" style="width: 100%;height:550px" class="ag-theme-alpine"></div>
        <br /><br/>
        <div>
            <button class="btn btn-primary"> Emutation Requests</button>
            <button class="btn btn-primary"> Search Property</button>
            <button class="btn btn-primary"  onclick='createService();'> Register New Property</button>
            <button class="btn btn-primary"> Apply for New UPIC</button>
            <button class="btn btn-primary"> Link Notice To My Account</button>
            <button class="btn btn-primary"> Request For Transfer UPIC</button>
        </div>
    </div>
</div>



<script type="text/javascript">
    function createService() {
        var portalId = $('#GlobalPortalId').val();
        var win = GetMainWindow();
        var url = '/Cms/Page?lo=Popup&pageType=Service&cbm=OnAfterServiceCreate&source=Create&dataAction=Create&templateCodes=TAX_NEW_PROPERTY_JAMMU&portalId=' + portalId /*+ '&prms=' + prms*/;
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: 'Create Property', Width: 450, Height: 800 });
        return false;
    }

    function OnAfterItemCreate() {
        getData()
    }

    function OnEdit(id) {
        var portalId = $('#GlobalPortalId').val();
        var win = GetMainWindow();
        var url = '/Cms/Page?lo=Popup&source=View&dataAction=View&templateCodes=TAX_NEW_PROPERTY_JAMMU&portalId=' + portalId + '&recordId=' + id;
        win.iframeOpenUrl = url;
        win.OpenWindow({ Title: 'Add Property', Width: 1000, Height: 800 });
        return false;
    }
</script>