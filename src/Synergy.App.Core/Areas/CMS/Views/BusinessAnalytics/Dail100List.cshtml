
@using Synergy.App.ViewModel;
@using Synergy.App.Common;

 @model System.Data.DataTable

<div class="row">
    <div class="col-12">
        <div id="@ViewBag.GridName" style="width: 100%;height:550px" class="ag-theme-alpine"></div>
       
    </div>
</div>

<script>
    var columnDefs = [

        {
            field: "View",
            headerName: "View",
            minWidth: 100, 
            maxWidth: 100,
            cellRenderer: params => {
                return "<span class='fas fa-eye' onclick='viewDetails("+params.data.JsonString+")'></span>";
            }
        },
        @foreach (System.Data.DataColumn column in Model.Columns)
        {
            if (column.ColumnName == "JsonString")
            {
                @:{ field: '@column.ColumnName', headerName: "Details", minWidth: 300, maxWidth: 500, cellRenderer: params => {  if (params.data.@column.ColumnName != null && params.data.@column.ColumnName != undefined) { return "<div class='text-justify' >" + params.data.@column.ColumnName + " </div>"; }else { return "";}} },
            
            }
            else
            {
                 @:{ field: '@column.ColumnName', headerName: toTitleCaseGrid('@column.ColumnName'), minWidth: 150, maxWidth: 300, cellRenderer: params => {  if (params.data.@column.ColumnName != null && params.data.@column.ColumnName != undefined) { return "<div class='text-justify' >" + params.data.@column.ColumnName + " </div>"; }else { return "";}} },
                
            }
        }
    ];

    $(function () {
        document.getElementById("@ViewBag.GridName").innerHTML = "";
        //var geocodeService = L.esri.Geocoding.geocodeService();
        //var coord = { lat: @ViewBag.Latitude, lng: @ViewBag.Longitude }
        //geocodeService.reverse().latlng(coord).run(function (error, result) {
        //    var str = result != undefined ? result.address.Match_addr : "";
            //str = str + " @ViewBag.PoliceStation";
            gridConfig(
                "@ViewBag.GridName",
                "/cms/BusinessAnalytics/ReadCctnsDataList?indexName=@ViewBag.IndexName&policeStation=@ViewBag.PoliceStation&district=@ViewBag.District",
                columnDefs,
                false,
                true,
                true,
                true,
                1,
                true,
                10);

        //})
    });

    function viewDetails(json) {
     var str=JSON.stringify(json)
    var url = '/Cms/BusinessAnalytics/CCTNSDetails?cctnsData=' + str;
    var win = GetMainWindow();
    win.iframeOpenUrl = url;
    win.OpenWindow({ Title: 'CCTNS Details', Width: 1200, Height: 600 });
    return false;
}
</script>