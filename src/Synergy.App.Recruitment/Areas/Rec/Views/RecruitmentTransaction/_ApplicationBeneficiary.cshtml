@using Synergy.App.ViewModel
@using Synergy.App.Common

@{
    ViewData["Title"] = "Manage Candidate Experience";
    Layout = "~/Areas/Core/Views/Shared/_PopupLayout.cshtml";
}
@model ApplicationBeneficiaryViewModel

<div style="margin-top: 5px;padding-left: 20px;padding-right: 20px;width: 100%;">

   
        <form asp-controller="RecruitmentTransaction" asp-action="ManageBeneficiary" method="post" class="form-horizontal" id="myForm" data-ajax-begin="onAjaxBegin" data-ajax-complete="onAjaxComplete"
              data-ajax-failure="onAjaxFailed" data-ajax-success="onAjaxSuccess"
              data-ajax="true" data-ajax-method="POST">
            <div id="validation-summary-managepage" class="text-danger" asp-validation-summary="All"></div>
            <div class="row no-gutters pad-10">

                <div class="col-12 pad-10">
                    <div class="form-label-group">
                        <input asp-for="Name" type="text" class="form-control" placeholder="Enter Name" autocomplete="off" style="width:80%" required="required" />
                        <label for="Name">Enter Name <span class="required">*</span></label>
                    </div>
                </div>

                <div class="col-12 pad-10">
                    <div class="form-label-group">
                        <input asp-for="address" type="text" class="form-control" placeholder="Enter Address" autocomplete="off" style="width:80%" required="required" />
                        <label for="Address">Enter Address <span class="required">*</span></label>
                    </div>
                </div>

                <div class="col-12 pad-10">
                    <div class="form-label-group">
                        <input asp-for="Relationship" type="text" class="form-control" placeholder="Enter Relationship" autocomplete="off" style="width:80%" required="required" />
                        <label for="Name">Enter Relationship <span class="required">*</span></label>
                    </div>
                </div>

                <div class="col-12 pad-10">
                    <div class="form-label-group">
                        <input asp-for="Ratio" type="number" oninput="this.value = !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null" class="form-control" maxlength="100" placeholder="Enter Ratio" autocomplete="off" style="width:80%" required="required" />
                        <label for="Ratio">Enter Ratio <span class="required">*</span></label>
                    </div>
                </div>

            </div>

            @Html.HiddenFor(x => x.ApplicationId)
            @Html.HiddenFor(x => x.DataAction)
            @Html.HiddenFor(x => x.Id)
            @Html.HiddenFor(x => x.ReferenceId)
            @Html.HiddenFor(x => x.NoteId)
            @Html.HiddenFor(x => x.Json)

            <div class="cms-footer">
                <div class="col-sm-12" style="text-align:right;">
                    <button type="button" class="btn btn-light" onclick="closeNav();">Close</button>
                    <button type="submit" class="btn btn-success" onclick="OnSave(event)">Save</button>

                </div>

            </div>
        </form>
</div>

<script type="text/javascript">
       var onAjaxSuccess = function (res) {

        if (res.success) {
            if ('@Model.DataAction'=='@DataActionEnum.Create')
            {
                ShowNotification("SavedSuccessfully", "success");
            }
            if ('@Model.DataAction'=='@DataActionEnum.Edit')
            {
                ShowNotification("UpdatedSuccessfully", "success");
            }
            closeNav();
            window.parent.GetNominationforBenefits();
         
        }
        else {

            $(".text-danger").removeClass("validation-summary-valid");
            $(".text-danger").addClass("validation-summary-errors");
            $(".text-danger").html(res.error);

        }
    };

      $(document).ready(function () {

        if ('@ViewBag.Success' == "True") {
            closeNav();
           // window.parent.$("#grid").data("kendoGrid").dataSource.read();
        }
      });

    function OnSave(evt) {
        var ratio = document.getElementById("Ratio").value;
        if (ratio != "" && ratio > 100) {
            $(".text-danger").removeClass("validation-summary-valid");
            $(".text-danger").addClass("validation-summary-errors");
            $(".text-danger").html("Ratio should not be greater than 100");
            evt.preventDefault();
            return false;
        }
        else {
            $(".text-danger").removeClass("validation-summary-errors");
            $(".text-danger").addClass("validation-summary-valid");
        }
    }

    function closeNav() {
        //window.parent.CloseIframePopup1();
        var win = GetMainWindow();
        win.CloseWindow({ MethodName: 'CallBack' });
        return false;
    }
</script>