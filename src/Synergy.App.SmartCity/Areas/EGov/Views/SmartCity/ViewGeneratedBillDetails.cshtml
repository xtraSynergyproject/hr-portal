@using System.Text;
@using Synergy.App.ViewModel;
@using Synergy.App.Common;

@model JSCParcelViewModel

@{
    ViewData["Title"] = "Generated Bill Details";
    Layout = null;
}


<style>
    .colLabel {
        color: black !important;
    }

    .divDim {
        width: 100%;
        height: 100%;
        min-height: calc(100vh - 6.5rem);
        margin: auto;
    }
</style>

<script>
    $(function () {
        var url = "/EGov/SmartCity/GetPropertyTaxPaymentDetails";
        getBillDetails(url);
    });

    function onSearch() {
        debugger;
        var billNo = $("#billNo").val();
        var propNo = $("#propNo").val();
        var newUrl = "/EGov/SmartCity/GetPropertyTaxPaymentDetails?propNo=" + propNo + "&taskNo=" + billNo;
        getBillDetails(newUrl);
    }

    var columnDefs = [
        {
            field: "PropertyNo",
            headerName: "Property No",
            minWidth: 150
        },
        {
            field: "TaskNo",
            headerName: "Bill No",
            minWidth: 150
        },
        {
            field: "",
            headerName: "Amount Before Due Date",
            minWidth: 150,
            cellRenderer: params => {
                var date = new Date(params.value);
                return date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear();
            }
        },
        {
            field: "",
            headerName: "Amount After Due Date",
            minWidth: 150,
            cellRenderer: params => {
                var date = new Date(params.value);
                return date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear();
            }
        },
        {
            field: "",
            headerName: "Bill Dated",
            minWidth: 180,
            cellRenderer: params => {
                var date = new Date(params.value);
                return date.getDate() + "/" + (date.getMonth() + 1) + "/" + date.getFullYear();
            }
        },
        {
            field: "FinancialYearName",
            headerName: "Financial Year",
            minWidth: 150
        },
        {
            field: "",
            headerName: "Generated By",
            minWidth: 150
        }
    ];

    function getBillDetails(url) {
        document.getElementById("billDetailsGrid").innerHTML = "";
        gridConfig(
            "billDetailsGrid",
            url,
            columnDefs,
            false,
            true,
            true,
            true,
            1,
            true,
            10);
    }
    

</script>

<div id="appWrapper" class="wrapper">
    <div class="page">
        <div class="page-inner">
            <div class="row no-gutters p-2">
                <div class="col-lg-6 col-md-6 col-sm-12">
                    <h4>View Generated Bill Details</h4>
                </div>
            </div>
            <div class="row pad-20">
                <div class="col-lg-3 col-md-3 col-sm-12 p-1">
                    @*<label for="billNo">Bill No.</label>*@
                        <input id="billNo" class="form-control" type="text" placeholder="Bill No." style="width:100%;"/>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-12 p-1">
                    @*<label for="propNo">Property No</label>*@
                        <input id="propNo" class="form-control" type="text" placeholder="Property No." style="width:100%;"/>
                </div>
                <div class="col-lg-3 col-md-3 col-sm-12 p-1">
                    <button class="btn btn-primary" onclick="onSearch()">Get Bill Details</button>
                </div>
            </div>

            <div id="billDetailsGrid" style="width: 100%;height:350px" class="ag-theme-alpine"></div>
        </div>
    </div>
</div>
