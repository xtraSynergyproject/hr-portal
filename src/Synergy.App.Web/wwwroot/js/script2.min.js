/*!
 * jquery.fancytree.js
 * Tree view control with support for lazy loading and much more.
 * https://github.com/mar10/fancytree/
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
function hex_md5(n){return rstr2hex(rstr_md5(str2rstr_utf8(n)))}function b64_md5(n){return rstr2b64(rstr_md5(str2rstr_utf8(n)))}function any_md5(n,t){return rstr2any(rstr_md5(str2rstr_utf8(n)),t)}function hex_hmac_md5(n,t){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(t)))}function b64_hmac_md5(n,t){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(t)))}function any_hmac_md5(n,t,i){return rstr2any(rstr_hmac_md5(str2rstr_utf8(n),str2rstr_utf8(t)),i)}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(n){return binl2rstr(binl_md5(rstr2binl(n),n.length*8))}function rstr_hmac_md5(n,t){var r=rstr2binl(n),u,f,i,e;for(r.length>16&&(r=binl_md5(r,n.length*8)),u=Array(16),f=Array(16),i=0;i<16;i++)u[i]=r[i]^909522486,f[i]=r[i]^1549556828;return e=binl_md5(u.concat(rstr2binl(t)),512+t.length*8),binl2rstr(binl_md5(f.concat(e),640))}function rstr2hex(n){var i,r,u,t;try{hexcase}catch(f){hexcase=0}for(i=hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",t=0;t<n.length;t++)u=n.charCodeAt(t),r+=i.charAt(u>>>4&15)+i.charAt(u&15);return r}function rstr2b64(n){var t,f,i;try{b64pad}catch(e){b64pad=""}var u="",r=n.length;for(t=0;t<r;t+=3)for(f=n.charCodeAt(t)<<16|(t+1<r?n.charCodeAt(t+1)<<8:0)|(t+2<r?n.charCodeAt(t+2):0),i=0;i<4;i++)u+=t*8+i*6>n.length*8?b64pad:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(f>>>6*(3-i)&63);return u}function rstr2any(n,t){for(var l=t.length,e,o,r,u,f=Array(Math.ceil(n.length/2)),h,s,c,i=0;i<f.length;i++)f[i]=n.charCodeAt(i*2)<<8|n.charCodeAt(i*2+1);for(h=Math.ceil(n.length*8/(Math.log(t.length)/Math.log(2))),s=Array(h),e=0;e<h;e++){for(u=Array(),r=0,i=0;i<f.length;i++)r=(r<<16)+f[i],o=Math.floor(r/l),r-=o*l,(u.length>0||o>0)&&(u[u.length]=o);s[e]=r;f=u}for(c="",i=s.length-1;i>=0;i--)c+=t.charAt(s[i]);return c}function str2rstr_utf8(n){for(var i="",r=-1,t,u;++r<n.length;)t=n.charCodeAt(r),u=r+1<n.length?n.charCodeAt(r+1):0,55296<=t&&t<=56319&&56320<=u&&u<=57343&&(t=65536+((t&1023)<<10)+(u&1023),r++),t<=127?i+=String.fromCharCode(t):t<=2047?i+=String.fromCharCode(192|t>>>6&31,128|t&63):t<=65535?i+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|t&63):t<=2097151&&(i+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|t&63));return i}function str2rstr_utf16le(n){for(var i="",t=0;t<n.length;t++)i+=String.fromCharCode(n.charCodeAt(t)&255,n.charCodeAt(t)>>>8&255);return i}function str2rstr_utf16be(n){for(var i="",t=0;t<n.length;t++)i+=String.fromCharCode(n.charCodeAt(t)>>>8&255,n.charCodeAt(t)&255);return i}function rstr2binl(n){for(var i=Array(n.length>>2),t=0;t<i.length;t++)i[t]=0;for(t=0;t<n.length*8;t+=8)i[t>>5]|=(n.charCodeAt(t/8)&255)<<t%32;return i}function binl2rstr(n){for(var i="",t=0;t<n.length*32;t+=8)i+=String.fromCharCode(n[t>>5]>>>t%32&255);return i}function binl_md5(n,t){var e;n[t>>5]|=128<<t%32;n[(t+64>>>9<<4)+14]=t;var i=1732584193,r=-271733879,u=-1732584194,f=271733878;for(e=0;e<n.length;e+=16){var o=i,s=r,h=u,c=f;i=md5_ff(i,r,u,f,n[e+0],7,-680876936);f=md5_ff(f,i,r,u,n[e+1],12,-389564586);u=md5_ff(u,f,i,r,n[e+2],17,606105819);r=md5_ff(r,u,f,i,n[e+3],22,-1044525330);i=md5_ff(i,r,u,f,n[e+4],7,-176418897);f=md5_ff(f,i,r,u,n[e+5],12,1200080426);u=md5_ff(u,f,i,r,n[e+6],17,-1473231341);r=md5_ff(r,u,f,i,n[e+7],22,-45705983);i=md5_ff(i,r,u,f,n[e+8],7,1770035416);f=md5_ff(f,i,r,u,n[e+9],12,-1958414417);u=md5_ff(u,f,i,r,n[e+10],17,-42063);r=md5_ff(r,u,f,i,n[e+11],22,-1990404162);i=md5_ff(i,r,u,f,n[e+12],7,1804603682);f=md5_ff(f,i,r,u,n[e+13],12,-40341101);u=md5_ff(u,f,i,r,n[e+14],17,-1502002290);r=md5_ff(r,u,f,i,n[e+15],22,1236535329);i=md5_gg(i,r,u,f,n[e+1],5,-165796510);f=md5_gg(f,i,r,u,n[e+6],9,-1069501632);u=md5_gg(u,f,i,r,n[e+11],14,643717713);r=md5_gg(r,u,f,i,n[e+0],20,-373897302);i=md5_gg(i,r,u,f,n[e+5],5,-701558691);f=md5_gg(f,i,r,u,n[e+10],9,38016083);u=md5_gg(u,f,i,r,n[e+15],14,-660478335);r=md5_gg(r,u,f,i,n[e+4],20,-405537848);i=md5_gg(i,r,u,f,n[e+9],5,568446438);f=md5_gg(f,i,r,u,n[e+14],9,-1019803690);u=md5_gg(u,f,i,r,n[e+3],14,-187363961);r=md5_gg(r,u,f,i,n[e+8],20,1163531501);i=md5_gg(i,r,u,f,n[e+13],5,-1444681467);f=md5_gg(f,i,r,u,n[e+2],9,-51403784);u=md5_gg(u,f,i,r,n[e+7],14,1735328473);r=md5_gg(r,u,f,i,n[e+12],20,-1926607734);i=md5_hh(i,r,u,f,n[e+5],4,-378558);f=md5_hh(f,i,r,u,n[e+8],11,-2022574463);u=md5_hh(u,f,i,r,n[e+11],16,1839030562);r=md5_hh(r,u,f,i,n[e+14],23,-35309556);i=md5_hh(i,r,u,f,n[e+1],4,-1530992060);f=md5_hh(f,i,r,u,n[e+4],11,1272893353);u=md5_hh(u,f,i,r,n[e+7],16,-155497632);r=md5_hh(r,u,f,i,n[e+10],23,-1094730640);i=md5_hh(i,r,u,f,n[e+13],4,681279174);f=md5_hh(f,i,r,u,n[e+0],11,-358537222);u=md5_hh(u,f,i,r,n[e+3],16,-722521979);r=md5_hh(r,u,f,i,n[e+6],23,76029189);i=md5_hh(i,r,u,f,n[e+9],4,-640364487);f=md5_hh(f,i,r,u,n[e+12],11,-421815835);u=md5_hh(u,f,i,r,n[e+15],16,530742520);r=md5_hh(r,u,f,i,n[e+2],23,-995338651);i=md5_ii(i,r,u,f,n[e+0],6,-198630844);f=md5_ii(f,i,r,u,n[e+7],10,1126891415);u=md5_ii(u,f,i,r,n[e+14],15,-1416354905);r=md5_ii(r,u,f,i,n[e+5],21,-57434055);i=md5_ii(i,r,u,f,n[e+12],6,1700485571);f=md5_ii(f,i,r,u,n[e+3],10,-1894986606);u=md5_ii(u,f,i,r,n[e+10],15,-1051523);r=md5_ii(r,u,f,i,n[e+1],21,-2054922799);i=md5_ii(i,r,u,f,n[e+8],6,1873313359);f=md5_ii(f,i,r,u,n[e+15],10,-30611744);u=md5_ii(u,f,i,r,n[e+6],15,-1560198380);r=md5_ii(r,u,f,i,n[e+13],21,1309151649);i=md5_ii(i,r,u,f,n[e+4],6,-145523070);f=md5_ii(f,i,r,u,n[e+11],10,-1120210379);u=md5_ii(u,f,i,r,n[e+2],15,718787259);r=md5_ii(r,u,f,i,n[e+9],21,-343485551);i=safe_add(i,o);r=safe_add(r,s);u=safe_add(u,h);f=safe_add(f,c)}return Array(i,r,u,f)}function md5_cmn(n,t,i,r,u,f){return safe_add(bit_rol(safe_add(safe_add(t,n),safe_add(r,f)),u),i)}function md5_ff(n,t,i,r,u,f,e){return md5_cmn(t&i|~t&r,n,t,u,f,e)}function md5_gg(n,t,i,r,u,f,e){return md5_cmn(t&r|i&~r,n,t,u,f,e)}function md5_hh(n,t,i,r,u,f,e){return md5_cmn(t^i^r,n,t,u,f,e)}function md5_ii(n,t,i,r,u,f,e){return md5_cmn(i^(t|~r),n,t,u,f,e)}function safe_add(n,t){var i=(n&65535)+(t&65535),r=(n>>16)+(t>>16)+(i>>16);return r<<16|i&65535}function bit_rol(n,t){return n<<t|n>>>32-t}function GetStack(){return new Stack}function TrimText(n,t){return n.length>t-3?n.substring(0,t-4)+"...":n}function InitializeContePlaceHolder(){$(".content-editable").each(function(){var n=$(this);n.html().trim()===""&&n.html(n.data("placeholder"))})}function ContentEditableBlur(n){var t=$(n),i=t.html().trim();i===""?(t.html(t.data("placeholder")),t.addClass("placeholder")):t.removeClass("placeholder")}function ContentEditableFocus(n){var t=$(n),i=t.html().trim();i==t.data("placeholder")&&(t.html(""),t.removeClass("placeholder"))}function GenerateGuid(){function n(n){var t=(Math.random().toString(16)+"000000000").substr(2,8);return n?"-"+t.substr(0,4)+"-"+t.substr(4,4):t}return n()+n(!0)+n(!0)+n()}function UtilityAjax(n,t){var r="../../utility/"+n+"?"+t,i="";return $.ajax({url:r,type:"GET",cache:!1,"async":!1,success:function(n){i=n},error:function(n){OnError(n)}}),i}var CryptoJS,hexcase,b64pad,EncryptionKey;(function(n,t,i,r){"use strict";function u(t,i){t||(i=i?": "+i:"",n.error("Fancytree assertion failed"+i))}function s(n,i){var r,u,f=t.console?t.console[n]:null;if(f)try{f.apply(t.console,i)}catch(e){for(u="",r=0;r<i.length;r++)u+=i[r];f(u)}}function it(n){return n!=null?n.length>26?n.substring(0,25)+"...":n:""}function at(n){return!!(n.tree&&n.statusNodeType!==r)}function vt(t){for(var r,u,e=n.map(n.trim(t).split("."),function(n){return parseInt(n,10)}),f=n.map(Array.prototype.slice.call(arguments,1),function(n){return parseInt(n,10)}),i=0;i<f.length;i++)if(r=e[i]||0,u=f[i]||0,r!==u)return r>u;return!0}function rt(n,t,i,r,u){return function(){var i=t[n],f=r[n],e=t.ext[u],o=function(){return i.apply(t,arguments)},s=function(n){return i.apply(t,n)};return function(){var n=t._local,i=t._super,r=t._superApply;try{return t._local=e,t._super=o,t._superApply=s,f.apply(t,arguments)}finally{t._local=n;t._super=i;t._superApply=r}}}()}function yt(t,i,r,u){for(var f in r)typeof r[f]=="function"?typeof t[f]=="function"?t[f]=rt(f,t,i,r,u):f.charAt(0)==="_"?t.ext[u][f]=rt(f,t,i,r,u):n.error("Could not override tree."+f+". Use prefix '_' to create tree."+u+"._"+f):f!=="options"&&(t.ext[u][f]=r[f])}function e(t,i){return t===r?n.Deferred(function(){this.resolve()}).promise():n.Deferred(function(){this.resolveWith(t,i)}).promise()}function w(t,i){return t===r?n.Deferred(function(){this.reject()}).promise():n.Deferred(function(){this.rejectWith(t,i)}).promise()}function ut(n,t){return function(){n.resolveWith(t)}}function b(t){var i=n.extend({},t.data()),r=i.json;return delete i.fancytree,delete i.uiFancytree,r&&(delete i.json,i=n.extend(i,r)),i}function ft(n){return(""+n).replace(st,function(n){return d[n]})}function pt(n){return(""+n).replace(ht,function(n){return d[n]})}function et(n){return n=n.toLowerCase(),function(t){return t.title.toLowerCase().indexOf(n)>=0}}function wt(n){var t=new RegExp("^"+n,"i");return function(n){return t.test(n.title)}}function l(t,i){var e,s,r,o;for(this.parent=t,this.tree=t.tree,this.ul=null,this.li=null,this.statusNodeType=null,this._isLoading=!1,this._error=null,this.data={},e=0,s=h.length;e<s;e++)r=h[e],this[r]=i[r];(this.unselectableIgnore!=null||this.unselectableStatus!=null)&&(this.unselectable=!0);i.hideCheckbox&&n.error("'hideCheckbox' node option was removed in v2.23.0: use 'checkbox: false'");i.data&&n.extend(this.data,i.data);for(r in i)y[r]||n.isFunction(i[r])||tt[r]||(this.data[r]=i[r]);this.key==null?this.tree.options.defaultKey?(this.key=this.tree.options.defaultKey(this),u(this.key,"defaultKey() must return a unique key")):this.key="_"+f._nextNodeKey++:this.key=""+this.key;i.active&&(u(this.tree.activeNode===null,"only one active node allowed"),this.tree.activeNode=this);i.selected&&(this.tree.lastSelectedNode=this);o=i.children;o?o.length?this._setChildren(o):this.children=this.lazy?[]:null:this.children=null;this.tree._callHook("treeRegisterNode",this.tree,!0,this)}function a(t){this.widget=t;this.$div=t.element;this.options=t.options;this.options&&(n.isFunction(this.options.lazyload)&&!n.isFunction(this.options.lazyLoad)&&(this.options.lazyLoad=function(){return f.warn("The 'lazyload' event is deprecated since 2014-02-25. Use 'lazyLoad' (with uppercase L) instead."),t.options.lazyload.apply(this,arguments)}),n.isFunction(this.options.loaderror)&&n.error("The 'loaderror' event was renamed since 2014-07-03. Use 'loadError' (with uppercase E) instead."),this.options.fx!==r&&f.warn("The 'fx' option was replaced by 'toggleEffect' since 2014-11-30."),this.options.removeNode!==r&&n.error("The 'removeNode' event was replaced by 'modifyChild' since 2.20 (2016-09-10)."));this.ext={};this.data=b(this.$div);this._id=n.ui.fancytree._nextId++;this._ns=".fancytree-"+this._id;this.activeNode=null;this.focusNode=null;this._hasFocus=null;this._enableUpdate=!0;this.lastSelectedNode=null;this.systemFocusElement=null;this.lastQuicksearchTerm="";this.lastQuicksearchTime=0;this.statusClassPropName="span";this.ariaPropName="li";this.nodeContainerAttrName="li";this.$div.find(">ul.fancytree-container").remove();var u={tree:this},i;this.rootNode=new l(u,{title:"root",key:"root_"+this._id,children:null,expanded:!0});this.rootNode.parent=null;i=n("<ul>",{"class":"ui-fancytree fancytree-container fancytree-plain"}).appendTo(this.$div);this.$container=i;this.rootNode.ul=i[0];this.options.debugLevel==null&&(this.options.debugLevel=f.debugLevel)}if(n.ui&&n.ui.fancytree){n.ui.fancytree.warn("Fancytree: ignored duplicate include");return}for(var c,f=null,ot=new RegExp(/\.|\//),st=/[&<>"'\/]/g,ht=/[<>"'\/]/g,k="$recursive_request",d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},ct={16:!0,17:!0,18:!0},g={8:"backspace",9:"tab",10:"return",13:"return",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",59:";",61:"=",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},lt={0:"",1:"left",2:"middle",3:"right"},v="active expanded focus folder lazy radiogroup selected unselectable unselectableIgnore".split(" "),nt={},h="checkbox expanded extraClasses folder icon key lazy radiogroup refKey selected statusNodeType title tooltip unselectable unselectableIgnore unselectableStatus".split(" "),y={},p={},tt={active:!0,children:!0,data:!0,focus:!0},o=0;o<v.length;o++)nt[v[o]]=!0;for(o=0;o<h.length;o++)c=h[o],y[c]=!0,c!==c.toLowerCase()&&(p[c.toLowerCase()]=c);u(n.ui,"Fancytree requires jQuery UI (http://jqueryui.com)");l.prototype={_findDirectChild:function(n){var t,r,i=this.children;if(i)if(typeof n=="string"){for(t=0,r=i.length;t<r;t++)if(i[t].key===n)return i[t]}else{if(typeof n=="number")return this.children[n];if(n.parent===this)return n}return null},_setChildren:function(n){u(n&&(!this.children||this.children.length===0),"only init supported");this.children=[];for(var t=0,i=n.length;t<i;t++)this.children.push(new l(this,n[t]))},addChildren:function(t,i){var r,e,o,s=this.getFirstChild(),h=this.getLastChild(),c=null,f=[];for(n.isPlainObject(t)&&(t=[t]),this.children||(this.children=[]),r=0,e=t.length;r<e;r++)f.push(new l(this,t[r]));if(c=f[0],i==null?this.children=this.children.concat(f):(i=this._findDirectChild(i),o=n.inArray(i,this.children),u(o>=0,"insertBefore must be an existing child"),this.children.splice.apply(this.children,[o,0].concat(f))),s&&!i){for(r=0,e=f.length;r<e;r++)f[r].render();s!==this.getFirstChild()&&s.renderStatus();h!==this.getLastChild()&&h.renderStatus()}else(!this.parent||this.parent.ul||this.tr)&&this.render();return this.tree.options.selectMode===3&&this.fixSelection3FromEndNodes(),this.triggerModifyChild("add",f.length===1?f[0]:null),c},addClass:function(n){return this.toggleClass(n,!0)},addNode:function(n,t){(t===r||t==="over")&&(t="child");switch(t){case"after":return this.getParent().addChildren(n,this.getNextSibling());case"before":return this.getParent().addChildren(n,this);case"firstChild":var i=this.children?this.children[0]:null;return this.addChildren(n,i);case"child":case"over":return this.addChildren(n)}u(!1,"Invalid mode: "+t)},addPagingNode:function(t,i){var r,u;if(i=i||"child",t===!1){for(r=this.children.length-1;r>=0;r--)u=this.children[r],u.statusNodeType==="paging"&&this.removeChild(u);this.partload=!1;return}return t=n.extend({title:this.tree.options.strings.moreData,statusNodeType:"paging",icon:!1},t),this.partload=!0,this.addNode(t,i)},appendSibling:function(n){return this.addNode(n,"after")},applyPatch:function(t){if(t===null)return this.remove(),e(this);var i,r,u={children:!0,expanded:!0,parent:!0};for(i in t)r=t[i],u[i]||n.isFunction(r)||(y[i]?this[i]=r:this.data[i]=r);return t.hasOwnProperty("children")&&(this.removeChildren(),t.children&&this._setChildren(t.children)),this.isVisible()&&(this.renderTitle(),this.renderStatus()),t.hasOwnProperty("expanded")?this.setExpanded(t.expanded):e(this)},collapseSiblings:function(){return this.tree._callHook("nodeCollapseSiblings",this)},copyTo:function(n,t,i){return n.addNode(this.toDict(!0,i),t)},countChildren:function(n){var r=this.children,t,u,i;if(!r)return 0;if(i=r.length,n!==!1)for(t=0,u=i;t<u;t++)i+=r[t].countChildren();return i},debug:function(){this.tree.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),s("log",arguments))},discard:function(){return this.warn("FancytreeNode.discard() is deprecated since 2014-02-16. Use .resetLazy() instead."),this.resetLazy()},discardMarkup:function(n){var t=n?"nodeRemoveMarkup":"nodeRemoveChildMarkup";this.tree._callHook(t,this)},findAll:function(t){t=n.isFunction(t)?t:et(t);var i=[];return this.visit(function(n){t(n)&&i.push(n)}),i},findFirst:function(t){t=n.isFunction(t)?t:et(t);var i=null;return this.visit(function(n){if(t(n))return i=n,!1}),i},_changeSelectStatusAttrs:function(n){var t=!1,i=this.tree.options,o=f.evalOption("unselectable",this,this,i,!1),e=f.evalOption("unselectableStatus",this,this,i,r);o&&e!=null&&(n=e);switch(n){case!1:t=this.selected||this.partsel;this.selected=!1;this.partsel=!1;break;case!0:t=!this.selected||!this.partsel;this.selected=!0;this.partsel=!0;break;case r:t=this.selected||!this.partsel;this.selected=!1;this.partsel=!0;break;default:u(!1,"invalid state: "+n)}return t&&this.renderStatus(),t},fixSelection3AfterClick:function(n){var t=this.isSelected();this.visit(function(n){n._changeSelectStatusAttrs(t)});this.fixSelection3FromEndNodes(n)},fixSelection3FromEndNodes:function(){function t(i){var u,v,e,h,o,c,l,y,a,s=i.children;if(s&&s.length){for(c=!0,l=!1,u=0,v=s.length;u<v;u++)e=s[u],h=t(e),y=f.evalOption("unselectableIgnore",e,e,n,!1),y||(h!==!1&&(l=!0),h!==!0&&(c=!1));o=c?!0:l?r:!1}else a=f.evalOption("unselectableStatus",i,i,n,r),o=a==null?!!i.selected:!!a;return i._changeSelectStatusAttrs(o),o}var n=this.tree.options;u(n.selectMode===3,"expected selectMode 3");t(this);this.visitParents(function(t){for(var i,u,h,o,c=t.children,l=!0,a=!1,e=0,s=c.length;e<s;e++)i=c[e],h=f.evalOption("unselectableIgnore",i,i,n,!1),h||(o=f.evalOption("unselectableStatus",i,i,n,r),u=o==null?!!i.selected:!!o,(u||i.partsel)&&(a=!0),u||(l=!1));u=l?!0:a?r:!1;t._changeSelectStatusAttrs(u)})},fromDict:function(t){for(var i in t)y[i]?this[i]=t[i]:i==="data"?n.extend(this.data,t.data):n.isFunction(t[i])||tt[i]||(this.data[i]=t[i]);t.children&&(this.removeChildren(),this.addChildren(t.children));this.renderTitle()},getChildren:function(){return this.hasChildren()===r?r:this.children},getFirstChild:function(){return this.children?this.children[0]:null},getIndex:function(){return n.inArray(this,this.parent.children)},getIndexHier:function(t,i){t=t||".";var r,u=[];return n.each(this.getParentList(!1,!0),function(n,t){r=""+(t.getIndex()+1);i&&(r=("0000000"+r).substr(-i));u.push(r)}),u.join(t)},getKeyPath:function(n){var t=[],i=this.tree.options.keyPathSeparator;return this.visitParents(function(n){n.parent&&t.unshift(n.key)},!n),i+t.join(i)},getLastChild:function(){return this.children?this.children[this.children.length-1]:null},getLevel:function(){for(var t=0,n=this.parent;n;)t++,n=n.parent;return t},getNextSibling:function(){if(this.parent)for(var t=this.parent.children,n=0,i=t.length-1;n<i;n++)if(t[n]===this)return t[n+1];return null},getParent:function(){return this.parent},getParentList:function(n,t){for(var r=[],i=t?this:this.parent;i;)(n||i.parent)&&r.unshift(i),i=i.parent;return r},getPrevSibling:function(){if(this.parent)for(var t=this.parent.children,n=1,i=t.length;n<i;n++)if(t[n]===this)return t[n-1];return null},getSelectedNodes:function(n){var t=[];return this.visit(function(i){if(i.selected&&(t.push(i),n===!0))return"skip"}),t},hasChildren:function(){return this.lazy?this.children==null?r:this.children.length===0?!1:this.children.length===1&&this.children[0].isStatusNode()?r:!0:!!(this.children&&this.children.length)},hasFocus:function(){return this.tree.hasFocus()&&this.tree.focusNode===this},info:function(){this.tree.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),s("info",arguments))},isActive:function(){return this.tree.activeNode===this},isChildOf:function(n){return this.parent&&this.parent===n},isDescendantOf:function(n){if(!n||n.tree!==this.tree)return!1;for(var t=this.parent;t;){if(t===n)return!0;t=t.parent}return!1},isExpanded:function(){return!!this.expanded},isFirstSibling:function(){var n=this.parent;return!n||n.children[0]===this},isFolder:function(){return!!this.folder},isLastSibling:function(){var n=this.parent;return!n||n.children[n.children.length-1]===this},isLazy:function(){return!!this.lazy},isLoaded:function(){return!this.lazy||this.hasChildren()!==r},isLoading:function(){return!!this._isLoading},isRoot:function(){return this.isRootNode()},isPartsel:function(){return!this.selected&&!!this.partsel},isPartload:function(){return!!this.partload},isRootNode:function(){return this.tree.rootNode===this},isSelected:function(){return!!this.selected},isStatusNode:function(){return!!this.statusNodeType},isPagingNode:function(){return this.statusNodeType==="paging"},isTopLevel:function(){return this.tree.rootNode===this.parent},isUndefined:function(){return this.hasChildren()===r},isVisible:function(){for(var i=this.getParentList(!1,!1),n=0,t=i.length;n<t;n++)if(!i[n].expanded)return!1;return!0},lazyLoad:function(n){return this.warn("FancytreeNode.lazyLoad() is deprecated since 2014-02-16. Use .load() instead."),this.load(n)},load:function(n){var t,i,r=this,f=this.isExpanded();return(u(this.isLazy(),"load() requires a lazy node"),!n&&!this.isUndefined())?e(this):(this.isLoaded()&&this.resetLazy(),i=this.tree._triggerNodeEvent("lazyLoad",this),i===!1)?e(this):(u(typeof i!="boolean","lazyLoad event must return source in data.result"),t=this.tree._callHook("nodeLoadChildren",this,i),f?(this.expanded=!0,t.always(function(){r.render()})):t.always(function(){r.renderStatus()}),t)},makeVisible:function(t){for(var e=this,u=[],r=new n.Deferred,f=this.getParentList(!1,!1),o=f.length,s=!(t&&t.noAnimation===!0),h=!(t&&t.scrollIntoView===!1),i=o-1;i>=0;i--)u.push(f[i].setExpanded(!0,t));return n.when.apply(n,u).done(function(){h?e.scrollIntoView(s).done(function(){r.resolve()}):r.resolve()}),r.promise()},moveTo:function(t,i,f){i===r||i==="over"?i="child":i==="firstChild"&&(t.children&&t.children.length?(i="before",t=t.children[0]):i="child");var o,s=this.parent,e=i==="child"?t:t.parent;if(this!==t){if(this.parent?e.isDescendantOf(this)&&n.error("Cannot move a node to its own descendant"):n.error("Cannot move system root"),e!==s&&s.triggerModifyChild("remove",this),this.parent.children.length===1){if(this.parent===e)return;this.parent.children=this.parent.lazy?[]:null;this.parent.expanded=!1}else o=n.inArray(this,this.parent.children),u(o>=0,"invalid source parent"),this.parent.children.splice(o,1);if(this.parent=e,e.hasChildren())switch(i){case"child":e.children.push(this);break;case"before":o=n.inArray(t,e.children);u(o>=0,"invalid target parent");e.children.splice(o,0,this);break;case"after":o=n.inArray(t,e.children);u(o>=0,"invalid target parent");e.children.splice(o+1,0,this);break;default:n.error("Invalid mode "+i)}else e.children=[this];f&&t.visit(f,!0);e===s?e.triggerModifyChild("move",this):e.triggerModifyChild("add",this);this.tree!==t.tree&&(this.warn("Cross-tree moveTo is experimantal!"),this.visit(function(n){n.tree=t.tree},!0));s.isDescendantOf(e)||s.render();e.isDescendantOf(s)||e===s||e.render()}},navigate:function(t,i){function f(r){if(r){try{r.makeVisible({scrollIntoView:!1})}catch(u){}if(!n(r.span).is(":visible")){r.debug("Navigate: skipping hidden node");r.navigate(t,i);return}return i===!1?r.setFocus():r.setActive()}}var s,h,u,c=!0,o=n.ui.keyCode,r=null;switch(t){case o.BACKSPACE:this.parent&&this.parent.parent&&(u=f(this.parent));break;case o.HOME:this.tree.visit(function(t){if(n(t.span).is(":visible"))return u=f(t),!1});break;case o.END:this.tree.visit(function(t){n(t.span).is(":visible")&&(u=t)});u&&(u=f(u));break;case o.LEFT:this.expanded?(this.setExpanded(!1),u=f(this)):this.parent&&this.parent.parent&&(u=f(this.parent));break;case o.RIGHT:!this.expanded&&(this.children||this.lazy)?(this.setExpanded(),u=f(this)):this.children&&this.children.length&&(u=f(this.children[0]));break;case o.UP:for(r=this.getPrevSibling();r&&!n(r.span).is(":visible");)r=r.getPrevSibling();while(r&&r.expanded&&r.children&&r.children.length)r=r.children[r.children.length-1];!r&&this.parent&&this.parent.parent&&(r=this.parent);u=f(r);break;case o.DOWN:if(this.expanded&&this.children&&this.children.length)r=this.children[0];else for(h=this.getParentList(!1,!0),s=h.length-1;s>=0;s--){for(r=h[s].getNextSibling();r&&!n(r.span).is(":visible");)r=r.getNextSibling();if(r)break}u=f(r);break;default:c=!1}return u||e()},remove:function(){return this.parent.removeChild(this)},removeChild:function(n){return this.tree._callHook("nodeRemoveChild",this,n)},removeChildren:function(){return this.tree._callHook("nodeRemoveChildren",this)},removeClass:function(n){return this.toggleClass(n,!1)},render:function(n,t){return this.tree._callHook("nodeRender",this,n,t)},renderTitle:function(){return this.tree._callHook("nodeRenderTitle",this)},renderStatus:function(){return this.tree._callHook("nodeRenderStatus",this)},replaceWith:function(t){var f,i=this.parent,e=n.inArray(this,i.children),r=this;return u(this.isPagingNode(),"replaceWith() currently requires a paging status node"),f=this.tree._callHook("nodeLoadChildren",this,t),f.done(function(){var n=r.children;for(o=0;o<n.length;o++)n[o].parent=i;i.children.splice.apply(i.children,[e+1,0].concat(n));r.children=null;r.remove();i.render()}).fail(function(){r.setExpanded()}),f},resetLazy:function(){this.removeChildren();this.expanded=!1;this.lazy=!0;this.children=r;this.renderStatus()},scheduleAction:function(t,i){this.tree.timer&&clearTimeout(this.tree.timer);this.tree.timer=null;var r=this;switch(t){case"cancel":break;case"expand":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger expand");r.setExpanded(!0)},i);break;case"activate":this.tree.timer=setTimeout(function(){r.tree.debug("setTimeout: trigger activate");r.setActive(!0)},i);break;default:n.error("Invalid mode "+t)}},scrollIntoView:function(f,o){o!==r&&at(o)&&(this.warn("scrollIntoView() with 'topNode' option is deprecated since 2014-05-08. Use 'options.topNode' instead."),o={topNode:o});var v,a,g,w,c=n.extend({effects:f===!0?{duration:200,queue:!1}:f,scrollOfs:this.tree.options.scrollOfs,scrollParent:this.tree.options.scrollParent||this.tree.$container,topNode:null},o),y=new n.Deferred,it=this,nt=n(this.span).height(),s=n(c.scrollParent),b=c.scrollOfs.top||0,tt=c.scrollOfs.bottom||0,k=s.height(),p=s.scrollTop(),d=s,rt=s[0]===t,h=c.topNode||null,l=null;return n(this.span).is(":visible")?(rt?(a=n(this.span).offset().top,v=h&&h.span?n(h.span).offset().top:0,d=n("html,body")):(u(s[0]!==i&&s[0]!==i.body,"scrollParent should be a simple element or `window`, not document or body."),w=s.offset().top,a=n(this.span).offset().top-w+p,v=h?n(h.span).offset().top-w+p:0,g=Math.max(0,s.innerHeight()-s[0].clientHeight),k-=g),a<p+b?l=a-b:a+nt>p+k-tt&&(l=a+nt-k+tt,h&&(u(h.isRootNode()||n(h.span).is(":visible"),"topNode must be visible"),v<l&&(l=v-b))),l!==null?c.effects?(c.effects.complete=function(){y.resolveWith(it)},d.stop(!0).animate({scrollTop:l},c.effects)):(d[0].scrollTop=l,y.resolveWith(this)):y.resolveWith(this),y.promise()):(this.warn("scrollIntoView(): node is invisible."),e())},setActive:function(n,t){return this.tree._callHook("nodeSetActive",this,n,t)},setExpanded:function(n,t){return this.tree._callHook("nodeSetExpanded",this,n,t)},setFocus:function(n){return this.tree._callHook("nodeSetFocus",this,n)},setSelected:function(n,t){return this.tree._callHook("nodeSetSelected",this,n,t)},setStatus:function(n,t,i){return this.tree._callHook("nodeSetStatus",this,n,t,i)},setTitle:function(n){this.title=n;this.renderTitle();this.triggerModify("rename")},sortChildren:function(n,t){var i,u,r=this.children;if(r){if(n=n||function(n,t){var i=n.title.toLowerCase(),r=t.title.toLowerCase();return i===r?0:i>r?1:-1},r.sort(n),t)for(i=0,u=r.length;i<u;i++)r[i].children&&r[i].sortChildren(n,"$norender$");t!=="$norender$"&&this.render();this.triggerModifyChild("sort")}},toDict:function(t,i){var u,o,e,r={},f=this;if(n.each(h,function(n,t){(f[t]||f[t]===!1)&&(r[t]=f[t])}),n.isEmptyObject(this.data)||(r.data=n.extend({},this.data),n.isEmptyObject(r.data)&&delete r.data),i&&i(r,f),t&&this.hasChildren())for(r.children=[],u=0,o=this.children.length;u<o;u++)e=this.children[u],e.isStatusNode()||r.children.push(e.toDict(!0,i));return r},toggleClass:function(t,i){var f,e,h=t.match(/\S+/g)||[],c=0,o=!1,s=this[this.tree.statusClassPropName],u=" "+(this.extraClasses||"")+" ";for(s&&n(s).toggleClass(t,i);f=h[c++];)if(e=u.indexOf(" "+f+" ")>=0,i=i===r?!e:!!i,i)e||(u+=f+" ",o=!0);else while(u.indexOf(" "+f+" ")>-1)u=u.replace(" "+f+" "," ");return this.extraClasses=n.trim(u),o},toggleExpanded:function(){return this.tree._callHook("nodeToggleExpanded",this)},toggleSelected:function(){return this.tree._callHook("nodeToggleSelected",this)},toString:function(){return"<FancytreeNode(#"+this.key+", '"+this.title+"')>"},triggerModifyChild:function(t,i,r){var u,f=this.tree.options.modifyChild;f&&(i&&i.parent!==this&&n.error("childNode "+i+" is not a child of "+this),u={node:this,tree:this.tree,operation:t,childNode:i||null},r&&n.extend(u,r),f({type:"modifyChild"},u))},triggerModify:function(n,t){this.parent.triggerModifyChild(n,this,t)},visit:function(n,t){var r,f,i=!0,u=this.children;if(t===!0&&(i=n(this),i===!1||i==="skip"))return i;if(u)for(r=0,f=u.length;r<f;r++)if(i=u[r].visit(n,!0),i===!1)break;return i},visitAndLoad:function(t,i,r){var o,u,s,f=this;return t&&i===!0&&(u=t(f),u===!1||u==="skip")?r?u:e():!f.children&&!f.lazy?e():(o=new n.Deferred,s=[],f.load().done(function(){for(var i=0,r=f.children.length;i<r;i++)if(u=f.children[i].visitAndLoad(t,!0,!0),u===!1){o.reject();break}else u!=="skip"&&s.push(u);n.when.apply(this,s).then(function(){o.resolve()})}),o.promise())},visitParents:function(n,t){if(t&&n(this)===!1)return!1;for(var i=this.parent;i;){if(n(i)===!1)return!1;i=i.parent}return!0},visitSiblings:function(n,t){for(var r,f=this.parent.children,i=0,u=f.length;i<u;i++)if(r=f[i],(t||r!==this)&&n(r)===!1)return!1;return!0},warn:function(){Array.prototype.unshift.call(arguments,this.toString());s("warn",arguments)}};a.prototype={_makeHookContext:function(t,i,u){var f,e;return t.node!==r?(i&&t.originalEvent!==i&&n.error("invalid args"),f=t):t.tree?(e=t.tree,f={node:t,tree:e,widget:e.widget,options:e.widget.options,originalEvent:i}):t.widget?f={node:null,tree:t,widget:t.widget,options:t.widget.options,originalEvent:i}:n.error("invalid args"),u&&n.extend(f,u),f},_callHook:function(t,i){var f=this._makeHookContext(i),r=this[t],u=Array.prototype.slice.call(arguments,2);return n.isFunction(r)||n.error("_callHook('"+t+"') is not a function"),u.unshift(f),r.apply(this,u)},_requireExtension:function(t,i,r,f){r=!!r;var e=this._local.name,s=this.options.extensions,c=n.inArray(t,s)<n.inArray(e,s),o=i&&this.ext[t]==null,h=!o&&r!=null&&r!==c;return(u(e&&e!==t,"invalid or same name"),o||h)?(f||(o||i?(f="'"+e+"' extension requires '"+t+"'",h&&(f+=" to be registered "+(r?"before":"after")+" itself")):f="If used together, `"+t+"` must be registered "+(r?"before":"after")+" `"+e+"`"),n.error(f),!1):!0},activateKey:function(n){var t=this.getNodeByKey(n);return t?t.setActive():this.activeNode&&this.activeNode.setActive(!1),t},addPagingNode:function(n,t){return this.rootNode.addPagingNode(n,t)},applyPatch:function(t){for(var o,r,f,s,e,c=t.length,h=[],i=0;i<c;i++)r=t[i],u(r.length===2,"patchList must be an array of length-2-arrays"),f=r[0],s=r[1],e=f===null?this.rootNode:this.getNodeByKey(f),e?(o=new n.Deferred,h.push(o),e.applyPatch(s).always(ut(o,e))):this.warn("could not find node with key '"+f+"'");return n.when.apply(n,h).promise()},clear:function(){this._callHook("treeClear",this)},count:function(){return this.rootNode.countChildren()},debug:function(){this.options.debugLevel>=2&&(Array.prototype.unshift.call(arguments,this.toString()),s("log",arguments))},enableUpdate:function(n){return(n=n!==!1,!!this._enableUpdate==!!n)?n:(this._enableUpdate=n,n?(this.debug("enableUpdate(true): redraw "),this.render()):this.debug("enableUpdate(false)..."),!n)},findAll:function(n){return this.rootNode.findAll(n)},findFirst:function(n){return this.rootNode.findFirst(n)},findNextNode:function(t,i){var u=null,e=i.parent.children,f=null,r=function(n,t,i){var f,e,o=n.children,s=o.length,u=o[t];if(u&&i(u)===!1||u&&u.children&&u.expanded&&r(u,0,i)===!1)return!1;for(f=t+1;f<s;f++)if(r(n,f,i)===!1)return!1;return e=n.parent,e?r(e,e.children.indexOf(n)+1,i):r(n,0,i)};return t=typeof t=="string"?wt(t):t,i=i||this.getFirstChild(),r(i.parent,e.indexOf(i),function(r){if(r===u)return!1;if(u=u||r,!n(r.span).is(":visible")){r.debug("quicksearch: skipping hidden node");return}if(t(r)&&(f=r,f!==i))return!1}),f},generateFormElements:function(t,i,r){function o(t){u.append(n("<input>",{type:"checkbox",name:s,value:t.key,checked:!0}))}r=r||{};var f,s=typeof t=="string"?t:"ft_"+this._id+"[]",h=typeof i=="string"?i:"ft_"+this._id+"_active",e="fancytree_result_"+this._id,u=n("#"+e),c=this.options.selectMode===3&&r.stopOnParents!==!1;u.length?u.empty():u=n("<div>",{id:e}).hide().insertAfter(this.$container);i!==!1&&this.activeNode&&u.append(n("<input>",{type:"radio",name:h,value:this.activeNode.key,checked:!0}));r.filter?this.visit(function(n){var t=r.filter(n);if(t==="skip")return t;t!==!1&&o(n)}):t!==!1&&(f=this.getSelectedNodes(c),n.each(f,function(n,t){o(t)}))},getActiveNode:function(){return this.activeNode},getFirstChild:function(){return this.rootNode.getFirstChild()},getFocusNode:function(){return this.focusNode},getNodeByKey:function(n,t){var r,u;return!t&&(r=i.getElementById(this.options.idPrefix+n),r)?r.ftnode?r.ftnode:null:(t=t||this.rootNode,u=null,t.visit(function(t){if(t.key===n)return u=t,!1},!0),u)},getRootNode:function(){return this.rootNode},getSelectedNodes:function(n){return this.rootNode.getSelectedNodes(n)},hasFocus:function(){return!!this._hasFocus},info:function(){this.options.debugLevel>=1&&(Array.prototype.unshift.call(arguments,this.toString()),s("info",arguments))},loadKeyPath:function(t,i,u){function w(n,t,r){i.call(o,t,"loading");t.load().done(function(){o.loadKeyPath.call(o,s[n],i,t).always(ut(r,o))}).fail(function(){o.warn("loadKeyPath: error loading: "+n+" (parent: "+h+")");i.call(o,t,"error");r.reject()})}var y,p,a,l,e,s,f,h,c,v=this.options.keyPathSeparator,o=this;for(i=i||n.noop,n.isArray(t)||(t=[t]),s={},a=0;a<t.length;a++)for(h=u||this.rootNode,l=t[a],l.charAt(0)===v&&(l=l.substr(1)),c=l.split(v);c.length;)if(e=c.shift(),f=h._findDirectChild(e),f)if(c.length===0){i.call(this,f,"ok");break}else if(f.lazy&&f.hasChildren()===r){i.call(this,f,"loaded");s[e]?s[e].push(c.join(v)):s[e]=[c.join(v)];break}else i.call(this,f,"loaded"),h=f;else{this.warn("loadKeyPath: key not found: "+e+" (parent: "+h+")");i.call(this,e,"error");break}y=[];for(e in s)f=h._findDirectChild(e),f==null&&(f=o.getNodeByKey(e)),p=new n.Deferred,y.push(p),w(e,f,p);return n.when.apply(n,y).promise()},reactivate:function(n){var i,t=this.activeNode;return t?(this.activeNode=null,i=t.setActive(!0,{noFocus:!0}),n&&t.setFocus(),i):e()},reload:function(n){return this._callHook("treeClear",this),this._callHook("treeLoad",this,n)},render:function(n,t){return this.rootNode.render(n,t)},setFocus:function(n){return this._callHook("treeSetFocus",this,n)},toDict:function(n,t){var i=this.rootNode.toDict(!0,t);return n?i:i.children},toString:function(){return"<Fancytree(#"+this._id+")>"},_triggerNodeEvent:function(n,t,i,u){var f=this._makeHookContext(t,i,u),e=this.widget._trigger(n,i,f);return e!==!1&&f.result!==r?f.result:e},_triggerTreeEvent:function(n,t,i){var u=this._makeHookContext(this,t,i),f=this.widget._trigger(n,t,u);return f!==!1&&u.result!==r?u.result:f},visit:function(n){return this.rootNode.visit(n,!1)},warn:function(){Array.prototype.unshift.call(arguments,this.toString());s("warn",arguments)}};n.extend(a.prototype,{nodeClick:function(n){var t,i,u=n.targetType,r=n.node;if(u==="expander"){if(r.isLoading()){r.debug("Got 2nd click while loading: ignored");return}this._callHook("nodeToggleExpanded",n)}else if(u==="checkbox")this._callHook("nodeToggleSelected",n),n.options.focusOnSelect&&this._callHook("nodeSetFocus",n,!0);else{if(i=!1,t=!0,r.folder)switch(n.options.clickFolderMode){case 2:i=!0;t=!1;break;case 3:t=!0;i=!0;
//!node.isExpanded();
}t&&(this.nodeSetFocus(n),this._callHook("nodeSetActive",n,!0));i&&(!t,this._callHook("nodeToggleExpanded",n))}},nodeCollapseSiblings:function(n,t){var r,i,f,u=n.node;if(u.parent)for(r=u.parent.children,i=0,f=r.length;i<f;i++)r[i]!==u&&r[i].expanded&&this._callHook("nodeSetExpanded",r[i],!1,t)},nodeDblclick:function(n){n.targetType==="title"&&n.options.clickFolderMode===4&&this._callHook("nodeToggleExpanded",n);n.targetType==="title"&&n.originalEvent.preventDefault()},nodeKeydown:function(t){var e,o,v,s,r=t.originalEvent,u=t.node,i=t.tree,h=t.options,c=r.which,l=String.fromCharCode(c),y=!(r.altKey||r.ctrlKey||r.metaKey||r.shiftKey),p=n(r.target),a=!0,w=!(r.ctrlKey||!h.autoActivate);if(u||(s=this.getActiveNode()||this.getFirstChild(),s&&(s.setFocus(),u=t.node=this.focusNode,u.debug("Keydown force focus on active node"))),h.quicksearch&&y&&/\w/.test(l)&&!g[c]&&!p.is(":input:enabled")){o=(new Date).getTime();o-i.lastQuicksearchTime>500&&(i.lastQuicksearchTerm="");i.lastQuicksearchTime=o;i.lastQuicksearchTerm+=l;e=i.findNextNode(i.lastQuicksearchTerm,i.getActiveNode());e&&e.setActive();r.preventDefault();return}switch(f.eventToString(r)){case"+":case"=":i.nodeSetExpanded(t,!0);break;case"-":i.nodeSetExpanded(t,!1);break;case"space":u.isPagingNode()?i._triggerNodeEvent("clickPaging",t,r):h.checkbox?i.nodeToggleSelected(t):i.nodeSetActive(t,!0);break;case"return":i.nodeSetActive(t,!0);break;case"home":case"end":case"backspace":case"left":case"right":case"up":case"down":v=u.navigate(r.which,w,!0);break;default:a=!1}a&&r.preventDefault()},nodeLoadChildren:function(t,i){var o,e,s,f=t.tree,r=t.node,h=(new Date).getTime();return n.isFunction(i)&&(i=i.call(f,{type:"source"},t),u(!n.isFunction(i),"source callback must not return another function")),i.url&&(r._requestId&&r.warn("Recursive load request #"+h+" while #"+r._requestId+" is pending."),o=n.extend({},t.options.ajax,i),r._requestId=h,o.debugDelay?(e=o.debugDelay,n.isArray(e)&&(e=e[0]+Math.random()*(e[1]-e[0])),r.warn("nodeLoadChildren waiting debugDelay "+Math.round(e)+" ms ..."),o.debugDelay=!1,s=n.Deferred(function(t){setTimeout(function(){n.ajax(o).done(function(){t.resolveWith(this,arguments)}).fail(function(){t.rejectWith(this,arguments)})},e)})):s=n.ajax(o),i=new n.Deferred,s.done(function(u){var o,e;if((this.dataType==="json"||this.dataType==="jsonp")&&typeof u=="string"&&n.error("Ajax request returned a string (did you get the JSON dataType wrong?)."),r._requestId&&r._requestId>h){i.rejectWith(this,[k]);return}if(t.options.postProcess){try{e=f._triggerNodeEvent("postProcess",t,t.originalEvent,{response:u,error:null,dataType:this.dataType})}catch(s){e={error:s,message:""+s,details:"postProcess failed"}}if(e.error){o=n.isPlainObject(e.error)?e.error:{message:e.error};o=f._makeHookContext(r,null,o);i.rejectWith(this,[o]);return}u=n.isArray(e)?e:u}else u&&u.hasOwnProperty("d")&&t.options.enableAspx&&(u=typeof u.d=="string"?n.parseJSON(u.d):u.d);i.resolveWith(this,[u])}).fail(function(n,t,u){var e=f._makeHookContext(r,null,{error:n,args:Array.prototype.slice.call(arguments),message:u,details:n.status+": "+u});i.rejectWith(this,[e])})),n.isFunction(i.then)&&n.isFunction(i["catch"])&&(s=i,i=new n.Deferred,s.then(function(n){i.resolve(n)},function(n){i.reject(n)})),n.isFunction(i.promise)&&(f.nodeSetStatus(t,"loading"),i.done(function(){f.nodeSetStatus(t,"ok");r._requestId=null}).fail(function(n){var i;if(n===k){r.warn("Ignored response for obsolete load request #"+h+" (expected #"+r._requestId+")");return}n.node&&n.error&&n.message?i=n:(i=f._makeHookContext(r,null,{error:n,args:Array.prototype.slice.call(arguments),message:n?n.message||n.toString():""}),i.message==="[object Object]"&&(i.message=""));r.warn("Load children failed ("+i.message+")",i);f._triggerNodeEvent("loadError",i,null)!==!1&&f.nodeSetStatus(t,"error",i.message,i.details)})),n.when(i).done(function(t){var i;n.isPlainObject(t)&&(u(r.isRootNode(),"source may only be an object for root nodes (expecting an array of child objects otherwise)"),u(n.isArray(t.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),i=t,t=t.children,delete i.children,n.extend(f.data,i));u(n.isArray(t),"expected array of children");r._setChildren(t);f._triggerNodeEvent("loadChildren",r)})},nodeLoadKeyPath:function(){},nodeRemoveChild:function(t,i){var f,e=t.node,o=n.extend({},t,{node:i}),r=e.children;if(r.length===1)return u(i===r[0],"invalid single child"),this.nodeRemoveChildren(t);this.activeNode&&(i===this.activeNode||this.activeNode.isDescendantOf(i))&&this.activeNode.setActive(!1);this.focusNode&&(i===this.focusNode||this.focusNode.isDescendantOf(i))&&(this.focusNode=null);this.nodeRemoveMarkup(o);this.nodeRemoveChildren(o);f=n.inArray(i,r);u(f>=0,"invalid child");e.triggerModifyChild("remove",i);i.visit(function(n){n.parent=null},!0);this._callHook("treeRegisterNode",this,!1,i);r.splice(f,1)},nodeRemoveChildMarkup:function(t){var i=t.node;i.ul&&(i.isRootNode()?n(i.ul).empty():(n(i.ul).remove(),i.ul=null),i.visit(function(n){n.li=n.ul=null}))},nodeRemoveChildren:function(t){var u,r=t.tree,i=t.node,f=i.children;f&&(this.activeNode&&this.activeNode.isDescendantOf(i)&&this.activeNode.setActive(!1),this.focusNode&&this.focusNode.isDescendantOf(i)&&(this.focusNode=null),this.nodeRemoveChildMarkup(t),u=n.extend({},t),i.triggerModifyChild("remove",null),i.visit(function(n){n.parent=null;r._callHook("treeRegisterNode",r,!1,n)}),i.children=i.lazy?[]:null,i.isRootNode()||(i.expanded=!1),this.nodeRenderStatus(t))},nodeRemoveMarkup:function(t){var i=t.node;i.li&&(n(i.li).remove(),i.li=null);this.nodeRemoveChildMarkup(t)},nodeRender:function(t,r,f,e,o){var h,b,l,c,p,d,g,s=t.node,k=t.tree,a=t.options,nt=a.aria,tt=!1,w=s.parent,v=!w,y=s.children,it=null;if(k._enableUpdate!==!1&&(v||w.ul)){if(u(v||w.ul,"parent UL must exist"),v||(s.li&&(r||s.li.parentNode!==s.parent.ul)&&(s.li.parentNode===s.parent.ul?it=s.li.nextSibling:this.debug("Unlinking "+s+" (must be child of "+s.parent+")"),this.nodeRemoveMarkup(t)),s.li?this.nodeRenderStatus(t):(tt=!0,s.li=i.createElement("li"),s.li.ftnode=s,s.key&&a.generateIds&&(s.li.id=a.idPrefix+s.key),s.span=i.createElement("span"),s.span.className="fancytree-node",nt&&!s.tr&&n(s.li).attr("role","treeitem"),s.li.appendChild(s.span),this.nodeRenderTitle(t),a.createNode&&a.createNode.call(k,{type:"createNode"},t)),a.renderNode&&a.renderNode.call(k,{type:"renderNode"},t)),y){if(v||s.expanded||f===!0){for(s.ul||(s.ul=i.createElement("ul"),(e!==!0||o)&&s.expanded||(s.ul.style.display="none"),nt&&n(s.ul).attr("role","group"),s.li?s.li.appendChild(s.ul):s.tree.$div.append(s.ul)),c=0,p=y.length;c<p;c++)g=n.extend({},t,{node:y[c]}),this.nodeRender(g,r,f,!1,!0);for(h=s.ul.firstChild;h;)l=h.ftnode,l&&l.parent!==s?(s.debug("_fixParent: remove missing "+l,h),d=h.nextSibling,h.parentNode.removeChild(h),h=d):h=h.nextSibling;for(h=s.ul.firstChild,c=0,p=y.length-1;c<p;c++)b=y[c],l=h.ftnode,b!==l?s.ul.insertBefore(b.li,l.li):h=h.nextSibling}}else s.ul&&(this.warn("remove child markup for "+s),this.nodeRemoveChildMarkup(t));v||tt&&w.ul.insertBefore(s.li,it)}},nodeRenderTitle:function(t,i){var a,v,e,l,s,w,c,u=t.node,y=t.tree,o=t.options,p=o.aria,b=u.getLevel(),h=[];(i!==r&&(u.title=i),u.span&&y._enableUpdate!==!1)&&(s=p&&u.hasChildren()!==!1?" role='button'":"",b<o.minExpandLevel?(u.lazy||(u.expanded=!0),b>1&&h.push("<span "+s+" class='fancytree-expander fancytree-expander-fixed'><\/span>")):h.push("<span "+s+" class='fancytree-expander'><\/span>"),a=f.evalOption("checkbox",u,u,o,!1),a&&!u.isStatusNode()&&(s=p?" role='checkbox'":"",v="fancytree-checkbox",(a==="radio"||u.parent&&u.parent.radiogroup)&&(v+=" fancytree-radio"),h.push("<span "+s+" class='"+v+"'><\/span>")),u.data.iconClass!==r&&(u.icon?n.error("'iconClass' node option is deprecated since v2.14.0: use 'icon' only instead"):(u.warn("'iconClass' node option is deprecated since v2.14.0: use 'icon' instead"),u.icon=u.data.iconClass)),e=f.evalOption("icon",u,u,o,!0),typeof e!="boolean"&&(e=""+e),e!==!1&&(s=p?" role='presentation'":"",typeof e=="string"?ot.test(e)?(e=e.charAt(0)==="/"?e:(o.imagePath||"")+e,h.push("<img src='"+e+"' class='fancytree-icon' alt='' />")):h.push("<span "+s+" class='fancytree-custom-icon "+e+"'><\/span>"):h.push("<span "+s+" class='fancytree-icon'><\/span>")),l="",o.renderTitle&&(l=o.renderTitle.call(y,{type:"renderTitle"},t)||""),l||(c=f.evalOption("tooltip",u,u,o,null),c===!0&&(c=u.title),c=c?" title='"+pt(c)+"'":"",w=o.titlesTabbable?" tabindex='0'":"",l="<span class='fancytree-title'"+c+w+">"+(o.escapeTitles?ft(it(u.title)):it(u.title))+"<\/span>"),h.push(l),u.span.innerHTML=h.join(""),this.nodeRenderStatus(t),o.enhanceTitle&&(t.$title=n(">span.fancytree-title",u.span),l=o.enhanceTitle.call(y,{type:"enhanceTitle"},t)||""))},nodeRenderStatus:function(t){var e,i=t.node,o=t.tree,c=t.options,l=i.hasChildren(),s=i.isLastSibling(),h=c.aria,u=c._classNames,r=[],a=i[o.statusClassPropName];a&&o._enableUpdate!==!1&&(h&&(e=n(i.tr||i.li)),r.push(u.node),o.activeNode===i&&r.push(u.active),o.focusNode===i&&r.push(u.focused),i.expanded&&r.push(u.expanded),h&&(l!==!1?e.attr("aria-expanded",Boolean(i.expanded)):e.removeAttr("aria-expanded")),i.folder&&r.push(u.folder),l!==!1&&r.push(u.hasChildren),s&&r.push(u.lastsib),i.lazy&&i.children==null&&r.push(u.lazy),i.partload&&r.push(u.partload),i.partsel&&r.push(u.partsel),f.evalOption("unselectable",i,i,c,!1)&&r.push(u.unselectable),i._isLoading&&r.push(u.loading),i._error&&r.push(u.error),i.statusNodeType&&r.push(u.statusNodePrefix+i.statusNodeType),i.selected?(r.push(u.selected),h&&e.attr("aria-selected",!0)):h&&e.attr("aria-selected",!1),i.extraClasses&&r.push(i.extraClasses),l===!1?r.push(u.combinedExpanderPrefix+"n"+(s?"l":"")):r.push(u.combinedExpanderPrefix+(i.expanded?"e":"c")+(i.lazy&&i.children==null?"d":"")+(s?"l":"")),r.push(u.combinedIconPrefix+(i.expanded?"e":"c")+(i.folder?"f":"")),a.className=r.join(" "),i.li&&n(i.li).toggleClass(u.lastsib,s))},nodeSetActive:function(t,i,r){r=r||{};var h,o=t.node,f=t.tree,l=t.options,s=r.noEvents===!0,c=r.noFocus===!0,a=o===f.activeNode;return(i=i!==!1,a===i)?e(o):i&&!s&&this._triggerNodeEvent("beforeActivate",o,t.originalEvent)===!1?w(o,["rejected"]):(i?(f.activeNode&&(u(f.activeNode!==o,"node was active (inconsistency)"),h=n.extend({},t,{node:f.activeNode}),f.nodeSetActive(h,!1),u(f.activeNode===null,"deactivate was out of sync?")),l.activeVisible&&o.makeVisible({scrollIntoView:c&&f.focusNode==null}),f.activeNode=o,f.nodeRenderStatus(t),c||f.nodeSetFocus(t),s||f._triggerNodeEvent("activate",o,t.originalEvent)):(u(f.activeNode===o,"node was not active (inconsistency)"),f.activeNode=null,this.nodeRenderStatus(t),s||t.tree._triggerNodeEvent("deactivate",o,t.originalEvent)),e(o))},nodeSetExpanded:function(t,i,u){u=u||{};var h,o,c,y,a,p,f=t.node,b=t.tree,s=t.options,l=u.noAnimation===!0,v=u.noEvents===!0;if(i=i!==!1,f.expanded&&i||!f.expanded&&!i)return e(f);if(!i||f.lazy||f.hasChildren()){if(!i&&f.getLevel()<s.minExpandLevel)return w(f,["locked"]);if(!v&&this._triggerNodeEvent("beforeExpand",f,t.originalEvent)===!1)return w(f,["rejected"])}else return e(f);if(l||f.isVisible()||(l=u.noAnimation=!0),o=new n.Deferred,i&&!f.expanded&&s.autoCollapse){a=f.getParentList(!1,!0);p=s.autoCollapse;try{for(s.autoCollapse=!1,c=0,y=a.length;c<y;c++)this._callHook("nodeCollapseSiblings",a[c],u)}finally{s.autoCollapse=p}}return o.done(function(){var n=f.getLastChild();i&&s.autoScroll&&!l&&n?n.scrollIntoView(!0,{topNode:f}).always(function(){v||t.tree._triggerNodeEvent(i?"expand":"collapse",t)}):v||t.tree._triggerNodeEvent(i?"expand":"collapse",t)}),h=function(r){var u=s._classNames,o,h,e=s.toggleEffect;if(f.expanded=i,b._callHook("nodeRender",t,!1,!1,!0),f.ul)if(o=f.ul.style.display!=="none",h=!!f.expanded,o===h)f.warn("nodeSetExpanded: UL.style.display already set");else if(!e||l)f.ul.style.display=f.expanded||!parent?"":"none";else{n(f.li).addClass(u.animating);n(f.ul).addClass(u.animating).toggle(e.effect,e.options,e.duration,function(){n(this).removeClass(u.animating);n(f.li).removeClass(u.animating);r()});return}r()},i&&f.lazy&&f.hasChildren()===r?f.load().done(function(){o.notifyWith&&o.notifyWith(f,["loaded"]);h(function(){o.resolveWith(f)})}).fail(function(n){h(function(){o.rejectWith(f,["load failed ("+n+")"])})}):h(function(){o.resolveWith(f)}),o.promise()},nodeSetFocus:function(t,r){var e,u=t.tree,f=t.node,o=u.options,s=t.originalEvent?n(t.originalEvent.target).is(":input"):!1;if(r=r!==!1,u.focusNode){if(u.focusNode===f&&r)return;e=n.extend({},t,{node:u.focusNode});u.focusNode=null;this._triggerNodeEvent("blur",e);this._callHook("nodeRenderStatus",e)}r&&(this.hasFocus()||(f.debug("nodeSetFocus: forcing container focus"),this._callHook("treeSetFocus",t,!0,{calledByNode:!0})),f.makeVisible({scrollIntoView:!1}),u.focusNode=f,o.titlesTabbable?s||n(f.span).find(".fancytree-title").focus():n(i.activeElement).closest(".fancytree-container").length===0&&n(u.$container).focus(),o.aria&&n(u.$container).attr("aria-activedescendant",n(f.tr||f.li).uniqueId().attr("id")),this._triggerNodeEvent("focus",t),o.autoScroll&&f.scrollIntoView(),this._callHook("nodeRenderStatus",t))},nodeSetSelected:function(n,t,i){i=i||{};var r=n.node,u=n.tree,e=n.options,o=i.noEvents===!0;if(t=t!==!1,!f.evalOption("unselectable",r,r,e,!1)){if(r._lastSelectIntent=t,!!r.selected===t&&(e.selectMode!==3||!r.partsel||t))return t;if(!o&&this._triggerNodeEvent("beforeSelect",r,n.originalEvent)===!1)return!!r.selected;t&&e.selectMode===1?(u.lastSelectedNode&&u.lastSelectedNode.setSelected(!1),r.selected=t):e.selectMode!==3||r.parent.radiogroup||r.radiogroup?r.parent.radiogroup?r.visitSiblings(function(n){n._changeSelectStatusAttrs(t&&n===r)},!0):r.selected=t:(r.selected=t,r.fixSelection3AfterClick(i));this.nodeRenderStatus(n);u.lastSelectedNode=t?r:null;o||u._triggerNodeEvent("select",n)}},nodeSetStatus:function(t,i,r,u){function s(){var n=f.children?f.children[0]:null;if(n&&n.isStatusNode()){try{f.ul&&(f.ul.removeChild(n.li),n.li=null)}catch(t){}f.children.length===1?f.children=[]:f.children.shift()}}function o(t,i){var r=f.children?f.children[0]:null;return r&&r.isStatusNode()?(n.extend(r,t),r.statusNodeType=i,e._callHook("nodeRenderTitle",r)):(f._setChildren([t]),f.children[0].statusNodeType=i,e.render()),f.children[0]}var f=t.node,e=t.tree;switch(i){case"ok":s();f._isLoading=!1;f._error=null;f.renderStatus();break;case"loading":f.parent||o({title:e.options.strings.loading+(r?" ("+r+")":""),checkbox:!1,tooltip:u},i);f._isLoading=!0;f._error=null;f.renderStatus();break;case"error":o({title:e.options.strings.loadError+(r?" ("+r+")":""),checkbox:!1,tooltip:u},i);f._isLoading=!1;f._error={message:r,details:u};f.renderStatus();break;case"nodata":o({title:e.options.strings.noData,checkbox:!1,tooltip:u},i);f._isLoading=!1;f._error=null;f.renderStatus();break;default:n.error("invalid node status "+i)}},nodeToggleExpanded:function(n){return this.nodeSetExpanded(n,!n.node.expanded)},nodeToggleSelected:function(n){var t=n.node,i=!t.selected;return t.partsel&&!t.selected&&t._lastSelectIntent===!0&&(i=!1,t.selected=!0),t._lastSelectIntent=i,this.nodeSetSelected(n,i)},treeClear:function(n){var t=n.tree;t.activeNode=null;t.focusNode=null;t.$div.find(">ul.fancytree-container").empty();t.rootNode.children=null},treeCreate:function(){},treeDestroy:function(){this.$div.find(">ul.fancytree-container").remove();this.$source&&this.$source.removeClass("ui-helper-hidden")},treeInit:function(n){var t=n.tree,i=t.options;t.$container.attr("tabindex",i.tabindex);i.rtl?t.$container.attr("DIR","RTL").addClass("fancytree-rtl"):t.$container.removeAttr("DIR").removeClass("fancytree-rtl");i.aria&&(t.$container.attr("role","tree"),i.selectMode!==1&&t.$container.attr("aria-multiselectable",!0));this.treeLoad(n)},treeLoad:function(t,i){var o,s,f,r=t.tree,e=t.widget.element,h=n.extend({},t,{node:this.rootNode});if(r.rootNode.children&&this.treeClear(t),i=i||this.options.source,i)typeof i=="string"&&n.error("Not implemented");else{s=e.data("type")||"html";switch(s){case"html":f=e.find(">ul:first");f.addClass("ui-fancytree-source ui-helper-hidden");i=n.ui.fancytree.parseHtml(f);this.data=n.extend(this.data,b(f));break;case"json":i=n.parseJSON(e.text());e.contents().filter(function(){return this.nodeType===3}).remove();n.isPlainObject(i)&&(u(n.isArray(i.children),"if an object is passed as source, it must contain a 'children' array (all other properties are added to 'tree.data')"),o=i,i=i.children,delete o.children,n.extend(r.data,o));break;default:n.error("Invalid data-type: "+s)}}return this.nodeLoadChildren(h,i).done(function(){r.render();t.options.selectMode===3&&r.rootNode.fixSelection3FromEndNodes();r.activeNode&&r.options.activeVisible&&r.activeNode.makeVisible();r._triggerTreeEvent("init",null,{status:!0})}).fail(function(){r.render();r._triggerTreeEvent("init",null,{status:!1})})},treeRegisterNode:function(){},treeSetFocus:function(t,i,r){function u(n){!n.activeNode&&n.getFirstChild()&&n.getFirstChild().setFocus()}if(i=i!==!1,i!==this.hasFocus()&&(this._hasFocus=i,!i&&this.focusNode?this.focusNode.setFocus(!1):!i||r&&r.calledByNode||n(this.$container).focus(),this.$container.toggleClass("fancytree-treefocus",i),this._triggerTreeEvent(i?"focusTree":"blurTree"),i)){var f=this;setTimeout(function(){u(f)},0)}},treeSetOption:function(t,i,r){var u=t.tree,e=!0,f=!1;switch(i){case"aria":case"checkbox":case"icon":case"minExpandLevel":case"tabindex":u._callHook("treeCreate",u);f=!0;break;case"escapeTitles":case"tooltip":f=!0;break;case"rtl":r===!1?u.$container.removeAttr("DIR").removeClass("fancytree-rtl"):u.$container.attr("DIR","RTL").addClass("fancytree-rtl");f=!0;break;case"source":e=!1;u._callHook("treeLoad",u,r);f=!0}u.debug("set option "+i+"="+r+" <"+typeof r+">");e&&(this.widget._super?this.widget._super.call(this.widget,i,r):n.Widget.prototype._setOption.call(this.widget,i,r));f&&u.render(!0,!1)}});n.widget("ui.fancytree",{options:{activeVisible:!0,ajax:{type:"GET",cache:!1,dataType:"json"},aria:!0,autoActivate:!0,autoCollapse:!1,autoScroll:!1,checkbox:!1,clickFolderMode:4,debugLevel:null,disabled:!1,enableAspx:!0,escapeTitles:!1,extensions:[],toggleEffect:{effect:"blind",options:{direction:"vertical",scale:"box"},duration:200},generateIds:!1,icon:!0,idPrefix:"ft_",focusOnSelect:!1,keyboard:!0,keyPathSeparator:"/",minExpandLevel:1,quicksearch:!1,rtl:!1,scrollOfs:{top:0,bottom:0},scrollParent:null,selectMode:2,strings:{loading:"Loading...",loadError:"Load error!",moreData:"More...",noData:"No data."},tabindex:"0",titlesTabbable:!1,tooltip:!1,_classNames:{node:"fancytree-node",folder:"fancytree-folder",animating:"fancytree-animating",combinedExpanderPrefix:"fancytree-exp-",combinedIconPrefix:"fancytree-ico-",hasChildren:"fancytree-has-children",active:"fancytree-active",selected:"fancytree-selected",expanded:"fancytree-expanded",lazy:"fancytree-lazy",focused:"fancytree-focused",partload:"fancytree-partload",partsel:"fancytree-partsel",radio:"fancytree-radio",unselectable:"fancytree-unselectable",lastsib:"fancytree-lastsib",loading:"fancytree-loading",error:"fancytree-error",statusNodePrefix:"fancytree-statusnode-"},lazyLoad:null,postProcess:null},_create:function(){this.tree=new a(this);this.$source=this.source||this.element.data("type")==="json"?this.element:this.element.find(">ul:first");for(var f,i,t=this.options,o=t.extensions,s=this.tree,e=0;e<o.length;e++)i=o[e],f=n.ui.fancytree._extensions[i],f||n.error("Could not apply extension '"+i+"' (it is not registered, did you forget to include it?)"),this.tree.options[i]=n.extend(!0,{},f.options,this.tree.options[i]),u(this.tree.ext[i]===r,"Extension name must not exist as Fancytree.ext attribute: '"+i+"'"),this.tree.ext[i]={},yt(this.tree,s,f,i),s=f;t.icons!==r&&(t.icon!==!0?n.error("'icons' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'icons' tree option is deprecated since v2.14.0: use 'icon' instead"),t.icon=t.icons));t.iconClass!==r&&(t.icon?n.error("'iconClass' tree option is deprecated since v2.14.0: use 'icon' only instead"):(this.tree.warn("'iconClass' tree option is deprecated since v2.14.0: use 'icon' instead"),t.icon=t.iconClass));t.tabbable!==r&&(t.tabindex=t.tabbable?"0":"-1",this.tree.warn("'tabbable' tree option is deprecated since v2.17.0: use 'tabindex='"+t.tabindex+"' instead"));this.tree._callHook("treeCreate",this.tree)},_init:function(){this.tree._callHook("treeInit",this.tree);this._bind()},_setOption:function(n,t){return this.tree._callHook("treeSetOption",this.tree,n,t)},destroy:function(){this._unbind();this.tree._callHook("treeDestroy",this.tree);n.Widget.prototype.destroy.call(this)},_unbind:function(){var t=this.tree._ns;this.element.off(t);this.tree.$container.off(t);n(i).off(t)},_bind:function(){var r=this,i=this.options,n=this.tree,t=n._ns;this._unbind();n.$container.on("focusin"+t+" focusout"+t,function(t){var i=f.getNode(t),r=t.type==="focusin";i?n._callHook("nodeSetFocus",n._makeHookContext(i,t),r):n._callHook("treeSetFocus",n,r)}).on("selectstart"+t,"span.fancytree-title",function(n){n.preventDefault()}).on("keydown"+t,function(t){if(i.disabled||i.keyboard===!1)return!0;var r,u=n.focusNode,f=n._makeHookContext(u||n,t),e=n.phase;try{return n.phase="userEvent",r=u?n._triggerNodeEvent("keydown",u,t):n._triggerTreeEvent("keydown",t),r==="preventNav"?r=!0:r!==!1&&(r=n._callHook("nodeKeydown",f)),r}finally{n.phase=e}}).on("mousedown"+t+" dblclick"+t,function(n){if(i.disabled)return!0;var u,e=f.getEventTarget(n),o=e.node,t=r.tree,s=t.phase;if(!o)return!0;u=t._makeHookContext(o,n);try{t.phase="userEvent";switch(n.type){case"mousedown":return(u.targetType=e.type,o.isPagingNode())?t._triggerNodeEvent("clickPaging",u,n)===!0:t._triggerNodeEvent("click",u,n)===!1?!1:t._callHook("nodeClick",u);case"dblclick":return u.targetType=e.type,t._triggerNodeEvent("dblclick",u,n)===!1?!1:t._callHook("nodeDblclick",u)}}finally{t.phase=s}})},getActiveNode:function(){return this.tree.activeNode},getNodeByKey:function(n){return this.tree.getNodeByKey(n)},getRootNode:function(){return this.tree.rootNode},getTree:function(){return this.tree}});f=n.ui.fancytree;n.extend(n.ui.fancytree,{version:"2.23.0",buildType:"production",debugLevel:1,_nextId:1,_nextNodeKey:1,_extensions:{},_FancytreeClass:a,_FancytreeNodeClass:l,jquerySupports:{positionMyOfs:vt(n.ui.version,1,9)},assert:function(n,t){return u(n,t)},debounce:function(n,t,i,r){var u;return arguments.length===3&&typeof i!="boolean"&&(r=i,i=!1),function(){var f=arguments;r=r||this;i&&!u&&t.apply(r,f);clearTimeout(u);u=setTimeout(function(){i||t.apply(r,f);u=null},n)}},debug:function(){n.ui.fancytree.debugLevel>=2&&s("log",arguments)},error:function(){s("error",arguments)},escapeHtml:ft,fixPositionOptions:function(t){if((t.offset||(""+t.my+t.at).indexOf("%")>=0)&&n.error("expected new position syntax (but '%' is not supported)"),!n.ui.fancytree.jquerySupports.positionMyOfs){var i=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(t.my),r=/(\w+)([+-]?\d+)?\s+(\w+)([+-]?\d+)?/.exec(t.at),u=(i[2]?+i[2]:0)+(r[2]?+r[2]:0),f=(i[4]?+i[4]:0)+(r[4]?+r[4]:0);t=n.extend({},t,{my:i[1]+" "+i[3],at:r[1]+" "+r[3]});(u||f)&&(t.offset=""+u+" "+f)}return t},getEventTargetType:function(n){return this.getEventTarget(n).type},getEventTarget:function(t){var u=t&&t.target?t.target.className:"",i={node:this.getNode(t.target),type:r};return/\bfancytree-title\b/.test(u)?i.type="title":/\bfancytree-expander\b/.test(u)?i.type=i.node.hasChildren()===!1?"prefix":"expander":/\bfancytree-checkbox\b/.test(u)?i.type="checkbox":/\bfancytree-icon\b/.test(u)?i.type="icon":/\bfancytree-node\b/.test(u)?i.type="title":t&&t.target&&n(t.target).closest(".fancytree-title").length&&(i.type="title"),i},getNode:function(n){if(n instanceof l)return n;for(n instanceof jQuery?n=n[0]:n.originalEvent!==r&&(n=n.target);n;){if(n.ftnode)return n.ftnode;n=n.parentNode}return null},getTree:function(t){var i;return t instanceof a?t:(t===r&&(t=0),typeof t=="number"?t=n(".fancytree-container").eq(t):typeof t=="string"?t=n(t).eq(0):t.selector!==r?t=t.eq(0):t.originalEvent!==r&&(t=n(t.target)),t=t.closest(":ui-fancytree"),i=t.data("ui-fancytree")||t.data("fancytree"),i?i.tree:null)},evalOption:function(t,i,r,u,f){var c,e,o=i.tree,s=u[t],h=r[t];return n.isFunction(s)?(c={node:i,tree:o,widget:o.widget,options:o.widget.options},e=s.call(o,{type:t},c),e==null&&(e=h)):e=h!=null?h:s,e==null&&(e=f),e},eventToString:function(n){var i=n.which,r=n.type,t=[];return n.altKey&&t.push("alt"),n.ctrlKey&&t.push("ctrl"),n.metaKey&&t.push("meta"),n.shiftKey&&t.push("shift"),r==="click"||r==="dblclick"?t.push(lt[n.button]+r):ct[i]||t.push(g[i]||String.fromCharCode(i).toLowerCase()),t.join("+")},info:function(){n.ui.fancytree.debugLevel>=1&&s("info",arguments)},keyEventToString:function(n){return this.warn("keyEventToString() is deprecated: use eventToString()"),this.eventToString(n)},overrideMethod:function(t,i,r){var u,f=t[i]||n.noop;t[i]=function(){try{return u=this._super,this._super=f,r.apply(this,arguments)}finally{this._super=u}}},parseHtml:function(t){var o,e,s,i,c,f,u,l,y=t.find(">li"),a=[];return y.each(function(){var w,g,k=n(this),tt=k.find(">span:first",this),d=tt.length?null:k.find(">a:first"),y={tooltip:null,data:{}};for(tt.length?y.title=tt.html():d&&d.length?(y.title=d.html(),y.data.href=d.attr("href"),y.data.target=d.attr("target"),y.tooltip=d.attr("title")):(y.title=k.html(),c=y.title.search(/<ul/i),c>=0&&(y.title=y.title.substring(0,c))),y.title=n.trim(y.title),i=0,f=v.length;i<f;i++)y[v[i]]=r;for(o=this.className.split(" "),s=[],i=0,f=o.length;i<f;i++)e=o[i],nt[e]?y[e]=!0:s.push(e);if(y.extraClasses=s.join(" "),u=k.attr("title"),u&&(y.tooltip=u),u=k.attr("id"),u&&(y.key=u),k.attr("hideCheckbox")&&(y.checkbox=!1),w=b(k),w&&!n.isEmptyObject(w)){for(g in p)w.hasOwnProperty(g)&&(w[p[g]]=w[g],delete w[g]);for(i=0,f=h.length;i<f;i++)u=h[i],l=w[u],l!=null&&(delete w[u],y[u]=l);n.extend(y.data,w)}t=k.find(">ul:first");y.children=t.length?n.ui.fancytree.parseHtml(t):y.lazy?r:null;a.push(y)}),a},registerExtension:function(t){u(t.name!=null,"extensions must have a `name` property.");u(t.version!=null,"extensions must have a `version` property.");n.ui.fancytree._extensions[t.name]=t},unescapeHtml:function(n){var t=i.createElement("div");return t.innerHTML=n,t.childNodes.length===0?"":t.childNodes[0].nodeValue},warn:function(){s("warn",arguments)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.childcounter.js
 *
 * Add a child counter bubble to tree nodes.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";n.ui.fancytree._FancytreeClass.prototype.countSelected=function(n){var t=this,i=t.options;return t.getSelectedNodes(n).length};n.ui.fancytree._FancytreeNodeClass.prototype.updateCounters=function(){var t=this,i=n("span.fancytree-childcounter",t.span),r=t.tree.options.childcounter,u=t.countChildren(r.deep);t.data.childCounter=u;!u&&r.hideZeros||t.isExpanded()&&r.hideExpanded?i.remove():(i.length||(i=n("<span class='fancytree-childcounter'/>").appendTo(n("span.fancytree-icon",t.span))),i.text(u));!r.deep||t.isTopLevel()||t.isRoot()||t.parent.updateCounters()};n.ui.fancytree.prototype.widgetMethod1=function(n){var t=this.tree;return n};n.ui.fancytree.registerExtension({name:"childcounter",version:"2.23.0",options:{deep:!0,hideZeros:!0,hideExpanded:!1},foo:42,_appendCounter:function(){var n=this},treeInit:function(n){var t=this,i=n.options,r=n.options.childcounter;this._superApply(arguments);this.$container.addClass("fancytree-ext-childcounter")},treeDestroy:function(){this._superApply(arguments)},nodeRenderTitle:function(t,i){var r=t.node,u=t.options.childcounter,f=r.data.childCounter==null?r.countChildren(u.deep):+r.data.childCounter;this._super(t,i);!f&&u.hideZeros||r.isExpanded()&&u.hideExpanded||n("span.fancytree-icon",r.span).append(n("<span class='fancytree-childcounter'/>").text(f))},nodeSetExpanded:function(n){var t=n.tree,i=n.node;return this._superApply(arguments).always(function(){t.nodeRenderTitle(n)})}})})(jQuery);
/*!
 *
 * jquery.fancytree.clones.js
 * Support faster lookup of nodes by key and shared ref-ids.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";function t(t,i){t||(i=i?": "+i:"",n.error("Assertion failed"+i))}function i(n,t){for(var i=n.length-1;i>=0;i--)if(n[i]===t)return n.splice(i,1),!0;return!1}function r(n,t,i){for(var s,r,h=n.length&3,c=n.length-h,u=i,e=3432918353,o=461845907,f=0;f<c;)r=n.charCodeAt(f)&255|(n.charCodeAt(++f)&255)<<8|(n.charCodeAt(++f)&255)<<16|(n.charCodeAt(++f)&255)<<24,++f,r=(r&65535)*e+(((r>>>16)*e&65535)<<16)&4294967295,r=r<<15|r>>>17,r=(r&65535)*o+(((r>>>16)*o&65535)<<16)&4294967295,u^=r,u=u<<13|u>>>19,s=(u&65535)*5+(((u>>>16)*5&65535)<<16)&4294967295,u=(s&65535)+27492+(((s>>>16)+58964&65535)<<16);r=0;switch(h){case 3:r^=(n.charCodeAt(f+2)&255)<<16;case 2:r^=(n.charCodeAt(f+1)&255)<<8;case 1:r^=n.charCodeAt(f)&255;r=(r&65535)*e+(((r>>>16)*e&65535)<<16)&4294967295;r=r<<15|r>>>17;r=(r&65535)*o+(((r>>>16)*o&65535)<<16)&4294967295;u^=r}return(u^=n.length,u^=u>>>16,u=(u&65535)*2246822507+(((u>>>16)*2246822507&65535)<<16)&4294967295,u^=u>>>13,u=(u&65535)*3266489909+(((u>>>16)*3266489909&65535)<<16)&4294967295,u^=u>>>16,t)?("0000000"+(u>>>0).toString(16)).substr(-8):u>>>0}function u(t){var i=n.map(t.getParentList(!1,!0),function(n){return n.refKey||n.key});return i=i.join("/"),"id_"+r(i,!0)}n.ui.fancytree._FancytreeNodeClass.prototype.getCloneList=function(t){var r,u=this.tree,i=u.refMap[this.refKey]||null,f=u.keyMap;return i&&(r=this.key,t?i=n.map(i,function(n){return f[n]}):(i=n.map(i,function(n){return n===r?null:f[n]}),i.length<1&&(i=null))),i};n.ui.fancytree._FancytreeNodeClass.prototype.isClone=function(){var n=this.refKey||null,t=n&&this.tree.refMap[n]||null;return!!(t&&t.length>1)};n.ui.fancytree._FancytreeNodeClass.prototype.reRegister=function(t,i){t=t==null?null:""+t;i=i==null?null:""+i;var h=this.tree,e=this.key,f=this.refKey,o=h.keyMap,r=h.refMap,u=r[f]||null,s=!1;return t!=null&&t!==this.key&&(o[t]&&n.error("[ext-clones] reRegister("+t+"): already exists: "+this),delete o[e],o[t]=this,u&&(r[f]=n.map(u,function(n){return n===e?t:n})),this.key=t,s=!0),i!=null&&i!==this.refKey&&(u&&(u.length===1?delete r[f]:r[f]=n.map(u,function(n){return n===e?null:n})),r[i]?r[i].append(t):r[i]=[this.key],this.refKey=i,s=!0),s};n.ui.fancytree._FancytreeNodeClass.prototype.setRefKey=function(n){return this.reRegister(null,n)};n.ui.fancytree._FancytreeClass.prototype.getNodesByRef=function(t,i){var u=this.keyMap,r=this.refMap[t]||null;return r&&(r=i?n.map(r,function(n){var t=u[n];return t.isDescendantOf(i)?t:null}):n.map(r,function(n){return u[n]}),r.length<1&&(r=null)),r};n.ui.fancytree._FancytreeClass.prototype.changeRefKey=function(n,t){var i,u,f=this.keyMap,r=this.refMap[n]||null;if(r){for(i=0;i<r.length;i++)u=f[r[i]],u.refKey=t;delete this.refMap[n];this.refMap[t]=r}};n.ui.fancytree.registerExtension({name:"clones",version:"2.23.0",options:{highlightActiveClones:!0,highlightClones:!1},treeCreate:function(n){this._superApply(arguments);n.tree.refMap={};n.tree.keyMap={}},treeInit:function(n){this.$container.addClass("fancytree-ext-clones");t(n.options.defaultKey==null);n.options.defaultKey=function(n){return u(n)};this._superApply(arguments)},treeClear:function(n){return n.tree.refMap={},n.tree.keyMap={},this._superApply(arguments)},treeRegisterNode:function(r,u,f){var e,c,a=r.tree,s=a.keyMap,l=a.refMap,o=f.key,h=f&&f.refKey!=null?""+f.refKey:null;return f.isStatusNode()?this._super(r,u,f):(u?(s[f.key]!=null&&n.error("clones.treeRegisterNode: node.key already exists: "+f),s[o]=f,h&&(e=l[h],e?(e.push(o),e.length===2&&r.options.clones.highlightClones&&s[e[0]].renderStatus()):l[h]=[o])):(s[o]==null&&n.error("clones.treeRegisterNode: node.key not registered: "+f.key),delete s[o],h&&(e=l[h],e&&(c=e.length,c<=1?(t(c===1),t(e[0]===o),delete l[h]):(i(e,o),c===2&&r.options.clones.highlightClones&&s[e[0]].renderStatus())))),this._super(r,u,f))},nodeRenderStatus:function(t){var i,r,u=t.node;return r=this._super(t),t.options.clones.highlightClones&&(i=n(u[t.tree.statusClassPropName]),i.length&&u.isClone()&&i.addClass("fancytree-clone")),r},nodeSetActive:function(t,i){var r,f=t.tree.statusClassPropName,u=t.node;return r=this._superApply(arguments),t.options.clones.highlightActiveClones&&u.isClone()&&n.each(u.getCloneList(!0),function(t,r){n(r[f]).toggleClass("fancytree-active-clone",i!==!1)}),r}})})(jQuery,window,document);
/*!
 * jquery.fancytree.dnd.js
 *
 * Drag-and-drop support (jQuery UI draggable/droppable).
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n,t,i,r){"use strict";function l(n){return n===0?"":n>0?"+"+n:""+n}function a(){e||(n.ui.plugin.add("draggable","connectToFancytree",{start:function(t,i){var r=n(this).data("ui-draggable")||n(this).data("draggable"),u=i.helper.data("ftSourceNode")||null;if(u)return r.offset.click.top=-2,r.offset.click.left=16,u.tree.ext.dnd._onDragEvent("start",u,null,t,i,r)},drag:function(t,i){var s,h,c,e=n(this).data("ui-draggable")||n(this).data("draggable"),u=i.helper.data("ftSourceNode")||null,f=i.helper.data("ftTargetNode")||null,r=n.ui.fancytree.getNode(t.target),o=u&&u.tree.options.dnd;if(t.target&&!r&&(h=n(t.target).closest("div.fancytree-drag-helper,#fancytree-drop-marker").length>0,h)){c=u||f||n.ui.fancytree;c.debug("Drag event over helper: ignored.");return}i.helper.data("ftTargetNode",r);o&&o.updateHelper&&(s=u.tree._makeHookContext(u,t,{otherNode:r,ui:i,draggable:e,dropMarker:n("#fancytree-drop-marker")}),o.updateHelper.call(u.tree,u,s));f&&f!==r&&f.tree.ext.dnd._onDragEvent("leave",f,u,t,i,e);r&&r.tree.options.dnd.dragDrop&&(r===f?r.tree.ext.dnd._onDragEvent("over",r,u,t,i,e):(r.tree.ext.dnd._onDragEvent("enter",r,u,t,i,e),r.tree.ext.dnd._onDragEvent("over",r,u,t,i,e)))},stop:function(t,i){var e,f=n(this).data("ui-draggable")||n(this).data("draggable"),r=i.helper.data("ftSourceNode")||null,u=i.helper.data("ftTargetNode")||null,o=t.type==="mouseup"&&t.which===1;o||(e=r||u||n.ui.fancytree,e.debug("Drag was cancelled"));u&&(o&&u.tree.ext.dnd._onDragEvent("drop",u,r,t,i,f),u.tree.ext.dnd._onDragEvent("leave",u,r,t,i,f));r&&r.tree.ext.dnd._onDragEvent("stop",r,null,t,i,f)}}),e=!0)}function v(t){var i=t.options.dnd||null,r=t.options.glyph||null;i&&a();i&&i.dragStart&&t.widget.element.draggable(n.extend({addClasses:!1,appendTo:t.$container,containment:!1,delay:0,distance:4,revert:!1,scroll:!0,scrollSpeed:7,scrollSensitivity:10,connectToFancytree:!0,helper:function(t){var u,e,f,i=n.ui.fancytree.getNode(t.target);return i?(f=i.tree.options.dnd,e=n(i.span),u=n("<div class='fancytree-drag-helper'><span class='fancytree-drag-helper-img' /><\/div>").css({zIndex:3,position:"relative"}).append(e.find("span.fancytree-title").clone()),u.data("ftSourceNode",i),r&&u.find(".fancytree-drag-helper-img").addClass(r.map.dragHelper),f.initHelper&&f.initHelper.call(i.tree,i,{node:i,tree:i.tree,originalEvent:t,ui:{helper:u}}),u):"<div>ERROR?: helper requested but sourceNode not found<\/div>"},start:function(n,t){var i=t.helper.data("ftSourceNode");return!!i}},t.options.dnd.draggable));i&&i.dragDrop&&t.widget.element.droppable(n.extend({addClasses:!1,tolerance:"intersect",greedy:!1},t.options.dnd.droppable))}var e=!1,u="fancytree-drop-accept",o="fancytree-drop-after",s="fancytree-drop-before",h="fancytree-drop-over",f="fancytree-drop-reject",c="fancytree-drop-target";n.ui.fancytree.registerExtension({name:"dnd",version:"2.23.0",options:{autoExpandMS:1e3,draggable:null,droppable:null,focusOnClick:!1,preventVoidMoves:!0,preventRecursiveMoves:!0,smartRevert:!0,dropMarkerOffsetX:-24,dropMarkerInsertOffsetX:-16,dragStart:null,dragStop:null,initHelper:null,updateHelper:null,dragEnter:null,dragOver:null,dragExpand:null,dragDrop:null,dragLeave:null},treeInit:function(t){var i=t.tree;if(this._superApply(arguments),i.options.dnd.dragStart)i.$container.on("mousedown",function(i){if(t.options.dnd.focusOnClick){var r=n.ui.fancytree.getNode(i);r&&r.debug("Re-enable focus that was prevented by jQuery UI draggable.");setTimeout(function(){n(i.target).closest(":tabbable").focus()},10)}});v(i)},_setDndStatus:function(t,i,r,e,a){var y,p="center",v=this._local,w=this.options.dnd,b=this.options.glyph,k=t?n(t.span):null,d=n(i.span),g=d.find("span.fancytree-title");if(v.$dropMarker||(v.$dropMarker=n("<div id='fancytree-drop-marker'><\/div>").hide().css({"z-index":1e3}).prependTo(n(this.$div).parent()),b&&v.$dropMarker.addClass(b.map.dropMarker)),e==="after"||e==="before"||e==="over"){y=w.dropMarkerOffsetX||0;switch(e){case"before":p="top";y+=w.dropMarkerInsertOffsetX||0;break;case"after":p="bottom";y+=w.dropMarkerInsertOffsetX||0}v.$dropMarker.toggleClass(o,e==="after").toggleClass(h,e==="over").toggleClass(s,e==="before").show().position(n.ui.fancytree.fixPositionOptions({my:"left"+l(y)+" center",at:"left "+p,of:g}))}else v.$dropMarker.hide();k&&k.toggleClass(u,a===!0).toggleClass(f,a===!1);d.toggleClass(c,e==="after"||e==="before"||e==="over").toggleClass(o,e==="after").toggleClass(s,e==="before").toggleClass(u,a===!0).toggleClass(f,a===!1);r.toggleClass(u,a===!0).toggleClass(f,a===!1)},_onDragEvent:function(t,u,f,e,o,s){var b,k,d,g,nt,p,a,h,l,it=this.options,c=it.dnd,v=this._makeHookContext(u,e,{otherNode:f,ui:o,draggable:s}),y=null,tt=this,w=n(u.span);c.smartRevert&&(s.options.revert="invalid");switch(t){case"start":if(u.isStatusNode()?y=!1:c.dragStart&&(y=c.dragStart(u,v)),y===!1)this.debug("tree.dragStart() cancelled"),o.helper.trigger("mouseup").hide();else{c.smartRevert&&(g=u[v.tree.nodeContainerAttrName].getBoundingClientRect(),d=n(s.options.appendTo)[0].getBoundingClientRect(),s.originalPosition.left=Math.max(0,g.left-d.left),s.originalPosition.top=Math.max(0,g.top-d.top));w.addClass("fancytree-drag-source");n(i).on("keydown.fancytree-dnd,mousedown.fancytree-dnd",function(t){t.type==="keydown"&&t.which===n.ui.keyCode.ESCAPE?tt.ext.dnd._cancelDrag():t.type==="mousedown"&&tt.ext.dnd._cancelDrag()})}break;case"enter":l=c.preventRecursiveMoves&&u.isDescendantOf(f)?!1:c.dragEnter?c.dragEnter(u,v):null;y=l?n.isArray(l)?{over:n.inArray("over",l)>=0,before:n.inArray("before",l)>=0,after:n.inArray("after",l)>=0}:{over:l===!0||l==="over",before:l===!0||l==="before",after:l===!0||l==="after"}:!1;o.helper.data("enterResponse",y);break;case"over":a=o.helper.data("enterResponse");h=null;a===!1||(typeof a=="string"?h=a:(k=w.offset(),nt={x:e.pageX-k.left,y:e.pageY-k.top},p={x:nt.x/w.width(),y:nt.y/w.height()},a.after&&p.y>.75?h="after":!a.over&&a.after&&p.y>.5?h="after":a.before&&p.y<=.25?h="before":!a.over&&a.before&&p.y<=.5?h="before":a.over&&(h="over"),c.preventVoidMoves&&(u===f?(this.debug("    drop over source node prevented"),h=null):h==="before"&&f&&u===f.getNextSibling()?(this.debug("    drop after source node prevented"),h=null):h==="after"&&f&&u===f.getPrevSibling()?(this.debug("    drop before source node prevented"),h=null):h==="over"&&f&&f.parent===u&&f.isLastSibling()&&(this.debug("    drop last child over own parent prevented"),h=null)),o.helper.data("hitMode",h)));h==="before"||h==="after"||!c.autoExpandMS||u.hasChildren()===!1||u.expanded||c.dragExpand&&c.dragExpand(u,v)===!1||u.scheduleAction("expand",c.autoExpandMS);h&&c.dragOver&&(v.hitMode=h,y=c.dragOver(u,v));b=y!==!1&&h!==null;c.smartRevert&&(s.options.revert=!b);this._local._setDndStatus(f,u,o.helper,h,b);break;case"drop":h=o.helper.data("hitMode");h&&c.dragDrop&&(v.hitMode=h,c.dragDrop(u,v));break;case"leave":u.scheduleAction("cancel");o.helper.data("enterResponse",null);o.helper.data("hitMode",null);this._local._setDndStatus(f,u,o.helper,"out",r);c.dragLeave&&c.dragLeave(u,v);break;case"stop":w.removeClass("fancytree-drag-source");n(i).off(".fancytree-dnd");c.dragStop&&c.dragStop(u,v);break;default:n.error("Unsupported drag event: "+t)}return y},_cancelDrag:function(){var t=n.ui.ddmanager.current;t&&t.cancel()}})})(jQuery,window,document);
/*!
 * jquery.fancytree.dnd5.js
 *
 * Drag-and-drop support (native HTML5).
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n,t,i,r){"use strict";function b(n){return n===0?"":n>0?"+"+n:""+n}function k(t){var i;return t?(i=n.isPlainObject(t)?{over:!!t.over,before:!!t.before,after:!!t.after}:n.isArray(t)?{over:n.inArray("over",t)>=0,before:n.inArray("before",t)>=0,after:n.inArray("after",t)>=0}:{over:t===!0||t==="over",before:t===!0||t==="before",after:t===!0||t==="after"},Object.keys(i).length===0)?!1:i:!1}function d(r,u){var c,f,l,a=r.options.dnd5,o=r.$scrollParent[0],s=a.scrollSensitivity,h=a.scrollSpeed,e=0;return o!==i&&o.tagName!=="HTML"?(c=r.$scrollParent.offset(),f=o.scrollTop,c.top+o.offsetHeight-u.pageY<s?(l=o.scrollHeight-r.$scrollParent.innerHeight()-f,l>0&&(o.scrollTop=e=f+h)):f>0&&u.pageY-c.top<s&&(o.scrollTop=e=f-h)):(f=n(i).scrollTop(),f>0&&u.pageY-f<s?(e=f-h,n(i).scrollTop(e)):n(t).height()-(u.pageY-f)<s&&(e=f+h,n(i).scrollTop(e))),e&&r.debug("autoScroll: "+e+"px"),e}function g(t,i){if(i.options.dnd5.scroll&&d(i.tree,t),!i.node)return i.tree.warn("Ignore dragover for non-node"),s;var k,tt,v,r=null,it=i.tree,rt=it.options,a=rt.dnd5,o=i.node,l=i.otherNode,g="center",nt=n(o.span),ut=nt.find("span.fancytree-title");if(u===!1)return it.warn("Ignore dragover, since dragenter returned false"),!1;if(typeof u=="string"?n.error("assert failed: dragenter returned string"):(tt=nt.offset(),v=(t.pageY-tt.top)/nt.height(),u.after&&v>.75?r="after":!u.over&&u.after&&v>.5?r="after":u.before&&v<=.25?r="before":!u.over&&u.before&&v<=.5?r="before":u.over&&(r="over"),a.preventVoidMoves&&(o===l?(o.debug("drop over source node prevented"),r=null):r==="before"&&l&&o===l.getNextSibling()?(o.debug("drop after source node prevented"),r=null):r==="after"&&l&&o===l.getPrevSibling()?(o.debug("drop before source node prevented"),r=null):r==="over"&&l&&l.parent===o&&l.isLastSibling()&&(o.debug("drop last child over own parent prevented"),r=null))),i.hitMode=r,r&&a.dragOver&&(a.dragOver(o,i),r=i.hitMode),s=r,r==="after"||r==="before"||r==="over"){k=a.dropMarkerOffsetX||0;switch(r){case"before":g="top";k+=a.dropMarkerInsertOffsetX||0;break;case"after":g="bottom";k+=a.dropMarkerInsertOffsetX||0}f.toggleClass(y,r==="after").toggleClass(e,r==="over").toggleClass(p,r==="before").show().position(n.ui.fancytree.fixPositionOptions({my:"left"+b(k)+" center",at:"left "+g,of:ut}))}else f.hide();return n(o.span).toggleClass(w,r==="after"||r==="before"||r==="over").toggleClass(y,r==="after").toggleClass(p,r==="before").toggleClass(h,r==="over").toggleClass(c,r===!1),r}var a="fancytree-drag-source",v="fancytree-drag-remove",h="fancytree-drop-accept",y="fancytree-drop-after",p="fancytree-drop-before",e="fancytree-drop-over",c="fancytree-drop-reject",w="fancytree-drop-target",l="application/x-fancytree-node",f=null,o=null,u=null,s=null;n.ui.fancytree.registerExtension({name:"dnd5",version:"2.23.0",options:{autoExpandMS:1500,setTextTypeJson:!1,preventForeignNodes:!1,preventNonNodes:!1,preventRecursiveMoves:!0,preventVoidMoves:!0,scroll:!0,scrollSensitivity:20,scrollSpeed:5,dropMarkerOffsetX:-24,dropMarkerInsertOffsetX:-16,dragStart:null,dragDrag:n.noop,dragEnd:n.noop,dragEnter:null,dragOver:n.noop,dragExpand:n.noop,dragDrop:n.noop,dragLeave:n.noop},treeInit:function(t){var y=t.tree,p=t.options,i=p.dnd5,w=n.ui.fancytree.getNode;if(n.inArray("dnd",p.extensions)>=0&&n.error("Extensions 'dnd' and 'dnd5' are mutually exclusive."),i.dragStop&&n.error("dragStop is not used by ext-dnd5. Use dragEnd instead."),i.dragStart&&n.ui.fancytree.overrideMethod(t.options,"createNode",function(n,t){this._super.apply(this,arguments);t.node.span.draggable=!0}),this._superApply(arguments),this.$container.addClass("fancytree-ext-dnd5"),this.$scrollParent=this.$container.children(":first").scrollParent(),f=n("#fancytree-drop-marker"),f.length||(f=n("<div id='fancytree-drop-marker'><\/div>").hide().css({"z-index":1e3,"pointer-events":"none"}).prependTo("body")),i.dragStart)y.$container.on("dragstart drag dragend",function(t){var c,e=w(t),s=t.dataTransfer||t.originalEvent.dataTransfer,p=s.dropEffect==="move",b=e?n(e.span):null,h={node:e,tree:y,options:y.options,originalEvent:t,dataTransfer:s,isCancelled:r};switch(t.type){case"dragstart":n(e.span).addClass(a);o=e;c=JSON.stringify(e.toDict());try{s.setData(l,c);s.setData("text/html",n(e.span).html());s.setData("text/plain",e.title)}catch(k){y.warn("Could not set data (IE only accepts 'text') - "+k)}return i.setTextTypeJson?s.setData("text",c):s.setData("text",e.title),s.effectAllowed="all",s.setDragImage&&s.setDragImage(n(e.span).find(".fancytree-title")[0],-10,-10),i.dragStart(e,h)!==!1;case"drag":b.toggleClass(v,p);i.dragDrag(e,h);break;case"dragend":n(e.span).removeClass(a+" "+v);o=null;u=null;h.isCancelled=s.dropEffect==="none";f.hide();i.dragEnd(e,h)}});if(i.dragEnter)y.$container.on("dragenter dragover dragleave drop",function(t){var nt,p,it,b,tt=null,a=w(t),d=t.dataTransfer||t.originalEvent.dataTransfer,v={node:a,tree:y,options:y.options,hitMode:u,originalEvent:t,dataTransfer:d,otherNode:o||null,otherNodeData:null,dropEffect:r,isCancelled:r};switch(t.type){case"dragenter":if(!a){y.debug("Ignore non-node "+t.type+": "+t.target.tagName+"."+t.target.className);u=!1;break}if(n(a.span).addClass(e).removeClass(h+" "+c),i.preventNonNodes&&!p){a.debug("Reject dropping a non-node");u=!1;break}else if(i.preventForeignNodes&&(!o||o.tree!==a.tree)){a.debug("Reject dropping a foreign node");u=!1;break}setTimeout(function(){!i.autoExpandMS||a.hasChildren()===!1||a.expanded||i.dragExpand&&i.dragExpand(a,v)===!1||a.scheduleAction("expand",i.autoExpandMS)},0);f.show();i.preventRecursiveMoves&&a.isDescendantOf(v.otherNode)?b=!1:(it=i.dragEnter(a,v),b=k(it));u=b;tt=b&&(b.over||b.before||b.after);break;case"dragover":s=g(t,v);tt=!!s;break;case"dragleave":if(!a){y.debug("Ignore non-node "+t.type+": "+t.target.tagName+"."+t.target.className);break}if(!n(a.span).hasClass(e)){a.debug("Ignore dragleave (multi)");break}n(a.span).removeClass(e+" "+h+" "+c);a.scheduleAction("cancel");i.dragLeave(a,v);f.hide();break;case"drop":if(n.inArray(l,d.types)>=0&&(p=d.getData(l),y.info(t.type+": getData('application/x-fancytree-node'): '"+p+"'")),p||(p=d.getData("text"),y.info(t.type+": getData('text'): '"+p+"'")),p)try{nt=JSON.parse(p);nt.title!==r&&(v.otherNodeData=nt)}catch(rt){}y.debug(t.type+": nodeData: '"+p+"', otherNodeData: ",v.otherNodeData);n(a.span).removeClass(e+" "+h+" "+c);f.hide();v.hitMode=s;v.dropEffect=d.dropEffect;v.isCancelled=v.dropEffect==="none";i.dragDrop(a,v);t.preventDefault()}if(tt)return t.preventDefault(),!1})}})})(jQuery,window,document);
/*!
 * jquery.fancytree.edit.js
 *
 * Make node titles editable.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n,t,i){"use strict";var r=/Mac/.test(navigator.platform),u=n.ui.fancytree.escapeHtml,f=n.ui.fancytree.unescapeHtml;n.ui.fancytree._FancytreeNodeClass.prototype.editStart=function(){var r,t=this,u=this.tree,s=u.ext.edit,e=u.options.edit,h=n(".fancytree-title",t.span),o={node:t,tree:u,options:u.options,isNew:n(t[u.statusClassPropName]).hasClass("fancytree-edit-new"),orgTitle:t.title,input:null,dirty:!1};if(e.beforeEdit.call(t,{type:"beforeEdit"},o)===!1)return!1;n.ui.fancytree.assert(!s.currentNode,"recursive edit");s.currentNode=this;s.eventData=o;u.widget._unbind();n(i).on("mousedown.fancytree-edit",function(i){n(i.target).hasClass("fancytree-edit-input")||t.editEnd(!0,i)});r=n("<input />",{"class":"fancytree-edit-input",type:"text",value:u.options.escapeTitles?o.orgTitle:f(o.orgTitle)});s.eventData.input=r;e.adjustWidthOfs!=null&&r.width(h.width()+e.adjustWidthOfs);e.inputCss!=null&&r.css(e.inputCss);h.html(r);r.focus().change(function(){r.addClass("fancytree-edit-dirty")}).keydown(function(i){switch(i.which){case n.ui.keyCode.ESCAPE:t.editEnd(!1,i);break;case n.ui.keyCode.ENTER:return t.editEnd(!0,i),!1}i.stopPropagation()}).blur(function(n){return t.editEnd(!0,n)});e.edit.call(t,{type:"edit"},o)};n.ui.fancytree._FancytreeNodeClass.prototype.editEnd=function(t,r){var o,e=this,s=this.tree,h=s.ext.edit,f=h.eventData,c=s.options.edit,a=n(".fancytree-title",e.span),l=a.find("input.fancytree-edit-input");return(c.trim&&l.val(n.trim(l.val())),o=l.val(),f.dirty=o!==e.title,f.originalEvent=r,f.save=t===!1?!1:f.isNew?o!=="":f.dirty&&o!=="",c.beforeClose.call(e,{type:"beforeClose"},f)===!1)?!1:f.save&&c.save.call(e,{type:"save"},f)===!1?!1:(l.removeClass("fancytree-edit-dirty").off(),n(i).off(".fancytree-edit"),f.save?(e.setTitle(s.options.escapeTitles?o:u(o)),e.setFocus()):f.isNew?(e.remove(),e=f.node=null,h.relatedNode.setFocus()):(e.renderTitle(),e.setFocus()),h.eventData=null,h.currentNode=null,h.relatedNode=null,s.widget._bind(),n(s.$container).focus(),f.input=null,c.close.call(e,{type:"close"},f),!0)};n.ui.fancytree._FancytreeNodeClass.prototype.editCreateNode=function(t,i){var r,f=this.tree,u=this;if(t=t||"child",i==null?i={title:""}:typeof i=="string"?i={title:i}:n.ui.fancytree.assert(n.isPlainObject(i)),t==="child"&&!this.isExpanded()&&this.hasChildren()!==!1){this.setExpanded().done(function(){u.editCreateNode(t,i)});return}r=this.addNode(i,t);r.match=!0;n(r[f.statusClassPropName]).removeClass("fancytree-hide").addClass("fancytree-match");r.makeVisible().done(function(){n(r[f.statusClassPropName]).addClass("fancytree-edit-new");u.tree.ext.edit.relatedNode=u;r.editStart()})};n.ui.fancytree._FancytreeClass.prototype.isEditing=function(){return this.ext.edit?this.ext.edit.currentNode:null};n.ui.fancytree._FancytreeNodeClass.prototype.isEditing=function(){return this.tree.ext.edit?this.tree.ext.edit.currentNode===this:!1};n.ui.fancytree.registerExtension({name:"edit",version:"2.23.0",options:{adjustWidthOfs:4,allowEmpty:!1,inputCss:{minWidth:"3em"},triggerStart:["f2","shift+click","mac+enter"],trim:!0,beforeClose:n.noop,beforeEdit:n.noop,close:n.noop,edit:n.noop,save:n.noop},currentNode:null,treeInit:function(){this._superApply(arguments);this.$container.addClass("fancytree-ext-edit")},nodeClick:function(t){return n.inArray("shift+click",t.options.edit.triggerStart)>=0&&t.originalEvent.shiftKey?(t.node.editStart(),!1):this._superApply(arguments)},nodeDblclick:function(t){return n.inArray("dblclick",t.options.edit.triggerStart)>=0?(t.node.editStart(),!1):this._superApply(arguments)},nodeKeydown:function(t){switch(t.originalEvent.which){case 113:if(n.inArray("f2",t.options.edit.triggerStart)>=0)return t.node.editStart(),!1;break;case n.ui.keyCode.ENTER:if(n.inArray("mac+enter",t.options.edit.triggerStart)>=0&&r)return t.node.editStart(),!1}return this._superApply(arguments)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.filter.js
 *
 * Remove or highlight tree nodes, based on a filter.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";function i(n){return(n+"").replace(/([.?*+\^\$\[\]\\(){}|-])/g,"\\$1")}function u(t){return t.indexOf(">")>=0?n("<div/>").html(t).text():t}var t="__not_found__",r=n.ui.fancytree.escapeHtml;n.ui.fancytree._FancytreeClass.prototype._applyFilterImpl=function(f,e,o){var a,s,v,y,l=0,c=this.options,p=c.escapeTitles,b=c.autoCollapse,h=n.extend({},c.filter,o),w=h.mode==="hide",k=!!h.leavesOnly&&!e;return typeof f=="string"&&(a=h.fuzzy?f.split("").reduce(function(n,t){return n+"[^"+t+"]*"+t}):i(f),v=new RegExp(".*"+a+".*","i"),y=new RegExp(i(f),"gi"),f=function(n){var t,i=p?n.title:u(n.title),f=!!v.test(i);return f&&h.highlight&&(t=p?r(n.title):i,n.titleWithHighlight=t.replace(y,function(n){return"<mark>"+n+"<\/mark>"})),f}),this.enableFilter=!0,this.lastFilterArgs=arguments,this.$div.addClass("fancytree-ext-filter"),w?this.$div.addClass("fancytree-ext-filter-hide"):this.$div.addClass("fancytree-ext-filter-dimm"),this.$div.toggleClass("fancytree-ext-filter-hide-expanders",!!h.hideExpanders),this.visit(function(n){delete n.match;delete n.titleWithHighlight;n.subMatchCount=0}),s=this.getRootNode()._findDirectChild(t),s&&s.remove(),c.autoCollapse=!1,this.visit(function(n){if(!k||n.children==null){var t=f(n),i=!1;if(t==="skip")return n.visit(function(n){n.match=!1},!0),"skip";!t&&(e||t==="branch")&&n.parent.match&&(t=!0,i=!0);t&&(l++,n.match=!0,n.visitParents(function(n){n.subMatchCount+=1;!h.autoExpand||i||n.expanded||(n.setExpanded(!0,{noAnimation:!0,noEvents:!0,scrollIntoView:!1}),n._filterAutoExpanded=!0)}))}}),c.autoCollapse=b,l===0&&h.nodata&&w&&(s=h.nodata,n.isFunction(s)&&(s=s()),s===!0?s={}:typeof s=="string"&&(s={title:s}),s=n.extend({statusNodeType:"nodata",key:t,title:this.options.strings.noData},s),this.getRootNode().addNode(s).match=!0),this.render(),l};n.ui.fancytree._FancytreeClass.prototype.filterNodes=function(n,t){return typeof t=="boolean"&&(t={leavesOnly:t},this.warn("Fancytree.filterNodes() leavesOnly option is deprecated since 2.9.0 / 2015-04-19. Use opts.leavesOnly instead.")),this._applyFilterImpl(n,!1,t)};n.ui.fancytree._FancytreeClass.prototype.applyFilter=function(){return this.warn("Fancytree.applyFilter() is deprecated since 2.1.0 / 2014-05-29. Use .filterNodes() instead."),this.filterNodes.apply(this,arguments)};n.ui.fancytree._FancytreeClass.prototype.filterBranches=function(n,t){return this._applyFilterImpl(n,!0,t)};n.ui.fancytree._FancytreeClass.prototype.clearFilter=function(){var i,r=this.getRootNode()._findDirectChild(t),f=this.options.escapeTitles,u=this.options.enhanceTitle;r&&r.remove();this.visit(function(t){t.match&&t.span&&(i=n(t.span).find(">span.fancytree-title"),f?i.text(t.title):i.html(t.title),u&&u({type:"enhanceTitle"},{node:t,$title:i}));delete t.match;delete t.subMatchCount;delete t.titleWithHighlight;t.$subMatchBadge&&(t.$subMatchBadge.remove(),delete t.$subMatchBadge);t._filterAutoExpanded&&t.expanded&&t.setExpanded(!1,{noAnimation:!0,noEvents:!0,scrollIntoView:!1});delete t._filterAutoExpanded});this.enableFilter=!1;this.lastFilterArgs=null;this.$div.removeClass("fancytree-ext-filter fancytree-ext-filter-dimm fancytree-ext-filter-hide");this.render()};n.ui.fancytree._FancytreeClass.prototype.isFilterActive=function(){return!!this.enableFilter};n.ui.fancytree._FancytreeNodeClass.prototype.isMatched=function(){return!(this.tree.enableFilter&&!this.match)};n.ui.fancytree.registerExtension({name:"filter",version:"2.23.0",options:{autoApply:!0,autoExpand:!1,counter:!0,fuzzy:!1,hideExpandedCounter:!0,hideExpanders:!1,highlight:!0,leavesOnly:!1,nodata:!0,mode:"dimm"},nodeLoadChildren:function(n){return this._superApply(arguments).done(function(){n.tree.enableFilter&&n.tree.lastFilterArgs&&n.options.filter.autoApply&&n.tree._applyFilterImpl.apply(n.tree,n.tree.lastFilterArgs)})},nodeSetExpanded:function(n,t){return delete n.node._filterAutoExpanded,!t&&n.options.filter.hideExpandedCounter&&n.node.$subMatchBadge&&n.node.$subMatchBadge.show(),this._superApply(arguments)},nodeRenderStatus:function(t){var u,i=t.node,f=t.tree,e=t.options.filter,r=n(i.span).find("span.fancytree-title"),o=n(i[f.statusClassPropName]),s=t.options.enhanceTitle,h=t.options.escapeTitles;return(u=this._super(t),!o.length||!f.enableFilter)?u:(o.toggleClass("fancytree-match",!!i.match).toggleClass("fancytree-submatch",!!i.subMatchCount).toggleClass("fancytree-hide",!(i.match||i.subMatchCount)),e.counter&&i.subMatchCount&&(!i.isExpanded()||!e.hideExpandedCounter)?(i.$subMatchBadge||(i.$subMatchBadge=n("<span class='fancytree-childcounter'/>"),n("span.fancytree-icon, span.fancytree-custom-icon",i.span).append(i.$subMatchBadge)),i.$subMatchBadge.show().text(i.subMatchCount)):i.$subMatchBadge&&i.$subMatchBadge.hide(),!i.span||i.isEditing&&i.isEditing.call(i)||(i.titleWithHighlight?r.html(i.titleWithHighlight):h?r.text(i.title):r.html(i.title),s&&s({type:"enhanceTitle"},{node:i,$title:r})),u)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.glyph.js
 *
 * Use glyph fonts as instead of icon sprites.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";function t(n,t){return n.map[t]}n.ui.fancytree.registerExtension({name:"glyph",version:"2.23.0",options:{map:{checkbox:"icon-check-empty",checkboxSelected:"icon-check",checkboxUnknown:"icon-check icon-muted",error:"icon-exclamation-sign",expanderClosed:"icon-caret-right",expanderLazy:"icon-angle-right",expanderOpen:"icon-caret-down",nodata:"icon-meh",noExpander:"",dragHelper:"icon-caret-right",dropMarker:"icon-caret-right",doc:"icon-file-alt",docOpen:"icon-file-alt",loading:"icon-refresh icon-spin",folder:"icon-folder-close-alt",folderOpen:"icon-folder-open-alt"}},treeInit:function(n){var t=n.tree;this._superApply(arguments);t.$container.addClass("fancytree-ext-glyph")},nodeRenderStatus:function(i){var f,o,u,r=i.node,s=n(r.span),e=i.options.glyph,h=e.map;return(o=this._super(i),r.isRoot())?o:(u=s.children("span.fancytree-expander").get(0),u&&(f=r.expanded&&r.hasChildren()?"expanderOpen":r.isUndefined()?"expanderLazy":r.hasChildren()?"expanderClosed":"noExpander",u.className="fancytree-expander "+h[f]),u=r.tr?n("td",r.tr).find("span.fancytree-checkbox").get(0):s.children("span.fancytree-checkbox").get(0),u&&(f=r.selected?"checkboxSelected":r.partsel?"checkboxUnknown":"checkbox",u.className="fancytree-checkbox "+h[f]),u=s.children("span.fancytree-icon").get(0),u&&(f=r.statusNodeType?t(e,r.statusNodeType):r.folder?r.expanded&&r.hasChildren()?t(e,"folderOpen"):t(e,"folder"):r.expanded?t(e,"docOpen"):t(e,"doc"),u.className="fancytree-icon "+f),o)},nodeSetStatus:function(i,r){var e,u,o=i.options.glyph,f=i.node;return e=this._superApply(arguments),(r==="error"||r==="loading"||r==="nodata")&&(f.parent?(u=n("span.fancytree-expander",f.span).get(0),u&&(u.className="fancytree-expander "+t(o,r))):(u=n(".fancytree-statusnode-"+r,f[this.nodeContainerAttrName]).find("span.fancytree-icon").get(0),u&&(u.className="fancytree-icon "+t(o,r)))),e}})})(jQuery,window,document);
/*!
 * jquery.fancytree.gridnav.js
 *
 * Support keyboard navigation for trees with embedded input controls.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";function r(t,i){var r,f=i.get(0),u=0;return t.children().each(function(){if(this===f)return!1;r=n(this).prop("colspan");u+=r?r:1}),u}function u(t,i){var r,u=null,f=0;return t.children().each(function(){if(f>=i)return u=n(this),!1;r=n(this).prop("colspan");f+=r?r:1}),u}function f(n,i){var f,s,o=n.closest("td"),e=null;switch(i){case t.LEFT:e=o.prev();break;case t.RIGHT:e=o.next();break;case t.UP:case t.DOWN:for(f=o.parent(),s=r(f,o);;){if(f=i===t.UP?f.prev():f.next(),!f.length)break;if(!f.is(":hidden")&&(e=u(f,s),e&&e.find(":input,a").length))break}}return e}var t=n.ui.keyCode,i={text:[t.UP,t.DOWN],checkbox:[t.UP,t.DOWN,t.LEFT,t.RIGHT],link:[t.UP,t.DOWN,t.LEFT,t.RIGHT],radiobutton:[t.UP,t.DOWN,t.LEFT,t.RIGHT],"select-one":[t.LEFT,t.RIGHT],"select-multiple":[t.LEFT,t.RIGHT]};n.ui.fancytree.registerExtension({name:"gridnav",version:"2.23.0",options:{autofocusInput:!1,handleCursorKeys:!0},treeInit:function(t){this._requireExtension("table",!0,!0);this._superApply(arguments);this.$container.addClass("fancytree-ext-gridnav");this.$container.on("focusin",function(i){var u,r=n.ui.fancytree.getNode(i.target);r&&!r.isActive()&&(u=t.tree._makeHookContext(r,i),t.tree._callHook("nodeSetActive",u,!0))})},nodeSetActive:function(t,i){var u,e=t.options.gridnav,r=t.node,o=t.originalEvent||{},f=n(o.target).is(":input");i=i!==!1;this._superApply(arguments);i&&(t.options.titlesTabbable?(f||(n(r.span).find("span.fancytree-title").focus(),r.setFocus()),t.tree.$container.attr("tabindex","-1")):e.autofocusInput&&!f&&(u=n(r.tr||r.span),u.find(":input:enabled:first").focus()))},nodeKeydown:function(t){var r,o,u,h=t.options.gridnav,s=t.originalEvent,e=n(s.target);return(e.is(":input:enabled")?r=e.prop("type"):e.is("a")&&(r="link"),r&&h.handleCursorKeys)?(o=i[r],o&&n.inArray(s.which,o)>=0&&(u=f(e,s.which),u&&u.length))?(u.find(":input:enabled,a").focus(),!1):!0:this._superApply(arguments)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.persist.js
 *
 * Persist tree status in cookiesRemove or highlight tree nodes, based on a filter.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * @depends: js-cookie or jquery-cookie
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n,t,i,r){"use strict";function l(t,i,r,u,e){var o,c,a,s,y=!1,p=t.options.persist.expandOpts,v=[],h=[];for(r=r||[],e=e||n.Deferred(),o=0,a=r.length;o<a;o++)c=r[o],s=t.getNodeByKey(c),s?u&&s.isUndefined()?(y=!0,t.debug("_loadLazyNodes: "+s+" is lazy: loading..."),u==="expand"?v.push(s.setExpanded(!0,p)):v.push(s.load())):(t.debug("_loadLazyNodes: "+s+" already loaded."),s.setExpanded(!0,p)):(h.push(c),t.debug("_loadLazyNodes: "+s+" was not yet found."));return n.when.apply(n,v).always(function(){if(y&&h.length>0)l(t,i,h,u,e);else{if(h.length)for(t.warn("_loadLazyNodes: could not load those keys: ",h),o=0,a=h.length;o<a;o++)c=r[o],i._appendKey(f,r[o],!1);e.resolve()}}),e}var s,h,c,a=n.ui.fancytree.assert,e="active",f="expanded",o="focus",u="selected";typeof Cookies=="function"?(c=Cookies.set,s=Cookies.get,h=Cookies.remove):(c=s=n.cookie,h=n.removeCookie);n.ui.fancytree._FancytreeClass.prototype.clearCookies=function(n){var t=this.ext.persist,i=t.cookiePrefix;n=n||"active expanded focus selected";n.indexOf(e)>=0&&t._data(i+e,null);n.indexOf(f)>=0&&t._data(i+f,null);n.indexOf(o)>=0&&t._data(i+o,null);n.indexOf(u)>=0&&t._data(i+u,null)};n.ui.fancytree._FancytreeClass.prototype.getPersistData=function(){var n=this.ext.persist,i=n.cookiePrefix,r=n.cookieDelimiter,t={};return t[e]=n._data(i+e),t[f]=(n._data(i+f)||"").split(r),t[u]=(n._data(i+u)||"").split(r),t[o]=n._data(i+o),t};n.ui.fancytree.registerExtension({name:"persist",version:"2.23.0",options:{cookieDelimiter:"~",cookiePrefix:r,cookie:{raw:!1,expires:"",path:"",domain:"",secure:!1},expandLazy:!1,expandOpts:r,fireActivate:!0,overrideSource:!0,store:"auto",types:"active expanded focus selected"},_data:function(n,t){var i=this._local.localStorage;if(t===r)return i?i.getItem(n):s(n);t===null?i?i.removeItem(n):h(n):i?i.setItem(n,t):c(n,t,this.options.persist.cookie)},_appendKey:function(t,i,r){i=""+i;var f=this._local,c=this.options.persist,e=c.cookieDelimiter,o=f.cookiePrefix+t,s=f._data(o),u=s?s.split(e):[],h=n.inArray(i,u);h>=0&&u.splice(h,1);r&&u.push(i);f._data(o,u.join(e))},treeInit:function(i){var v=i.tree,y=i.options,h=this._local,c=this.options.persist;return a(c.store!=="auto"&&c.store!=="cookie"||s,"Missing required plugin for 'persist' extension: js.cookie.js or jquery.cookie.js"),h.cookiePrefix=c.cookiePrefix||"fancytree-"+v._id+"-",h.storeActive=c.types.indexOf(e)>=0,h.storeExpanded=c.types.indexOf(f)>=0,h.storeSelected=c.types.indexOf(u)>=0,h.storeFocus=c.types.indexOf(o)>=0,h.localStorage=c.store!=="cookie"&&t.localStorage?c.store==="local"?t.localStorage:t.sessionStorage:null,v.$div.bind("fancytreeinit",function(){if(v._triggerTreeEvent("beforeRestore",null,{})!==!1){var i,p,a,s,t,w=h._data(h.cookiePrefix+o),b=c.fireActivate===!1;i=h._data(h.cookiePrefix+f);s=i&&i.split(c.cookieDelimiter);p=h.storeExpanded?l(v,h,s,c.expandLazy?"expand":!1,null):(new n.Deferred).resolve();p.done(function(){if(h.storeSelected){if(i=h._data(h.cookiePrefix+u),i)for(s=i.split(c.cookieDelimiter),a=0;a<s.length;a++)t=v.getNodeByKey(s[a]),t?(t.selected===r||c.overrideSource&&t.selected===!1)&&(t.selected=!0,t.renderStatus()):h._appendKey(u,s[a],!1);v.options.selectMode===3&&v.visit(function(n){if(n.selected)return n.fixSelection3AfterClick(),"skip"})}h.storeActive&&(i=h._data(h.cookiePrefix+e),i&&(y.persist.overrideSource||!v.activeNode)&&(t=v.getNodeByKey(i),t&&(t.debug("persist: set active",i),t.setActive(!0,{noFocus:!0,noEvents:b}))));h.storeFocus&&w&&(t=v.getNodeByKey(w),t&&(v.options.titlesTabbable?n(t.span).find(".fancytree-title").focus():n(v.$container).focus()));v._triggerTreeEvent("restore",null,{})})}}),this._superApply(arguments)},nodeSetActive:function(n,t){var r,i=this._local;return t=t!==!1,r=this._superApply(arguments),i.storeActive&&i._data(i.cookiePrefix+e,this.activeNode?this.activeNode.key:null),r},nodeSetExpanded:function(n,t){var i,u=n.node,r=this._local;return t=t!==!1,i=this._superApply(arguments),r.storeExpanded&&r._appendKey(f,u.key,t),i},nodeSetFocus:function(n,t){var r,i=this._local;return t=t!==!1,r=this._superApply(arguments),i.storeFocus&&i._data(i.cookiePrefix+o,this.focusNode?this.focusNode.key:null),r},nodeSetSelected:function(t,i){var e,r,o=t.tree,s=t.node,f=this._local;return i=i!==!1,e=this._superApply(arguments),f.storeSelected&&(o.options.selectMode===3?(r=n.map(o.getSelectedNodes(!0),function(n){return n.key}),r=r.join(t.options.persist.cookieDelimiter),f._data(f.cookiePrefix+u,r)):f._appendKey(u,s.key,s.selected)),e}})})(jQuery,window,document);
/*!
 * jquery.fancytree.table.js
 *
 * Render tree as table (aka 'tree grid', 'table tree').
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n,t,i){"use strict";function r(t,i){i=i||"";t||n.error("Assertion failed "+i)}function f(n,t){n.insertBefore(t,n.firstChild)}function e(n,t){n.parentNode.insertBefore(t,n.nextSibling)}function u(n,t){n.visit(function(n){var i=n.tr;return i&&(i.style.display=n.hide||!t?"none":""),n.expanded?void 0:"skip"})}function o(t){var o,f,i,e=t.parent,u=e?e.children:null;if(u&&u.length>1&&u[0]!==t)for(o=n.inArray(t,u),i=u[o-1],r(i.tr);i.children&&i.children.length;){if(f=i.children[i.children.length-1],!f.tr)break;i=f}else i=e;return i}n.ui.fancytree.registerExtension({name:"table",version:"2.23.0",options:{checkboxColumnIdx:null,indentation:16,nodeColumnIdx:0},treeInit:function(t){var c,o,s,f,l,u=t.tree,e=t.options,a=e.table,h=u.widget.element;if(a.customStatus!=null&&(e.renderStatusColumns!=null?n.error("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' only instead."):(u.warn("The 'customStatus' option is deprecated since v2.15.0. Use 'renderStatusColumns' instead."),e.renderStatusColumns=a.customStatus)),e.renderStatusColumns&&e.renderStatusColumns===!0&&(e.renderStatusColumns=e.renderColumns),h.addClass("fancytree-container fancytree-ext-table"),u.tbody=h.find(">tbody")[0],l=n(u.tbody),o=n("thead >tr:last >th",h).length,f=l.children("tr:first"),f.length)s=f.children("td").length,o&&s!==o&&(u.warn("Column count mismatch between thead ("+o+") and tbody ("+s+"): using tbody."),o=s),f=f.clone();else for(r(o>=1,"Need either <thead> or <tbody> with <td> elements to determine column count."),f=n("<tr />"),c=0;c<o;c++)f.append("<td />");f.find(">td").eq(a.nodeColumnIdx).html("<span class='fancytree-node' />");e.aria&&(f.attr("role","row"),f.find("td").attr("role","gridcell"));u.rowFragment=i.createDocumentFragment();u.rowFragment.appendChild(f.get(0));l.empty();u.statusClassPropName="tr";u.ariaPropName="tr";this.nodeContainerAttrName="tr";u.$container=h;this._superApply(arguments);n(u.rootNode.ul).remove();u.rootNode.ul=null;this.$container.attr("tabindex",e.tabindex);e.aria&&u.$container.attr("role","treegrid").attr("aria-readonly",!0)},nodeRemoveChildMarkup:function(t){var i=t.node;i.visit(function(t){t.tr&&(n(t.tr).remove(),t.tr=null)})},nodeRemoveMarkup:function(t){var i=t.node;i.tr&&(n(i.tr).remove(),i.tr=null);this.nodeRemoveChildMarkup(t)},nodeRender:function(t,i,s,h,c){var p,g,k,nt,v,w,b,d,a=t.tree,l=t.node,y=t.options,tt=!l.parent;if(a._enableUpdate!==!1){if(c||(t.hasCollapsedParents=l.parent&&!l.parent.expanded),!tt)if(l.tr&&i&&this.nodeRemoveMarkup(t),l.tr)i?this.nodeRenderTitle(t):this.nodeRenderStatus(t);else{if(t.hasCollapsedParents&&!s)return;v=a.rowFragment.firstChild.cloneNode(!0);w=o(l);r(w);h===!0&&c?v.style.display="none":s&&t.hasCollapsedParents&&(v.style.display="none");w.tr?e(w.tr,v):(r(!w.parent,"prev. row must have a tr, or be system root"),f(a.tbody,v));l.tr=v;l.key&&y.generateIds&&(l.tr.id=y.idPrefix+l.key);l.tr.ftnode=l;l.span=n("span.fancytree-node",l.tr).get(0);this.nodeRenderTitle(t);y.createNode&&y.createNode.call(a,{type:"createNode"},t)}if(y.renderNode&&y.renderNode.call(a,{type:"renderNode"},t),p=l.children,p&&(tt||s||l.expanded))for(k=0,nt=p.length;k<nt;k++)d=n.extend({},t,{node:p[k]}),d.hasCollapsedParents=d.hasCollapsedParents||!l.expanded,this.nodeRender(d,i,s,h,!0);p&&!c&&(b=l.tr||null,g=a.tbody.firstChild,l.visit(function(n){if(n.tr){if(n.parent.expanded||n.tr.style.display==="none"||(n.tr.style.display="none",u(n,!1)),n.tr.previousSibling!==b){l.debug("_fixOrder: mismatch at node: "+n);var t=b?b.nextSibling:g;a.tbody.insertBefore(n.tr,t)}b=n.tr}}))}},nodeRenderTitle:function(t,i){var e,f,u=t.node,r=t.options,o=u.isStatusNode();return(f=this._super(t,i),u.isRootNode())?f:(r.checkbox&&!o&&r.table.checkboxColumnIdx!=null&&(e=n("span.fancytree-checkbox",u.span),n(u.tr).find("td").eq(+r.table.checkboxColumnIdx).html(e)),this.nodeRenderStatus(t),o?r.renderStatusColumns&&r.renderStatusColumns.call(t.tree,{type:"renderStatusColumns"},t):r.renderColumns&&r.renderColumns.call(t.tree,{type:"renderColumns"},t),f)},nodeRenderStatus:function(t){var r,i=t.node,u=t.options;this._super(t);n(i.tr).removeClass("fancytree-node");r=(i.getLevel()-1)*u.table.indentation;n(i.span).css({paddingLeft:r+"px"})},nodeSetExpanded:function(t,i,r){function e(n){u(t.node,i);n?i&&t.options.autoScroll&&!r.noAnimation&&t.node.hasChildren()?t.node.getLastChild().scrollIntoView(!0,{topNode:t.node}).always(function(){r.noEvents||t.tree._triggerNodeEvent(i?"expand":"collapse",t);f.resolveWith(t.node)}):(r.noEvents||t.tree._triggerNodeEvent(i?"expand":"collapse",t),f.resolveWith(t.node)):(r.noEvents||t.tree._triggerNodeEvent(i?"expand":"collapse",t),f.rejectWith(t.node))}if(i=i!==!1,t.node.expanded&&i||!t.node.expanded&&!i)return this._superApply(arguments);var f=new n.Deferred,o=n.extend({},r,{noEvents:!0,noAnimation:!0});return r=r||{},this._super(t,i,o).done(function(){e(!0)}).fail(function(){e(!1)}),f.promise()},nodeSetStatus:function(t,i){if(i==="ok"){var u=t.node,r=u.children?u.children[0]:null;r&&r.isStatusNode()&&n(r.tr).remove()}return this._superApply(arguments)},treeClear:function(){return this.nodeRemoveChildMarkup(this._makeHookContext(this.rootNode)),this._superApply(arguments)},treeDestroy:function(){return this.$container.find("tbody").empty(),this.$source&&this.$source.removeClass("ui-helper-hidden"),this._superApply(arguments)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.themeroller.js
 *
 * Enable jQuery UI ThemeRoller styles.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * @see http://jqueryui.com/themeroller/
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";n.ui.fancytree.registerExtension({name:"themeroller",version:"2.23.0",options:{activeClass:"ui-state-active",addClass:"ui-corner-all",focusClass:"ui-state-focus",hoverClass:"ui-state-hover",selectedClass:"ui-state-highlight"},treeInit:function(t){var i=t.widget.element,r=t.options.themeroller;this._superApply(arguments);i[0].nodeName==="TABLE"?(i.addClass("ui-widget ui-corner-all"),i.find(">thead tr").addClass("ui-widget-header"),i.find(">tbody").addClass("ui-widget-conent")):i.addClass("ui-widget ui-widget-content ui-corner-all");i.delegate(".fancytree-node","mouseenter mouseleave",function(t){var i=n.ui.fancytree.getNode(t.target),u=t.type==="mouseenter";n(i.tr?i.tr:i.span).toggleClass(r.hoverClass+" "+r.addClass,u)})},treeDestroy:function(n){this._superApply(arguments);n.widget.element.removeClass("ui-widget ui-widget-content ui-corner-all")},nodeRenderStatus:function(t){var r={},u=t.node,f=n(u.tr?u.tr:u.span),i=t.options.themeroller;this._super(t);r[i.activeClass]=!1;r[i.focusClass]=!1;r[i.selectedClass]=!1;u.isActive()&&(r[i.activeClass]=!0);u.hasFocus()&&(r[i.focusClass]=!0);u.isSelected()&&!u.isActive()&&(r[i.selectedClass]=!0);f.toggleClass(i.activeClass,r[i.activeClass]);f.toggleClass(i.focusClass,r[i.focusClass]);f.toggleClass(i.selectedClass,r[i.selectedClass]);f.addClass(i.addClass)}})})(jQuery,window,document);
/*!
 * jquery.fancytree.wide.js
 * Support for 100% wide selection bars.
 * (Extension module for jquery.fancytree.js: https://github.com/mar10/fancytree/)
 *
 * Copyright (c) 2008-2017, Martin Wendt (http://wwWendt.de)
 *
 * Released under the MIT license
 * https://github.com/mar10/fancytree/wiki/LicenseInfo
 *
 * @version 2.23.0
 * @date 2017-05-27T20:09:38Z
 */
(function(n){"use strict";function i(t,i){t="fancytree-style-"+t;var r=n("#"+t);if(!i)return r.remove(),null;r.length||(r=n("<style />").attr("id",t).addClass("fancytree-style").prop("type","text/css").appendTo("head"));try{r.html(i)}catch(u){r[0].styleSheet.cssText=i}return r}function r(n,t,i,r,u,f){for(var s="#"+n+" span.fancytree-level-",o=[],e=0;e<t;e++)o.push(s+(e+1)+" span.fancytree-title { padding-left: "+(e*i+r)+f+"; }");return o.push("#"+n+" div.ui-effects-wrapper ul li span.fancytree-title, #"+n+" ul.fancytree-animating span.fancytree-title { padding-left: "+u+f+"; position: static; width: auto; }"),o.join("\n")}var t=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;n.ui.fancytree.registerExtension({name:"wide",version:"2.23.0",options:{iconWidth:null,iconSpacing:null,labelSpacing:null,levelOfs:null},treeCreate:function(u){this._superApply(arguments);this.$container.addClass("fancytree-ext-wide");var c,a,v,y,f,p,o=u.options.wide,l=n("<li id='fancytreeTemp'><span class='fancytree-node'><span class='fancytree-icon' /><span class='fancytree-title' /><\/span><ul />").appendTo(u.tree.$container),w=l.find(".fancytree-icon"),k=l.find("ul"),e=o.iconSpacing||w.css("margin-left"),s=o.iconWidth||w.css("width"),h=o.labelSpacing||"3px",b=o.levelOfs||k.css("padding-left");l.remove();v=e.match(t)[2];e=parseFloat(e,10);y=h.match(t)[2];h=parseFloat(h,10);f=s.match(t)[2];s=parseFloat(s,10);p=b.match(t)[2];(v!==f||p!==f||y!==f)&&n.error("iconWidth, iconSpacing, and levelOfs must have the same css measure unit");this._local.measureUnit=f;this._local.levelOfs=parseFloat(b);this._local.lineOfs=(1+(u.options.checkbox?1:0)+(u.options.icon===!1?0:1))*(s+e)+e;this._local.labelOfs=h;this._local.maxDepth=10;c=this.$container.uniqueId().attr("id");a=r(c,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.labelOfs,this._local.measureUnit);i(c,a)},treeDestroy:function(){return i(this.$container.attr("id"),null),this._superApply(arguments)},nodeRenderStatus:function(t){var u,e,o,f=t.node,s=f.getLevel();return o=this._super(t),s>this._local.maxDepth&&(u=this.$container.attr("id"),this._local.maxDepth*=2,f.debug("Define global ext-wide css up to level "+this._local.maxDepth),e=r(u,this._local.maxDepth,this._local.levelOfs,this._local.lineOfs,this._local.labelSpacing,this._local.measureUnit),i(u,e)),n(f.span).addClass("fancytree-level-"+s),o}})})(jQuery,window,document),function(n){"use strict";var t=function(t,i,r,u){t.$container.on("mousedown.contextMenu",function(t){var f=n.ui.fancytree.getNode(t);f&&(n.contextMenu("destroy","."+i),f.setFocus(!0),f.setActive(!0),n.contextMenu({selector:"."+i,build:function(t){f=n.ui.fancytree.getNode(t);var i={};return n.isFunction(r)?i=r(f):n.isPlainObject(r)&&(i=r),{callback:function(t,i){n.isFunction(u)?u(f,t,i):n.isPlainObject(u)&&u.hasOwnProperty(t)&&n.isFunction(u[t])&&u[t](f,i)},items:i}}}))})};n.ui.fancytree.registerExtension({name:"contextMenu",version:"1.0",contextMenu:{selector:"fancytree-title",menu:{},actions:{}},treeInit:function(n){this._super(n);t(n.tree,n.options.contextMenu.selector||"fancytree-title",n.options.contextMenu.menu,n.options.contextMenu.actions)}})}(jQuery,document);
/*!
 * jQuery Spliter Plugin version 0.28.5
 * Copyright (C) 2010-2020 Jakub T. Jankiewicz <https://jcubic.pl/me>
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */
(function(n,t){var i=typeof window!="undefined"?window:global;typeof define=="function"&&define.amd?define(["jquery"],n):typeof module=="object"&&module.exports?module.exports=function(i,r){return r===t&&(r=window!==t?require("jquery"):require("jquery")(i)),n(r),r}:n(i.jQuery)})(function(n,t){var o;typeof String.prototype.trim=="undefined"&&(o=/(^\s+)|(\s+)$/g,String.prototype.trim=function(){return this.replace(o,"")});var f=0,u=null,r=[],i=null,e=null;n.fn.split=function(o){function rt(n){return o&&typeof o[n]=="undefined"||!o}function nt(n){if(n instanceof Array)return n.map(nt);if(typeof n=="number")return n;if(typeof n=="string"){var t=n.match(/^([0-9\.]+)(px|%)$/);if(t){if(t[2]=="px")return+t[1];if(h.orientation=="vertical")return p*+t[1]/100;if(h.orientation=="horizontal")return v*+t[1]/100}}}function et(n){return!isNaN(parseFloat(n))&&isFinite(n)?{leftUpper:n,rightBottom:n}:n}function ft(n,t){var r=n.slice(0,i.index),u,e,f;return u=r.length?t-r.reduce(function(n,t){return n+t}):t,e=n[i.index]-u,r.push(u),i.index<n.length-1&&(f=n.slice(i.index+1),f[0]+=e,r=r.concat(f)),r}var it=this.data("splitter"),g,ut,y,k,p,v,d,l,s,a;if(it)return it;var c=[],w=[],b,tt,h=n.extend({limit:100,orientation:"horizontal",position:"50%",invisible:!1,onDragStart:n.noop,onDragEnd:n.noop,onDrag:n.noop,percent:!1},o||{});this.settings=h;g=this.children().length;g>2&&(rt("position")&&(ut=100/g,h.position=new Array(g-1).fill(0).map(function(){return ut+"%"})),rt("percent")&&(h.percent=!0));k=this.children();k.length===2?(h.orientation=="vertical"?(b=k.first().addClass("left_panel"),tt=b.next().addClass("right_panel"),y="vsplitter"):h.orientation=="horizontal"&&(b=k.first().addClass("top_panel"),tt=b.next().addClass("bottom_panel"),y="hsplitter"),c=[b,tt]):k.each(function(){var t=n(this);h.orientation=="vertical"?(t.addClass("vertical_panel"),y="vsplitter"):(t.addClass("horizontal_panel"),y="hsplitter");c.push(t)});h.invisible&&(y+=" splitter-invisible");p=this.width();v=this.height();this.addClass("splitter_panel");d=f++;c.slice(0,-1).forEach(function(t,i){var r=n("<div/>").addClass(y).on("mouseenter touchstart",function(){u=d;e=r.index()-i-1}).on("mouseleave touchend",function(){u=null;e=null}).insertAfter(t);w.push(r)});s=n.extend(this,{refresh:function(){var n=this.width(),t=this.height();(p!=n||v!=t)&&(p=this.width(),v=this.height(),s.position(l))},option:function(n,t){return n==="position"?s.position(t):typeof t=="undefined"?h[n]:(h[n]=t,s)},position:function(){function i(n,i){return function(r,u){var b,o,rt,ut,it,ft,y;if(r===t)return l;if(l=nt(r),l instanceof Array||(l=[l]),l.length!==c.length-1)throw new Error("position array need to equal splitters length");b="outer"+(n[0].toUpperCase()+n.substring(1));var a=s.css("visiblity","hidden")[n](),f=0,e=0;for(o=0;o<l.length;++o){var k=w[o],p=c[o],d=l[o],g=k[n](),tt=g/2;h.invisible?(f+=p[n](d)[b](),k.css(i,f-tt*(o+1))):h.percent?(rt=(d-tt)/a*100,ut=(f+e)/a*100,p.css(i,ut+"%"),f+=p.css(n,rt+"%")[b](),k.css(i,(f+e)/a*100+"%")):(p.css(i,f+e),f+=p.css(n,d-tt)[b](),k.css(i,f+e));e+=g}return it=c[o],h.invisible?it.height(v-f):(ft=g*o,y={},h.percent?(y[n]=(a-f-e)/a*100+"%",y[i]=(f+e)/a*100+"%"):(y[n]=a-f-e,y[i]=f+e),it.css(y)),s.css("visiblity",""),u||(s.trigger("splitter.resize"),s.find(".splitter_panel").trigger("splitter.resize")),s}}return h.orientation=="vertical"?i("width","left"):h.orientation=="horizontal"?i("height","top"):n.noop}(),_splitters:w,_panels:c,orientation:h.orientation,limit:et(h.limit),isActive:function(){return u===d},destroy:function(){function t(n,t){var i=n.attr(t);typeof i!="string"||i.trim()||n.removeAttr(t)}var i,u;for(s.removeClass("splitter_panel"),t(s,"class"),c.forEach(function(n){n.css({height:"",width:"",left:"",top:""});var i=n.attr("class").replace(/\w+_panel/g,"").trim();n.attr("class",i);t(n,"class");t(n,"style")}),s.off("splitter.resize"),s.trigger("splitter.resize"),s.find(".splitter_panel").trigger("splitter.resize"),r[d]=null,f--,w.forEach(function(t){var i=n(this);t.off("mouseenter");t.off("mouseleave");t.off("touchstart");t.off("touchmove");t.off("touchend");t.off("touchleave");t.off("touchcancel");t.remove()}),s.removeData("splitter"),i=!1,u=r.length;u--;)if(r[u]!==null){i=!0;break}i||(n(document.documentElement).off(".splitter"),n(window).off("resize.splitter"),r=[],f=0)}});s.on("splitter.resize",function(n){var t=s.position();s.orientation=="vertical"&&t>s.width()?t=s.width()-s.limit.rightBottom-1:s.orientation=="horizontal"&&t>s.height()&&(t=s.height()-s.limit.rightBottom-1);t<s.limit.leftUpper&&(t=s.limit.leftUpper+1);n.stopPropagation();s.position(t,!0)});if(h.orientation=="vertical"?a=a>p-h.limit.rightBottom?p-h.limit.rightBottom:nt(h.position):h.orientation=="horizontal"&&(a=a>v-h.limit.rightBottom?v-h.limit.rightBottom:nt(h.position)),a<h.limit.leftUpper&&(a=h.limit.leftUpper),c.length>2&&!(a instanceof Array&&a.length==w.length))throw new Error("position need to be array equal to $splitters length");if(s.position(a,!0),r.filter(Boolean).length===0){n(window).on("resize.splitter",function(){n.each(r,function(n,t){t&&t.refresh()})});n(document.documentElement).on("mousedown.splitter touchstart.splitter",function(t){if(u!==null){t.preventDefault();i={node:r[u],index:e};t.originalEvent.button!==2&&setTimeout(function(){i&&n('<div class="splitterMask"><\/div>').css("cursor",i.node.children().eq(1).css("cursor")).insertAfter(i.node)});i.node.settings.onDragStart(t)}}).on("mouseup.splitter touchend.splitter touchleave.splitter touchcancel.splitter",function(t){if(i){setTimeout(function(){n(".splitterMask").remove()});i.node.settings.onDragEnd(t);i=null}}).on("mousemove.splitter touchmove.splitter",function(n){var f,o,r,s,u;if(i!==null){var t=i.node,c=t.limit.leftUpper,e=t.limit.rightBottom,h=t.offset();t.orientation=="vertical"?(o=n.pageX,n.originalEvent&&n.originalEvent.changedTouches&&(o=n.originalEvent.changedTouches[0].pageX),r=o-h.left,r<=t.limit.leftUpper?r=t.limit.leftUpper+1:r>=t.width()-e&&(r=t.width()-e-1),f=t.position(),f.length>1?t.position(ft(f,r),!0):r>t.limit.leftUpper&&r<t.width()-e&&(t.position(r,!0),t.trigger("splitter.resize"),t.find(".splitter_panel").trigger("splitter.resize"))):t.orientation=="horizontal"&&(s=n.pageY,n.originalEvent&&n.originalEvent.changedTouches&&(s=n.originalEvent.changedTouches[0].pageY),u=s-h.top,u<=t.limit.leftUpper?u=t.limit.leftUpper+1:u>=t.height()-e&&(u=t.height()-e-1),f=t.position(),f.length>1?t.position(ft(f,u),!0):u>t.limit.leftUpper&&u<t.height()-e&&(t.position(u,!0),t.trigger("splitter.resize"),t.find(".splitter_panel").trigger("splitter.resize")));t.settings.onDrag(n)}})}return r[d]=s,s.data("splitter",s),s}});CryptoJS=CryptoJS||function(n,t){var u={},f=u.lib={},o=function(){},i=f.Base={extend:function(n){o.prototype=this;var t=new o;return n&&t.mixIn(n),t.hasOwnProperty("init")||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var n=this.extend();return n.init.apply(n,arguments),n},init:function(){},mixIn:function(n){for(var t in n)n.hasOwnProperty(t)&&(this[t]=n[t]);n.hasOwnProperty("toString")&&(this.toString=n.toString)},clone:function(){return this.init.prototype.extend(this)}},r=f.WordArray=i.extend({init:function(n,i){n=this.words=n||[];this.sigBytes=i!=t?i:4*n.length},toString:function(n){return(n||l).stringify(this)},concat:function(n){var i=this.words,r=n.words,u=this.sigBytes,t;if(n=n.sigBytes,this.clamp(),u%4)for(t=0;t<n;t++)i[u+t>>>2]|=(r[t>>>2]>>>24-8*(t%4)&255)<<24-8*((u+t)%4);else if(65535<r.length)for(t=0;t<n;t+=4)i[u+t>>>2]=r[t>>>2];else i.push.apply(i,r);return this.sigBytes+=n,this},clamp:function(){var i=this.words,t=this.sigBytes;i[t>>>2]&=4294967295<<32-8*(t%4);i.length=n.ceil(t/4)},clone:function(){var n=i.clone.call(this);return n.words=this.words.slice(0),n},random:function(t){for(var i=[],u=0;u<t;u+=4)i.push(4294967296*n.random()|0);return new r.init(i,t)}}),e=u.enc={},l=e.Hex={stringify:function(n){var u=n.words,i,t,r;for(n=n.sigBytes,i=[],t=0;t<n;t++)r=u[t>>>2]>>>24-8*(t%4)&255,i.push((r>>>4).toString(16)),i.push((r&15).toString(16));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t+=2)u[t>>>3]|=parseInt(n.substr(t,2),16)<<24-4*(t%8);return new r.init(u,i/2)}},s=e.Latin1={stringify:function(n){var r=n.words,i,t;for(n=n.sigBytes,i=[],t=0;t<n;t++)i.push(String.fromCharCode(r[t>>>2]>>>24-8*(t%4)&255));return i.join("")},parse:function(n){for(var i=n.length,u=[],t=0;t<i;t++)u[t>>>2]|=(n.charCodeAt(t)&255)<<24-8*(t%4);return new r.init(u,i)}},a=e.Utf8={stringify:function(n){try{return decodeURIComponent(escape(s.stringify(n)))}catch(t){throw Error("Malformed UTF-8 data");}},parse:function(n){return s.parse(unescape(encodeURIComponent(n)))}},h=f.BufferedBlockAlgorithm=i.extend({reset:function(){this._data=new r.init;this._nDataBytes=0},_append:function(n){"string"==typeof n&&(n=a.parse(n));this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(t){var f=this._data,s=f.words,u=f.sigBytes,e=this.blockSize,o=u/(4*e),o=t?n.ceil(o):n.max((o|0)-this._minBufferSize,0),i;if(t=o*e,u=n.min(4*t,u),t){for(i=0;i<t;i+=e)this._doProcessBlock(s,i);i=s.splice(0,t);f.sigBytes-=u}return new r.init(i,u)},clone:function(){var n=i.clone.call(this);return n._data=this._data.clone(),n},_minBufferSize:0}),c;return f.Hasher=h.extend({cfg:i.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){h.reset.call(this);this._doReset()},update:function(n){return this._append(n),this._process(),this},finalize:function(n){return n&&this._append(n),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,i){return new n.init(i).finalize(t)}},_createHmacHelper:function(n){return function(t,i){return new c.HMAC.init(n,i).finalize(t)}}}),c=u.algo={},u}(Math),function(){var n=CryptoJS,t=n.lib.WordArray;n.enc.Base64={stringify:function(n){var i=n.words,u=n.sigBytes,f=this._map,t,e,r;for(n.clamp(),n=[],t=0;t<u;t+=3)for(e=(i[t>>>2]>>>24-8*(t%4)&255)<<16|(i[t+1>>>2]>>>24-8*((t+1)%4)&255)<<8|i[t+2>>>2]>>>24-8*((t+2)%4)&255,r=0;4>r&&t+.75*r<u;r++)n.push(f.charAt(e>>>6*(3-r)&63));if(i=f.charAt(64))for(;n.length%4;)n.push(i);return n.join("")},parse:function(n){var e=n.length,f=this._map,i=f.charAt(64),o,s;i&&(i=n.indexOf(i),-1!=i&&(e=i));for(var i=[],u=0,r=0;r<e;r++)r%4&&(o=f.indexOf(n.charAt(r-1))<<2*(r%4),s=f.indexOf(n.charAt(r))>>>6-2*(r%4),i[u>>>2]|=(o|s)<<24-8*(u%4),u++);return t.create(i,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(n){function i(n,t,i,r,u,f,e){return n=n+(t&i|~t&r)+u+e,(n<<f|n>>>32-f)+t}function r(n,t,i,r,u,f,e){return n=n+(t&r|i&~r)+u+e,(n<<f|n>>>32-f)+t}function u(n,t,i,r,u,f,e){return n=n+(t^i^r)+u+e,(n<<f|n>>>32-f)+t}function f(n,t,i,r,u,f,e){return n=n+(i^(t|~r))+u+e,(n<<f|n>>>32-f)+t}for(var o=CryptoJS,e=o.lib,c=e.WordArray,s=e.Hasher,e=o.algo,t=[],h=0;64>h;h++)t[h]=4294967296*n.abs(n.sin(h+1))|0;e=e.MD5=s.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(n,e){for(var v,a,l=0;16>l;l++)v=e+l,a=n[v],n[v]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;var l=this._hash.words,v=n[e+0],a=n[e+1],y=n[e+2],p=n[e+3],w=n[e+4],b=n[e+5],k=n[e+6],d=n[e+7],g=n[e+8],nt=n[e+9],tt=n[e+10],it=n[e+11],rt=n[e+12],ut=n[e+13],ft=n[e+14],et=n[e+15],o=l[0],s=l[1],h=l[2],c=l[3],o=i(o,s,h,c,v,7,t[0]),c=i(c,o,s,h,a,12,t[1]),h=i(h,c,o,s,y,17,t[2]),s=i(s,h,c,o,p,22,t[3]),o=i(o,s,h,c,w,7,t[4]),c=i(c,o,s,h,b,12,t[5]),h=i(h,c,o,s,k,17,t[6]),s=i(s,h,c,o,d,22,t[7]),o=i(o,s,h,c,g,7,t[8]),c=i(c,o,s,h,nt,12,t[9]),h=i(h,c,o,s,tt,17,t[10]),s=i(s,h,c,o,it,22,t[11]),o=i(o,s,h,c,rt,7,t[12]),c=i(c,o,s,h,ut,12,t[13]),h=i(h,c,o,s,ft,17,t[14]),s=i(s,h,c,o,et,22,t[15]),o=r(o,s,h,c,a,5,t[16]),c=r(c,o,s,h,k,9,t[17]),h=r(h,c,o,s,it,14,t[18]),s=r(s,h,c,o,v,20,t[19]),o=r(o,s,h,c,b,5,t[20]),c=r(c,o,s,h,tt,9,t[21]),h=r(h,c,o,s,et,14,t[22]),s=r(s,h,c,o,w,20,t[23]),o=r(o,s,h,c,nt,5,t[24]),c=r(c,o,s,h,ft,9,t[25]),h=r(h,c,o,s,p,14,t[26]),s=r(s,h,c,o,g,20,t[27]),o=r(o,s,h,c,ut,5,t[28]),c=r(c,o,s,h,y,9,t[29]),h=r(h,c,o,s,d,14,t[30]),s=r(s,h,c,o,rt,20,t[31]),o=u(o,s,h,c,b,4,t[32]),c=u(c,o,s,h,g,11,t[33]),h=u(h,c,o,s,it,16,t[34]),s=u(s,h,c,o,ft,23,t[35]),o=u(o,s,h,c,a,4,t[36]),c=u(c,o,s,h,w,11,t[37]),h=u(h,c,o,s,d,16,t[38]),s=u(s,h,c,o,tt,23,t[39]),o=u(o,s,h,c,ut,4,t[40]),c=u(c,o,s,h,v,11,t[41]),h=u(h,c,o,s,p,16,t[42]),s=u(s,h,c,o,k,23,t[43]),o=u(o,s,h,c,nt,4,t[44]),c=u(c,o,s,h,rt,11,t[45]),h=u(h,c,o,s,et,16,t[46]),s=u(s,h,c,o,y,23,t[47]),o=f(o,s,h,c,v,6,t[48]),c=f(c,o,s,h,d,10,t[49]),h=f(h,c,o,s,ft,15,t[50]),s=f(s,h,c,o,b,21,t[51]),o=f(o,s,h,c,rt,6,t[52]),c=f(c,o,s,h,p,10,t[53]),h=f(h,c,o,s,tt,15,t[54]),s=f(s,h,c,o,a,21,t[55]),o=f(o,s,h,c,g,6,t[56]),c=f(c,o,s,h,et,10,t[57]),h=f(h,c,o,s,k,15,t[58]),s=f(s,h,c,o,ut,21,t[59]),o=f(o,s,h,c,w,6,t[60]),c=f(c,o,s,h,it,10,t[61]),h=f(h,c,o,s,y,15,t[62]),s=f(s,h,c,o,nt,21,t[63]);l[0]=l[0]+o|0;l[1]=l[1]+s|0;l[2]=l[2]+h|0;l[3]=l[3]+c|0},_doFinalize:function(){var u=this._data,r=u.words,t=8*this._nDataBytes,i=8*u.sigBytes,f;for(r[i>>>5]|=128<<24-i%32,f=n.floor(t/4294967296),r[(i+64>>>9<<4)+15]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360,r[(i+64>>>9<<4)+14]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360,u.sigBytes=4*(r.length+1),this._process(),u=this._hash,r=u.words,t=0;4>t;t++)i=r[t],r[t]=(i<<8|i>>>24)&16711935|(i<<24|i>>>8)&4278255360;return u},clone:function(){var n=s.clone.call(this);return n._hash=this._hash.clone(),n}});o.MD5=s._createHelper(e);o.HmacMD5=s._createHmacHelper(e)}(Math),function(){var t=CryptoJS,n=t.lib,i=n.Base,r=n.WordArray,n=t.algo,u=n.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:n.MD5,iterations:1}),init:function(n){this.cfg=this.cfg.extend(n)},compute:function(n,t){for(var i,o,f=this.cfg,u=f.hasher.create(),e=r.create(),h=e.words,s=f.keySize,f=f.iterations;h.length<s;){for(i&&u.update(i),i=u.update(n).finalize(t),u.reset(),o=1;o<f;o++)i=u.finalize(i),u.reset();e.concat(i)}return e.sigBytes=4*s,e}});t.EvpKDF=function(n,t,i){return u.create(i).compute(n,t)}}();CryptoJS.lib.Cipher||function(n){var i=CryptoJS,t=i.lib,f=t.Base,e=t.WordArray,c=t.BufferedBlockAlgorithm,l=i.enc.Base64,y=i.algo.EvpKDF,o=t.Cipher=c.extend({cfg:f.extend(),createEncryptor:function(n,t){return this.create(this._ENC_XFORM_MODE,n,t)},createDecryptor:function(n,t){return this.create(this._DEC_XFORM_MODE,n,t)},init:function(n,t,i){this.cfg=this.cfg.extend(i);this._xformMode=n;this._key=t;this.reset()},reset:function(){c.reset.call(this);this._doReset()},process:function(n){return this._append(n),this._process()},finalize:function(n){return n&&this._append(n),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(n){return{encrypt:function(t,i,r){return("string"==typeof i?v:u).encrypt(n,t,i,r)},decrypt:function(t,i,r){return("string"==typeof i?v:u).decrypt(n,t,i,r)}}}});t.StreamCipher=o.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var s=i.mode={},a=function(t,i,r){var f=this._iv,u;for(f?this._iv=n:f=this._prevBlock,u=0;u<r;u++)t[i+u]^=f[u]},r=(t.BlockCipherMode=f.extend({createEncryptor:function(n,t){return this.Encryptor.create(n,t)},createDecryptor:function(n,t){return this.Decryptor.create(n,t)},init:function(n,t){this._cipher=n;this._iv=t}})).extend();r.Encryptor=r.extend({processBlock:function(n,t){var i=this._cipher,r=i.blockSize;a.call(this,n,t,r);i.encryptBlock(n,t);this._prevBlock=n.slice(t,t+r)}});r.Decryptor=r.extend({processBlock:function(n,t){var i=this._cipher,r=i.blockSize,u=n.slice(t,t+r);i.decryptBlock(n,t);a.call(this,n,t,r);this._prevBlock=u}});s=s.CBC=r;r=(i.pad={}).Pkcs7={pad:function(n,t){for(var i=4*t,i=i-n.sigBytes%i,f=i<<24|i<<16|i<<8|i,r=[],u=0;u<i;u+=4)r.push(f);i=e.create(r,i);n.concat(i)},unpad:function(n){n.sigBytes-=n.words[n.sigBytes-1>>>2]&255}};t.BlockCipher=o.extend({cfg:o.cfg.extend({mode:s,padding:r}),reset:function(){var t;o.reset.call(this);var n=this.cfg,i=n.iv,n=n.mode;this._xformMode==this._ENC_XFORM_MODE?t=n.createEncryptor:(t=n.createDecryptor,this._minBufferSize=1);this._mode=t.call(n,this,i&&i.words)},_doProcessBlock:function(n,t){this._mode.processBlock(n,t)},_doFinalize:function(){var t=this.cfg.padding,n;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),n=this._process(!0)):(n=this._process(!0),t.unpad(n)),n},blockSize:4});var h=t.CipherParams=f.extend({init:function(n){this.mixIn(n)},toString:function(n){return(n||this.formatter).stringify(this)}}),s=(i.format={}).OpenSSL={stringify:function(n){var t=n.ciphertext;return n=n.salt,(n?e.create([1398893684,1701076831]).concat(n).concat(t):t).toString(l)},parse:function(n){var t,i;return n=l.parse(n),t=n.words,1398893684==t[0]&&1701076831==t[1]&&(i=e.create(t.slice(2,4)),t.splice(0,4),n.sigBytes-=16),h.create({ciphertext:n,salt:i})}},u=t.SerializableCipher=f.extend({cfg:f.extend({format:s}),encrypt:function(n,t,i,r){r=this.cfg.extend(r);var u=n.createEncryptor(i,r);return t=u.finalize(t),u=u.cfg,h.create({ciphertext:t,key:i,iv:u.iv,algorithm:n,mode:u.mode,padding:u.padding,blockSize:n.blockSize,formatter:r.format})},decrypt:function(n,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),n.createDecryptor(i,r).finalize(t.ciphertext)},_parse:function(n,t){return"string"==typeof n?t.parse(n,this):n}}),i=(i.kdf={}).OpenSSL={execute:function(n,t,i,r){return r||(r=e.random(8)),n=y.create({keySize:t+i}).compute(n,r),i=e.create(n.words.slice(t),4*i),n.sigBytes=4*t,h.create({key:n,iv:i,salt:r})}},v=t.PasswordBasedCipher=u.extend({cfg:u.cfg.extend({kdf:i}),encrypt:function(n,t,i,r){return r=this.cfg.extend(r),i=r.kdf.execute(i,n.keySize,n.ivSize),r.iv=i.iv,n=u.encrypt.call(this,n,t,i.key,r),n.mixIn(i),n},decrypt:function(n,t,i,r){return r=this.cfg.extend(r),t=this._parse(t,r.format),i=r.kdf.execute(i,n.keySize,n.ivSize,t.salt),r.iv=i.iv,u.decrypt.call(this,n,t,i.key,r)}})}(),function(){for(var i,tt,s=CryptoJS,y=s.lib.BlockCipher,h=s.algo,t=[],p=[],w=[],b=[],k=[],d=[],c=[],l=[],a=[],v=[],u=[],f=0;256>f;f++)u[f]=128>f?f<<1:f<<1^283;for(var r=0,e=0,f=0;256>f;f++){i=e^e<<1^e<<2^e<<3^e<<4;i=i>>>8^i&255^99;t[r]=i;p[i]=r;var o=u[r],g=u[o],nt=u[g],n=257*u[i]^16843008*i;w[r]=n<<24|n>>>8;b[r]=n<<16|n>>>16;k[r]=n<<8|n>>>24;d[r]=n;n=16843009*nt^65537*g^257*o^16843008*r;c[i]=n<<24|n>>>8;l[i]=n<<16|n>>>16;a[i]=n<<8|n>>>24;v[i]=n;r?(r=o^u[u[u[nt^o]]],e^=u[u[e]]):r=e=1}tt=[0,1,2,4,8,16,32,64,128,27,54];h=h.AES=y.extend({_doReset:function(){for(var n,f=this._key,e=f.words,r=f.sigBytes/4,f=4*((this._nRounds=r+6)+1),u=this._keySchedule=[],i=0;i<f;i++)i<r?u[i]=e[i]:(n=u[i-1],i%r?6<r&&4==i%r&&(n=t[n>>>24]<<24|t[n>>>16&255]<<16|t[n>>>8&255]<<8|t[n&255]):(n=n<<8|n>>>24,n=t[n>>>24]<<24|t[n>>>16&255]<<16|t[n>>>8&255]<<8|t[n&255],n^=tt[i/r|0]<<24),u[i]=u[i-r]^n);for(e=this._invKeySchedule=[],r=0;r<f;r++)i=f-r,n=r%4?u[i]:u[i-4],e[r]=4>r||4>=i?n:c[t[n>>>24]]^l[t[n>>>16&255]]^a[t[n>>>8&255]]^v[t[n&255]]},encryptBlock:function(n,i){this._doCryptBlock(n,i,this._keySchedule,w,b,k,d,t)},decryptBlock:function(n,t){var i=n[t+1];n[t+1]=n[t+3];n[t+3]=i;this._doCryptBlock(n,t,this._invKeySchedule,c,l,a,v,p);i=n[t+1];n[t+1]=n[t+3];n[t+3]=i},_doCryptBlock:function(n,t,i,r,u,f,e,o){for(var b=this._nRounds,h=n[t]^i[0],c=n[t+1]^i[1],l=n[t+2]^i[2],s=n[t+3]^i[3],a=4,w=1;w<b;w++)var v=r[h>>>24]^u[c>>>16&255]^f[l>>>8&255]^e[s&255]^i[a++],y=r[c>>>24]^u[l>>>16&255]^f[s>>>8&255]^e[h&255]^i[a++],p=r[l>>>24]^u[s>>>16&255]^f[h>>>8&255]^e[c&255]^i[a++],s=r[s>>>24]^u[h>>>16&255]^f[c>>>8&255]^e[l&255]^i[a++],h=v,c=y,l=p;v=(o[h>>>24]<<24|o[c>>>16&255]<<16|o[l>>>8&255]<<8|o[s&255])^i[a++];y=(o[c>>>24]<<24|o[l>>>16&255]<<16|o[s>>>8&255]<<8|o[h&255])^i[a++];p=(o[l>>>24]<<24|o[s>>>16&255]<<16|o[h>>>8&255]<<8|o[c&255])^i[a++];s=(o[s>>>24]<<24|o[h>>>16&255]<<16|o[c>>>8&255]<<8|o[l&255])^i[a++];n[t]=v;n[t+1]=y;n[t+2]=p;n[t+3]=s},keySize:8});s.AES=y._createHelper(h)}(),function(n){n.DurationPicker=function(t,i){function b(n){return n==="days"?"D":n==="hours"?"H":"M"}function k(n){return n==="days"?"Days":n==="hours"?"Hours":"Minutes"}function c(n,t){var i=n===1?t.substring(0,t.length-1):t}function a(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,t=h+s*60+o*3600+e*86400;if(r.val(t),r.change(),c(e,"days"),c(o,"hours"),c(s,"minutes"),c(h,"seconds"),f.days.val(e),f.hours.val(o),f.minutes.val(s),f.seconds.val(h),typeof u.settings.onChanged=="function")u.settings.onChanged(r.val(),n)}function d(){e=parseInt(f.days.val(),10)||0;o=parseInt(f.hours.val(),10)||0;s=parseInt(f.minutes.val(),10)||0;h=parseInt(f.seconds.val(),10)||0;a()}function l(t,i,r){var u=n("<input>",{"class":"bdp-input-sm",type:"number",min:0,value:0,disabled:w}).change(d),e;return r&&u.attr("max",r),f[t]=u,e=n("<span>",{"class":"bdp-label",id:"bdp-"+t+"-label",text:b(t)}),p[t]=e,n("<div>",{"class":"bdp-block "+(i?"bdp-hidden":""),title:k(t),html:[e,u]})}function v(n,t){r.val(n);var i=parseInt(n,10);h=i%60;i=Math.floor(i/60);s=i%60;i=Math.floor(i/60);u.settings.showDays?(o=i%24,e=Math.floor(i/24)):(o=i,e=0);a(t)}var y={translations:{day:"day",hour:"hour",minute:"minute",second:"second",days:"days",hours:"hours",minutes:"minutes",seconds:"seconds"},showSeconds:!1,showDays:!0},u=this,r;u.settings={};r=n(t);u.init=function(){u.settings=n.extend({},y,i);var t=n("<div>",{"class":"bdp-input",html:[l("days",!u.settings.showDays),l("hours",!1,u.settings.showDays?23:99999),l("minutes",!1,59),l("seconds",!u.settings.showSeconds,59)]});r.after(t).hide();r.val()===""&&r.val(0);v(r.val(),!0)};var f=[],p=[],w=r.hasClass("disabled")||r.attr("disabled")==="disabled",e=0,o=0,s=0,h=0;u.setValue=function(n){v(n,!0)};u.destroy=function(){r.next(".bdp-input").remove();r.data("durationPicker",null).show()};u.init()};n.fn.durationPicker=function(t){return this.each(function(){if(undefined===n(this).data("durationPicker")){var i=new n.DurationPicker(this,t);n(this).data("durationPicker",i)}})}}(jQuery);
/*! jsTree - v3.3.12 - 2021-09-03 - (MIT) */
!function(n){"use strict";"function"==typeof define&&define.amd?define(["jquery"],n):"undefined"!=typeof module&&module.exports?module.exports=n(require("jquery")):n(jQuery)}(function(n,t){"use strict";var c,e,u,l,s,v;if(!n.jstree){var w=0,f=!1,r=!1,o=!1,y=[],a=n("script:last").attr("src"),i=window.document,h=window.setImmediate,p=window.Promise;if(!h&&p&&(h=function(n,t){p.resolve(t).then(n)}),n.jstree={version:"3.3.12",defaults:{plugins:[]},plugins:{},path:a&&-1!==a.indexOf("/")?a.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%?`]/g,root:"#"},n.jstree.create=function(t,i){var r=new n.jstree.core(++w),u=i;return i=n.extend(!0,{},n.jstree.defaults,i),u&&u.plugins&&(i.plugins=u.plugins),n.each(i.plugins,function(n,t){"core"!==n&&(r=r.plugin(t,i[t]))}),n(t).data("jstree",r),r.init(t,i),r},n.jstree.destroy=function(){n(".jstree:jstree").jstree("destroy");n(i).off(".jstree")},n.jstree.core=function(n){this._id=n;this._cnt=0;this._wrk=null;this._data={core:{themes:{name:!1,dots:!1,icons:!1,ellipsis:!1},selected:[],last_error:{},working:!1,worker_queue:[],focused:null}}},n.jstree.reference=function(t){var r=null,i=null;if(!t||!t.id||t.tagName&&t.nodeType||(t=t.id),!i||!i.length)try{i=n(t)}catch(u){}if(!i||!i.length)try{i=n("#"+t.replace(n.jstree.idregex,"\\$&"))}catch(u){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?r=i:n(".jstree").each(function(){var i=n(this).data("jstree");if(i&&i._model.data[t])return(r=i,!1)}),r},n.fn.jstree=function(i){var u="string"==typeof i,f=Array.prototype.slice.call(arguments,1),r=null;return i!==!0||this.length?(this.each(function(){var e=n.jstree.reference(this),o=u&&e?e[i]:null;return r=u&&o?o.apply(e,f):null,e||u||i!==t&&!n.isPlainObject(i)||n.jstree.create(this,i),(e&&!u||i===!0)&&(r=e||!1),null!==r&&r!==t?!1:void 0}),null!==r&&r!==t?r:this):!1},n.expr.pseudos.jstree=n.expr.createPseudo(function(){return function(i){return n(i).hasClass("jstree")&&n(i).data("jstree")!==t}}),n.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:n.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,ellipsis:!1,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1,dblclick_toggle:!0,loaded_state:!1,restore_focus:!0,compute_elements_positions:!1,keyboard:{"ctrl-space":function(t){t.type="click";n(t.currentTarget).trigger(t)},enter:function(t){t.type="click";n(t.currentTarget).trigger(t)},left:function(t){if(t.preventDefault(),this.is_open(t.currentTarget))this.close_node(t.currentTarget);else{var i=this.get_parent(t.currentTarget);i&&i.id!==n.jstree.root&&this.get_node(i,!0).children(".jstree-anchor").trigger("focus")}},up:function(n){n.preventDefault();var t=this.get_prev_dom(n.currentTarget);t&&t.length&&t.children(".jstree-anchor").trigger("focus")},right:function(t){if(t.preventDefault(),this.is_closed(t.currentTarget))this.open_node(t.currentTarget,function(n){this.get_node(n,!0).children(".jstree-anchor").trigger("focus")});else if(this.is_open(t.currentTarget)){var i=this.get_node(t.currentTarget,!0).children(".jstree-children")[0];i&&n(this._firstChild(i)).children(".jstree-anchor").trigger("focus")}},down:function(n){n.preventDefault();var t=this.get_next_dom(n.currentTarget);t&&t.length&&t.children(".jstree-anchor").trigger("focus")},"*":function(){this.open_all()},home:function(t){t.preventDefault();var i=this._firstChild(this.get_container_ul()[0]);i&&n(i).children(".jstree-anchor").filter(":visible").trigger("focus")},end:function(n){n.preventDefault();this.element.find(".jstree-anchor").filter(":visible").last().trigger("focus")},f2:function(n){n.preventDefault();this.edit(n.currentTarget)}}},n.jstree.core.prototype={plugin:function(t,i){var r=n.jstree.plugins[t];return r?(this._data[t]={},r.prototype=this,new r(i,this)):this},init:function(t,i){this._model={data:{},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}};this._model.data[n.jstree.root]={id:n.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this.element=n(t).addClass("jstree jstree-"+this._id);this.settings=i;this._data.core.ready=!1;this._data.core.loaded=!1;this._data.core.rtl="rtl"===this.element.css("direction");this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl");this.element.attr("role","tree");this.settings.core.multiple&&this.element.attr("aria-multiselectable",!0);this.element.attr("tabindex")||this.element.attr("tabindex","0");this.bind();this.trigger("init");this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0);this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove();this.element.html("<ul class='jstree-container-ul jstree-children' role='group'><li id='j"+this._id+"_loading' class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>");this.element.attr("aria-activedescendant","j"+this._id+"_loading");this._data.core.li_height=this.get_container_ul().children("li").first().outerHeight()||24;this._data.core.node=this._create_prototype_node();this.trigger("loading");this.load_node(n.jstree.root)},destroy:function(n){if(this.trigger("destroy"),this._wrk)try{window.URL.revokeObjectURL(this._wrk);this._wrk=null}catch(t){}n||this.element.empty();this.teardown()},_create_prototype_node:function(){var r=i.createElement("LI"),n,t;return r.setAttribute("role","none"),n=i.createElement("I"),n.className="jstree-icon jstree-ocl",n.setAttribute("role","presentation"),r.appendChild(n),n=i.createElement("A"),n.className="jstree-anchor",n.setAttribute("href","#"),n.setAttribute("tabindex","-1"),n.setAttribute("role","treeitem"),t=i.createElement("I"),t.className="jstree-icon jstree-themeicon",t.setAttribute("role","presentation"),n.appendChild(t),r.appendChild(n),n=t=null,r},_kbevent_to_func:function(n){var t=[],r,u,i;if(n.ctrlKey&&t.push("ctrl"),n.altKey&&t.push("alt"),n.shiftKey&&t.push("shift"),t.push({8:"Backspace",9:"Tab",13:"Enter",19:"Pause",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"Print",45:"Insert",46:"Delete",96:"Numpad0",97:"Numpad1",98:"Numpad2",99:"Numpad3",100:"Numpad4",101:"Numpad5",102:"Numpad6",103:"Numpad7",104:"Numpad8",105:"Numpad9","-13":"NumpadEnter",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Numlock",145:"Scrolllock",16:"Shift",17:"Ctrl",18:"Alt",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",61:"=",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",107:"+",109:"-",110:".",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",111:"/",106:"*",173:"-"}[n.which]||n.which),t=t.sort().join("-").toLowerCase(),"shift-shift"===t||"ctrl-ctrl"===t||"alt-alt"===t)return null;r=this.settings.core.keyboard;for(u in r)if(r.hasOwnProperty(u)&&(i=u,"-"!==i&&"+"!==i&&(i=i.replace("--","-MINUS").replace("+-","-MINUS").replace("++","-PLUS").replace("-+","-PLUS"),i=i.split(/-|\+/).sort().join("-").replace("MINUS","-").replace("PLUS","+").toLowerCase()),i===t))return r[u];return null},teardown:function(){this.unbind();this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")});this.element=null},bind:function(){var t="",r=null,u=0;this.element.on("dblclick.jstree",function(n){if(n.target.tagName&&"input"===n.target.tagName.toLowerCase())return!0;if(i.selection&&i.selection.empty)i.selection.empty();else if(window.getSelection){var t=window.getSelection();try{t.removeAllRanges();t.collapse()}catch(r){}}}).on("mousedown.jstree",function(n){n.target===this.element[0]&&(n.preventDefault(),u=+new Date)}.bind(this)).on("mousedown.jstree",".jstree-ocl",function(n){n.preventDefault()}).on("click.jstree",".jstree-ocl",function(n){this.toggle_node(n.target)}.bind(this)).on("dblclick.jstree",".jstree-anchor",function(n){return n.target.tagName&&"input"===n.target.tagName.toLowerCase()?!0:void(this.settings.core.dblclick_toggle&&this.toggle_node(n.target))}.bind(this)).on("click.jstree",".jstree-anchor",function(t){t.preventDefault();t.currentTarget!==i.activeElement&&n(t.currentTarget).trigger("focus");this.activate_node(t.currentTarget,t)}.bind(this)).on("keydown.jstree",".jstree-anchor",function(n){var i,t;return n.target.tagName&&"input"===n.target.tagName.toLowerCase()?!0:(this._data.core.rtl&&(37===n.which?n.which=39:39===n.which&&(n.which=37)),i=this._kbevent_to_func(n),i&&(t=i.call(this,n),t===!1||t===!0)?t:void 0)}.bind(this)).on("load_node.jstree",function(t,i){i.status&&(i.node.id!==n.jstree.root||this._data.core.loaded||(this._data.core.loaded=!0,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.trigger("loaded")),this._data.core.ready||setTimeout(function(){if(this.element&&!this.get_container_ul().find(".jstree-loading").length){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var i=[],t=0,r=this._data.core.selected.length;r>t;t++)i=i.concat(this._model.data[this._data.core.selected[t]].parents);for(i=n.vakata.array_unique(i),t=0,r=i.length;r>t;t++)this.open_node(i[t],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}this.trigger("ready")}}.bind(this),0))}.bind(this)).on("keypress.jstree",function(u){if(u.target.tagName&&"input"===u.target.tagName.toLowerCase())return!0;r&&clearTimeout(r);r=setTimeout(function(){t=""},500);var o=String.fromCharCode(u.which).toLowerCase(),e=this.element.find(".jstree-anchor").filter(":visible"),s=e.index(i.activeElement)||0,f=!1;if(t+=o,t.length>1){if(e.slice(s).each(function(i,r){if(0===n(r).text().toLowerCase().indexOf(t))return(n(r).trigger("focus"),f=!0,!1)}.bind(this)),f)return;if(e.slice(0,s).each(function(i,r){if(0===n(r).text().toLowerCase().indexOf(t))return(n(r).trigger("focus"),f=!0,!1)}.bind(this)),f)return}if(new RegExp("^"+o.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+"+$").test(t)){if(e.slice(s+1).each(function(t,i){if(n(i).text().toLowerCase().charAt(0)===o)return(n(i).trigger("focus"),f=!0,!1)}.bind(this)),f)return;if(e.slice(0,s+1).each(function(t,i){if(n(i).text().toLowerCase().charAt(0)===o)return(n(i).trigger("focus"),f=!0,!1)}.bind(this)),f)return}}.bind(this)).on("init.jstree",function(){var n=this.settings.core.themes;this._data.core.themes.dots=n.dots;this._data.core.themes.stripes=n.stripes;this._data.core.themes.icons=n.icons;this._data.core.themes.ellipsis=n.ellipsis;this.set_theme(n.name||"default",n.url);this.set_theme_variant(n.variant)}.bind(this)).on("loading.jstree",function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"]();this[this._data.core.themes.icons?"show_icons":"hide_icons"]();this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]();this[this._data.core.themes.ellipsis?"show_ellipsis":"hide_ellipsis"]()}.bind(this)).on("blur.jstree",".jstree-anchor",function(t){this._data.core.focused=null;n(t.currentTarget).filter(".jstree-hovered").trigger("mouseleave");this.element.attr("tabindex","0")}.bind(this)).on("focus.jstree",".jstree-anchor",function(t){var i=this.get_node(t.currentTarget);i&&i.id&&(this._data.core.focused=i.id);this.element.find(".jstree-hovered").not(t.currentTarget).trigger("mouseleave");n(t.currentTarget).trigger("mouseenter");this.element.attr("tabindex","-1")}.bind(this)).on("focus.jstree",function(){if(+new Date-u>500&&!this._data.core.focused&&this.settings.core.restore_focus){u=0;var n=this.get_node(this.element.attr("aria-activedescendant"),!0);n&&n.find("> .jstree-anchor").trigger("focus")}}.bind(this)).on("mouseenter.jstree",".jstree-anchor",function(n){this.hover_node(n.currentTarget)}.bind(this)).on("mouseleave.jstree",".jstree-anchor",function(n){this.dehover_node(n.currentTarget)}.bind(this))},unbind:function(){this.element.off(".jstree");n(i).off(".jstree-"+this._id)},trigger:function(n,t){t||(t={});t.instance=this;this.element.triggerHandler(n.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children").first()},get_string:function(t){var i=this.settings.core.strings;return n.vakata.is_function(i)?i.call(this,t):i&&i[t]?i[t]:t},_firstChild:function(n){for(n=n?n.firstChild:null;null!==n&&1!==n.nodeType;)n=n.nextSibling;return n},_nextSibling:function(n){for(n=n?n.nextSibling:null;null!==n&&1!==n.nodeType;)n=n.nextSibling;return n},_previousSibling:function(n){for(n=n?n.previousSibling:null;null!==n&&1!==n.nodeType;)n=n.previousSibling;return n},get_node:function(t,i){t&&t.id&&(t=t.id);t instanceof n&&t.length&&t[0].id&&(t=t[0].id);var r;try{if(this._model.data[t])t=this._model.data[t];else if("string"==typeof t&&this._model.data[t.replace(/^#/,"")])t=this._model.data[t.replace(/^#/,"")];else if("string"==typeof t&&(r=n("#"+t.replace(n.jstree.idregex,"\\$&"),this.element)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else if((r=this.element.find(t)).length&&this._model.data[r.closest(".jstree-node").attr("id")])t=this._model.data[r.closest(".jstree-node").attr("id")];else{if(!(r=this.element.find(t)).length||!r.hasClass("jstree"))return!1;t=this._model.data[n.jstree.root]}return i&&(t=t.id===n.jstree.root?this.element:n("#"+t.id.replace(n.jstree.idregex,"\\$&"),this.element)),t}catch(u){return!1}},get_path:function(t,i,r){if(t=t.parents?t:this.get_node(t),!t||t.id===n.jstree.root||!t.parents)return!1;var f,e,u=[];for(u.push(r?t.id:t.text),f=0,e=t.parents.length;e>f;f++)u.push(r?t.parents[f]:this.get_text(t.parents[f]));return u=u.reverse().slice(1),i?u.join(i):u},get_next_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this._firstChild(this.get_container_ul()[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);return r?n(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return r?n(r):!1}if(t.hasClass("jstree-open")){for(r=this._firstChild(t.children(".jstree-children")[0]);r&&0===r.offsetHeight;)r=this._nextSibling(r);if(null!==r)return n(r)}r=t[0];do r=this._nextSibling(r);while(r&&0===r.offsetHeight);return null!==r?n(r):t.parentsUntil(".jstree",".jstree-node").nextAll(".jstree-node:visible").first()},get_prev_dom:function(t,i){var r;if(t=this.get_node(t,!0),t[0]===this.element[0]){for(r=this.get_container_ul()[0].lastChild;r&&0===r.offsetHeight;)r=this._previousSibling(r);return r?n(r):!1}if(!t||!t.length)return!1;if(i){r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);return r?n(r):!1}r=t[0];do r=this._previousSibling(r);while(r&&0===r.offsetHeight);if(null!==r){for(t=n(r);t.hasClass("jstree-open");)t=t.children(".jstree-children").first().children(".jstree-node:visible:last");return t}return r=t[0].parentNode.parentNode,r&&r.className&&-1!==r.className.indexOf("jstree-node")?n(r):!1},get_parent:function(t){return t=this.get_node(t),t&&t.id!==n.jstree.root?t.parent:!1},get_children_dom:function(n){return n=this.get_node(n,!0),n[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):n&&n.length?n.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(n){return n=this.get_node(n),n&&(n.state.loaded===!1||n.children.length>0)},is_loaded:function(n){return n=this.get_node(n),n&&n.state.loaded},is_loading:function(n){return n=this.get_node(n),n&&n.state&&n.state.loading},is_open:function(n){return n=this.get_node(n),n&&n.state.opened},is_closed:function(n){return n=this.get_node(n),n&&this.is_parent(n)&&!n.state.opened},is_leaf:function(n){return!this.is_parent(n)},load_node:function(t,i){var r,e,u,o,f;if(n.vakata.is_array(t))return this._load_nodes(t.slice(),i),!0;if(t=this.get_node(t),!t)return i&&i.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,u=0,o=t.parents.length;o>u;u++)this._model.data[t.parents[u]].children_d=n.vakata.array_filter(this._model.data[t.parents[u]].children_d,function(i){return-1===n.inArray(i,t.children_d)});for(r=0,e=t.children_d.length;e>r;r++)this._model.data[t.children_d[r]].state.selected&&(f=!0),delete this._model.data[t.children_d[r]];f&&(this._data.core.selected=n.vakata.array_filter(this._data.core.selected,function(i){return-1===n.inArray(i,t.children_d)}));t.children=[];t.children_d=[];f&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.failed=!1,t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading").attr("aria-busy",!0),this._load_node(t,function(n){t=this._model.data[t.id];t.state.loading=!1;t.state.loaded=n;t.state.failed=!t.state.loaded;for(var r=this.get_node(t,!0),u=0,f=0,e=this._model.data,o=!1,u=0,f=t.children.length;f>u;u++)if(e[t.children[u]]&&!e[t.children[u]].state.hidden){o=!0;break}t.state.loaded&&r&&r.length&&(r.removeClass("jstree-closed jstree-open jstree-leaf"),o?"#"!==t.id&&r.addClass(t.state.opened?"jstree-open":"jstree-closed"):r.addClass("jstree-leaf"));r.removeClass("jstree-loading").attr("aria-busy",!1);this.trigger("load_node",{node:t,status:n});i&&i.call(this,t,n)}.bind(this)),!0},_load_nodes:function(n,t,i,r){for(var o=!0,h=function(){this._load_nodes(n,t,!0)},f=this._model.data,s=[],u=0,e=n.length;e>u;u++)!f[n[u]]||(f[n[u]].state.loaded||f[n[u]].state.failed)&&(i||!r)||(this.is_loading(n[u])||this.load_node(n[u],h),o=!1);if(o){for(u=0,e=n.length;e>u;u++)f[n[u]]&&f[n[u]].state.loaded&&s.push(n[u]);t&&!t.done&&(t.call(this,s),t.done=!0)}},load_all:function(t,i){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var f=[],e=this._model.data,u=e[t.id].children_d,r,o;for(t.state&&!t.state.loaded&&f.push(t.id),r=0,o=u.length;o>r;r++)e[u[r]]&&e[u[r]].state&&!e[u[r]].state.loaded&&f.push(u[r]);f.length?this._load_nodes(f,function(){this.load_all(t,i)}):(i&&i.call(this,t),this.trigger("load_all",{node:t}))},_load_node:function(t,i){var r=this.settings.core.data,f,u=function(){return 3!==this.nodeType&&8!==this.nodeType};return r?n.vakata.is_function(r)?r.call(this,t,function(r){r===!1?i.call(this,!1):this["string"==typeof r?"_append_html_data":"_append_json_data"](t,"string"==typeof r?n(n.parseHTML(r)).filter(u):r,function(n){i.call(this,n)})}.bind(this)):"object"==typeof r?r.url?(r=n.extend(!0,{},r),n.vakata.is_function(r.url)&&(r.url=r.url.call(this,t)),n.vakata.is_function(r.data)&&(r.data=r.data.call(this,t)),n.ajax(r).done(function(r,f,e){var o=e.getResponseHeader("Content-Type");return o&&-1!==o.indexOf("json")||"object"==typeof r?this._append_json_data(t,r,function(n){i.call(this,n)}):o&&-1!==o.indexOf("html")||"string"==typeof r?this._append_html_data(t,n(n.parseHTML(r)).filter(u),function(n){i.call(this,n)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))}.bind(this)).fail(function(n){this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:n})};i.call(this,!1);this.settings.core.error.call(this,this._data.core.last_error)}.bind(this))):(f=n.vakata.is_array(r)?n.extend(!0,[],r):n.isPlainObject(r)?n.extend(!0,{},r):r,t.id===n.jstree.root?this._append_json_data(t,f,function(n){i.call(this,n)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1))):"string"==typeof r?t.id===n.jstree.root?this._append_html_data(t,n(n.parseHTML(r)).filter(u),function(n){i.call(this,n)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),i.call(this,!1)):i.call(this,!1):t.id===n.jstree.root?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(n){i.call(this,n)}):i.call(this,!1)},_node_changed:function(t){t=this.get_node(t);t&&-1===n.inArray(t.id,this._model.changed)&&this._model.changed.push(t.id)},_append_html_data:function(t,i,r){t=this.get_node(t);t.children=[];t.children_d=[];var a=i.is("ul")?i.children():i,o=t.id,c=[],u=[],s=this._model.data,f=s[o],v=this._data.core.selected.length,e,h,l;for(a.each(function(t,i){e=this._parse_model_from_html(n(i),o,f.parents.concat());e&&(c.push(e),u.push(e),s[e].children_d.length&&(u=u.concat(s[e].children_d)))}.bind(this)),f.children=c,f.children_d=u,h=0,l=f.parents.length;l>h;h++)s[f.parents[h]].children_d=s[f.parents[h]].children_d.concat(u);this.trigger("model",{nodes:u,parent:o});o!==n.jstree.root?(this._node_changed(o),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0));this._data.core.selected.length!==v&&this.trigger("changed",{action:"model",selected:this._data.core.selected});r.call(this,!0)},_append_json_data:function(t,i,r,u){if(null!==this.element){t=this.get_node(t);t.children=[];t.children_d=[];i.d&&(i=i.d,"string"==typeof i&&(i=JSON.parse(i)));n.vakata.is_array(i)||(i=[i]);var e=null,o={df:this._model.default_state,dat:i,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},f=this,s=function(n,t){n.data&&(n=n.data);var u=n.dat,l=n.par,p=[],s=[],a=[],c=n.df,d=n.t_id,y=n.t_cnt,r=n.m,e=r[l],w=n.sel,h,i,o,v,b=function(n,i,u){u=u?u.concat():[];i&&u.unshift(i);var h=n.id.toString(),e,l,o,s,f={id:h,text:n.text||"",icon:n.icon!==t?n.icon:!0,parent:i,parents:u,children:n.children||[],children_d:n.children_d||[],data:n.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in c)c.hasOwnProperty(e)&&(f.state[e]=c[e]);if(n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(f.icon=n.data.jstree.icon),(f.icon===t||null===f.icon||""===f.icon)&&(f.icon=!0),n&&n.data&&(f.data=n.data,n.data.jstree))for(e in n.data.jstree)n.data.jstree.hasOwnProperty(e)&&(f.state[e]=n.data.jstree[e]);if(n&&"object"==typeof n.state)for(e in n.state)n.state.hasOwnProperty(e)&&(f.state[e]=n.state[e]);if(n&&"object"==typeof n.li_attr)for(e in n.li_attr)n.li_attr.hasOwnProperty(e)&&(f.li_attr[e]=n.li_attr[e]);if(f.li_attr.id||(f.li_attr.id=h),n&&"object"==typeof n.a_attr)for(e in n.a_attr)n.a_attr.hasOwnProperty(e)&&(f.a_attr[e]=n.a_attr[e]);for(n&&n.children&&n.children===!0&&(f.state.loaded=!1,f.children=[],f.children_d=[]),r[f.id]=f,e=0,l=f.children.length;l>e;e++)o=b(r[f.children[e]],f.id,u),s=r[o],f.children_d.push(o),s.children_d.length&&(f.children_d=f.children_d.concat(s.children_d));return delete n.data,delete n.children,r[f.id].original=n,f.state.selected&&a.push(f.id),f.id},k=function(n,i,u){u=u?u.concat():[];i&&u.unshift(i);var o=!1,e,l,s,h,f;do o="j"+d+"_"+ ++y;while(r[o]);f={id:!1,text:"string"==typeof n?n:"",icon:"object"==typeof n&&n.icon!==t?n.icon:!0,parent:i,parents:u,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(e in c)c.hasOwnProperty(e)&&(f.state[e]=c[e]);if(n&&n.id&&(f.id=n.id.toString()),n&&n.text&&(f.text=n.text),n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(f.icon=n.data.jstree.icon),(f.icon===t||null===f.icon||""===f.icon)&&(f.icon=!0),n&&n.data&&(f.data=n.data,n.data.jstree))for(e in n.data.jstree)n.data.jstree.hasOwnProperty(e)&&(f.state[e]=n.data.jstree[e]);if(n&&"object"==typeof n.state)for(e in n.state)n.state.hasOwnProperty(e)&&(f.state[e]=n.state[e]);if(n&&"object"==typeof n.li_attr)for(e in n.li_attr)n.li_attr.hasOwnProperty(e)&&(f.li_attr[e]=n.li_attr[e]);if(f.li_attr.id&&!f.id&&(f.id=f.li_attr.id.toString()),f.id||(f.id=o),f.li_attr.id||(f.li_attr.id=f.id),n&&"object"==typeof n.a_attr)for(e in n.a_attr)n.a_attr.hasOwnProperty(e)&&(f.a_attr[e]=n.a_attr[e]);if(n&&n.children&&n.children.length){for(e=0,l=n.children.length;l>e;e++)s=k(n.children[e],f.id,u),h=r[s],f.children.push(s),h.children_d.length&&(f.children_d=f.children_d.concat(h.children_d));f.children_d=f.children_d.concat(f.children)}return n&&n.children&&n.children===!0&&(f.state.loaded=!1,f.children=[],f.children_d=[]),delete n.data,delete n.children,f.original=n,r[f.id]=f,f.state.selected&&a.push(f.id),f.id};if(u.length&&u[0].id!==t&&u[0].parent!==t){for(i=0,o=u.length;o>i;i++)u[i].children||(u[i].children=[]),u[i].state||(u[i].state={}),r[u[i].id.toString()]=u[i];for(i=0,o=u.length;o>i;i++)r[u[i].parent.toString()]?(r[u[i].parent.toString()].children.push(u[i].id.toString()),e.children_d.push(u[i].id.toString())):"undefined"!=typeof f&&(f._data.core.last_error={error:"parse",plugin:"core",id:"core_07",reason:"Node with invalid parent",data:JSON.stringify({id:u[i].id.toString(),parent:u[i].parent.toString()})},f.settings.core.error.call(f,f._data.core.last_error));for(i=0,o=e.children.length;o>i;i++)h=b(r[e.children[i]],l,e.parents.concat()),s.push(h),r[h].children_d.length&&(s=s.concat(r[h].children_d));for(i=0,o=e.parents.length;o>i;i++)r[e.parents[i]].children_d=r[e.parents[i]].children_d.concat(s);v={cnt:y,mod:r,sel:w,par:l,dpc:s,add:a}}else{for(i=0,o=u.length;o>i;i++)h=k(u[i],l,e.parents.concat()),h&&(p.push(h),s.push(h),r[h].children_d.length&&(s=s.concat(r[h].children_d)));for(e.children=p,e.children_d=s,i=0,o=e.parents.length;o>i;i++)r[e.parents[i]].children_d=r[e.parents[i]].children_d.concat(s);v={cnt:y,mod:r,sel:w,par:l,dpc:s,add:a}}return"undefined"!=typeof window&&"undefined"!=typeof document?v:void postMessage(v)},c=function(t,i){var u,e;if(null!==this.element){this._cnt=t.cnt;e=this._model.data;for(u in e)e.hasOwnProperty(u)&&e[u].state&&e[u].state.loading&&t.mod[u]&&(t.mod[u].state.loading=!0);if(this._model.data=t.mod,i){var c,l=t.add,o=t.sel,s=this._data.core.selected.slice();if(e=this._model.data,o.length!==s.length||n.vakata.array_unique(o.concat(s)).length!==o.length){for(u=0,c=o.length;c>u;u++)-1===n.inArray(o[u],l)&&-1===n.inArray(o[u],s)&&(e[o[u]].state.selected=!1);for(u=0,c=s.length;c>u;u++)-1===n.inArray(s[u],o)&&(e[s[u]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add));this.trigger("model",{nodes:t.dpc,parent:t.par});t.par!==n.jstree.root?(this._node_changed(t.par),this.redraw()):this.redraw(!0);t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected});!i&&h?h(function(){r.call(f,!0)}):r.call(f,!0)}};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+s.toString()],{type:"text/javascript"})));!this._data.core.working||u?(this._data.core.working=!0,e=new window.Worker(this._wrk),e.onmessage=function(n){c.call(this,n.data,!0);try{e.terminate();e=null}catch(t){}this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}.bind(this),o.par?e.postMessage(o):this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1):this._data.core.worker_queue.push([t,i,r,!0])}catch(l){c.call(this,s(o),!1);this._data.core.worker_queue.length?this._append_json_data.apply(this,this._data.core.worker_queue.shift()):this._data.core.working=!1}else c.call(this,s(o),!1)}},_parse_model_from_html:function(i,r,u){u=u?[].concat(u):[];r&&u.unshift(r);var s,h,l=this._model.data,f={id:!1,text:!1,icon:!0,parent:r,parents:u,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1},o,e,c;for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(f.state[o]=this._model.default_state[o]);if(e=n.vakata.attributes(i,!0),n.each(e,function(t,i){return i=n.vakata.trim(i),i.length?(f.li_attr[t]=i,void("id"===t&&(f.id=i.toString()))):!0}),e=i.children("a").first(),e.length&&(e=n.vakata.attributes(e,!0),n.each(e,function(t,i){i=n.vakata.trim(i);i.length&&(f.a_attr[t]=i)})),e=i.children("a").first().length?i.children("a").first().clone():i.clone(),e.children("ins, i, ul").remove(),e=e.html(),e=n("<div><\/div>").html(e),f.text=this.settings.core.force_text?e.text():e.html(),e=i.data(),f.data=e?n.extend(!0,{},e):null,f.state.opened=i.hasClass("jstree-open"),f.state.selected=i.children("a").hasClass("jstree-clicked"),f.state.disabled=i.children("a").hasClass("jstree-disabled"),f.data&&f.data.jstree)for(o in f.data.jstree)f.data.jstree.hasOwnProperty(o)&&(f.state[o]=f.data.jstree[o]);e=i.children("a").children(".jstree-themeicon");e.length&&(f.icon=e.hasClass("jstree-themeicon-hidden")?!1:e.attr("rel"));f.state.icon!==t&&(f.icon=f.state.icon);(f.icon===t||null===f.icon||""===f.icon)&&(f.icon=!0);e=i.children("ul").children("li");do c="j"+this._id+"_"+ ++this._cnt;while(l[c]);return f.id=f.li_attr.id?f.li_attr.id.toString():c,e.length?(e.each(function(t,i){s=this._parse_model_from_html(n(i),f.id,u);h=this._model.data[s];f.children.push(s);h.children_d.length&&(f.children_d=f.children_d.concat(h.children_d))}.bind(this)),f.children_d=f.children_d.concat(f.children)):i.hasClass("jstree-closed")&&(f.state.loaded=!1),f.li_attr["class"]&&(f.li_attr["class"]=f.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),f.a_attr["class"]&&(f.a_attr["class"]=f.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),l[f.id]=f,f.state.selected&&this._data.core.selected.push(f.id),f.id},_parse_model_from_flat_json:function(n,i,r){r=r?r.concat():[];i&&r.unshift(i);var c=n.id.toString(),e=this._model.data,o=this._model.default_state,f,l,s,h,u={id:c,text:n.text||"",icon:n.icon!==t?n.icon:!0,parent:i,parents:r,children:n.children||[],children_d:n.children_d||[],data:n.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in o)o.hasOwnProperty(f)&&(u.state[f]=o[f]);if(n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(u.icon=n.data.jstree.icon),(u.icon===t||null===u.icon||""===u.icon)&&(u.icon=!0),n&&n.data&&(u.data=n.data,n.data.jstree))for(f in n.data.jstree)n.data.jstree.hasOwnProperty(f)&&(u.state[f]=n.data.jstree[f]);if(n&&"object"==typeof n.state)for(f in n.state)n.state.hasOwnProperty(f)&&(u.state[f]=n.state[f]);if(n&&"object"==typeof n.li_attr)for(f in n.li_attr)n.li_attr.hasOwnProperty(f)&&(u.li_attr[f]=n.li_attr[f]);if(u.li_attr.id||(u.li_attr.id=c),n&&"object"==typeof n.a_attr)for(f in n.a_attr)n.a_attr.hasOwnProperty(f)&&(u.a_attr[f]=n.a_attr[f]);for(n&&n.children&&n.children===!0&&(u.state.loaded=!1,u.children=[],u.children_d=[]),e[u.id]=u,f=0,l=u.children.length;l>f;f++)s=this._parse_model_from_flat_json(e[u.children[f]],u.id,r),h=e[s],u.children_d.push(s),h.children_d.length&&(u.children_d=u.children_d.concat(h.children_d));return delete n.data,delete n.children,e[u.id].original=n,u.state.selected&&this._data.core.selected.push(u.id),u.id},_parse_model_from_json:function(n,i,r){r=r?r.concat():[];i&&r.unshift(i);var e=!1,f,l,o,s,h=this._model.data,c=this._model.default_state,u;do e="j"+this._id+"_"+ ++this._cnt;while(h[e]);u={id:!1,text:"string"==typeof n?n:"",icon:"object"==typeof n&&n.icon!==t?n.icon:!0,parent:i,parents:r,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(f in c)c.hasOwnProperty(f)&&(u.state[f]=c[f]);if(n&&n.id&&(u.id=n.id.toString()),n&&n.text&&(u.text=n.text),n&&n.data&&n.data.jstree&&n.data.jstree.icon&&(u.icon=n.data.jstree.icon),(u.icon===t||null===u.icon||""===u.icon)&&(u.icon=!0),n&&n.data&&(u.data=n.data,n.data.jstree))for(f in n.data.jstree)n.data.jstree.hasOwnProperty(f)&&(u.state[f]=n.data.jstree[f]);if(n&&"object"==typeof n.state)for(f in n.state)n.state.hasOwnProperty(f)&&(u.state[f]=n.state[f]);if(n&&"object"==typeof n.li_attr)for(f in n.li_attr)n.li_attr.hasOwnProperty(f)&&(u.li_attr[f]=n.li_attr[f]);if(u.li_attr.id&&!u.id&&(u.id=u.li_attr.id.toString()),u.id||(u.id=e),u.li_attr.id||(u.li_attr.id=u.id),n&&"object"==typeof n.a_attr)for(f in n.a_attr)n.a_attr.hasOwnProperty(f)&&(u.a_attr[f]=n.a_attr[f]);if(n&&n.children&&n.children.length){for(f=0,l=n.children.length;l>f;f++)o=this._parse_model_from_json(n.children[f],u.id,r),s=h[o],u.children.push(o),s.children_d.length&&(u.children_d=u.children_d.concat(s.children_d));u.children_d=u.children.concat(u.children_d)}return n&&n.children&&n.children===!0&&(u.state.loaded=!1,u.children=[],u.children_d=[]),delete n.data,delete n.children,u.original=n,h[u.id]=u,u.state.selected&&this._data.core.selected.push(u.id),u.id},_redraw:function(){for(var f=this._model.force_full_redraw?this._model.data[n.jstree.root].children.concat([]):this._model.changed.concat([]),r=i.createElement("UL"),t,o=this._data.core.focused,u=0,e=f.length;e>u;u++)t=this.redraw_node(f[u],!0,this._model.force_full_redraw),t&&this._model.force_full_redraw&&r.appendChild(t);this._model.force_full_redraw&&(r.className=this.get_container_ul()[0].className,r.setAttribute("role","group"),this.element.empty().append(r));null!==o&&this.settings.core.restore_focus&&(t=this.get_node(o,!0),t&&t.length&&t.children(".jstree-anchor")[0]!==i.activeElement?t.children(".jstree-anchor").trigger("focus"):this._data.core.focused=null);this._model.force_full_redraw=!1;this._model.changed=[];this.trigger("redraw",{nodes:f})},redraw:function(n){n&&(this._model.force_full_redraw=!0);this._redraw()},draw_children:function(t){var r=this.get_node(t),f=!1,e=!1,u=!1,o=i;if(!r)return!1;if(r.id===n.jstree.root)return this.redraw(!0);if(t=this.get_node(t,!0),!t||!t.length)return!1;if(t.children(".jstree-children").remove(),t=t[0],r.children.length&&r.state.loaded){for(u=o.createElement("UL"),u.setAttribute("role","group"),u.className="jstree-children",f=0,e=r.children.length;e>f;f++)u.appendChild(this.redraw_node(r.children[f],!0,!0));t.appendChild(u)}},redraw_node:function(t,r,u,f){var e=this.get_node(t),s=!1,y=!1,w=!1,o=!1,h=!1,v=!1,c="",b=i,l=this._model.data,k=!1,a=null,d=0,g=0,nt=!1,p=!1;if(!e)return!1;if(e.id===n.jstree.root)return this.redraw(!0);if(r=r||0===e.children.length,t=i.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(e.id[0])?"\\3"+e.id[0]+" "+e.id.substr(1).replace(n.jstree.idregex,"\\$&"):e.id.replace(n.jstree.idregex,"\\$&"))):i.getElementById(e.id))t=n(t),u||(s=t.parent().parent()[0],s===this.element[0]&&(s=null),y=t.index()),r||!e.children.length||t.children(".jstree-children").length||(r=!0),r||(w=t.children(".jstree-children")[0]),k=t.children(".jstree-anchor")[0]===i.activeElement,t.remove();else if(r=!0,!u){if(s=e.parent!==n.jstree.root?n("#"+e.parent.replace(n.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===s||s&&l[e.parent].state.opened))return!1;y=n.inArray(e.id,null===s?l[n.jstree.root].children:l[e.parent].children)}t=this._data.core.node.cloneNode(!0);c="jstree-node ";for(o in e.li_attr)if(e.li_attr.hasOwnProperty(o)){if("id"===o)continue;"class"!==o?t.setAttribute(o,e.li_attr[o]):c+=e.li_attr[o]}for(e.a_attr.id||(e.a_attr.id=e.id+"_anchor"),t.childNodes[1].setAttribute("aria-selected",!!e.state.selected),t.childNodes[1].setAttribute("aria-level",e.parents.length),this.settings.core.compute_elements_positions&&(t.childNodes[1].setAttribute("aria-setsize",l[e.parent].children.length),t.childNodes[1].setAttribute("aria-posinset",l[e.parent].children.indexOf(e.id)+1)),e.state.disabled&&t.childNodes[1].setAttribute("aria-disabled",!0),o=0,h=e.children.length;h>o;o++)if(!l[e.children[o]].state.hidden){nt=!0;break}if(null!==e.parent&&l[e.parent]&&!e.state.hidden&&(o=n.inArray(e.id,l[e.parent].children),p=e.id,-1!==o))for(o++,h=l[e.parent].children.length;h>o;o++)if(l[l[e.parent].children[o]].state.hidden||(p=l[e.parent].children[o]),p!==e.id)break;e.state.hidden&&(c+=" jstree-hidden");e.state.loading&&(c+=" jstree-loading");e.state.loaded&&!nt?c+=" jstree-leaf":(c+=e.state.opened&&e.state.loaded?" jstree-open":" jstree-closed",t.childNodes[1].setAttribute("aria-expanded",e.state.opened&&e.state.loaded));p===e.id&&(c+=" jstree-last");t.id=e.id;t.className=c;c=(e.state.selected?" jstree-clicked":"")+(e.state.disabled?" jstree-disabled":"");for(h in e.a_attr)if(e.a_attr.hasOwnProperty(h)){if("href"===h&&"#"===e.a_attr[h])continue;"class"!==h?t.childNodes[1].setAttribute(h,e.a_attr[h]):c+=" "+e.a_attr[h]}if(c.length&&(t.childNodes[1].className="jstree-anchor "+c),(e.icon&&e.icon!==!0||e.icon===!1)&&(e.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===e.icon.indexOf("/")&&-1===e.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+e.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage='url("'+e.icon+'")',t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(b.createTextNode(e.text)):t.childNodes[1].innerHTML+=e.text,r&&e.children.length&&(e.state.opened||f)&&e.state.loaded){for(v=b.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",o=0,h=e.children.length;h>o;o++)v.appendChild(this.redraw_node(e.children[o],r,!0));t.appendChild(v)}if(w&&t.appendChild(w),!u){for(s||(s=this.element[0]),o=0,h=s.childNodes.length;h>o;o++)if(s.childNodes[o]&&s.childNodes[o].className&&-1!==s.childNodes[o].className.indexOf("jstree-children")){a=s.childNodes[o];break}a||(a=b.createElement("UL"),a.setAttribute("role","group"),a.className="jstree-children",s.appendChild(a));s=a;y<s.childNodes.length?s.insertBefore(t,s.childNodes[y]):s.appendChild(t);k&&(d=this.element[0].scrollTop,g=this.element[0].scrollLeft,t.childNodes[1].focus(),this.element[0].scrollTop=d,this.element[0].scrollLeft=g)}return e.state.opened&&!e.state.loaded&&(e.state.opened=!1,setTimeout(function(){this.open_node(e.id,!1,0)}.bind(this),0)),t},open_node:function(i,r,u){var e,s,f,o;if(n.vakata.is_array(i)){for(i=i.slice(),e=0,s=i.length;s>e;e++)this.open_node(i[e],r,u);return!0}return i=this.get_node(i),i&&i.id!==n.jstree.root?(u=u===t?this.settings.core.animation:u,this.is_closed(i)?this.is_loaded(i)?(f=this.get_node(i,!0),o=this,f.length&&(u&&f.children(".jstree-children").length&&f.children(".jstree-children").stop(!0,!0),i.children.length&&!this._firstChild(f.children(".jstree-children")[0])&&this.draw_children(i),u?(this.trigger("before_open",{node:i}),f.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").children(".jstree-anchor").attr("aria-expanded",!0).end().children(".jstree-children").stop(!0,!0).slideDown(u,function(){this.style.display="";o.element&&o.trigger("after_open",{node:i})})):(this.trigger("before_open",{node:i}),f[0].className=f[0].className.replace("jstree-closed","jstree-open"),f[0].childNodes[1].setAttribute("aria-expanded",!0))),i.state.opened=!0,r&&r.call(this,i,!0),f.length||this.trigger("before_open",{node:i}),this.trigger("open_node",{node:i}),u&&f.length||this.trigger("after_open",{node:i}),!0):this.is_loading(i)?setTimeout(function(){this.open_node(i,r,u)}.bind(this),500):void this.load_node(i,function(n,t){return t?this.open_node(n,r,u):r?r.call(this,n,!1):!1}):(r&&r.call(this,i,!1),!1)):!1},_open_to:function(t){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;for(var u=t.parents,i=0,r=u.length;r>i;i+=1)i!==n.jstree.root&&this.open_node(u[i],!1,0);return n("#"+t.id.replace(n.jstree.idregex,"\\$&"),this.element)},close_node:function(i,r){var f,o,e,u;if(n.vakata.is_array(i)){for(i=i.slice(),f=0,o=i.length;o>f;f++)this.close_node(i[f],r);return!0}return i=this.get_node(i),i&&i.id!==n.jstree.root?this.is_closed(i)?!1:(r=r===t?this.settings.core.animation:r,e=this,u=this.get_node(i,!0),i.state.opened=!1,this.trigger("close_node",{node:i}),void(u.length?r?u.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").children(".jstree-anchor").attr("aria-expanded",!1).end().children(".jstree-children").stop(!0,!0).slideUp(r,function(){this.style.display="";u.children(".jstree-children").remove();e.element&&e.trigger("after_close",{node:i})}):(u[0].className=u[0].className.replace("jstree-open","jstree-closed"),u.children(".jstree-anchor").attr("aria-expanded",!1),u.children(".jstree-children").remove(),this.trigger("after_close",{node:i})):this.trigger("after_close",{node:i}))):!1},toggle_node:function(t){var i,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.toggle_node(t[i]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(t,i,r){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var u=t.id===n.jstree.root?this.get_container_ul():this.get_node(t,!0),f,e,o;if(!u.length){for(f=0,e=t.children_d.length;e>f;f++)this.is_closed(this._model.data[t.children_d[f]])&&(this._model.data[t.children_d[f]].state.opened=!0);return this.trigger("open_all",{node:t})}r=r||u;o=this;u=this.is_closed(t)?u.find(".jstree-closed").addBack():u.find(".jstree-closed");u.each(function(){o.open_node(this,function(n,t){t&&this.is_parent(n)&&this.open_all(n,i,r)},i||0)});0===r.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(r)})},close_all:function(t,i){if(t||(t=n.jstree.root),t=this.get_node(t),!t)return!1;var r=t.id===n.jstree.root?this.get_container_ul():this.get_node(t,!0),e=this,u,f;for(r.length&&(r=this.is_open(t)?r.find(".jstree-open").addBack():r.find(".jstree-open"),n(r.get().reverse()).each(function(){e.close_node(this,i||0)})),u=0,f=t.children_d.length;f>u;u++)this._model.data[t.children_d[u]].state.opened=!1;this.trigger("close_all",{node:t})},is_disabled:function(n){return n=this.get_node(n),n&&n.state&&n.state.disabled},enable_node:function(t){var i,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.enable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled").attr("aria-disabled",!1),void this.trigger("enable_node",{node:t})):!1},disable_node:function(t){var i,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.disable_node(t[i]);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled").attr("aria-disabled",!0),void this.trigger("disable_node",{node:t})):!1},is_hidden:function(n){return n=this.get_node(n),n.state.hidden===!0},hide_node:function(t,i){var r,u;if(n.vakata.is_array(t)){for(t=t.slice(),r=0,u=t.length;u>r;r++)this.hide_node(t[r],!0);return i||this.redraw(),!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?void(t.state.hidden||(t.state.hidden=!0,this._node_changed(t.parent),i||this.redraw(),this.trigger("hide_node",{node:t}))):!1},show_node:function(t,i){var r,u;if(n.vakata.is_array(t)){for(t=t.slice(),r=0,u=t.length;u>r;r++)this.show_node(t[r],!0);return i||this.redraw(),!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?void(t.state.hidden&&(t.state.hidden=!1,this._node_changed(t.parent),i||this.redraw(),this.trigger("show_node",{node:t}))):!1},hide_all:function(t){var i,r=this._model.data,u=[];for(i in r)r.hasOwnProperty(i)&&i!==n.jstree.root&&!r[i].state.hidden&&(r[i].state.hidden=!0,u.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("hide_all",{nodes:u}),u},show_all:function(t){var i,r=this._model.data,u=[];for(i in r)r.hasOwnProperty(i)&&i!==n.jstree.root&&r[i].state.hidden&&(r[i].state.hidden=!1,u.push(i));return this._model.force_full_redraw=!0,t||this.redraw(),this.trigger("show_all",{nodes:u}),u},activate_node:function(n,i){if(this.is_disabled(n))return!1;if(i&&"object"==typeof i||(i={}),this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&(!i.shiftKey||this._data.core.last_clicked&&this.get_parent(n)&&this.get_parent(n)===this._data.core.last_clicked.parent))if(i.shiftKey){for(var e=this.get_node(n).id,o=this._data.core.last_clicked.id,u=this.get_node(this._data.core.last_clicked.parent).children,f=!1,r=0,s=u.length;s>r;r+=1)u[r]===e&&(f=!f),u[r]===o&&(f=!f),this.is_disabled(u[r])||!f&&u[r]!==e&&u[r]!==o?this.deselect_node(u[r],!0,i):this.is_hidden(u[r])||this.select_node(u[r],!0,!1,i);this.trigger("changed",{action:"select_node",node:this.get_node(n),selected:this._data.core.selected,event:i})}else this.is_selected(n)?this.deselect_node(n,!1,i):this.select_node(n,!1,!1,i);else!this.settings.core.multiple&&(i.metaKey||i.ctrlKey||i.shiftKey)&&this.is_selected(n)?this.deselect_node(n,!1,i):(this.deselect_all(!0),this.select_node(n,!1,!1,i),this._data.core.last_clicked=this.get_node(n));this.trigger("activate_node",{node:this.get_node(n),event:i})},hover_node:function(n){if(n=this.get_node(n,!0),!n||!n.length||n.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),i=this.element;t&&t.length&&this.dehover_node(t);n.children(".jstree-anchor").addClass("jstree-hovered");this.trigger("hover_node",{node:this.get_node(n)});setTimeout(function(){i.attr("aria-activedescendant",n[0].id)},0)},dehover_node:function(n){return n=this.get_node(n,!0),n&&n.length&&n.children(".jstree-hovered").length?(n.children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(n)})):!1},select_node:function(t,i,r,u){var f,e,o;if(n.vakata.is_array(t)){for(t=t.slice(),e=0,o=t.length;o>e;e++)this.select_node(t[e],i,r,u);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(f=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),r||(f=this._open_to(t)),f&&f.length&&f.children(".jstree-anchor").addClass("jstree-clicked").attr("aria-selected",!0),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:u}),i||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:u})))):!1},deselect_node:function(t,i,r){var u,e,f;if(n.vakata.is_array(t)){for(t=t.slice(),u=0,e=t.length;e>u;u++)this.deselect_node(t[u],i,r);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(f=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=n.vakata.array_remove_item(this._data.core.selected,t.id),f.length&&f.children(".jstree-anchor").removeClass("jstree-clicked").attr("aria-selected",!1),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:r}),i||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:r})))):!1},select_all:function(t){var u=this._data.core.selected.concat([]),i,r;for(this._data.core.selected=this._model.data[n.jstree.root].children_d.concat(),i=0,r=this._data.core.selected.length;r>i;i++)this._model.data[this._data.core.selected[i]]&&(this._model.data[this._data.core.selected[i]].state.selected=!0);this.redraw(!0);this.trigger("select_all",{selected:this._data.core.selected});t||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:u})},deselect_all:function(n){for(var i=this._data.core.selected.concat([]),t=0,r=this._data.core.selected.length;r>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!1);this._data.core.selected=[];this.element.find(".jstree-clicked").removeClass("jstree-clicked").attr("aria-selected",!1);this.trigger("deselect_all",{selected:this._data.core.selected,node:i});n||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:i})},is_selected:function(t){return t=this.get_node(t),t&&t.id!==n.jstree.root?t.state.selected:!1},get_selected:function(t){return t?n.map(this._data.core.selected,function(n){return this.get_node(n)}.bind(this)):this._data.core.selected.slice()},get_top_selected:function(t){for(var r=this.get_selected(!0),u={},f,o,i=0,e=r.length;e>i;i++)u[r[i].id]=r[i];for(i=0,e=r.length;e>i;i++)for(f=0,o=r[i].children_d.length;o>f;f++)u[r[i].children_d[f]]&&delete u[r[i].children_d[f]];r=[];for(i in u)u.hasOwnProperty(i)&&r.push(i);return t?n.map(r,function(n){return this.get_node(n)}.bind(this)):r},get_bottom_selected:function(t){for(var r=this.get_selected(!0),u=[],i=0,f=r.length;f>i;i++)r[i].children.length||u.push(r[i].id);return t?n.map(u,function(n){return this.get_node(n)}.bind(this)):u},get_state:function(){var i={core:{open:[],loaded:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};for(var t in this._model.data)this._model.data.hasOwnProperty(t)&&t!==n.jstree.root&&(this._model.data[t].state.loaded&&this.settings.core.loaded_state&&i.core.loaded.push(t),this._model.data[t].state.opened&&i.core.open.push(t),this._model.data[t].state.selected&&i.core.selected.push(t));return i},set_state:function(i,r){if(i){if(i.core&&i.core.selected&&i.core.initial_selection===t&&(i.core.initial_selection=this._data.core.selected.concat([]).sort().join(",")),i.core){var f,u;if(i.core.loaded)return this.settings.core.loaded_state&&n.vakata.is_array(i.core.loaded)&&i.core.loaded.length?this._load_nodes(i.core.loaded,function(){delete i.core.loaded;this.set_state(i,r)}):(delete i.core.loaded,this.set_state(i,r)),!1;if(i.core.open)return n.vakata.is_array(i.core.open)&&i.core.open.length?this._load_nodes(i.core.open,function(n){this.open_node(n,!1,0);delete i.core.open;this.set_state(i,r)}):(delete i.core.open,this.set_state(i,r)),!1;if(i.core.scroll)return i.core.scroll&&i.core.scroll.left!==t&&this.element.scrollLeft(i.core.scroll.left),i.core.scroll&&i.core.scroll.top!==t&&this.element.scrollTop(i.core.scroll.top),delete i.core.scroll,this.set_state(i,r),!1;if(i.core.selected)return f=this,(i.core.initial_selection===t||i.core.initial_selection===this._data.core.selected.concat([]).sort().join(","))&&(this.deselect_all(),n.each(i.core.selected,function(n,t){f.select_node(t,!1,!0)})),delete i.core.initial_selection,delete i.core.selected,this.set_state(i,r),!1;for(u in i)i.hasOwnProperty(u)&&"core"!==u&&-1===n.inArray(u,this.settings.plugins)&&delete i[u];if(n.isEmptyObject(i.core))return delete i.core,this.set_state(i,r),!1}return n.isEmptyObject(i)?(i=null,r&&r.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t,i){this._data.core.state=i===!0?{}:this.get_state();i&&n.vakata.is_function(i)&&(this._data.core.state=i.call(this,this._data.core.state));this._cnt=0;this._model.data={};this._model.data[n.jstree.root]={id:n.jstree.root,parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}};this._data.core.selected=[];this._data.core.last_clicked=null;this._data.core.focused=null;var r=this.get_container_ul()[0].className;t||(this.element.html("<ul class='"+r+"' role='group'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last' role='none' id='j"+this._id+"_loading'><i class='jstree-icon jstree-ocl'><\/i><a class='jstree-anchor' role='treeitem' href='#'><i class='jstree-icon jstree-themeicon-hidden'><\/i>"+this.get_string("Loading ...")+"<\/a><\/li><\/ul>"),this.element.attr("aria-activedescendant","j"+this._id+"_loading"));this.load_node(n.jstree.root,function(t,i){i&&(this.get_container_ul()[0].className=r,this._firstChild(this.get_container_ul()[0])&&this.element.attr("aria-activedescendant",this._firstChild(this.get_container_ul()[0]).id),this.set_state(n.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")}));this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;var i=[],r=[],u=this._data.core.selected.concat([]);r.push(t.id);t.state.opened===!0&&i.push(t.id);this.get_node(t,!0).find(".jstree-open").each(function(){r.push(this.id);i.push(this.id)});this._load_nodes(r,function(n){this.open_node(i,!1,0);this.select_node(u);this.trigger("refresh_node",{node:t,nodes:n})}.bind(this),!1,!0)},set_id:function(t,i){if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;var r,f,u=this._model.data,e=t.id;for(i=i.toString(),u[t.parent].children[n.inArray(t.id,u[t.parent].children)]=i,r=0,f=t.parents.length;f>r;r++)u[t.parents[r]].children_d[n.inArray(t.id,u[t.parents[r]].children_d)]=i;for(r=0,f=t.children.length;f>r;r++)u[t.children[r]].parent=i;for(r=0,f=t.children_d.length;f>r;r++)u[t.children_d[r]].parents[n.inArray(t.id,u[t.children_d[r]].parents)]=i;return r=n.inArray(t.id,this._data.core.selected),-1!==r&&(this._data.core.selected[r]=i),r=this.get_node(t.id,!0),r&&(r.attr("id",i),this.element.attr("aria-activedescendant")===t.id&&this.element.attr("aria-activedescendant",i)),delete u[t.id],t.id=i,t.li_attr.id=i,u[i]=t,this.trigger("set_id",{node:t,"new":t.id,old:e}),!0},get_text:function(t){return t=this.get_node(t),t&&t.id!==n.jstree.root?t.text:!1},set_text:function(t,i){var r,u;if(n.vakata.is_array(t)){for(t=t.slice(),r=0,u=t.length;u>r;r++)this.set_text(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(t.text=i,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:i}),!0):!1},get_json:function(t,i,r){if(t=this.get_node(t||n.jstree.root),!t)return!1;i&&i.flat&&!r&&(r=[]);var u={id:t.id,text:t.text,icon:this.get_icon(t),li_attr:n.extend(!0,{},t.li_attr),a_attr:n.extend(!0,{},t.a_attr),state:{},data:i&&i.no_data?!1:n.extend(!0,n.vakata.is_array(t.data)?[]:{},t.data)},f,e;if(i&&i.flat?u.parent=t.parent:u.children=[],i&&i.no_state)delete u.state;else for(f in t.state)t.state.hasOwnProperty(f)&&(u.state[f]=t.state[f]);if(i&&i.no_li_attr&&delete u.li_attr,i&&i.no_a_attr&&delete u.a_attr,i&&i.no_id&&(delete u.id,u.li_attr&&u.li_attr.id&&delete u.li_attr.id,u.a_attr&&u.a_attr.id&&delete u.a_attr.id),i&&i.flat&&t.id!==n.jstree.root&&r.push(u),!i||!i.no_children)for(f=0,e=t.children.length;e>f;f++)i&&i.flat?this.get_json(t.children[f],i,r):u.children.push(this.get_json(t.children[f],i));return i&&i.flat?r:t.id===n.jstree.root?u.children:u},create_node:function(i,r,u,f,e){if(null===i&&(i=n.jstree.root),i=this.get_node(i),!i)return!1;if(u=u===t?"last":u,!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(i))return this.load_node(i,function(){this.create_node(i,r,u,f,!0)});r||(r={text:this.get_string("New node")});r="string"==typeof r?{text:r}:n.extend(!0,{},r);r.text===t&&(r.text=this.get_string("New node"));var o,h,s,c;switch(i.id===n.jstree.root&&("before"===u&&(u="first"),"after"===u&&(u="last")),u){case"before":o=this.get_node(i.parent);u=n.inArray(i.id,o.children);i=o;break;case"after":o=this.get_node(i.parent);u=n.inArray(i.id,o.children)+1;i=o;break;case"inside":case"first":u=0;break;case"last":u=i.children.length;break;default:u||(u=0)}if(u>i.children.length&&(u=i.children.length),r.id||(r.id=!0),!this.check("create_node",r,i,u))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(r.id===!0&&delete r.id,r=this._parse_model_from_json(r,i.id,i.parents.concat()),!r)return!1;for(o=this.get_node(r),h=[],h.push(r),h=h.concat(o.children_d),this.trigger("model",{nodes:h,parent:i.id}),i.children_d=i.children_d.concat(h),s=0,c=i.parents.length;c>s;s++)this._model.data[i.parents[s]].children_d=this._model.data[i.parents[s]].children_d.concat(h);for(r=o,o=[],s=0,c=i.children.length;c>s;s++)o[s>=u?s+1:s]=i.children[s];return o[u]=r.id,i.children=o,this.redraw_node(i,!0),this.trigger("create_node",{node:this.get_node(r),parent:i.id,position:u}),f&&f.call(this,this.get_node(r)),r.id},rename_node:function(t,i){var r,u,f;if(n.vakata.is_array(t)){for(t=t.slice(),r=0,u=t.length;u>r;r++)this.rename_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(f=t.text,this.check("rename_node",t,this.get_parent(t),i)?(this.set_text(t,i),this.trigger("rename_node",{node:t,text:i,old:f}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(t){var e,c,i,o,r,f,l,u,s,h,a,v;if(n.vakata.is_array(t)){for(t=t.slice(),e=0,c=t.length;c>e;e++)this.delete_node(t[e]);return!0}if(t=this.get_node(t),!t||t.id===n.jstree.root)return!1;if(i=this.get_node(t.parent),o=n.inArray(t.id,i.children),h=!1,!this.check("delete_node",t,i,o))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==o&&(i.children=n.vakata.array_remove(i.children,o)),r=t.children_d.concat([]),r.push(t.id),f=0,l=t.parents.length;l>f;f++)this._model.data[t.parents[f]].children_d=n.vakata.array_filter(this._model.data[t.parents[f]].children_d,function(t){return-1===n.inArray(t,r)});for(u=0,s=r.length;s>u;u++)if(this._model.data[r[u]].state.selected){h=!0;break}for(h&&(this._data.core.selected=n.vakata.array_filter(this._data.core.selected,function(t){return-1===n.inArray(t,r)})),this.trigger("delete_node",{node:t,parent:i.id}),h&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:i.id}),u=0,s=r.length;s>u;u++)delete this._model.data[r[u]];return-1!==n.inArray(this._data.core.focused,r)&&(this._data.core.focused=null,a=this.element[0].scrollTop,v=this.element[0].scrollLeft,i.id===n.jstree.root?this._model.data[n.jstree.root].children[0]&&this.get_node(this._model.data[n.jstree.root].children[0],!0).children(".jstree-anchor").triger("focus"):this.get_node(i,!0).children(".jstree-anchor").trigger("focus"),this.element[0].scrollTop=a,this.element[0].scrollLeft=v),this.redraw_node(i,!0),!0},check:function(t,i,r,u,f){i=i&&i.id?i:this.get_node(i);r=r&&r.id?r:this.get_node(r);var e=t.match(/^move_node|copy_node|create_node$/i)?r:i,o=this.settings.core.check_callback;if("move_node"===t||"copy_node"===t){if(!(f&&f.is_multi||"move_node"!==t||n.inArray(i.id,r.children)!==u))return this._data.core.last_error={error:"check",plugin:"core",id:"core_08",reason:"Moving node to its current position",data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1;if(!(f&&f.is_multi||i.id!==r.id&&("move_node"!==t||n.inArray(i.id,r.children)!==u)&&-1===n.inArray(r.id,i.children_d)))return this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1}return e&&e.data&&(e=e.data),e&&e.functions&&(e.functions[t]===!1||e.functions[t]===!0)?(e.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})}),e.functions[t]):o===!1||n.vakata.is_function(o)&&o.call(this,t,i,r,u,f)===!1||o&&o[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:u,obj:i&&i.id?i.id:!1,par:r&&r.id?r.id:!1})},!1):!0},last_error:function(){return this._data.core.last_error},move_node:function(i,r,u,f,e,o,s){var k,d,y,g,l,c,nt,v,a,h,p,b,tt,w;if(r=this.get_node(r),u=u===t?0:u,!r)return!1;if(!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(r))return this.load_node(r,function(){this.move_node(i,r,u,f,!0,!1,s)});if(n.vakata.is_array(i)){if(1!==i.length){for(k=0,d=i.length;d>k;k++)(a=this.move_node(i[k],r,u,f,e,!1,s))&&(r=a,u="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===n.jstree.root)return!1;if(y=(i.parent||n.jstree.root).toString(),l=u.toString().match(/^(before|after)$/)&&r.id!==n.jstree.root?this.get_node(r.parent):r,c=s?s:this._model.data[i.id]?this:n.jstree.reference(i.id),nt=!c||!c._id||this._id!==c._id,g=c&&c._id&&y&&c._model.data[y]&&c._model.data[y].children?n.inArray(i.id,c._model.data[y].children):-1,c&&c._id&&(i=c._model.data[i.id]),nt)return(a=this.copy_node(i,r,u,f,e,!1,s))?(c&&c.delete_node(i),a):!1;switch(r.id===n.jstree.root&&("before"===u&&(u="first"),"after"===u&&(u="last")),u){case"before":u=n.inArray(r.id,l.children);break;case"after":u=n.inArray(r.id,l.children)+1;break;case"inside":case"first":u=0;break;case"last":u=l.children.length;break;default:u||(u=0)}if(u>l.children.length&&(u=l.children.length),!this.check("move_node",i,l,u,{core:!0,origin:s,is_multi:c&&c._id&&c._id!==this._id,is_foreign:!c||!c._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.parent===l.id){for(v=l.children.concat(),a=n.inArray(i.id,v),-1!==a&&(v=n.vakata.array_remove(v,a),u>a&&u--),a=[],h=0,p=v.length;p>h;h++)a[h>=u?h+1:h]=v[h];a[u]=i.id;l.children=a;this._node_changed(l.id);this.redraw(l.id===n.jstree.root)}else{for(a=i.children_d.concat(),a.push(i.id),h=0,p=i.parents.length;p>h;h++){for(v=[],w=c._model.data[i.parents[h]].children_d,b=0,tt=w.length;tt>b;b++)-1===n.inArray(w[b],a)&&v.push(w[b]);c._model.data[i.parents[h]].children_d=v}for(c._model.data[y].children=n.vakata.array_remove_item(c._model.data[y].children,i.id),h=0,p=l.parents.length;p>h;h++)this._model.data[l.parents[h]].children_d=this._model.data[l.parents[h]].children_d.concat(a);for(v=[],h=0,p=l.children.length;p>h;h++)v[h>=u?h+1:h]=l.children[h];for(v[u]=i.id,l.children=v,l.children_d.push(i.id),l.children_d=l.children_d.concat(i.children_d),i.parent=l.id,a=l.parents.concat(),a.unshift(l.id),w=i.parents.length,i.parents=a,a=a.concat(),h=0,p=i.children_d.length;p>h;h++)this._model.data[i.children_d[h]].parents=this._model.data[i.children_d[h]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[i.children_d[h]].parents,a);(y===n.jstree.root||l.id===n.jstree.root)&&(this._model.force_full_redraw=!0);this._model.force_full_redraw||(this._node_changed(y),this._node_changed(l.id));o||this.redraw()}return f&&f.call(this,i,l,u),this.trigger("move_node",{node:i,parent:l.id,position:u,old_parent:y,old_position:g,is_multi:c&&c._id&&c._id!==this._id,is_foreign:!c||!c._id,old_instance:c,new_instance:this}),i.id},copy_node:function(i,r,u,f,e,o,s){var w,k,v,a,l,b,y,p,c,h,d;if(r=this.get_node(r),u=u===t?0:u,!r)return!1;if(!u.toString().match(/^(before|after)$/)&&!e&&!this.is_loaded(r))return this.load_node(r,function(){this.copy_node(i,r,u,f,!0,!1,s)});if(n.vakata.is_array(i)){if(1!==i.length){for(w=0,k=i.length;k>w;w++)(a=this.copy_node(i[w],r,u,f,e,!0,s))&&(r=a,u="after");return this.redraw(),!0}i=i[0]}if(i=i&&i.id?i:this.get_node(i),!i||i.id===n.jstree.root)return!1;switch(p=(i.parent||n.jstree.root).toString(),c=u.toString().match(/^(before|after)$/)&&r.id!==n.jstree.root?this.get_node(r.parent):r,h=s?s:this._model.data[i.id]?this:n.jstree.reference(i.id),d=!h||!h._id||this._id!==h._id,h&&h._id&&(i=h._model.data[i.id]),r.id===n.jstree.root&&("before"===u&&(u="first"),"after"===u&&(u="last")),u){case"before":u=n.inArray(r.id,c.children);break;case"after":u=n.inArray(r.id,c.children)+1;break;case"inside":case"first":u=0;break;case"last":u=c.children.length;break;default:u||(u=0)}if(u>c.children.length&&(u=c.children.length),!this.check("copy_node",i,c,u,{core:!0,origin:s,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if((y=h?h.get_json(i,{no_id:!0,no_data:!0,no_state:!0}):i,!y)||(y.id===!0&&delete y.id,y=this._parse_model_from_json(y,c.id,c.parents.concat()),!y))return!1;for(a=this.get_node(y),i&&i.state&&i.state.loaded===!1&&(a.state.loaded=!1),v=[],v.push(y),v=v.concat(a.children_d),this.trigger("model",{nodes:v,parent:c.id}),l=0,b=c.parents.length;b>l;l++)this._model.data[c.parents[l]].children_d=this._model.data[c.parents[l]].children_d.concat(v);for(v=[],l=0,b=c.children.length;b>l;l++)v[l>=u?l+1:l]=c.children[l];return v[u]=a.id,c.children=v,c.children_d.push(a.id),c.children_d=c.children_d.concat(a.children_d),c.id===n.jstree.root&&(this._model.force_full_redraw=!0),this._model.force_full_redraw||this._node_changed(c.id),o||this.redraw(c.id===n.jstree.root),f&&f.call(this,a,c,u),this.trigger("copy_node",{node:a,original:i,parent:c.id,position:u,old_parent:p,old_position:h&&h._id&&p&&h._model.data[p]&&h._model.data[p].children?n.inArray(i.id,h._model.data[p].children):-1,is_multi:h&&h._id&&h._id!==this._id,is_foreign:!h||!h._id,old_instance:h,new_instance:this}),a.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),n.vakata.is_array(t)||(t=[t]),!t.length)return!1;for(var e=[],i,u=0,s=t.length;s>u;u++)i=this.get_node(t[u]),i&&i.id&&i.id!==n.jstree.root&&e.push(i);return e.length?(f=e,o=this,r="move_node",void this.trigger("cut",{node:t})):!1},copy:function(t){if(t||(t=this._data.core.selected.concat()),n.vakata.is_array(t)||(t=[t]),!t.length)return!1;for(var e=[],i,u=0,s=t.length;s>u;u++)i=this.get_node(t[u]),i&&i.id&&i.id!==n.jstree.root&&e.push(i);return e.length?(f=e,o=this,r="copy_node",void this.trigger("copy",{node:t})):!1},get_buffer:function(){return{mode:r,node:f,inst:o}},can_paste:function(){return r!==!1&&f!==!1},paste:function(n,t){return n=this.get_node(n),n&&r&&r.match(/^(copy_node|move_node)$/)&&f?(this[r](f,n,t,!1,!1,!1,o)&&this.trigger("paste",{parent:n.id,node:f,mode:r}),f=!1,r=!1,void(o=!1)):!1},clear_buffer:function(){f=!1;r=!1;o=!1;this.trigger("clear_buffer")},edit:function(t,r,u){var v,l,f,h,e,c,o,a,s,y=!1;return(t=this.get_node(t))?this.check("edit",t,this.get_parent(t))?(s=t,r="string"==typeof r?r:t.text,this.set_text(t,""),t=this._open_to(t),s.text=r,v=this._data.core.rtl,l=this.element.width(),this._data.core.focused=s.id,f=t.children(".jstree-anchor").trigger("focus"),h=n("<span><\/span>"),e=r,c=n("<div><\/div>",{css:{position:"absolute",top:"-200px",left:v?"0px":"-1000px",visibility:"hidden"}}).appendTo(i.body),o=n("<input />",{value:e,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:function(i){i.stopImmediatePropagation();i.preventDefault();var v=h.children(".jstree-rename-input"),r=v.val(),a=this.settings.core.force_text,l;""===r&&(r=e);c.remove();h.replaceWith(f);h.remove();e=a?e:n("<div><\/div>").append(n.parseHTML(e)).html();t=this.get_node(t);this.set_text(t,e);l=!!this.rename_node(t,a?n("<div><\/div>").text(r).text():n("<div><\/div>").append(n.parseHTML(r)).html());l||this.set_text(t,e);this._data.core.focused=s.id;setTimeout(function(){var n=this.get_node(s.id,!0);n.length&&(this._data.core.focused=s.id,n.children(".jstree-anchor").trigger("focus"))}.bind(this),0);u&&u.call(this,s,l,y,r);o=null}.bind(this),keydown:function(n){var t=n.which;27===t&&(y=!0,this.value=e);(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&n.stopImmediatePropagation();(27===t||13===t)&&(n.preventDefault(),this.blur())},click:function(n){n.stopImmediatePropagation()},mousedown:function(n){n.stopImmediatePropagation()},keyup:function(){o.width(Math.min(c.text("pW"+this.value).width(),l))},keypress:function(n){if(13===n.which)return!1}}),a={fontFamily:f.css("fontFamily")||"",fontSize:f.css("fontSize")||"",fontWeight:f.css("fontWeight")||"",fontStyle:f.css("fontStyle")||"",fontStretch:f.css("fontStretch")||"",fontVariant:f.css("fontVariant")||"",letterSpacing:f.css("letterSpacing")||"",wordSpacing:f.css("wordSpacing")||""},h.attr("class",f.attr("class")).append(f.contents().clone()).append(o),f.replaceWith(h),c.css(a),o.css(a).width(Math.min(c.text("pW"+o[0].value).width(),l))[0].select(),void n(i).one("mousedown.jstree touchstart.jstree dnd_start.vakata",function(t){o&&t.target!==o&&n(o).trigger("blur")})):(this.settings.core.error.call(this,this._data.core.last_error),!1):!1},set_theme:function(t,i){if(!t)return!1;if(i===!0){var r=this.settings.core.themes.dir;r||(r=n.jstree.path+"/themes");i=r+"/"+t+"/style.css"}i&&-1===n.inArray(i,y)&&(n("head").append('<link rel="stylesheet" href="'+i+'" type="text/css" />'),y.push(i));this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name);this._data.core.themes.name=t;this.element.addClass("jstree-"+t);this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive");this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(n){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant);this._data.core.themes.variant=n;n&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0;this.get_container_ul().addClass("jstree-striped");this.trigger("show_stripes")},hide_stripes:function(){this._data.core.themes.stripes=!1;this.get_container_ul().removeClass("jstree-striped");this.trigger("hide_stripes")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0;this.get_container_ul().removeClass("jstree-no-dots");this.trigger("show_dots")},hide_dots:function(){this._data.core.themes.dots=!1;this.get_container_ul().addClass("jstree-no-dots");this.trigger("hide_dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0;this.get_container_ul().removeClass("jstree-no-icons");this.trigger("show_icons")},hide_icons:function(){this._data.core.themes.icons=!1;this.get_container_ul().addClass("jstree-no-icons");this.trigger("hide_icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},show_ellipsis:function(){this._data.core.themes.ellipsis=!0;this.get_container_ul().addClass("jstree-ellipsis");this.trigger("show_ellipsis")},hide_ellipsis:function(){this._data.core.themes.ellipsis=!1;this.get_container_ul().removeClass("jstree-ellipsis");this.trigger("hide_ellipsis")},toggle_ellipsis:function(){this._data.core.themes.ellipsis?this.hide_ellipsis():this.show_ellipsis()},set_icon:function(i,r){var e,o,f,u;if(n.vakata.is_array(i)){for(i=i.slice(),e=0,o=i.length;o>e;e++)this.set_icon(i[e],r);return!0}return i=this.get_node(i),i&&i.id!==n.jstree.root?(u=i.icon,i.icon=r===!0||null===r||r===t||""===r?!0:r,f=this.get_node(i,!0).children(".jstree-anchor").children(".jstree-themeicon"),r===!1?(f.removeClass("jstree-themeicon-custom "+u).css("background","").removeAttr("rel"),this.hide_icon(i)):r===!0||null===r||r===t||""===r?(f.removeClass("jstree-themeicon-custom "+u).css("background","").removeAttr("rel"),u===!1&&this.show_icon(i)):-1===r.indexOf("/")&&-1===r.indexOf(".")?(f.removeClass(u).css("background",""),f.addClass(r+" jstree-themeicon-custom").attr("rel",r),u===!1&&this.show_icon(i)):(f.removeClass(u).css("background",""),f.addClass("jstree-themeicon-custom").css("background","url('"+r+"') center center no-repeat").attr("rel",r),u===!1&&this.show_icon(i)),!0):!1},get_icon:function(t){return t=this.get_node(t),t&&t.id!==n.jstree.root?t.icon:!1},hide_icon:function(t){var i,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,r=t.length;r>i;i++)this.hide_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==n.jstree.root?(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(t){var i,u,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,u=t.length;u>i;i++)this.show_icon(t[i]);return!0}return t=this.get_node(t),t&&t!==n.jstree.root?(r=this.get_node(t,!0),t.icon=r.length?r.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),r.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},n.vakata={},n.vakata.attributes=function(t,i){t=n(t)[0];var r=i?{}:[];return t&&t.attributes&&n.each(t.attributes,function(t,u){-1===n.inArray(u.name.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==u.value&&""!==n.vakata.trim(u.value)&&(i?r[u.name]=u.value:r.push(u.name))}),r},n.vakata.array_unique=function(n){for(var r=[],f={},i=0,u=n.length;u>i;i++)f[n[i]]===t&&(r.push(n[i]),f[n[i]]=!0);return r},n.vakata.array_remove=function(n,t){return n.splice(t,1),n},n.vakata.array_remove_item=function(t,i){var r=n.inArray(i,t);return-1!==r?n.vakata.array_remove(t,r):t},n.vakata.array_filter=function(n,t,i,r,u){if(n.filter)return n.filter(t,i);r=[];for(u in n)~~u+""==u+""&&u>=0&&t.call(i,n[u],+u,n)&&r.push(n[u]);return r},n.vakata.trim=function(n){return String.prototype.trim?String.prototype.trim.call(n.toString()):n.toString().replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},n.vakata.is_function=function(n){return"function"==typeof n&&"number"!=typeof n.nodeType},n.vakata.is_array=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)},Function.prototype.bind||(Function.prototype.bind=function(){var n=this,t=arguments[0],i=Array.prototype.slice.call(arguments,1);if("function"!=typeof n)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");return function(){var r=i.concat(Array.prototype.slice.call(arguments));return n.apply(t,r)}}),n.jstree.plugins.changed=function(n,t){var i=[];this.trigger=function(n,r){var u,f,e;if(r||(r={}),"changed"===n.replace(".jstree","")){for(r.changed={selected:[],deselected:[]},e={},u=0,f=i.length;f>u;u++)e[i[u]]=1;for(u=0,f=r.selected.length;f>u;u++)e[r.selected[u]]?e[r.selected[u]]=2:r.changed.selected.push(r.selected[u]);for(u=0,f=i.length;f>u;u++)1===e[i[u]]&&r.changed.deselected.push(i[u]);i=r.selected.slice()}t.trigger.call(this,n,r)};this.refresh=function(){return i=[],t.refresh.apply(this,arguments)}},c=i.createElement("I"),c.className="jstree-icon jstree-checkbox",c.setAttribute("role","presentation"),n.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0,cascade_to_disabled:!0,cascade_to_hidden:!0},n.jstree.plugins.checkbox=function(i,r){this.bind=function(){r.bind.call(this);this._data.checkbox.uto=!1;this._data.checkbox.selected=[];this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined");this.element.on("init.jstree",function(){this._data.checkbox.visible=this.settings.checkbox.visible;this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked");this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")}.bind(this)).on("loading.jstree",function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()}.bind(this));-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto);this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)}.bind(this));this.settings.checkbox.tie_selection||this.element.on("model.jstree",function(n,t){for(var u=this._model.data,e=u[t.parent],r=t.nodes,i=0,f=r.length;f>i;i++)u[r[i]].state.checked=u[r[i]].state.checked||u[r[i]].original&&u[r[i]].original.state&&u[r[i]].original.state.checked,u[r[i]].state.checked&&this._data.checkbox.selected.push(r[i])}.bind(this));(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",function(t,i){var e=this._model.data,u=e[i.parent],s=i.nodes,c=[],v,r,o,h,l,a,y=this.settings.checkbox.cascade,f=this.settings.checkbox.tie_selection;if(-1!==y.indexOf("down"))if(u.state[f?"selected":"checked"]){for(r=0,o=s.length;o>r;r++)e[s[r]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(s)}else for(r=0,o=s.length;o>r;r++)if(e[s[r]].state[f?"selected":"checked"]){for(h=0,l=e[s[r]].children_d.length;l>h;h++)e[e[s[r]].children_d[h]].state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected=this._data[f?"core":"checkbox"].selected.concat(e[s[r]].children_d)}if(-1!==y.indexOf("up")){for(r=0,o=u.children_d.length;o>r;r++)e[u.children_d[r]].children.length||c.push(e[u.children_d[r]].parent);for(c=n.vakata.array_unique(c),h=0,l=c.length;l>h;h++)for(u=e[c[h]];u&&u.id!==n.jstree.root;){for(v=0,r=0,o=u.children.length;o>r;r++)v+=e[u.children[r]].state[f?"selected":"checked"];if(v!==o)break;u.state[f?"selected":"checked"]=!0;this._data[f?"core":"checkbox"].selected.push(u.id);a=this.get_node(u,!0);a&&a.length&&a.attr("aria-selected",!0).children(".jstree-anchor").addClass(f?"jstree-clicked":"jstree-checked");u=this.get_node(u.parent)}}this._data[f?"core":"checkbox"].selected=n.vakata.array_unique(this._data[f?"core":"checkbox"].selected)}.bind(this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",function(t,i){for(var w=this,c=i.node,p=this._model.data,u=this.get_node(c.parent),a,l,v=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection,e={},s=this._data[o?"core":"checkbox"].selected,y,h,r=0,f=s.length;f>r;r++)e[s[r]]=!0;if(-1!==v.indexOf("down"))for(y=this._cascade_new_checked_state(c.id,!0),h=c.children_d.concat(c.id),r=0,f=h.length;f>r;r++)y.indexOf(h[r])>-1?e[h[r]]=!0:delete e[h[r]];if(-1!==v.indexOf("up"))while(u&&u.id!==n.jstree.root){for(a=0,r=0,f=u.children.length;f>r;r++)a+=p[u.children[r]].state[o?"selected":"checked"];if(a!==f)break;u.state[o?"selected":"checked"]=!0;e[u.id]=!0;l=this.get_node(u,!0);l&&l.length&&l.attr("aria-selected",!0).children(".jstree-anchor").addClass(o?"jstree-clicked":"jstree-checked");u=this.get_node(u.parent)}s=[];for(r in e)e.hasOwnProperty(r)&&s.push(r);this._data[o?"core":"checkbox"].selected=s}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",function(){for(var r=this.get_node(n.jstree.root),f=this._model.data,t,i=0,u=r.children_d.length;u>i;i++)t=f[r.children_d[i]],t&&t.original&&t.original.state&&t.original.state.undetermined&&(t.original.state.undetermined=!1)}.bind(this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",function(t,i){var a=this,u=i.node,v=this.get_node(u,!0),e,s,r,h=this.settings.checkbox.cascade,o=this.settings.checkbox.tie_selection,f=this._data[o?"core":"checkbox"].selected,l=u.children_d.concat(u.id),c;if(-1!==h.indexOf("down")&&(c=this._cascade_new_checked_state(u.id,!1),f=n.vakata.array_filter(f,function(n){return-1===l.indexOf(n)||c.indexOf(n)>-1})),-1!==h.indexOf("up")&&-1===f.indexOf(u.id)){for(e=0,s=u.parents.length;s>e;e++)r=this._model.data[u.parents[e]],r.state[o?"selected":"checked"]=!1,r&&r.original&&r.original.state&&r.original.state.undetermined&&(r.original.state.undetermined=!1),r=this.get_node(u.parents[e],!0),r&&r.length&&r.attr("aria-selected",!1).children(".jstree-anchor").removeClass(o?"jstree-clicked":"jstree-checked");f=n.vakata.array_filter(f,function(n){return-1===u.parents.indexOf(n)})}this._data[o?"core":"checkbox"].selected=f}.bind(this));-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",function(t,i){for(var r=this.get_node(i.parent),h=this._model.data,f,e,s,o,u=this.settings.checkbox.tie_selection;r&&r.id!==n.jstree.root&&!r.state[u?"selected":"checked"];){for(s=0,f=0,e=r.children.length;e>f;f++)s+=h[r.children[f]].state[u?"selected":"checked"];if(!(e>0&&s===e))break;r.state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected.push(r.id);o=this.get_node(r,!0);o&&o.length&&o.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked");r=this.get_node(r.parent)}}.bind(this)).on("move_node.jstree",function(t,i){var c=i.is_multi,l=i.old_parent,a=this.get_node(i.parent),h=this._model.data,r,s,e,o,f,u=this.settings.checkbox.tie_selection;if(!c)for(r=this.get_node(l);r&&r.id!==n.jstree.root&&!r.state[u?"selected":"checked"];){for(s=0,e=0,o=r.children.length;o>e;e++)s+=h[r.children[e]].state[u?"selected":"checked"];if(!(o>0&&s===o))break;r.state[u?"selected":"checked"]=!0;this._data[u?"core":"checkbox"].selected.push(r.id);f=this.get_node(r,!0);f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked");r=this.get_node(r.parent)}for(r=a;r&&r.id!==n.jstree.root;){for(s=0,e=0,o=r.children.length;o>e;e++)s+=h[r.children[e]].state[u?"selected":"checked"];if(s===o)r.state[u?"selected":"checked"]||(r.state[u?"selected":"checked"]=!0,this._data[u?"core":"checkbox"].selected.push(r.id),f=this.get_node(r,!0),f&&f.length&&f.attr("aria-selected",!0).children(".jstree-anchor").addClass(u?"jstree-clicked":"jstree-checked"));else{if(!r.state[u?"selected":"checked"])break;r.state[u?"selected":"checked"]=!1;this._data[u?"core":"checkbox"].selected=n.vakata.array_remove_item(this._data[u?"core":"checkbox"].selected,r.id);f=this.get_node(r,!0);f&&f.length&&f.attr("aria-selected",!1).children(".jstree-anchor").removeClass(u?"jstree-clicked":"jstree-checked")}r=this.get_node(r.parent)}}.bind(this))};this.get_undetermined=function(i){if(-1===this.settings.checkbox.cascade.indexOf("undetermined"))return[];for(var r,c,f={},e=this._model.data,l=this.settings.checkbox.tie_selection,s=this._data[l?"core":"checkbox"].selected,o=[],v=this,a=[],u=0,h=s.length;h>u;u++)if(e[s[u]]&&e[s[u]].parents)for(r=0,c=e[s[u]].parents.length;c>r;r++){if(f[e[s[u]].parents[r]]!==t)break;e[s[u]].parents[r]!==n.jstree.root&&(f[e[s[u]].parents[r]]=!0,o.push(e[s[u]].parents[r]))}for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var i=v.get_node(this),s;if(i)if(i.state.loaded){for(u=0,h=i.children_d.length;h>u;u++)if(s=e[i.children_d[u]],!s.state.loaded&&s.original&&s.original.state&&s.original.state.undetermined&&s.original.state.undetermined===!0)for(f[s.id]===t&&s.id!==n.jstree.root&&(f[s.id]=!0,o.push(s.id)),r=0,c=s.parents.length;c>r;r++)f[s.parents[r]]===t&&s.parents[r]!==n.jstree.root&&(f[s.parents[r]]=!0,o.push(s.parents[r]))}else if(i.original&&i.original.state&&i.original.state.undetermined&&i.original.state.undetermined===!0)for(f[i.id]===t&&i.id!==n.jstree.root&&(f[i.id]=!0,o.push(i.id)),r=0,c=i.parents.length;c>r;r++)f[i.parents[r]]===t&&i.parents[r]!==n.jstree.root&&(f[i.parents[r]]=!0,o.push(i.parents[r]))}),u=0,h=o.length;h>u;u++)e[o[u]].state[l?"selected":"checked"]||a.push(i?e[o[u]]:o[u]);return a};this._undetermined=function(){if(null!==this.element){var i=this.get_undetermined(!1),n,r,t;for(this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),n=0,r=i.length;r>n;n++)t=this.get_node(i[n],!0),t&&t.length&&t.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined")}};this.redraw_node=function(n,t,i){if(n=r.redraw_node.apply(this,arguments)){for(var f=null,e=null,u=0,o=n.childNodes.length;o>u;u++)if(n.childNodes[u]&&n.childNodes[u].className&&-1!==n.childNodes[u].className.indexOf("jstree-anchor")){f=n.childNodes[u];break}f&&(!this.settings.checkbox.tie_selection&&this._model.data[n.id].state.checked&&(f.className+=" jstree-checked"),e=c.cloneNode(!1),this._model.data[n.id].state.checkbox_disabled&&(e.className+=" jstree-checkbox-disabled"),f.insertBefore(e,f.childNodes[0]))}return i||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(this._undetermined.bind(this),50)),n};this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0;this.get_container_ul().removeClass("jstree-no-checkboxes")};this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1;this.get_container_ul().addClass("jstree-no-checkboxes")};this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()};this.is_undetermined=function(t){t=this.get_node(t);var r=this.settings.checkbox.cascade,i,u,f=this.settings.checkbox.tie_selection,o=this._data[f?"core":"checkbox"].selected,e=this._model.data;if(!t||t.state[f?"selected":"checked"]===!0||-1===r.indexOf("undetermined")||-1===r.indexOf("down")&&-1===r.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(i=0,u=t.children_d.length;u>i;i++)if(-1!==n.inArray(t.children_d[i],o)||!e[t.children_d[i]].state.loaded&&e[t.children_d[i]].original.state.undetermined)return!0;return!1};this.disable_checkbox=function(t){var i,u,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,u=t.length;u>i;i++)this.disable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(r=this.get_node(t,!0),void(t.state.checkbox_disabled||(t.state.checkbox_disabled=!0,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-checkbox-disabled"),this.trigger("disable_checkbox",{node:t})))):!1};this.enable_checkbox=function(t){var i,u,r;if(n.vakata.is_array(t)){for(t=t.slice(),i=0,u=t.length;u>i;i++)this.enable_checkbox(t[i]);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(r=this.get_node(t,!0),void(t.state.checkbox_disabled&&(t.state.checkbox_disabled=!1,r&&r.length&&r.children(".jstree-anchor").children(".jstree-checkbox").removeClass("jstree-checkbox-disabled"),this.trigger("enable_checkbox",{node:t})))):!1};this.activate_node=function(t,i){return n(i.target).hasClass("jstree-checkbox-disabled")?!1:(this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||n(i.target).hasClass("jstree-checkbox"))&&(i.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!n(i.target).hasClass("jstree-checkbox")?r.activate_node.call(this,t,i):this.is_disabled(t)?!1:(this.is_checked(t)?this.uncheck_node(t,i):this.check_node(t,i),void this.trigger("activate_node",{node:this.get_node(t)})))};this._cascade_new_checked_state=function(n,t){var l=this,r=this.settings.checkbox.tie_selection,i=this._model.data[n],u=[],e=[],o,a,f,s,h,c;if(!this.settings.checkbox.cascade_to_disabled&&i.state.disabled||!this.settings.checkbox.cascade_to_hidden&&i.state.hidden)f=this.get_checked_descendants(n),i.state[r?"selected":"checked"]&&f.push(i.id),u=u.concat(f);else{if(i.children)for(o=0,a=i.children.length;a>o;o++)s=i.children[o],f=l._cascade_new_checked_state(s,t),u=u.concat(f),f.indexOf(s)>-1&&e.push(s);h=l.get_node(i,!0);c=e.length>0&&e.length<i.children.length;i.original&&i.original.state&&i.original.state.undetermined&&(i.original.state.undetermined=c);c?(i.state[r?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(r?"jstree-clicked":"jstree-checked")):t&&e.length===i.children.length?(i.state[r?"selected":"checked"]=t,u.push(i.id),h.attr("aria-selected",!0).children(".jstree-anchor").addClass(r?"jstree-clicked":"jstree-checked")):(i.state[r?"selected":"checked"]=!1,h.attr("aria-selected",!1).children(".jstree-anchor").removeClass(r?"jstree-clicked":"jstree-checked"))}return u};this.get_checked_descendants=function(t){var i=this,r=i.settings.checkbox.tie_selection,u=i._model.data[t];return n.vakata.array_filter(u.children_d,function(n){return i._model.data[n].state[r?"selected":"checked"]})};this.check_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,i);var r,u,f;if(n.vakata.is_array(t)){for(t=t.slice(),u=0,f=t.length;f>u;u++)this.check_node(t[u],i);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(r=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),r&&r.length&&r.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1};this.uncheck_node=function(t,i){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,i);var r,f,u;if(n.vakata.is_array(t)){for(t=t.slice(),r=0,f=t.length;f>r;r++)this.uncheck_node(t[r],i);return!0}return t=this.get_node(t),t&&t.id!==n.jstree.root?(u=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=n.vakata.array_remove_item(this._data.checkbox.selected,t.id),u.length&&u.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:i})))):!1};this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();var r=this._data.checkbox.selected.concat([]),t,i;for(this._data.checkbox.selected=this._model.data[n.jstree.root].children_d.concat(),t=0,i=this._data.checkbox.selected.length;i>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!0);this.redraw(!0);this.trigger("check_all",{selected:this._data.checkbox.selected})};this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var i=this._data.checkbox.selected.concat([]),n=0,t=this._data.checkbox.selected.length;t>n;n++)this._model.data[this._data.checkbox.selected[n]]&&(this._model.data[this._data.checkbox.selected[n]].state.checked=!1);this._data.checkbox.selected=[];this.element.find(".jstree-checked").removeClass("jstree-checked");this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:i})};this.is_checked=function(t){return this.settings.checkbox.tie_selection?this.is_selected(t):(t=this.get_node(t),t&&t.id!==n.jstree.root?t.state.checked:!1)};this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?n.map(this._data.checkbox.selected,function(n){return this.get_node(n)}.bind(this)):this._data.checkbox.selected.slice()};this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);for(var r=this.get_checked(!0),u={},f,o,i=0,e=r.length;e>i;i++)u[r[i].id]=r[i];for(i=0,e=r.length;e>i;i++)for(f=0,o=r[i].children_d.length;o>f;f++)u[r[i].children_d[f]]&&delete u[r[i].children_d[f]];r=[];for(i in u)u.hasOwnProperty(i)&&r.push(i);return t?n.map(r,function(n){return this.get_node(n)}.bind(this)):r};this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);for(var r=this.get_checked(!0),u=[],i=0,f=r.length;f>i;i++)r[i].children.length||u.push(r[i].id);return t?n.map(u,function(n){return this.get_node(n)}.bind(this)):u};this.load_node=function(t){var u,f,e,i;if(!n.vakata.is_array(t)&&!this.settings.checkbox.tie_selection&&(i=this.get_node(t),i&&i.state.loaded))for(u=0,f=i.children_d.length;f>u;u++)this._model.data[i.children_d[u]].state.checked&&(e=!0,this._data.checkbox.selected=n.vakata.array_remove_item(this._data.checkbox.selected,i.children_d[u]));return r.load_node.apply(this,arguments)};this.get_state=function(){var n=r.get_state.apply(this,arguments);return this.settings.checkbox.tie_selection?n:(n.checkbox=this._data.checkbox.selected.slice(),n)};this.set_state=function(t,i){var u=r.set_state.apply(this,arguments),f;return u&&t.checkbox?(this.settings.checkbox.tie_selection||(this.uncheck_all(),f=this,n.each(t.checkbox,function(n,t){f.check_node(t)})),delete t.checkbox,this.set_state(t,i),!1):u};this.refresh=function(){return this.settings.checkbox.tie_selection&&(this._data.checkbox.selected=[]),r.refresh.apply(this,arguments)}},n.jstree.defaults.conditionalselect=function(){return!0},n.jstree.plugins.conditionalselect=function(n,t){this.activate_node=function(n,i){if(this.settings.conditionalselect.call(this,this.get_node(n),i))return t.activate_node.call(this,n,i)}},n.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.create_node(r,{},"last",function(n){try{i.edit(n)}catch(t){setTimeout(function(){i.edit(n)},0)}})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.edit(r)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.delete_node(i.get_selected()):i.delete_node(r)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.cut(i.get_top_selected()):i.cut(r)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.is_selected(r)?i.copy(i.get_top_selected()):i.copy(r)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!n.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var i=n.jstree.reference(t.reference),r=i.get_node(t.reference);i.paste(r)}}}}}}},n.jstree.plugins.contextmenu=function(r,u){this.bind=function(){u.bind.call(this);var r=0,t=null,f,e;this.element.on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-contextmenu")}.bind(this)).on("contextmenu.jstree",".jstree-anchor",function(n,i){"input"!==n.target.tagName.toLowerCase()&&(n.preventDefault(),r=n.ctrlKey?+new Date:0,(i||t)&&(r=+new Date+1e4),t&&clearTimeout(t),this.is_loading(n.currentTarget)||this.show_contextmenu(n.currentTarget,n.pageX,n.pageY,n))}.bind(this)).on("click.jstree",".jstree-anchor",function(){this._data.contextmenu.visible&&(!r||+new Date-r>250)&&n.vakata.context.hide();r=0}.bind(this)).on("touchstart.jstree",".jstree-anchor",function(i){i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(f=i.originalEvent.changedTouches[0].clientX,e=i.originalEvent.changedTouches[0].clientY,t=setTimeout(function(){n(i.currentTarget).trigger("contextmenu",!0)},750))}).on("touchmove.vakata.jstree",function(i){t&&i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches[0]&&(Math.abs(f-i.originalEvent.changedTouches[0].clientX)>10||Math.abs(e-i.originalEvent.changedTouches[0].clientY)>10)&&(clearTimeout(t),n.vakata.context.hide())}).on("touchend.vakata.jstree",function(){t&&clearTimeout(t)});n(i).on("context_hide.vakata.jstree",function(t,i){this._data.contextmenu.visible=!1;n(i.reference).removeClass("jstree-context")}.bind(this))};this.teardown=function(){this._data.contextmenu.visible&&n.vakata.context.hide();n(i).off("context_hide.vakata.jstree");u.teardown.call(this)};this.show_contextmenu=function(i,r,u,f){if(i=this.get_node(i),!i||i.id===n.jstree.root)return!1;var s=this.settings.contextmenu,h=this.get_node(i,!0),c=h.children(".jstree-anchor"),o=!1,e=!1;(s.show_at_node||r===t||u===t)&&(o=c.offset(),r=o.left,u=o.top+this._data.core.li_height);this.settings.contextmenu.select_node&&!this.is_selected(i)&&this.activate_node(i,f);e=s.items;n.vakata.is_function(e)&&(e=e.call(this,i,function(n){this._show_contextmenu(i,r,u,n)}.bind(this)));n.isPlainObject(e)&&this._show_contextmenu(i,r,u,e)};this._show_contextmenu=function(t,r,u,f){var o=this.get_node(t,!0),e=o.children(".jstree-anchor");n(i).one("context_show.vakata.jstree",function(t,i){var r="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";n(i.element).addClass(r);e.addClass("jstree-context")}.bind(this));this._data.contextmenu.visible=!0;n.vakata.context.show(e,{x:r,y:u},f);this.trigger("show_contextmenu",{node:t,x:r,y:u})}},function(n){var r=!1,t={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};n.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(r){n(i).triggerHandler("context_"+r+".vakata",{reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}})},_execute:function(i){return i=t.items[i],i&&(!i._disabled||n.vakata.is_function(i._disabled)&&!i._disabled({item:i,reference:t.reference,element:t.element}))&&i.action?i.action.call(null,{item:i,reference:t.reference,element:t.element,position:{x:t.position_x,y:t.position_y}}):!1},_parse:function(i,r){if(!i)return!1;r||(t.html="",t.items=[]);var u="",f=!1,e;return r&&(u+="<ul>"),n.each(i,function(i,r){return r?(t.items.push(r),!f&&r.separator_before&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;<\/a><\/li>"),f=!1,u+="<li class='"+(r._class||"")+(r._disabled===!0||n.vakata.is_function(r._disabled)&&r._disabled({item:r,reference:t.reference,element:t.element})?" vakata-contextmenu-disabled ":"")+"' "+(r.shortcut?" data-shortcut='"+r.shortcut+"' ":"")+">",u+="<a href='#' rel='"+(t.items.length-1)+"' "+(r.title?"title='"+r.title+"'":"")+">",n.vakata.context.settings.icons&&(u+="<i ",r.icon&&(u+=-1!==r.icon.indexOf("/")||-1!==r.icon.indexOf(".")?" style='background:url(\""+r.icon+"\") center center no-repeat' ":" class='"+r.icon+"' "),u+="><\/i><span class='vakata-contextmenu-sep'>&#160;<\/span>"),u+=(n.vakata.is_function(r.label)?r.label({item:i,reference:t.reference,element:t.element}):r.label)+(r.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+r.shortcut+'">'+(r.shortcut_label||"")+"<\/span>":"")+"<\/a>",r.submenu&&(e=n.vakata.context._parse(r.submenu,!0),e&&(u+=e)),u+="<\/li>",void(r.separator_after&&(u+="<li class='vakata-context-separator'><a href='#' "+(n.vakata.context.settings.icons?"":'class="vakata-context-no-icons"')+">&#160;<\/a><\/li>",f=!0))):!0}),u=u.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),r&&(u+="<\/ul>"),r||(t.html=u,n.vakata.context._trigger("parse")),u.length>10?u:!1},_show_submenu:function(t){if(t=n(t),t.length&&t.children("ul").length){var i=t.children("ul"),e=t.offset().left,f=e+t.outerWidth(),s=t.offset().top,u=i.width(),h=i.height(),o=n(window).width()+n(window).scrollLeft(),c=n(window).height()+n(window).scrollTop();r?t[f-(u+10+t.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):t[f+u>o&&e>o-f?"addClass":"removeClass"]("vakata-context-right");s+h+10>c&&i.css("bottom","-1px");t.hasClass("vakata-context-right")?u>e&&i.css("margin-right",e-u):u>o-f&&i.css("margin-left",o-f-u);i.show()}},show:function(u,f,e){var c,s,o,h,l,a,v,y;switch(t.element&&t.element.length&&t.element.width(""),!0){case!f&&!u:return!1;case!!f&&!!u:t.reference=u;t.position_x=f.x;t.position_y=f.y;break;case!f&&!!u:t.reference=u;c=u.offset();t.position_x=c.left+u.outerHeight();t.position_y=c.top;break;case!!f&&!u:t.position_x=f.x;t.position_y=f.y}u&&!e&&n(u).data("vakata_contextmenu")&&(e=n(u).data("vakata_contextmenu"));n.vakata.context._parse(e)&&t.element.html(t.html);t.items.length&&(t.element.appendTo(i.body),s=t.element,o=t.position_x,h=t.position_y,l=s.width(),a=s.height(),v=n(window).width()+n(window).scrollLeft(),y=n(window).height()+n(window).scrollTop(),r&&(o-=s.outerWidth()-n(u).outerWidth(),o<n(window).scrollLeft()+20&&(o=n(window).scrollLeft()+20)),o+l+20>v&&(o=v-(l+20)),h+a+20>y&&(h=y-(a+20)),t.element.css({left:o,top:h}).show().find("a").first().trigger("focus").parent().addClass("vakata-context-hover"),t.is_visible=!0,n.vakata.context._trigger("show"))},hide:function(){t.is_visible&&(t.element.hide().find("ul").hide().end().find(":focus").trigger("blur").end().detach(),t.is_visible=!1,n.vakata.context._trigger("hide"))}};n(function(){r="rtl"===n(i.body).css("direction");var u=!1;t.element=n("<ul class='vakata-context'><\/ul>");t.element.on("mouseenter","li",function(i){i.stopImmediatePropagation();n.contains(this,i.relatedTarget)||(u&&clearTimeout(u),t.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),n(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),n.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){n.contains(this,t.relatedTarget)||n(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){n(this).find(".vakata-context-hover").removeClass("vakata-context-hover");n.vakata.context.settings.hide_onmouseleave&&(u=setTimeout(function(){return function(){n.vakata.context.hide()}}(this),n.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault();n(this).trigger("blur").parent().hasClass("vakata-context-disabled")||n.vakata.context._execute(n(this).attr("rel"))===!1||n.vakata.context.hide()}).on("keydown","a",function(i){var r=null;switch(i.which){case 13:case 32:i.type="click";i.preventDefault();n(i.currentTarget).trigger(i);break;case 37:t.is_visible&&(t.element.find(".vakata-context-hover").last().closest("li").first().find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").trigger("focus"),i.stopImmediatePropagation(),i.preventDefault());break;case 38:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),r.addClass("vakata-context-hover").children("a").trigger("focus"),i.stopImmediatePropagation(),i.preventDefault());break;case 39:t.is_visible&&(t.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").trigger("focus"),i.stopImmediatePropagation(),i.preventDefault());break;case 40:t.is_visible&&(r=t.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),r.length||(r=t.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),r.addClass("vakata-context-hover").children("a").trigger("focus"),i.stopImmediatePropagation(),i.preventDefault());break;case 27:n.vakata.context.hide();i.preventDefault()}}).on("keydown",function(n){n.preventDefault();var i=t.element.find(".vakata-contextmenu-shortcut-"+n.which).parent();i.parent().not(".vakata-context-disabled")&&i.trigger("click")});n(i).on("mousedown.vakata.jstree",function(i){t.is_visible&&t.element[0]!==i.target&&!n.contains(t.element[0],i.target)&&n.vakata.context.hide()}).on("context_show.vakata.jstree",function(){t.element.find("li:has(ul)").children("a").addClass("vakata-context-parent");r&&t.element.addClass("vakata-context-rtl").css("direction","rtl");t.element.find("ul").hide().end()})})}(n),n.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0,drag_selection:!0,touch:!0,large_drop_target:!1,large_drag_target:!1,use_html5:!1},n.jstree.plugins.dnd=function(t,r){this.init=function(n,t){r.init.call(this,n,t);this.settings.dnd.use_html5=this.settings.dnd.use_html5&&"draggable"in i.createElement("span")};this.bind=function(){r.bind.call(this);this.element.on(this.settings.dnd.use_html5?"dragstart.jstree":"mousedown.jstree touchstart.jstree",this.settings.dnd.large_drag_target?".jstree-node":".jstree-anchor",function(t){if(this.settings.dnd.large_drag_target&&n(t.target).closest(".jstree-node")[0]!==t.currentTarget||"touchstart"===t.type&&(!this.settings.dnd.touch||"selected"===this.settings.dnd.touch&&!n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").hasClass("jstree-clicked")))return!0;var i=this.get_node(t.target),r=this.is_selected(i)&&this.settings.dnd.drag_selection?this.get_top_selected().length:1,f=r>1?r+" "+this.get_string("nodes"):this.get_text(t.currentTarget);if(this.settings.core.force_text&&(f=n.vakata.html.escape(f)),i&&i.id&&i.id!==n.jstree.root&&(1===t.which||"touchstart"===t.type||"dragstart"===t.type)&&(this.settings.dnd.is_draggable===!0||n.vakata.is_function(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,r>1?this.get_top_selected(!0):[i],t))){if(e={jstree:!0,origin:this,obj:this.get_node(i,!0),nodes:r>1?this.get_top_selected():[i.id]},u=t.currentTarget,!this.settings.dnd.use_html5)return this.element.trigger("mousedown.jstree"),n.vakata.dnd.start(t,e,'<div id="jstree-dnd" class="jstree-'+this.get_theme()+" jstree-"+this.get_theme()+"-"+this.get_theme_variant()+" "+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"><\/i>'+f+'<ins class="jstree-copy">+<\/ins><\/div>');n.vakata.dnd._trigger("start",t,{helper:n(),element:u,data:e})}}.bind(this));this.settings.dnd.use_html5&&this.element.on("dragover.jstree",function(t){return t.preventDefault(),n.vakata.dnd._trigger("move",t,{helper:n(),element:u,data:e}),!1}).on("drop.jstree",function(t){return t.preventDefault(),n.vakata.dnd._trigger("stop",t,{helper:n(),element:u,data:e}),!1}.bind(this))};this.redraw_node=function(n){if(n=r.redraw_node.apply(this,arguments),n&&this.settings.dnd.use_html5)if(this.settings.dnd.large_drag_target)n.setAttribute("draggable",!0);else{for(var i=null,t=0,u=n.childNodes.length;u>t;t++)if(n.childNodes[t]&&n.childNodes[t].className&&-1!==n.childNodes[t].className.indexOf("jstree-anchor")){i=n.childNodes[t];break}i&&i.setAttribute("draggable",!0)}return n}},n(function(){var r=!1,h=!1,f=!1,o=!1,s=n('<div id="jstree-marker">&#160;<\/div>').hide();n(i).on("dragover.vakata.jstree",function(t){u&&n.vakata.dnd._trigger("move",t,{helper:n(),element:u,data:e})}).on("drop.vakata.jstree",function(t){u&&(n.vakata.dnd._trigger("stop",t,{helper:n(),element:u,data:e}),u=null,e=null)}).on("dnd_start.vakata.jstree",function(n,t){r=!1;f=!1;t&&t.data&&t.data.jstree&&s.appendTo(i.body)}).on("dnd_move.vakata.jstree",function(i,u){var st=u.event.target!==f.target;if(o&&(!u.event||"dragover"!==u.event.type||st)&&clearTimeout(o),u&&u.data&&u.data.jstree&&(!u.event.target.id||"jstree-marker"!==u.event.target.id)){f=u.event;var e=n.jstree.reference(u.event.target),c=!1,v=!1,d=!1,g,nt,p,y,w,tt,a,l,it,et,rt,ht,b,k,ut,ot,ft;if(e&&e._data&&e._data.dnd)if(s.attr("class","jstree-"+e.get_theme()+(e.settings.core.themes.responsive?" jstree-dnd-responsive":"")),ut=u.data.origin&&(u.data.origin.settings.dnd.always_copy||u.data.origin.settings.dnd.copy&&(u.event.metaKey||u.event.ctrlKey)),u.helper.children().attr("class","jstree-"+e.get_theme()+" jstree-"+e.get_theme()+"-"+e.get_theme_variant()+" "+(e.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy").first()[ut?"show":"hide"](),u.event.target!==e.element[0]&&u.event.target!==e.get_container_ul()[0]||0!==e.get_container_ul().children().length){if(c=e.settings.dnd.large_drop_target?n(u.event.target).closest(".jstree-node").children(".jstree-anchor"):n(u.event.target).closest(".jstree-anchor"),c&&c.length&&c.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(v=c.offset(),d=(u.event.pageY!==t?u.event.pageY:u.event.originalEvent.pageY)-v.top,p=c.outerHeight(),tt=p/3>d?["b","i","a"]:d>p-p/3?["a","i","b"]:d>p/2?["i","a","b"]:["i","b","a"],n.each(tt,function(t,i){switch(i){case"b":g=v.left-6;nt=v.top;y=e.get_parent(c);w=c.parent().index();ft="jstree-below";break;case"i":b=e.settings.dnd.inside_pos;k=e.get_node(c.parent());g=v.left-2;nt=v.top+p/2+1;y=k.id;w="first"===b?0:"last"===b?k.children.length:Math.min(b,k.children.length);ft="jstree-inside";break;case"a":g=v.left-6;nt=v.top+p;y=e.get_parent(c);w=c.parent().index()+1;ft="jstree-above"}for(a=!0,l=0,it=u.data.nodes.length;it>l;l++)if(et=u.data.origin&&(u.data.origin.settings.dnd.always_copy||u.data.origin.settings.dnd.copy&&(u.event.metaKey||u.event.ctrlKey))?"copy_node":"move_node",rt=w,"move_node"===et&&"a"===i&&u.data.origin&&u.data.origin===e&&y===e.get_parent(u.data.nodes[l])&&(ht=e.get_node(y),rt>n.inArray(u.data.nodes[l],ht.children)&&(rt-=1)),a=a&&(e&&e.settings&&e.settings.dnd&&e.settings.dnd.check_while_dragging===!1||e.check(et,u.data.origin&&u.data.origin!==e?u.data.origin.get_node(u.data.nodes[l]):u.data.nodes[l],y,rt,{dnd:!0,ref:e.get_node(c.parent()),pos:i,origin:u.data.origin,is_multi:u.data.origin&&u.data.origin!==e,is_foreign:!u.data.origin})),!a){e&&e.last_error&&(h=e.last_error());break}return"i"===i&&c.parent().is(".jstree-closed")&&e.settings.dnd.open_timeout&&(!u.event||"dragover"!==u.event.type||st)&&(o&&clearTimeout(o),o=setTimeout(function(n,t){return function(){n.open_node(t)}}(e,c),e.settings.dnd.open_timeout)),a?(ot=e.get_node(y,!0),ot.hasClass(".jstree-dnd-parent")||(n(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),ot.addClass("jstree-dnd-parent")),r={ins:e,par:y,pos:"i"!==i||"last"!==b||0!==w||e.is_loaded(k)?w:"last"},s.css({left:g+"px",top:nt+"px"}).show(),s.removeClass("jstree-above jstree-inside jstree-below").addClass(ft),u.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),u.event.originalEvent&&u.event.originalEvent.dataTransfer&&(u.event.originalEvent.dataTransfer.dropEffect=ut?"copy":"move"),h={},tt=!0,!1):void 0}),tt===!0))return}else{for(a=!0,l=0,it=u.data.nodes.length;it>l;l++)if(a=a&&e.check(u.data.origin&&(u.data.origin.settings.dnd.always_copy||u.data.origin.settings.dnd.copy&&(u.event.metaKey||u.event.ctrlKey))?"copy_node":"move_node",u.data.origin&&u.data.origin!==e?u.data.origin.get_node(u.data.nodes[l]):u.data.nodes[l],n.jstree.root,"last",{dnd:!0,ref:e.get_node(n.jstree.root),pos:"i",origin:u.data.origin,is_multi:u.data.origin&&u.data.origin!==e,is_foreign:!u.data.origin}),!a)break;if(a)return r={ins:e,par:n.jstree.root,pos:"last"},s.hide(),u.helper.find(".jstree-icon").first().removeClass("jstree-er").addClass("jstree-ok"),void(u.event.originalEvent&&u.event.originalEvent.dataTransfer&&(u.event.originalEvent.dataTransfer.dropEffect=ut?"copy":"move"))}n(".jstree-dnd-parent").removeClass("jstree-dnd-parent");r=!1;u.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er");u.event.originalEvent&&u.event.originalEvent.dataTransfer;s.hide()}}).on("dnd_scroll.vakata.jstree",function(n,t){t&&t.data&&t.data.jstree&&(s.hide(),r=!1,f=!1,t.helper.find(".jstree-icon").first().removeClass("jstree-ok").addClass("jstree-er"))}).on("dnd_stop.vakata.jstree",function(t,i){if(n(".jstree-dnd-parent").removeClass("jstree-dnd-parent"),o&&clearTimeout(o),i&&i.data&&i.data.jstree){s.hide().detach();var u,e,c=[];if(r){for(u=0,e=i.data.nodes.length;e>u;u++)c[u]=i.data.origin?i.data.origin.get_node(i.data.nodes[u]):i.data.nodes[u];r.ins[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(i.event.metaKey||i.event.ctrlKey))?"copy_node":"move_node"](c,r.par,r.pos,!1,!1,!1,i.data.origin)}else u=n(i.event.target).closest(".jstree"),u.length&&h&&h.error&&"check"===h.error&&(u=u.jstree(!0),u&&u.settings.core.error.call(this,h));f=!1;r=!1}}).on("keyup.jstree keydown.jstree",function(t,i){i=n.vakata.dnd._get();i&&i.data&&i.data.jstree&&("keyup"===t.type&&27===t.which?(o&&clearTimeout(o),r=!1,h=!1,f=!1,o=!1,s.hide().detach(),n.vakata.dnd._clean()):(i.helper.find(".jstree-copy").first()[i.data.origin&&(i.data.origin.settings.dnd.always_copy||i.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"](),f&&(f.metaKey=t.metaKey,f.ctrlKey=t.ctrlKey,n.vakata.dnd._trigger("move",f))))})}),function(n){n.vakata.html={div:n("<div><\/div>"),escape:function(t){return n.vakata.html.div.text(t).html()},strip:function(t){return n.vakata.html.div.empty().append(n.parseHTML(t)).text()}};var r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};n.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:10},_trigger:function(r,u,f){f===t&&(f=n.vakata.dnd._get());f.event=u;n(i).triggerHandler("dnd_"+r+".vakata",f)},_get:function(){return{data:r.data,element:r.element,helper:r.helper}},_clean:function(){r.helper&&r.helper.remove();r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1);r={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};u=null;n(i).off("mousemove.vakata.jstree touchmove.vakata.jstree",n.vakata.dnd.drag);n(i).off("mouseup.vakata.jstree touchend.vakata.jstree",n.vakata.dnd.stop)},_scroll:function(t){if(!r.scroll_e||!r.scroll_l&&!r.scroll_t)return r.scroll_i&&(clearInterval(r.scroll_i),r.scroll_i=!1),!1;if(!r.scroll_i)return r.scroll_i=setInterval(n.vakata.dnd._scroll,100),!1;if(t===!0)return!1;var i=r.scroll_e.scrollTop(),u=r.scroll_e.scrollLeft();r.scroll_e.scrollTop(i+r.scroll_t*n.vakata.dnd.settings.scroll_speed);r.scroll_e.scrollLeft(u+r.scroll_l*n.vakata.dnd.settings.scroll_speed);(i!==r.scroll_e.scrollTop()||u!==r.scroll_e.scrollLeft())&&n.vakata.dnd._trigger("scroll",r.scroll_e)},start:function(t,u,f){"touchstart"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=i.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset));r.is_drag&&n.vakata.dnd.stop({});try{t.currentTarget.unselectable="on";t.currentTarget.onselectstart=function(){return!1};t.currentTarget.style&&(t.currentTarget.style.touchAction="none",t.currentTarget.style.msTouchAction="none",t.currentTarget.style.MozUserSelect="none")}catch(e){}return r.init_x=t.pageX,r.init_y=t.pageY,r.data=u,r.is_down=!0,r.element=t.currentTarget,r.target=t.target,r.is_touch="touchstart"===t.type,f!==!1&&(r.helper=n("<div id='vakata-dnd'><\/div>").html(f).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),n(i).on("mousemove.vakata.jstree touchmove.vakata.jstree",n.vakata.dnd.drag),n(i).on("mouseup.vakata.jstree touchend.vakata.jstree",n.vakata.dnd.stop),!1},drag:function(t){if("touchmove"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=i.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_down){if(!r.is_drag){if(!(Math.abs(t.pageX-r.init_x)>(r.is_touch?n.vakata.dnd.settings.threshold_touch:n.vakata.dnd.settings.threshold)||Math.abs(t.pageY-r.init_y)>(r.is_touch?n.vakata.dnd.settings.threshold_touch:n.vakata.dnd.settings.threshold)))return;r.helper&&(r.helper.appendTo(i.body),r.helper_w=r.helper.outerWidth());r.is_drag=!0;n(r.target).one("click.vakata",!1);n.vakata.dnd._trigger("start",t)}var u=!1,l=!1,f=!1,o=!1,e=!1,s=!1,a=!1,v=!1,h=!1,c=!1;return r.scroll_t=0,r.scroll_l=0,r.scroll_e=!1,n(n(t.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(n(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var u=n(this),i=u.offset();return this.scrollHeight>this.offsetHeight&&(i.top+u.height()-t.pageY<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),t.pageY-i.top<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(i.left+u.width()-t.pageX<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),t.pageX-i.left<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1)),r.scroll_t||r.scroll_l?(r.scroll_e=n(this),!1):void 0}),r.scroll_e||(u=n(i),l=n(window),f=u.height(),o=l.height(),e=u.width(),s=l.width(),a=u.scrollTop(),v=u.scrollLeft(),f>o&&t.pageY-a<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=-1),f>o&&o-(t.pageY-a)<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_t=1),e>s&&t.pageX-v<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=-1),e>s&&s-(t.pageX-v)<n.vakata.dnd.settings.scroll_proximity&&(r.scroll_l=1),(r.scroll_t||r.scroll_l)&&(r.scroll_e=u)),r.scroll_e&&n.vakata.dnd._scroll(!0),r.helper&&(h=parseInt(t.pageY+n.vakata.dnd.settings.helper_top,10),c=parseInt(t.pageX+n.vakata.dnd.settings.helper_left,10),f&&h+25>f&&(h=f-50),e&&c+r.helper_w>e&&(c=e-(r.helper_w+2)),r.helper.css({left:c+"px",top:h+"px"})),n.vakata.dnd._trigger("move",t),!1}},stop:function(t){if("touchend"===t.type&&t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches[0]&&(t.pageX=t.originalEvent.changedTouches[0].pageX,t.pageY=t.originalEvent.changedTouches[0].pageY,t.target=i.elementFromPoint(t.originalEvent.changedTouches[0].pageX-window.pageXOffset,t.originalEvent.changedTouches[0].pageY-window.pageYOffset)),r.is_drag)t.target!==r.target&&n(r.target).off("click.vakata"),n.vakata.dnd._trigger("stop",t);else if("touchend"===t.type&&t.target===r.target){var u=setTimeout(function(){n(t.target).trigger("click")},100);n(t.target).one("click",function(){u&&clearTimeout(u)})}return n.vakata.dnd._clean(),!1}}}(n),n.jstree.defaults.massload=null,n.jstree.plugins.massload=function(t,i){this.init=function(n,t){this._data.massload={};i.init.call(this,n,t)};this._load_nodes=function(t,r,u,f){var e=this.settings.massload,h=[],c=this._model.data,s,l,o;if(!u){for(s=0,l=t.length;l>s;s++)c[t[s]]&&(c[t[s]].state.loaded||c[t[s]].state.failed)&&!f||(h.push(t[s]),o=this.get_node(t[s],!0),o&&o.length&&o.addClass("jstree-loading").attr("aria-busy",!0));if(this._data.massload={},h.length){if(n.vakata.is_function(e))return e.call(this,h,function(n){var e,s;if(n)for(e in n)n.hasOwnProperty(e)&&(this._data.massload[e]=n[e]);for(e=0,s=t.length;s>e;e++)o=this.get_node(t[e],!0),o&&o.length&&o.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,r,u,f)}.bind(this));if("object"==typeof e&&e&&e.url)return e=n.extend(!0,{},e),n.vakata.is_function(e.url)&&(e.url=e.url.call(this,h)),n.vakata.is_function(e.data)&&(e.data=e.data.call(this,h)),n.ajax(e).done(function(n){var e,s;if(n)for(e in n)n.hasOwnProperty(e)&&(this._data.massload[e]=n[e]);for(e=0,s=t.length;s>e;e++)o=this.get_node(t[e],!0),o&&o.length&&o.removeClass("jstree-loading").attr("aria-busy",!1);i._load_nodes.call(this,t,r,u,f)}.bind(this)).fail(function(){i._load_nodes.call(this,t,r,u,f)}.bind(this))}}return i._load_nodes.call(this,t,r,u,f)};this._load_node=function(t,r){var u=this._data.massload[t.id],e=null,f;return u?(e=this["string"==typeof u?"_append_html_data":"_append_json_data"](t,"string"==typeof u?n(n.parseHTML(u)).filter(function(){return 3!==this.nodeType}):u,function(n){r.call(this,n)}),f=this.get_node(t.id,!0),f&&f.length&&f.removeClass("jstree-loading").attr("aria-busy",!1),delete this._data.massload[t.id],e):i._load_node.call(this,t,r)}},n.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,show_only_matches_children:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},n.jstree.plugins.search=function(i,r){this.bind=function(){r.bind.call(this);this._data.search.str="";this._data.search.dom=n();this._data.search.res=[];this._data.search.opn=[];this._data.search.som=!1;this._data.search.smc=!1;this._data.search.hdn=[];this.element.on("search.jstree",function(t,i){if(this._data.search.som&&i.res.length){for(var u=this._model.data,f=[],e,s,r=0,o=i.res.length;o>r;r++)if(u[i.res[r]]&&!u[i.res[r]].state.hidden&&(f.push(i.res[r]),f=f.concat(u[i.res[r]].parents),this._data.search.smc))for(e=0,s=u[i.res[r]].children_d.length;s>e;e++)u[u[i.res[r]].children_d[e]]&&!u[u[i.res[r]].children_d[e]].state.hidden&&f.push(u[i.res[r]].children_d[e]);f=n.vakata.array_remove_item(n.vakata.array_unique(f),n.jstree.root);this._data.search.hdn=this.hide_all(!0);this.show_node(f,!0);this.redraw(!0)}}.bind(this)).on("clear_search.jstree",function(n,t){this._data.search.som&&t.res.length&&(this.show_node(this._data.search.hdn,!0),this.redraw(!0))}.bind(this))};this.search=function(i,r,u,f,e,o){if(i===!1||""===n.vakata.trim(i.toString()))return this.clear_search();f=this.get_node(f);f=f&&f.id?f.id:null;i=i.toString();var h=this.settings.search,s=h.ajax?h.ajax:!1,v=this._model.data,y=null,a=[],c=[],l,p;if(this._data.search.res.length&&!e&&this.clear_search(),u===t&&(u=h.show_only_matches),o===t&&(o=h.show_only_matches_children),!r&&s!==!1)return n.vakata.is_function(s)?s.call(this,i,function(t){t&&t.d&&(t=t.d);this._load_nodes(n.vakata.is_array(t)?n.vakata.array_unique(t):[],function(){this.search(i,!0,u,f,e,o)})}.bind(this),f):(s=n.extend({},s),s.data||(s.data={}),s.data.str=i,f&&(s.data.inside=f),this._data.search.lastRequest&&this._data.search.lastRequest.abort(),this._data.search.lastRequest=n.ajax(s).fail(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(s)};this.settings.core.error.call(this,this._data.core.last_error)}.bind(this)).done(function(t){t&&t.d&&(t=t.d);this._load_nodes(n.vakata.is_array(t)?n.vakata.array_unique(t):[],function(){this.search(i,!0,u,f,e,o)})}.bind(this)),this._data.search.lastRequest);if(e||(this._data.search.str=i,this._data.search.dom=n(),this._data.search.res=[],this._data.search.opn=[],this._data.search.som=u,this._data.search.smc=o),y=new n.vakata.search(i,!0,{caseSensitive:h.case_sensitive,fuzzy:h.fuzzy}),n.each(v[f?f:n.jstree.root].children_d,function(n,t){var r=v[t];r.text&&!r.state.hidden&&(!h.search_leaves_only||r.state.loaded&&0===r.children.length)&&(h.search_callback&&h.search_callback.call(this,i,r)||!h.search_callback&&y.search(r.text).isMatch)&&(a.push(t),c=c.concat(r.parents))}),a.length){for(c=n.vakata.array_unique(c),l=0,p=c.length;p>l;l++)c[l]!==n.jstree.root&&v[c[l]]&&this.open_node(c[l],null,0)===!0&&this._data.search.opn.push(c[l]);e?(this._data.search.dom=this._data.search.dom.add(n(this.element[0].querySelectorAll("#"+n.map(a,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #")))),this._data.search.res=n.vakata.array_unique(this._data.search.res.concat(a))):(this._data.search.dom=n(this.element[0].querySelectorAll("#"+n.map(a,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=a);this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")}this.trigger("search",{nodes:this._data.search.dom,str:i,res:this._data.search.res,show_only_matches:u})};this.clear_search=function(){this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0);this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res});this._data.search.res.length&&(this._data.search.dom=n(this.element[0].querySelectorAll("#"+n.map(this._data.search.res,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(n.jstree.idregex,"\\$&"):t.replace(n.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"));this._data.search.str="";this._data.search.res=[];this._data.search.opn=[];this._data.search.dom=n()};this.redraw_node=function(t){if(t=r.redraw_node.apply(this,arguments),t&&-1!==n.inArray(t.id,this._data.search.res)){for(var u=null,i=0,f=t.childNodes.length;f>i;i++)if(t.childNodes[i]&&t.childNodes[i].className&&-1!==t.childNodes[i].className.indexOf("jstree-anchor")){u=t.childNodes[i];break}u&&(u.className+=" jstree-search")}return t}},function(n){n.vakata.search=function(t,i,r){r=r||{};r=n.extend({},n.vakata.search.defaults,r);r.fuzzy!==!1&&(r.fuzzy=!0);t=r.caseSensitive?t:t.toLowerCase();var f=r.location,s=r.distance,l=r.threshold,u=t.length,h,c,e,o;return u>32&&(r.fuzzy=!1),r.fuzzy&&(h=1<<u-1,c=function(){for(var i={},n=0,n=0;u>n;n++)i[t.charAt(n)]=0;for(n=0;u>n;n++)i[t.charAt(n)]|=1<<u-n-1;return i}(),e=function(n,t){var i=n/u,r=Math.abs(f-t);return s?i+r/s:r?1:i}),o=function(n){if(n=r.caseSensitive?n:n.toLowerCase(),t===n||-1!==n.indexOf(t))return{isMatch:!0,score:0};if(!r.fuzzy)return{isMatch:!1,score:1};var a,i,tt=n.length,v=l,o=n.indexOf(t,f),p,s,w=u+tt,b,g,k,y,nt,d=1,it=[];for(-1!==o&&(v=Math.min(e(0,o),v),o=n.lastIndexOf(t,f+u),-1!==o&&(v=Math.min(e(0,o),v))),o=-1,a=0;u>a;a++){for(p=0,s=w;s>p;)e(a,f+s)<=v?p=s:w=s,s=Math.floor((w-p)/2+p);for(w=s,g=Math.max(1,f-s+1),k=Math.min(f+s,tt)+u,y=new Array(k+2),y[k+1]=(1<<a)-1,i=k;i>=g;i--)if(nt=c[n.charAt(i-1)],y[i]=0===a?(y[i+1]<<1|1)&nt:(y[i+1]<<1|1)&nt|(b[i+1]|b[i])<<1|1|b[i+1],y[i]&h&&(d=e(a,i-1),v>=d)){if(v=d,o=i-1,it.push(o),!(o>f))break;g=Math.max(1,2*f-o)}if(e(a+1,f)>v)break;b=y}return{isMatch:o>=0,score:d}},i===!0?{search:o}:o(i)};n.vakata.search.defaults={location:0,distance:100,threshold:.6,fuzzy:!1,caseSensitive:!1}}(n),n.jstree.defaults.sort=function(n,t){return this.get_text(n)>this.get_text(t)?1:-1},n.jstree.plugins.sort=function(n,t){this.bind=function(){t.bind.call(this);this.element.on("model.jstree",function(n,t){this.sort(t.parent,!0)}.bind(this)).on("rename_node.jstree create_node.jstree",function(n,t){this.sort(t.parent||t.node.parent,!1);this.redraw_node(t.parent||t.node.parent,!0)}.bind(this)).on("move_node.jstree copy_node.jstree",function(n,t){this.sort(t.parent,!1);this.redraw_node(t.parent,!0)}.bind(this))};this.sort=function(n,t){var i,r;if(n=this.get_node(n),n&&n.children&&n.children.length&&(n.children.sort(this.settings.sort.bind(this)),t))for(i=0,r=n.children_d.length;r>i;i++)this.sort(n.children_d[i],!1)}},l=!1,n.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree check_node.jstree uncheck_node.jstree",ttl:!1,filter:!1,preserve_loaded:!1},n.jstree.plugins.state=function(t,i){this.bind=function(){i.bind.call(this);var n=function(){this.element.on(this.settings.state.events,function(){l&&clearTimeout(l);l=setTimeout(function(){this.save_state()}.bind(this),100)}.bind(this));this.trigger("state_ready")}.bind(this);this.element.on("ready.jstree",function(){this.element.one("restore_state.jstree",n);this.restore_state()||n()}.bind(this))};this.save_state=function(){var t=this.get_state(),i;this.settings.state.preserve_loaded||delete t.core.loaded;i={state:t,ttl:this.settings.state.ttl,sec:+new Date};n.vakata.storage.set(this.settings.state.key,JSON.stringify(i))};this.restore_state=function(){var t=n.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(i){return!1}return t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(t&&t.state&&(t=t.state),t&&n.vakata.is_function(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.settings.state.preserve_loaded||delete t.core.loaded,this.element.one("set_state.jstree",function(i,r){r.instance.trigger("restore_state",{state:n.extend(!0,{},t)})}),this.set_state(t),!0):!1)};this.clear_state=function(){return n.vakata.storage.del(this.settings.state.key)}},function(n){n.vakata.storage={set:function(n,t){return window.localStorage.setItem(n,t)},get:function(n){return window.localStorage.getItem(n)},del:function(n){return window.localStorage.removeItem(n)}}}(n),n.jstree.defaults.types={"default":{}},n.jstree.defaults.types[n.jstree.root]={},n.jstree.plugins.types=function(i,r){this.init=function(i,u){var f,e;if(u&&u.types&&u.types["default"])for(f in u.types)if("default"!==f&&f!==n.jstree.root&&u.types.hasOwnProperty(f))for(e in u.types["default"])u.types["default"].hasOwnProperty(e)&&u.types[f][e]===t&&(u.types[f][e]=u.types["default"][e]);r.init.call(this,i,u);this._model.data[n.jstree.root].type=n.jstree.root};this.refresh=function(t,i){r.refresh.call(this,t,i);this._model.data[n.jstree.root].type=n.jstree.root};this.bind=function(){this.element.on("model.jstree",function(i,r){for(var f=this._model.data,e=r.nodes,s=this.settings.types,o="default",h,u=0,c=e.length;c>u;u++){if(o="default",f[e[u]].original&&f[e[u]].original.type&&s[f[e[u]].original.type]&&(o=f[e[u]].original.type),f[e[u]].data&&f[e[u]].data.jstree&&f[e[u]].data.jstree.type&&s[f[e[u]].data.jstree.type]&&(o=f[e[u]].data.jstree.type),f[e[u]].type=o,f[e[u]].icon===!0&&s[o].icon!==t&&(f[e[u]].icon=s[o].icon),s[o].li_attr!==t&&"object"==typeof s[o].li_attr)for(h in s[o].li_attr)if(s[o].li_attr.hasOwnProperty(h)){if("id"===h)continue;f[e[u]].li_attr[h]===t?f[e[u]].li_attr[h]=s[o].li_attr[h]:"class"===h&&(f[e[u]].li_attr["class"]=s[o].li_attr["class"]+" "+f[e[u]].li_attr["class"])}if(s[o].a_attr!==t&&"object"==typeof s[o].a_attr)for(h in s[o].a_attr)if(s[o].a_attr.hasOwnProperty(h)){if("id"===h)continue;f[e[u]].a_attr[h]===t?f[e[u]].a_attr[h]=s[o].a_attr[h]:"href"===h&&"#"===f[e[u]].a_attr[h]?f[e[u]].a_attr.href=s[o].a_attr.href:"class"===h&&(f[e[u]].a_attr["class"]=s[o].a_attr["class"]+" "+f[e[u]].a_attr["class"])}}f[n.jstree.root].type=n.jstree.root}.bind(this));r.bind.call(this)};this.get_json=function(t,i,u){var e,s,o=this._model.data,h=i?n.extend(!0,{},i,{no_id:!1}):{},f=r.get_json.call(this,t,h,u);if(f===!1)return!1;if(n.vakata.is_array(f))for(e=0,s=f.length;s>e;e++)f[e].type=f[e].id&&o[f[e].id]&&o[f[e].id].type?o[f[e].id].type:"default",i&&i.no_id&&(delete f[e].id,f[e].li_attr&&f[e].li_attr.id&&delete f[e].li_attr.id,f[e].a_attr&&f[e].a_attr.id&&delete f[e].a_attr.id);else f.type=f.id&&o[f.id]&&o[f.id].type?o[f.id].type:"default",i&&i.no_id&&(f=this._delete_ids(f));return f};this._delete_ids=function(t){if(n.vakata.is_array(t)){for(var i=0,r=t.length;r>i;i++)t[i]=this._delete_ids(t[i]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.a_attr&&t.a_attr.id&&delete t.a_attr.id,t.children&&n.vakata.is_array(t.children)&&(t.children=this._delete_ids(t.children)),t};this.check=function(i,u,f,e,o){if(r.check.call(this,i,u,f,e,o)===!1)return!1;u=u&&u.id?u:this.get_node(u);f=f&&f.id?f:this.get_node(f);var c=u&&u.id?o&&o.origin?o.origin:n.jstree.reference(u.id):null,s,h,l,a;switch(c=c&&c._model&&c._model.data?c._model.data:null,i){case"create_node":case"move_node":case"copy_node":if("move_node"!==i||-1===n.inArray(u.id,f.children)){if(s=this.get_rules(f),s.max_children!==t&&-1!==s.max_children&&s.max_children===f.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;if(s.valid_children!==t&&-1!==s.valid_children&&-1===n.inArray(u.type||"default",s.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;if(c&&u.children_d&&u.parents){for(h=0,l=0,a=u.children_d.length;a>l;l++)h=Math.max(h,c[u.children_d[l]].parents.length);h=h-u.parents.length+1}(0>=h||h===t)&&(h=1);do{if(s.max_depth!==t&&-1!==s.max_depth&&s.max_depth<h)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+i,data:JSON.stringify({chk:i,pos:e,obj:u&&u.id?u.id:!1,par:f&&f.id?f.id:!1})},!1;f=this.get_node(f.parent);s=this.get_rules(f);h++}while(f)}}return!0};this.get_rules=function(n){if(n=this.get_node(n),!n)return!1;var i=this.get_type(n,!0);return i.max_depth===t&&(i.max_depth=-1),i.max_children===t&&(i.max_children=-1),i.valid_children===t&&(i.valid_children=-1),i};this.get_type=function(t,i){return t=this.get_node(t),t?i?n.extend({type:t.type},this.settings.types[t.type]):t.type:!1};this.set_type=function(i,r){var o=this._model.data,f,c,a,e,l,u,h,s;if(n.vakata.is_array(i)){for(i=i.slice(),c=0,a=i.length;a>c;c++)this.set_type(i[c],r);return!0}if(f=this.settings.types,i=this.get_node(i),!f[r]||!i)return!1;if(h=this.get_node(i,!0),h&&h.length&&(s=h.children(".jstree-anchor")),e=i.type,l=this.get_icon(i),i.type=r,(l===!0||!f[e]||f[e].icon!==t&&l===f[e].icon)&&this.set_icon(i,f[r].icon!==t?f[r].icon:!0),f[e]&&f[e].li_attr!==t&&"object"==typeof f[e].li_attr)for(u in f[e].li_attr)if(f[e].li_attr.hasOwnProperty(u)){if("id"===u)continue;"class"===u?(o[i.id].li_attr["class"]=(o[i.id].li_attr["class"]||"").replace(f[e].li_attr[u],""),h&&h.removeClass(f[e].li_attr[u])):o[i.id].li_attr[u]===f[e].li_attr[u]&&(o[i.id].li_attr[u]=null,h&&h.removeAttr(u))}if(f[e]&&f[e].a_attr!==t&&"object"==typeof f[e].a_attr)for(u in f[e].a_attr)if(f[e].a_attr.hasOwnProperty(u)){if("id"===u)continue;"class"===u?(o[i.id].a_attr["class"]=(o[i.id].a_attr["class"]||"").replace(f[e].a_attr[u],""),s&&s.removeClass(f[e].a_attr[u])):o[i.id].a_attr[u]===f[e].a_attr[u]&&("href"===u?(o[i.id].a_attr[u]="#",s&&s.attr("href","#")):(delete o[i.id].a_attr[u],s&&s.removeAttr(u)))}if(f[r].li_attr!==t&&"object"==typeof f[r].li_attr)for(u in f[r].li_attr)if(f[r].li_attr.hasOwnProperty(u)){if("id"===u)continue;o[i.id].li_attr[u]===t?(o[i.id].li_attr[u]=f[r].li_attr[u],h&&("class"===u?h.addClass(f[r].li_attr[u]):h.attr(u,f[r].li_attr[u]))):"class"===u&&(o[i.id].li_attr["class"]=f[r].li_attr[u]+" "+o[i.id].li_attr["class"],h&&h.addClass(f[r].li_attr[u]))}if(f[r].a_attr!==t&&"object"==typeof f[r].a_attr)for(u in f[r].a_attr)if(f[r].a_attr.hasOwnProperty(u)){if("id"===u)continue;o[i.id].a_attr[u]===t?(o[i.id].a_attr[u]=f[r].a_attr[u],s&&("class"===u?s.addClass(f[r].a_attr[u]):s.attr(u,f[r].a_attr[u]))):"href"===u&&"#"===o[i.id].a_attr[u]?(o[i.id].a_attr.href=f[r].a_attr.href,s&&s.attr("href",f[r].a_attr.href)):"class"===u&&(o[i.id].a_attr["class"]=f[r].a_attr["class"]+" "+o[i.id].a_attr["class"],s&&s.addClass(f[r].a_attr[u]))}return!0}},n.jstree.defaults.unique={case_sensitive:!1,trim_whitespace:!1,duplicate:function(n,t){return n+" ("+t+")"}},n.jstree.plugins.unique=function(i,r){this.check=function(t,i,u,f,e){if(r.check.call(this,t,i,u,f,e)===!1)return!1;if(i=i&&i.id?i:this.get_node(i),u=u&&u.id?u:this.get_node(u),!u||!u.children)return!0;for(var s="rename_node"===t?f:i.text,c=[],l=this.settings.unique.case_sensitive,a=this.settings.unique.trim_whitespace,y=this._model.data,h,o=0,v=u.children.length;v>o;o++)h=y[u.children[o]].text,l||(h=h.toLowerCase()),a&&(h=h.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),c.push(h);switch(l||(s=s.toLowerCase()),a&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),t){case"delete_node":return!0;case"rename_node":return h=i.text||"",l||(h=h.toLowerCase()),a&&(h=h.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),o=-1===n.inArray(s,c)||i.text&&h===s,o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"create_node":return o=-1===n.inArray(s,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"copy_node":return o=-1===n.inArray(s,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o;case"move_node":return o=i.parent===u.id&&(!e||!e.is_multi)||-1===n.inArray(s,c),o||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+s+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:f,obj:i&&i.id?i.id:!1,par:u&&u.id?u.id:!1})}),o}return!0};this.create_node=function(i,u,f,e,o){if(!u||u.text===t){if((null===i&&(i=n.jstree.root),i=this.get_node(i),!i)||(f=f===t?"last":f,!f.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i)))return r.create_node.call(this,i,u,f,e,o);u||(u={});var y,c,l,h,p,w=this._model.data,a=this.settings.unique.case_sensitive,v=this.settings.unique.trim_whitespace,b=this.settings.unique.duplicate,s;for(c=y=this.get_string("New node"),l=[],h=0,p=i.children.length;p>h;h++)s=w[i.children[h]].text,a||(s=s.toLowerCase()),v&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")),l.push(s);for(h=1,s=c,a||(s=s.toLowerCase()),v&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));-1!==n.inArray(s,l);)c=b.call(this,y,++h).toString(),s=c,a||(s=s.toLowerCase()),v&&(s=s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""));u.text=c}return r.create_node.call(this,i,u,f,e,o)}},s=i.createElement("DIV"),s.setAttribute("unselectable","on"),s.setAttribute("role","presentation"),s.className="jstree-wholerow",s.innerHTML="&#160;",n.jstree.plugins.wholerow=function(t,i){this.bind=function(){i.bind.call(this);this.element.on("ready.jstree set_state.jstree",function(){this.hide_dots()}.bind(this)).on("init.jstree loading.jstree ready.jstree",function(){this.get_container_ul().addClass("jstree-wholerow-ul")}.bind(this)).on("deselect_all.jstree",function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")}.bind(this)).on("changed.jstree",function(n,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var i=!1,r=0,u=t.selected.length;u>r;r++)i=this.get_node(t.selected[r],!0),i&&i.length&&i.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("open_node.jstree",function(n,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")}.bind(this)).on("hover_node.jstree dehover_node.jstree",function(n,t){"hover_node"===n.type&&this.is_disabled(t.node)||this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===n.type?"addClass":"removeClass"]("jstree-wholerow-hovered")}.bind(this)).on("contextmenu.jstree",".jstree-wholerow",function(t){if(this._data.contextmenu){t.preventDefault();var i=n.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i)}}.bind(this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=n.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).trigger("focus")}).on("dblclick.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var i=n.Event("dblclick",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).trigger("focus")}).on("click.jstree",".jstree-leaf > .jstree-ocl",function(t){t.stopImmediatePropagation();var i=n.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});n(t.currentTarget).closest(".jstree-node").children(".jstree-anchor").first().trigger(i).trigger("focus")}.bind(this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",function(n){return n.stopImmediatePropagation(),this.is_disabled(n.currentTarget)||this.hover_node(n.currentTarget),!1}.bind(this)).on("mouseleave.jstree",".jstree-node",function(n){this.dehover_node(n.currentTarget)}.bind(this))};this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove();i.teardown.call(this)};this.redraw_node=function(t){if(t=i.redraw_node.apply(this,arguments)){var r=s.cloneNode(!0);-1!==n.inArray(t.id,this._data.core.selected)&&(r.className+=" jstree-wholerow-clicked");this._data.core.focused&&this._data.core.focused===t.id&&(r.className+=" jstree-wholerow-hovered");t.insertBefore(r,t.childNodes[0])}return t}},window.customElements&&Object&&Object.create){v=Object.create(HTMLElement.prototype);v.createdCallback=function(){var i={core:{},plugins:[]};for(var t in n.jstree.plugins)n.jstree.plugins.hasOwnProperty(t)&&this.attributes[t]&&(i.plugins.push(t),this.getAttribute(t)&&JSON.parse(this.getAttribute(t))&&(i[t]=JSON.parse(this.getAttribute(t))));for(t in n.jstree.defaults.core)n.jstree.defaults.core.hasOwnProperty(t)&&this.attributes[t]&&(i.core[t]=JSON.parse(this.getAttribute(t))||this.getAttribute(t));n(this).jstree(i)};try{window.customElements.define("vakata-jstree",function(){},{prototype:v})}catch(b){}}}});hexcase=0;b64pad="";
/*
 RichText: WYSIWYG editor developed as jQuery plugin
 @name RichText
 @author https://github.com/webfashionist - Bob Schockweiler - richtext@webfashion.eu
 @license GNU AFFERO GENERAL PUBLIC LICENSE Version 3
 @preserve
 Copyright (C) 2020 Bob Schockweiler ( richtext@webfashion.eu )
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as published
 by the Free Software Foundation, either version 3 of the License, or
 (at your option) any later version.
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.
 You should have received a copy of the GNU Affero General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
(function(n){n.fn.richText=function(t){function cr(){var c,s,h="",p,t;i.useParagraph!==!1&&document.execCommand("DefaultParagraphSeparator",!1,"p");f.prop("tagName")==="TEXTAREA"||(f.val()?(c=f.val(),s=f.prop("attributes"),n.each(s,function(){this.name&&(h+=" "+this.name+'="'+this.value+'"')}),f.replaceWith(n("<textarea"+h+' data-richtext="init">'+c+"<\/textarea>")),f=n('[data-richtext="init"]'),f.removeAttr("data-richtext")):f.html()?(c=f.html(),s=f.prop("attributes"),n.each(s,function(){this.name&&(h+=" "+this.name+'="'+this.value+'"')}),f.replaceWith(n("<textarea"+h+' data-richtext="init">'+c+"<\/textarea>")),f=n('[data-richtext="init"]'),f.removeAttr("data-richtext")):(s=f.prop("attributes"),n.each(s,function(){this.name&&(h+=" "+this.name+'="'+this.value+'"')}),f.replaceWith(n("<textarea"+h+' data-richtext="init"><\/textarea>')),f=n('[data-richtext="init"]'),f.removeAttr("data-richtext")));r=n("<div />",{"class":"richText"});var a=n("<div />",{"class":"richText-toolbar"}),v=n("<div />",{"class":"richText-editor",id:u,contenteditable:!0}),y=f.prop("tabindex");y>=0&&i.useTabForNext===!0&&v.attr("tabindex",y);a.append(e);i.$editor=r;i.bold===!0&&e.append(o.clone().append(gi));i.italic===!0&&e.append(o.clone().append(nr));i.underline===!0&&e.append(o.clone().append(tr));i.leftAlign===!0&&e.append(o.clone().append(rr));i.centerAlign===!0&&e.append(o.clone().append(ur));i.rightAlign===!0&&e.append(o.clone().append(fr));i.justify===!0&&e.append(o.clone().append(ir));i.ol===!0&&e.append(o.clone().append(er));i.ul===!0&&e.append(o.clone().append(or));i.fonts===!0&&i.fontList.length>0&&e.append(o.clone().append(ui));i.fontSize===!0&&e.append(o.clone().append(ei));i.heading===!0&&e.append(o.clone().append(ri));i.fontColor===!0&&e.append(o.clone().append(fi));i.imageUpload===!0&&e.append(o.clone().append(oi));i.fileUpload===!0&&e.append(o.clone().append(hi));i.videoEmbed===!0&&e.append(o.clone().append(si));i.urls===!0&&e.append(o.clone().append(ci));i.table===!0&&e.append(o.clone().append(li));i.removeStyles===!0&&e.append(o.clone().append(sr));i.code===!0&&e.append(o.clone().append(hr));v.html(f.val());r.append(a);r.append(v);r.append(f.clone().hide());f.replaceWith(r);r.append(n("<div />",{"class":"richText-toolbar"}).append(n("<a />",{"class":"richText-undo is-disabled",html:'<span class="fa fa-undo"><\/span>',title:i.translations.undo})).append(n("<a />",{"class":"richText-redo is-disabled",html:'<span class="fa fa-repeat fa-redo"><\/span>',title:i.translations.redo})).append(n("<a />",{"class":"richText-help",html:'<span class="fa fa-question-circle"><\/span>'})));i.maxlength>0&&(r.data("maxlength",i.maxlength),r.children(".richText-toolbar").children(".richText-help").before(n("<a />",{"class":"richText-length",text:"0/"+i.maxlength})));i.height&&i.height>0?r.children(".richText-editor, .richText-initial").css({"min-height":i.height+"px",height:i.height+"px"}):i.heightPercentage&&i.heightPercentage>0&&(p=r.parent().innerHeight(),t=i.heightPercentage/100*p,t-=a.outerHeight()*2,t-=parseInt(r.css("margin-top")),t-=parseInt(r.css("margin-bottom")),t-=parseInt(r.find(".richText-editor").css("padding-top")),t-=parseInt(r.find(".richText-editor").css("padding-bottom")),r.children(".richText-editor, .richText-initial").css({"min-height":t+"px",height:t+"px"}));i.class&&r.addClass(i.class);i.id&&r.attr("id",i.id);di();l[u].push(r.find("textarea").val());i.callback&&typeof i.callback=="function"&&i.callback(r)}function lr(){var n,t,i;document.activeElement&&(n=Array.prototype.filter.call(document.querySelectorAll('a:not([disabled]):not(.richText-btn,.richText-undo,.richText-redo,.richText-help), button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), [tabindex]:not([disabled]):not([tabindex="-1"])'),function(n){return n.offsetWidth>0||n.offsetHeight>0||n===document.activeElement}),t=n.indexOf(document.activeElement),t>-1&&(i=n[t+1]||n[0],i.focus()))}function ai(n,t,r){var u,f;typeof t=="undefined"&&(t=null);wi(r);n==="heading"&&at()?d("<"+t+">"+at()+"<\/"+t+">"):n==="fontSize"&&parseInt(t)>0?(u=at(),u=(u+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1<br>$2"),f=i.useSingleQuotes?"<span style='font-size:"+t+"px;'>"+u+"<\/span>":'<span style="font-size:'+t+'px;">'+u+"<\/span>",d(f)):document.execCommand(n,!1,t)}function ct(){var r=n("#"+u),t=r.html();i.useSingleQuotes===!0&&(t=bi(t));r.siblings(".richText-initial").val(t)}function ar(t){var i=n("#"+t),r=i.siblings(".richText-initial").val();i.html(r)}function vr(t){var s=document.getElementById(t),r,i,u,o,f,e;return window.getSelection&&document.createRange&&(f=window.getSelection&&window.getSelection(),f&&f.rangeCount>0&&n(f.anchorNode).parents("#"+t).length>0)?(r=window.getSelection().getRangeAt(0),e=r.cloneRange(),e.selectNodeContents(s),e.setEnd(r.startContainer,r.startOffset),i=e.toString().length,u=i+r.toString().length,o=i===u?"caret":"selection",anchor=f.anchorNode,i=o==="caret"&&anchor!==!1?i:e.toString().length,u=o==="caret"&&anchor!==!1?u:i+r.toString().length,{start:i,end:u,type:o,anchor:anchor,editorID:t}):w?w:{start:0,end:0}}function k(t,i,r){var f=document.getElementById(t),u=w,e,o,h,l,a;if(u||(u={start:0,end:0,type:"caret",editorID:t,anchor:n("#"+t).children("div")[0]}),u.editorID!==t)return!1;if(i===!0?f=u.anchor?u.anchor:f:r===!0&&u.start===0&&u.end===0&&(f=u.anchor?u.anchor:f),window.getSelection&&document.createRange){if(e=0,o=document.createRange(),!o||!f)return window.getSelection().removeAllRanges(),!0;o.setStart(f,0);o.collapse(!0);for(var v=[f],s,c=!1,y=!1;!y&&(s=v.pop());)if(s.nodeType===3)h=e+s.length,!c&&u.start>=e&&u.start<=h&&(o.setStart(s,u.start-e),c=!0),c&&u.end>=e&&u.end<=h&&(o.setEnd(s,u.end-e),y=!0),e=h;else for(l=s.childNodes.length;l--;)v.push(s.childNodes[l]);a=window.getSelection();a.removeAllRanges();a.addRange(o)}}function vi(t,i){var r,u,f,e;if(i.keyCode!==9)return!1;if(t.getSelection&&(r=t.getSelection(),r.rangeCount>0)){if(u=null,f=null,i.shiftKey?(f="previous",u=r.focusNode.nodeName==="TD"?r.focusNode.previousSibling!=null?r.focusNode.previousSibling:r.focusNode.parentNode.previousSibling!=null?r.focusNode.parentNode.previousSibling.childNodes[r.focusNode.parentNode.previousSibling.childNodes.length-1]:null:r.focusNode.parentNode.previousSibling!=null?r.focusNode.parentNode.previousSibling:r.focusNode.parentNode.parentNode.previousSibling!=null?r.focusNode.parentNode.parentNode.previousSibling.childNodes[r.focusNode.parentNode.parentNode.previousSibling.childNodes.length-1]:null):(f="next",u=r.focusNode.nodeName==="TD"?r.focusNode.nextSibling!=null?r.focusNode.nextSibling:r.focusNode.parentNode.nextSibling!=null?r.focusNode.parentNode.nextSibling.childNodes[0]:null:r.focusNode.parentNode.nextSibling!=null?r.focusNode.parentNode.nextSibling:r.focusNode.parentNode.parentNode.nextSibling!=null?r.focusNode.parentNode.parentNode.nextSibling.childNodes[0]:null),u!=null)return r.collapse(u,Math.min(u.length,r.focusOffset+1)),u.textContent!=null&&r.selectAllChildren(u),i.preventDefault(),!0;if(u===null&&f==="next"&&r.focusNode.nodeName==="TD"){var o=n(r.focusNode).parents("table"),h=o.find("tr").first().children("td").length,s=n("<tr />"),c=n("<td />");for(e=1;e<=h;e++)s.append(c.clone());o.append(s);vi(window,{keyCode:9,shiftKey:!1,preventDefault:function(){}})}}return!1}function at(){var n;return window.getSelection?(n=window.getSelection(),n.toString()?n.toString():n.focusNode.nodeValue):document.selection.createRange?(n=document.selection.createRange(),n.text):!1}function ti(t){var i=n(".richText-editor#"+t).siblings(".richText-initial");yr(i.val(),t);w=vr(t)}function yi(t){var f=n(".richText-editor#"+t),i=f.parents(".richText");if(!i.data("maxlength"))return!0;var e,r=parseInt(i.data("maxlength")),u=f.text(),o=u.length/r*100;return(e=o>99?"red":o>=90?"orange":"black",i.find(".richText-length").html('<span class="'+e+'">'+u.length+"<\/span>/"+r),u.length>r)?(pi(i),!1):!0}function yr(n,t){if(!l[t])return!1;l[t].length-1>c[t]&&(l[t].length=c[t]+1);l[t][l[t].length-1]!==n&&l[t].push(n);c[t]=l[t].length-1;ii(t)}function ii(n){c[n]<=0?r.find(".richText-undo").addClass("is-disabled"):r.find(".richText-undo").removeClass("is-disabled");c[n]>=l[n].length-1||l[n].length===0?r.find(".richText-redo").addClass("is-disabled"):r.find(".richText-redo").removeClass("is-disabled")}function pi(n){var t=n.children(".richText-editor").attr("id"),i;if(c[t]--,!c[t]&&c[t]!==0)return!1;i=l[t][c[t]];n.find("textarea").val(i);n.find(".richText-editor").html(i);ii(t)}function pr(n){var t=n.children(".richText-editor").attr("id"),i;if(c[t]++,!c[t]&&c[t]!==0)return!1;i=l[t][c[t]];n.find("textarea").val(i);n.find(".richText-editor").html(i);ii(t)}function wi(n){w&&k(n?n:w.editorID)}function d(n){var i,t,r,u,e,f;if(window.getSelection){if(i=window.getSelection(),i.getRangeAt&&i.rangeCount){for(t=i.getRangeAt(0),t.deleteContents(),r=document.createElement("div"),r.innerHTML=n,u=document.createDocumentFragment();e=r.firstChild;)f=u.appendChild(e);t.insertNode(u);f&&(t=t.cloneRange(),t.setStartAfter(f),t.collapse(!0),i.removeAllRanges(),i.addRange(t))}}else document.selection&&document.selection.type!=="Control"&&document.selection.createRange().pasteHTML(n)}function bi(n){if(!n)return"";var t,r;return i.useSingleQuotes===!0?(t=/\s+(\w+\s*=\s*(["][^"]*["])|(['][^']*[']))+/g,r=n.replace(t,function(n,t,i){return i?n.replace(i,i.replace(/\"/g,"'")):n})):(t=/\s+(\w+\s*=\s*(['][^']*['])|(["][^"]*["]))+/g,r=n.replace(t,function(n,t,i){return i?n.replace(i,i.replace(/'/g,'"')):n})),r}function wr(n){var t=[],u="",r;t["#FFFFFF"]=i.translations.white;t["#000000"]=i.translations.black;t["#7F6000"]=i.translations.brown;t["#938953"]=i.translations.beige;t["#1F497D"]=i.translations.darkBlue;t.blue=i.translations.blue;t["#4F81BD"]=i.translations.lightBlue;t["#953734"]=i.translations.darkRed;t.red=i.translations.red;t["#4F6128"]=i.translations.darkGreen;t.green=i.translations.green;t["#3F3151"]=i.translations.purple;t["#31859B"]=i.translations.darkTurquois;t["#4BACC6"]=i.translations.turquois;t["#E36C09"]=i.translations.darkOrange;t["#F79646"]=i.translations.orange;t["#FFFF00"]=i.translations.yellow;i.colors&&i.colors.length>0&&(t=i.colors);for(r in t)u+='<li class="inline"><a data-command="'+n+'" data-option="'+r+'" style="text-align:left;" title="'+t[r]+'"><span class="box-color" style="background-color:'+r+'"><\/span><\/a><\/li>';return u}function br(t){wi(t);r.find(".richText-editor").is(":visible")?(r.find(".richText-initial").show(),r.find(".richText-editor").hide(),n(".richText-toolbar").find(".richText-btn").each(function(){n(this).children(".fa-code").length===0&&n(this).parent("li").attr("data-disable","true")}),ki(t,w)):(r.find(".richText-initial").hide(),r.find(".richText-editor").show(),ki(t,w,!0),n(".richText-toolbar").find("li").removeAttr("data-disable"))}function ki(t,i,r){var o=n("#"+t),s=o.siblings(".richText-initial"),e=s.val(),u,f;if(!i||!e)return{start:0,end:0};if(r===!0)return w={start:o.text().length,end:o.text().length,editorID:t},k(t),!0;for(i.node=s[0],u={start:!1,end:!1,tag:!1,isTag:!1,tagsCount:0,isHighlight:i.start!==i.end},f=0;f<e.length;f++)e[f]==="<"?(u.isTag=!0,u.tag=!1,u.tagsCount++):u.isTag===!0&&e[f]!==">"?u.tagsCount++:u.isTag===!0&&e[f]===">"?(u.isTag=!1,u.tag=!0,u.tagsCount++):u.tag===!0&&(u.tag=!1),r||(i.start+u.tagsCount<=f&&u.isHighlight&&!u.isTag&&!u.tag&&!u.start?(i.start=f,u.start=!0):!(i.start+u.tagsCount<=f+1)||u.isHighlight||u.isTag||u.tag||u.start||(i.start=f+1,u.start=!0),i.end+u.tagsCount<=f+1&&!u.isTag&&!u.tag&&!u.end&&(i.end=f+1,u.end=!0));return kr(i.node,i.start,i.end),i}function kr(n,t,i){if(n.createTextRange){var r=n.createTextRange();r.collapse(!0);r.moveStart("character",t);r.moveEnd("character",i);r.select();n.focus()}else n.setSelectionRange?(n.focus(),n.setSelectionRange(t,i)):typeof n.selectionStart!="undefined"&&(n.selectionStart=t,n.selectionEnd=i,n.focus())}function dr(n,t){var u=gr(n),f=!1,e=!1,r,o,s;return u?(t?t!=="responsive"?t=t.split("x"):(f=!0,t="640x360",t=t.split("x")):(t="640x360",t=t.split("x")),r="<br><br>",f===!0&&(r+='<div class="videoEmbed" style="position:relative;height:0;padding-bottom:56.25%">'),o="webkitallowfullscreen mozallowfullscreen allowfullscreen",u.platform==="YouTube"?(s=i.youtubeCookies?"www.youtube.com":"www.youtube-nocookie.com",r+='<iframe src="https://'+s+"/embed/"+u.id+'?ecver=2" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(f===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"><\/iframe>",e=!0):u.platform==="Vimeo"?(r+='<iframe src="https://player.vimeo.com/video/'+u.id+'" width="'+t[0]+'" height="'+t[1]+'" frameborder="0"'+(f===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"><\/iframe>",e=!0):u.platform==="Facebook"?(r+='<iframe src="https://www.facebook.com/plugins/video.php?href='+encodeURI(n)+"&show_text=0&width="+t[0]+'" width="'+t[0]+'" height="'+t[1]+'" style="'+(f===!0?'position:absolute;width:100%;height:100%;left:0;border:none;overflow:hidden"':"border:none;overflow:hidden")+'" scrolling="no" frameborder="0" allowTransparency="true" '+o+"><\/iframe>",e=!0):u.platform==="Dailymotion"&&(r+='<iframe frameborder="0" width="'+t[0]+'" height="'+t[1]+'" src="//www.dailymotion.com/embed/video/'+u.id+'"'+(f===!0?' style="position:absolute;width:100%;height:100%;left:0"':"")+" "+o+"><\/iframe>",e=!0),f===!0&&(r+="<\/div>"),r+="<br><br>",e)?r:!1:!1}function gr(n){var t=n.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/),i=n.match(/(?:http?s?:\/\/)?(?:www\.)?(?:vimeo\.com)\/?(.+)/),r=n.match(/(?:http?s?:\/\/)?(?:www\.)?(?:facebook\.com)\/.*\/videos\/[0-9]+/),u=n.match(/(?:http?s?:\/\/)?(?:www\.)?(?:dailymotion\.com)\/video\/([a-zA-Z0-9]+)/);return t&&t[2].length===11?{platform:"YouTube",id:t[2]}:i&&i[1]?{platform:"Vimeo",id:i[1]}:r&&r[0]?{platform:"Facebook",id:r[0]}:u&&u[1]?{platform:"Dailymotion",id:u[1]}:!1}function di(){r&&!r.find(".richText-editor").html()?i.useParagraph!==!1?r.find(".richText-editor").html("<p><br><\/p>"):r.find(".richText-editor").html("<div><br><\/div>"):i.useParagraph!==!1?r.find(".richText-editor").find("div:not(.videoEmbed)").replaceWith(function(){return n("<p />",{html:n(this).html()})}):r.find(".richText-editor").find("p").replaceWith(function(){return n("<div />",{html:n(this).html()})});ct()}var i=n.extend({bold:!0,italic:!0,underline:!0,leftAlign:!0,centerAlign:!0,rightAlign:!0,justify:!0,ol:!0,ul:!0,heading:!0,fonts:!0,fontList:["Arial","Arial Black","Comic Sans MS","Courier New","Geneva","Georgia","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman","Verdana"],fontColor:!0,fontSize:!0,imageUpload:!0,fileUpload:!0,videoEmbed:!0,urls:!0,table:!0,removeStyles:!0,code:!0,colors:[],fileHTML:"",imageHTML:"",translations:{title:"Title",white:"White",black:"Black",brown:"Brown",beige:"Beige",darkBlue:"Dark Blue",blue:"Blue",lightBlue:"Light Blue",darkRed:"Dark Red",red:"Red",darkGreen:"Dark Green",green:"Green",purple:"Purple",darkTurquois:"Dark Turquois",turquois:"Turquois",darkOrange:"Dark Orange",orange:"Orange",yellow:"Yellow",imageURL:"Image URL",fileURL:"File URL",linkText:"Link text",url:"URL",size:"Size",responsive:"Responsive",text:"Text",openIn:"Open in",sameTab:"Same tab",newTab:"New tab",align:"Align",left:"Left",justify:"Justify",center:"Center",right:"Right",rows:"Rows",columns:"Columns",add:"Add",pleaseEnterURL:"Please enter an URL",videoURLnotSupported:"Video URL not supported",pleaseSelectImage:"Please select an image",pleaseSelectFile:"Please select a file",bold:"Bold",italic:"Italic",underline:"Underline",alignLeft:"Align left",alignCenter:"Align centered",alignRight:"Align right",addOrderedList:"Add ordered list",addUnorderedList:"Add unordered list",addHeading:"Add Heading/title",addFont:"Add font",addFontColor:"Add font color",addFontSize:"Add font size",addImage:"Add image",addVideo:"Add video",addFile:"Add file",addURL:"Add URL",addTable:"Add table",removeStyles:"Remove styles",code:"Show HTML code",undo:"Undo",redo:"Redo",close:"Close"},youtubeCookies:!1,useSingleQuotes:!1,height:0,heightPercentage:0,id:"","class":"",useParagraph:!1,maxlength:0,callback:undefined,useTabForNext:!1},t),f=n(this),c,g,et,yt,ot,pt,a,wt,bt,nt,kt,st,dt,tt,gt,it,ni,ht;f.addClass("richText-initial");var r,e=n("<ul />"),o=n("<li />"),gi=n("<a />",{"class":"richText-btn","data-command":"bold",title:i.translations.bold,html:'<span class="fa fa-bold"><\/span>'}),nr=n("<a />",{"class":"richText-btn","data-command":"italic",title:i.translations.italic,html:'<span class="fa fa-italic"><\/span>'}),tr=n("<a />",{"class":"richText-btn","data-command":"underline",title:i.translations.underline,html:'<span class="fa fa-underline"><\/span>'}),ir=n("<a />",{"class":"richText-btn","data-command":"justifyFull",title:i.translations.justify,html:'<span class="fa fa-align-justify"><\/span>'}),rr=n("<a />",{"class":"richText-btn","data-command":"justifyLeft",title:i.translations.alignLeft,html:'<span class="fa fa-align-left"><\/span>'}),ur=n("<a />",{"class":"richText-btn","data-command":"justifyCenter",title:i.translations.alignCenter,html:'<span class="fa fa-align-center"><\/span>'}),fr=n("<a />",{"class":"richText-btn","data-command":"justifyRight",title:i.translations.alignRight,html:'<span class="fa fa-align-right"><\/span>'}),er=n("<a />",{"class":"richText-btn","data-command":"insertOrderedList",title:i.translations.addOrderedList,html:'<span class="fa fa-list-ol"><\/span>'}),or=n("<a />",{"class":"richText-btn","data-command":"insertUnorderedList",title:i.translations.addUnorderedList,html:'<span class="fa fa-list"><\/span>'}),ri=n("<a />",{"class":"richText-btn",title:i.translations.addHeading,html:'<span class="fa fa-header fa-heading"><\/span>'}),ui=n("<a />",{"class":"richText-btn",title:i.translations.addFont,html:'<span class="fa fa-font"><\/span>'}),fi=n("<a />",{"class":"richText-btn",title:i.translations.addFontColor,html:'<span class="fa fa-paint-brush"><\/span>'}),ei=n("<a />",{"class":"richText-btn",title:i.translations.addFontSize,html:'<span class="fa fa-text-height"><\/span>'}),oi=n("<a />",{"class":"richText-btn",title:i.translations.addImage,html:'<span class="fa fa-image"><\/span>'}),si=n("<a />",{"class":"richText-btn",title:i.translations.addVideo,html:'<span class="fa fa-video-camera fa-video"><\/span>'}),hi=n("<a />",{"class":"richText-btn",title:i.translations.addFile,html:'<span class="fa fa-file-text-o far fa-file-alt"><\/span>'}),ci=n("<a />",{"class":"richText-btn",title:i.translations.addURL,html:'<span class="fa fa-link"><\/span>'}),li=n("<a />",{"class":"richText-btn",title:i.translations.addTable,html:'<span class="fa fa-table"><\/span>'}),sr=n("<a />",{"class":"richText-btn","data-command":"removeFormat",title:i.translations.removeStyles,html:'<span class="fa fa-recycle"><\/span>'}),hr=n("<a />",{"class":"richText-btn","data-command":"toggleCode",title:i.translations.code,html:'<span class="fa fa-code"><\/span>'}),y=n("<div />",{"class":"richText-dropdown-outer"}),p=n("<span />",{"class":"richText-dropdown-close",html:'<span title="'+i.translations.close+'"><span class="fa fa-times"><\/span><\/span>'}),lt=n("<ul />",{"class":"richText-dropdown"}),rt=n("<div />",{"class":"richText-dropdown"}),ut=n("<div />",{"class":"richText-form"}),h=n("<div />",{"class":"richText-form-item"}),v=n("<label />"),b=n("<input />",{type:"text"}),nu=n("<input />",{type:"file"}),vt=n("<select />"),ft=n("<button />",{text:i.translations.add,"class":"btn"}),w,u="richText-"+Math.random().toString(36).substring(7),s=null,l=[];for(l[u]=[],c=[],c[u]=0,g=lt.clone(),g.append(n("<li />",{html:'<a data-command="formatBlock" data-option="h1">'+i.translations.title+" #1<\/a>"})),g.append(n("<li />",{html:'<a data-command="formatBlock" data-option="h2">'+i.translations.title+" #2<\/a>"})),g.append(n("<li />",{html:'<a data-command="formatBlock" data-option="h3">'+i.translations.title+" #3<\/a>"})),g.append(n("<li />",{html:'<a data-command="formatBlock" data-option="h4">'+i.translations.title+" #4<\/a>"})),ri.append(y.clone().append(g.prepend(p.clone()))),et=i.fontList,yt=lt.clone(),a=0;a<et.length;a++)yt.append(n("<li />",{html:'<a style="font-family:'+et[a]+';" data-command="fontName" data-option="'+et[a]+'">'+et[a]+"<\/a>"}));for(ui.append(y.clone().append(yt.prepend(p.clone()))),ot=[24,18,16,14,12],pt=lt.clone(),a=0;a<ot.length;a++)pt.append(n("<li />",{html:'<a style="font-size:'+ot[a]+'px;" data-command="fontSize" data-option="'+ot[a]+'">'+i.translations.text+" "+ot[a]+"px<\/a>"}));ei.append(y.clone().append(pt.prepend(p.clone())));wt=lt.clone();wt.html(wr("forecolor"));fi.append(y.clone().append(wt.prepend(p.clone())));bt=rt.clone();nt=ut.clone().attr("id","richText-URL").attr("data-editor",u);nt.append(h.clone().append(v.clone().text(i.translations.url).attr("for","url")).append(b.clone().attr("id","url")));nt.append(h.clone().append(v.clone().text(i.translations.text).attr("for","urlText")).append(b.clone().attr("id","urlText")));nt.append(h.clone().append(v.clone().text(i.translations.openIn).attr("for","openIn")).append(vt.clone().attr("id","openIn").append(n("<option />",{value:"_self",text:i.translations.sameTab})).append(n("<option />",{value:"_blank",text:i.translations.newTab}))));nt.append(h.clone().append(ft.clone()));bt.append(nt);ci.append(y.clone().append(bt.prepend(p.clone())));kt=rt.clone();st=ut.clone().attr("id","richText-Video").attr("data-editor",u);st.append(h.clone().append(v.clone().text(i.translations.url).attr("for","videoURL")).append(b.clone().attr("id","videoURL")));st.append(h.clone().append(v.clone().text(i.translations.size).attr("for","size")).append(vt.clone().attr("id","size").append(n("<option />",{value:"responsive",text:i.translations.responsive})).append(n("<option />",{value:"640x360",text:"640x360"})).append(n("<option />",{value:"560x315",text:"560x315"})).append(n("<option />",{value:"480x270",text:"480x270"})).append(n("<option />",{value:"320x180",text:"320x180"}))));st.append(h.clone().append(ft.clone()));kt.append(st);si.append(y.clone().append(kt.prepend(p.clone())));dt=rt.clone();tt=ut.clone().attr("id","richText-Image").attr("data-editor",u);i.imageHTML&&(n(i.imageHTML).find("#imageURL").length>0||n(i.imageHTML).attr("id")==="imageURL")?tt.html(i.imageHTML):(tt.append(h.clone().append(v.clone().text(i.translations.imageURL).attr("for","imageURL")).append(b.clone().attr("id","imageURL"))),tt.append(h.clone().append(v.clone().text(i.translations.align).attr("for","align")).append(vt.clone().attr("id","align").append(n("<option />",{value:"left",text:i.translations.left})).append(n("<option />",{value:"center",text:i.translations.center})).append(n("<option />",{value:"right",text:i.translations.right})))));tt.append(h.clone().append(ft.clone()));dt.append(tt);oi.append(y.clone().append(dt.prepend(p.clone())));gt=rt.clone();it=ut.clone().attr("id","richText-File").attr("data-editor",u);i.fileHTML&&(n(i.fileHTML).find("#fileURL").length>0||n(i.fileHTML).attr("id")==="fileURL")?it.html(i.fileHTML):(it.append(h.clone().append(v.clone().text(i.translations.fileURL).attr("for","fileURL")).append(b.clone().attr("id","fileURL"))),it.append(h.clone().append(v.clone().text(i.translations.linkText).attr("for","fileText")).append(b.clone().attr("id","fileText"))));it.append(h.clone().append(ft.clone()));gt.append(it);hi.append(y.clone().append(gt.prepend(p.clone())));ni=rt.clone();ht=ut.clone().attr("id","richText-Table").attr("data-editor",u);ht.append(h.clone().append(v.clone().text(i.translations.rows).attr("for","tableRows")).append(b.clone().attr("id","tableRows").attr("type","number")));ht.append(h.clone().append(v.clone().text(i.translations.columns).attr("for","tableColumns")).append(b.clone().attr("id","tableColumns").attr("type","number")));ht.append(h.clone().append(ft.clone()));ni.append(ht);li.append(y.clone().append(ni.prepend(p.clone())));cr();i.$editor.find(".richText-help").on("click",function(){var u=n(this).parents(".richText");if(u){var t=n("<div />",{"class":"richText-help-popup",style:"position:absolute;top:0;right:0;bottom:0;left:0;background-color: rgba(0,0,0,0.3);"}),f=n("<div />",{style:"position:relative;margin:60px auto;padding:20px;background-color:#FAFAFA;width:70%;font-family:Calibri,Verdana,Helvetica,sans-serif;font-size:small;"}),r=n("<div />",{html:'<span id="closeHelp" style="display:block;position:absolute;top:0;right:0;padding:10px;cursor:pointer;" title="'+i.translations.close+'"><span class="fa fa-times"><\/span><\/span>'});r.append('<h3 style="margin:0;">RichText<\/h3>');r.append('<hr><br>Powered by <a href="https://github.com/webfashionist/RichText" target="_blank">webfashionist/RichText<\/a> (Github) <br>License: <a href="https://github.com/webfashionist/RichText/blob/master/LICENSE" target="_blank">AGPL-3.0<\/a>');t.append(f.append(r));u.append(t);t.on("click","#closeHelp",function(){n(this).parents(".richText-help-popup").remove()})}});i.$editor.find(".richText-undo, .richText-redo").on("click",function(){var t=n(this);t.hasClass("richText-undo")&&!t.hasClass("is-disabled")?pi(i.$editor):t.hasClass("richText-redo")&&!t.hasClass("is-disabled")&&pr(i.$editor)});i.$editor.find(".richText-editor").on("input change blur keydown keyup",function(t){if((t.keyCode===9||t.keyCode==="9")&&t.type==="keydown")return i.useTabForNext===!0?(lr(),!1):(t.preventDefault(),vi(window,t),!1);di();ct();ti(n(this).attr("id"));yi(n(this).attr("id"))});i.$editor.find(".richText-editor").on("contextmenu",".richText-editor",function(t){var r=n("<ul />",{"class":"list-rightclick richText-list"}),e=n("<li />");n(".richText-editor").find(".richText-editNode").removeClass("richText-editNode");var i=n(t.target),f=i.parents(".richText"),u=f.find(".richText-toolbar"),o=t.pageX-f.offset().left,s=t.pageY-f.offset().top;if(r.css({top:s,left:o}),i.prop("tagName")==="A"){t.preventDefault();r.append(e.clone().html('<span class="fa fa-link"><\/span>'));i.parents(".richText").append(r);r.find(".fa-link").on("click",function(){n(".list-rightclick.richText-list").remove();i.addClass("richText-editNode");var t=u.find("#richText-URL");t.find("input#url").val(i.attr("href"));t.find("input#urlText").val(i.text());t.find("select#openIn").val(i.attr("target"));u.find(".richText-btn").children(".fa-link").parents("li").addClass("is-selected")});return!1}if(i.prop("tagName")==="IMG"){t.preventDefault();r.append(e.clone().html('<span class="fa fa-image"><\/span>'));i.parents(".richText").append(r);r.find(".fa-image").on("click",function(){var r,t;r=i.parent("div").length>0&&i.parent("div").attr("style")==="text-align:center;"?"center":i.attr("align");n(".list-rightclick.richText-list").remove();i.addClass("richText-editNode");t=u.find("#richText-Image");t.find("input#imageURL").val(i.attr("src"));t.find("select#align").val(r);u.find(".richText-btn").children(".fa-image").parents("li").addClass("is-selected")});return!1}});i.$editor.find(".richText-initial").on("input change blur",function(){i.useSingleQuotes===!0&&n(this).val(bi(n(this).val()));var t=n(this).siblings(".richText-editor").attr("id");ar(t);ti(t);yi(t)});i.$editor.find(".richText-editor").on("dblclick mouseup",function(){ti(n(this).attr("id"))});i.$editor.find("#richText-Video button.btn").on("click",function(t){var o,r,e,s,f;t.preventDefault();o=n(this);r=o.parent(".richText-form-item").parent(".richText-form");r.attr("data-editor")===u&&(e=r.find("input#videoURL").val(),s=r.find("select#size").val(),e?(f="",f=dr(e,s),f?(i.useSingleQuotes===!0,k(u,!0),d(f),ct(),r.find("input#videoURL").val(""),n(".richText-toolbar li.is-selected").removeClass("is-selected")):(r.prepend(n("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:i.translations.videoURLnotSupported})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){n(this).remove()})},5e3))):(r.prepend(n("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:i.translations.pleaseEnterURL})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){n(this).remove()})},5e3)))});n(document).on("mousedown",function(t){var i=n(t.target);if(i.hasClass("richText-list")||i.parents(".richText-list").length!==0||(n(".richText-list.list-rightclick").remove(),i.hasClass("richText-form")||i.parents(".richText-form").length!==0||n(".richText-editNode").each(function(){var t=n(this);t.removeClass("richText-editNode");t.attr("class")===""&&t.removeAttr("class")})),i.prop("tagName")==="IMG"&&i.parents("#"+u)){startX=t.pageX;startY=t.pageY;startW=i.innerWidth();startH=i.innerHeight();var o=i.offset().left,f=i.offset().left+i.innerWidth(),e=i.offset().top+i.innerHeight(),h=i.offset().top,r=!1;i.css({cursor:"default"});startY<=e&&startY>=e-20&&startX>=f-20&&startX<=f&&(s=i,s.css({cursor:"nwse-resize"}),r=!0);(r===!0||s)&&!s.data("width")?(s.data("width",i.parents("#"+u).innerWidth()),s.data("height",i.parents("#"+u).innerHeight()*3),t.preventDefault()):r===!0||s?t.preventDefault():s=null}});n(document).mouseup(function(){s&&s.css({cursor:"default"});s=null}).mousemove(function(n){if(s!==null){var t=s.data("width"),i=s.width(),r=s.data("height"),u=s.height();startW+n.pageX-startX<=t&&startH+n.pageY-startY<=r?(s.innerWidth(startW+n.pageX-startX),ct()):startW+n.pageX-startX<=i&&startH+n.pageY-startY<=u&&(s.innerWidth(startW+n.pageX-startX),ct())}});i.$editor.find("#richText-URL button.btn").on("click",function(t){var c,r,h,f;if(t.preventDefault(),c=n(this),r=c.parent(".richText-form-item").parent(".richText-form"),r.attr("data-editor")===u){var e=r.find("input#url").val(),o=r.find("input#urlText").val(),s=r.find("#openIn").val();s||(s="_self");o||(o=e);e?(h="",h=i.useSingleQuotes===!0?"<a href='"+e+"' target='"+s+"'>"+o+"<\/a>":'<a href="'+e+'" target="'+s+'">'+o+"<\/a>",k(u,!1,!0),f=n(".richText-editNode"),f.length>0&&f.prop("tagName")==="A"?(f.attr("href",e),f.attr("target",s),f.text(o),f.removeClass("richText-editNode"),f.attr("class")===""&&f.removeAttr("class")):d(h),r.find("input#url").val(""),r.find("input#urlText").val(""),n(".richText-toolbar li.is-selected").removeClass("is-selected")):(r.prepend(n("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:i.translations.pleaseEnterURL})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){n(this).remove()})},5e3))}});i.$editor.find("#richText-Image button.btn").on("click",function(t){var h,e,o,f,s,r;t.preventDefault();h=n(this);e=h.parent(".richText-form-item").parent(".richText-form");e.attr("data-editor")===u&&(o=e.find("#imageURL").val(),f=e.find("select#align").val(),f||(f="center"),o?(s="",s=i.useSingleQuotes===!0?f==="center"?"<div style='text-align:center;'><img src='"+o+"'><\/div>":"<img src='"+o+"' align='"+f+"'>":f==="center"?'<div style="text-align:center;"><img src="'+o+'"><\/div>':'<img src="'+o+'" align="'+f+'">',k(u,!0),r=n(".richText-editNode"),r.length>0&&r.prop("tagName")==="IMG"?(r.attr("src",o),r.parent("div").length>0&&r.parent("div").attr("style")==="text-align:center;"&&f!=="center"?(r.unwrap("div"),r.attr("align",f)):(r.parent("div").length===0||r.parent("div").attr("style")!=="text-align:center;")&&f==="center"?(r.wrap('<div style="text-align:center;"><\/div>'),r.removeAttr("align")):r.attr("align",f),r.removeClass("richText-editNode"),r.attr("class")===""&&r.removeAttr("class")):d(s),e.find("input#imageURL").val(""),n(".richText-toolbar li.is-selected").removeClass("is-selected")):(e.prepend(n("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:i.translations.pleaseSelectImage})),e.children(".form-item.is-error").slideDown(),setTimeout(function(){e.children(".form-item.is-error").slideUp(function(){n(this).remove()})},5e3)))});i.$editor.find("#richText-File button.btn").on("click",function(t){var s,r,f,e,o;t.preventDefault();s=n(this);r=s.parent(".richText-form-item").parent(".richText-form");r.attr("data-editor")===u&&(f=r.find("#fileURL").val(),e=r.find("#fileText").val(),e||(e=f),f?(o="",o=i.useSingleQuotes===!0?"<a href='"+f+"' target='_blank'>"+e+"<\/a>":'<a href="'+f+'" target="_blank">'+e+"<\/a>",k(u,!0),d(o),r.find("input#fileURL").val(""),r.find("input#fileText").val(""),n(".richText-toolbar li.is-selected").removeClass("is-selected")):(r.prepend(n("<div />",{style:"color:red;display:none;","class":"form-item is-error",text:i.translations.pleaseSelectFile})),r.children(".form-item.is-error").slideDown(),setTimeout(function(){r.children(".form-item.is-error").slideUp(function(){n(this).remove()})},5e3)))});i.$editor.find("#richText-Table button.btn").on("click",function(t){var c,f,e,o,r,s,h;if(t.preventDefault(),c=n(this),f=c.parent(".richText-form-item").parent(".richText-form"),f.attr("data-editor")===u){for(e=f.find("input#tableRows").val(),o=f.find("input#tableColumns").val(),(!e||e<=0)&&(e=2),(!o||o<=0)&&(o=2),r="",r=i.useSingleQuotes===!0?"<table class='table-1'><tbody>":'<table class="table-1"><tbody>',s=1;s<=e;s++){for(r+="<tr>",h=1;h<=o;h++)r+="<td> <\/td>";r+="<\/tr>"}r+="<\/tbody><\/table>";k(u,!0);d(r);f.find("input#tableColumns").val("");f.find("input#tableRows").val("");n(".richText-toolbar li.is-selected").removeClass("is-selected")}});n(document).on("click",function(t){var i=n(t.target),r;i.parents(".richText-toolbar").length===0||(i.hasClass("richText-dropdown-outer")?i.parent("a").parent("li").removeClass("is-selected"):i.find(".richText").length>0?n(".richText-toolbar li").removeClass("is-selected"):i.parent().hasClass("richText-dropdown-close")?n(".richText-toolbar li").removeClass("is-selected"):i.hasClass("richText-btn")&&n(t.target).children(".richText-dropdown-outer").length>0&&(i.parent("li").addClass("is-selected"),i.children(".fa,svg").hasClass("fa-link")?(k(u,!1,!0),r=at(),i.find("input#urlText").val(""),i.find("input#url").val(""),r&&i.find("input#urlText").val(r)):i.hasClass("fa-image")))});i.$editor.find(".richText-toolbar a[data-command]").on("click",function(t){var f=n(this),s=f.closest(".richText-toolbar"),i=s.siblings(".richText-editor"),o=i.attr("id"),r,e;i.length>0&&o===u&&(!f.parent("li").attr("data-disable")||f.parent("li").attr("data-disable")==="false")&&(t.preventDefault(),r=n(this).data("command"),r==="toggleCode"?br(i.attr("id")):(e=null,n(this).data("option")&&(e=n(this).data("option").toString(),e.match(/^h[1-6]$/)&&(r="heading")),ai(r,e,o),r==="removeFormat"&&(i.find("*").each(function(){var i=["id","class","name","action","method","src","align","alt","title","style","webkitallowfullscreen","mozallowfullscreen","allowfullscreen","width","height","frameborder"],t=n(this),r=n.map(this.attributes,function(n){return n.name});n.each(r,function(n,r){i.indexOf(r)<0&&r.substr(0,5)!=="data-"&&t.removeAttr(r)});t.prop("tagName")==="A"&&t.replaceWith(function(){return n("<span />",{html:n(this).html()})})}),ai("formatBlock","div",o)),i.find("div:empty,p:empty,li:empty,h1:empty,h2:empty,h3:empty,h4:empty,h5:empty,h6:empty").remove(),i.find("h1,h2,h3,h4,h5,h6").unwrap("h1,h2,h3,h4,h5,h6")));f.parents("li.is-selected").removeClass("is-selected")});return n(this)};n.fn.unRichText=function(t){function s(){if(u.hasClass("richText")?i=u:(u.hasClass("richText-initial")||u.hasClass("richText-editor"))&&(i=u.parents(".richText")),!i)return!1;o=i.find(".richText-editor");f=i.find(".richText-initial");parseInt(r.delay)>0?setTimeout(e,parseInt(r.delay)):e()}function e(){i.find(".richText-toolbar").remove();i.find(".richText-editor").remove();f.unwrap(".richText").data("editor","richText").removeClass("richText-initial").show();r.callback&&typeof r.callback=="function"&&r.callback()}var r=n.extend({delay:0},t),o,f,i,u=n(this);s()}})(jQuery);!function(n,t,i){"use strict";!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(n.jQuery)}(function(r){function c(n,t){return this.$element=r(n),t&&("string"===r.type(t.delay)||"number"===r.type(t.delay))&&(t.delay={show:t.delay,hide:t.delay}),this.options=r.extend({},l,t),this._defaults=l,this._name=u,this._targetclick=!1,this.init(),e.push(this.$element),this}var u="webuiPopover",f="webui-popover",s="webui.popover",l={placement:"auto",container:null,width:"auto",height:"auto",trigger:"click",style:"",selector:!1,delay:{show:null,hide:300},"async":{type:"GET",before:null,success:null,error:null},cache:!0,multi:!1,arrow:!0,title:"",content:"",closeable:!1,padding:!0,url:"",type:"html",direction:"",animation:null,template:'<div class="webui-popover"><div class="webui-arrow"><\/div><div class="webui-popover-inner"><a href="#" class="close"><\/a><h3 class="webui-popover-title"><\/h3><div class="webui-popover-content"><i class="icon-refresh"><\/i> <p>&nbsp;<\/p><\/div><\/div><\/div>',backdrop:!1,dismissible:!0,onShow:null,onHide:null,abortXHR:!0,autoHide:!1,offsetTop:0,offsetLeft:0,iframeOptions:{frameborder:"0",allowtransparency:"true",id:"",name:"",scrolling:"",onload:"",height:"",width:""},hideEmpty:!1},a=f+"-rtl",e=[],v=r('<div class="webui-popover-backdrop"><\/div>'),w=0,b=!1,o=-2e3,h=r(t),k=function(n,t){return isNaN(n)?t||0:Number(n)},y=function(n){return n.data("plugin_"+u)},p=function(){for(var n=null,t=0;t<e.length;t++)n=y(e[t]),n&&n.hide(!0);h.trigger("hiddenAll."+s)},nt=function(n){for(var t=null,i=0;i<e.length;i++)t=y(e[i]),t&&t.id!==n.id&&t.hide(!0);h.trigger("hiddenAll."+s)},d="ontouchstart"in t.documentElement&&/Mobi/.test(navigator.userAgent),tt=function(n){var t={x:0,y:0},i;return"touchstart"===n.type||"touchmove"===n.type||"touchend"===n.type||"touchcancel"===n.type?(i=n.originalEvent.touches[0]||n.originalEvent.changedTouches[0],t.x=i.pageX,t.y=i.pageY):("mousedown"===n.type||"mouseup"===n.type||"click"===n.type)&&(t.x=n.pageX,t.y=n.pageY),t},g;c.prototype={init:function(){if(this.$element[0]instanceof t.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");"manual"!==this.getTrigger()&&(d?this.$element.off("touchend",this.options.selector).on("touchend",this.options.selector,r.proxy(this.toggle,this)):"click"===this.getTrigger()?this.$element.off("click",this.options.selector).on("click",this.options.selector,r.proxy(this.toggle,this)):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave click",this.options.selector).on("mouseenter",this.options.selector,r.proxy(this.mouseenterHandler,this)).on("mouseleave",this.options.selector,r.proxy(this.mouseleaveHandler,this)));this._poped=!1;this._inited=!0;this._opened=!1;this._idSeed=w;this.id=u+this._idSeed;this.options.container=r(this.options.container||t.body).first();this.options.backdrop&&v.appendTo(this.options.container).hide();w++;"sticky"===this.getTrigger()&&this.show();this.options.selector&&(this._options=r.extend({},this.options,{selector:""}))},destroy:function(){for(var t=-1,n=0;n<e.length;n++)if(e[n]===this.$element){t=n;break}e.splice(t,1);this.hide();this.$element.data("plugin_"+u,null);"click"===this.getTrigger()?this.$element.off("click"):"hover"===this.getTrigger()&&this.$element.off("mouseenter mouseleave");this.$target&&this.$target.remove()},getDelegateOptions:function(){var n={};return this._options&&r.each(this._options,function(t,i){l[t]!==i&&(n[t]=i)}),n},hide:function(n,t){var u,i;(n||"sticky"!==this.getTrigger())&&this._opened&&(t&&(t.preventDefault(),t.stopPropagation()),this.xhr&&this.options.abortXHR===!0&&(this.xhr.abort(),this.xhr=null),u=r.Event("hide."+s),(this.$element.trigger(u,[this.$target]),this.$target)&&(this.$target.removeClass("in").addClass(this.getHideAnimation()),i=this,setTimeout(function(){i.$target.hide();i.getCache()||i.$target.remove()},i.getHideDelay())),this.options.backdrop&&v.hide(),this._opened=!1,this.$element.trigger("hidden."+s,[this.$target]),this.options.onHide&&this.options.onHide(this.$target))},resetAutoHide:function(){var n=this,t=n.getAutoHide();t&&(n.autoHideHandler&&clearTimeout(n.autoHideHandler),n.autoHideHandler=setTimeout(function(){n.hide()},t))},delegate:function(n){var t=r(n).data("plugin_"+u);return t||(t=new c(n,this.getDelegateOptions()),r(n).data("plugin_"+u,t)),t},toggle:function(n){var t=this;n&&(n.preventDefault(),n.stopPropagation(),this.options.selector&&(t=this.delegate(n.currentTarget)));t[t.getTarget().hasClass("in")?"hide":"show"]()},hideAll:function(){p()},hideOthers:function(){nt(this)},show:function(){if(!this._opened){var n=this.getTarget().removeClass().addClass(f).addClass(this._customTargetClass);if(this.options.multi||this.hideOthers(),!this.getCache()||!this._poped||""===this.content){if(this.content="",this.setTitle(this.getTitle()),this.options.closeable||n.find(".close").off("click").remove(),this.isAsync()?this.setContentASync(this.options.content):this.setContent(this.getContent()),this.canEmptyHide()&&""===this.content)return;n.show()}this.displayContent();this.options.onShow&&this.options.onShow(n);this.bindBodyEvents();this.options.backdrop&&v.show();this._opened=!0;this.resetAutoHide()}},displayContent:function(){var v=this.getElementPosition(),n=this.getTarget().removeClass().addClass(f).addClass(this._customTargetClass),t=this.getContentElement(),y=n[0].offsetWidth,p=n[0].offsetHeight,i="bottom",d=r.Event("show."+s),l,h,c,u,e;if(!this.canEmptyHide()||(l=t.children().html(),null===l||0!==l.trim().length)){if(this.$element.trigger(d,[n]),h=this.$element.data("width")||this.options.width,""===h&&(h=this._defaults.width),"auto"!==h&&n.width(h),c=this.$element.data("height")||this.options.height,""===c&&(c=this._defaults.height),"auto"!==c&&t.height(c),this.options.style&&this.$target.addClass(f+"-"+this.options.style),"rtl"!==this.options.direction||t.hasClass(a)||t.addClass(a),this.options.arrow||n.find(".webui-arrow").remove(),n.detach().css({top:o,left:o,display:"block"}),this.getAnimation()&&n.addClass(this.getAnimation()),n.appendTo(this.options.container),i=this.getPlacement(v),this.$element.trigger("added."+s),this.initTargetEvents(),this.options.padding||("auto"!==this.options.height&&t.css("height",t.outerHeight()),this.$target.addClass("webui-no-padding")),this.options.maxHeight&&t.css("maxHeight",this.options.maxHeight),this.options.maxWidth&&t.css("maxWidth",this.options.maxWidth),y=n[0].offsetWidth,p=n[0].offsetHeight,u=this.getTargetPositin(v,i,y,p),this.$target.css(u.position).addClass(i).addClass("in"),"iframe"===this.options.type){var w=n.find("iframe"),b=n.width(),k=w.parent().height();""!==this.options.iframeOptions.width&&"auto"!==this.options.iframeOptions.width&&(b=this.options.iframeOptions.width);""!==this.options.iframeOptions.height&&"auto"!==this.options.iframeOptions.height&&(k=this.options.iframeOptions.height);w.width(b).height(k)}(this.options.arrow||this.$target.css({margin:0}),this.options.arrow)&&(e=this.$target.find(".webui-arrow"),e.removeAttr("style"),"left"===i||"right"===i?e.css({top:this.$target.height()/2}):("top"===i||"bottom"===i)&&e.css({left:this.$target.width()/2}),u.arrowOffset&&(-1===u.arrowOffset.left||-1===u.arrowOffset.top?e.hide():e.css(u.arrowOffset)));this._poped=!0;this.$element.trigger("shown."+s,[this.$target])}},isTargetLoaded:function(){return 0===this.getTarget().find("i.glyphicon-refresh").length},getTriggerElement:function(){return this.$element},getTarget:function(){if(!this.$target){var n=u+this._idSeed;this.$target=r(this.options.template).attr("id",n);this._customTargetClass=this.$target.attr("class")!==f?this.$target.attr("class"):null;this.getTriggerElement().attr("data-target",n)}return this.$target.data("trigger-element")||this.$target.data("trigger-element",this.getTriggerElement()),this.$target},removeTarget:function(){this.$target.remove();this.$target=null;this.$contentElement=null},getTitleElement:function(){return this.getTarget().find("."+f+"-title")},getContentElement:function(){return this.$contentElement||(this.$contentElement=this.getTarget().find("."+f+"-content")),this.$contentElement},getTitle:function(){return this.$element.attr("data-title")||this.options.title||this.$element.attr("title")},getUrl:function(){return this.$element.attr("data-url")||this.options.url},getAutoHide:function(){return this.$element.attr("data-auto-hide")||this.options.autoHide},getOffsetTop:function(){return k(this.$element.attr("data-offset-top"))||this.options.offsetTop},getOffsetLeft:function(){return k(this.$element.attr("data-offset-left"))||this.options.offsetLeft},getCache:function(){var n=this.$element.attr("data-cache");if("undefined"!=typeof n)switch(n.toLowerCase()){case"true":case"yes":case"1":return!0;case"false":case"no":case"0":return!1}return this.options.cache},getTrigger:function(){return this.$element.attr("data-trigger")||this.options.trigger},getDelayShow:function(){var n=this.$element.attr("data-delay-show");return"undefined"!=typeof n?n:0===this.options.delay.show?0:this.options.delay.show||100},getHideDelay:function(){var n=this.$element.attr("data-delay-hide");return"undefined"!=typeof n?n:0===this.options.delay.hide?0:this.options.delay.hide||100},getAnimation:function(){var n=this.$element.attr("data-animation");return n||this.options.animation},getHideAnimation:function(){var n=this.getAnimation();return n?n+"-out":"out"},setTitle:function(n){var t=this.getTitleElement();n?("rtl"!==this.options.direction||t.hasClass(a)||t.addClass(a),t.html(n)):t.remove()},hasContent:function(){return this.getContent()},canEmptyHide:function(){return this.options.hideEmpty&&"html"===this.options.type},getIframe:function(){var n=r("<iframe><\/iframe>").attr("src",this.getUrl()),t=this;return r.each(this._defaults.iframeOptions,function(i){"undefined"!=typeof t.options.iframeOptions[i]&&n.attr(i,t.options.iframeOptions[i])}),n},getContent:function(){var t,n;if(this.getUrl())switch(this.options.type){case"iframe":this.content=this.getIframe();break;case"html":try{this.content=r(this.getUrl());this.content.is(":visible")||this.content.show()}catch(i){throw new Error("Unable to get popover content. Invalid selector specified.");}}else this.content||(t="",(t=r.isFunction(this.options.content)?this.options.content.apply(this.$element[0],[this]):this.options.content,this.content=this.$element.attr("data-content")||t,this.content)||(n=this.$element.next(),n&&n.hasClass(f+"-content")&&(this.content=n)));return this.content},setContent:function(n){var i=this.getTarget(),t=this.getContentElement();"string"==typeof n?t.html(n):n instanceof r&&(t.html(""),this.options.cache?n.removeClass(f+"-content").appendTo(t):n.clone(!0,!0).removeClass(f+"-content").appendTo(t));this.$target=i},isAsync:function(){return"async"===this.options.type},setContentASync:function(n){var t=this;this.xhr||(this.xhr=r.ajax({url:this.getUrl(),type:this.options.async.type,cache:this.getCache(),beforeSend:function(n,i){t.options.async.before&&t.options.async.before(t,n,i)},success:function(i){t.bindBodyEvents();t.content=n&&r.isFunction(n)?n.apply(t.$element[0],[i]):i;t.setContent(t.content);var u=t.getContentElement();u.removeAttr("style");t.displayContent();t.options.async.success&&t.options.async.success(t,i)},complete:function(){t.xhr=null},error:function(n,i){t.options.async.error&&t.options.async.error(t,n,i)}}))},bindBodyEvents:function(){b||(this.options.dismissible&&"click"===this.getTrigger()?d?h.off("touchstart.webui-popover").on("touchstart.webui-popover",r.proxy(this.bodyTouchStartHandler,this)):(h.off("keyup.webui-popover").on("keyup.webui-popover",r.proxy(this.escapeHandler,this)),h.off("click.webui-popover").on("click.webui-popover",r.proxy(this.bodyClickHandler,this))):"hover"===this.getTrigger()&&h.off("touchend.webui-popover").on("touchend.webui-popover",r.proxy(this.bodyClickHandler,this)))},mouseenterHandler:function(n){var t=this;n&&this.options.selector&&(t=this.delegate(n.currentTarget));t._timeout&&clearTimeout(t._timeout);t._enterTimeout=setTimeout(function(){t.getTarget().is(":visible")||t.show()},this.getDelayShow())},mouseleaveHandler:function(){var n=this;clearTimeout(n._enterTimeout);n._timeout=setTimeout(function(){n.hide()},this.getHideDelay())},escapeHandler:function(n){27===n.keyCode&&this.hideAll()},bodyTouchStartHandler:function(n){var i=this,t=r(n.currentTarget);t.on("touchend",function(n){i.bodyClickHandler(n);t.off("touchend")});t.on("touchmove",function(){t.off("touchend")})},bodyClickHandler:function(n){var f,i,t;for(b=!0,f=!0,i=0;i<e.length;i++)if(t=y(e[i]),t&&t._opened){var r=t.getTarget().offset(),o=r.left,s=r.top,h=r.left+t.getTarget().width(),c=r.top+t.getTarget().height(),u=tt(n),l=u.x>=o&&u.x<=h&&u.y>=s&&u.y<=c;if(l){f=!1;break}}f&&p()},initTargetEvents:function(){"hover"===this.getTrigger()&&this.$target.off("mouseenter mouseleave").on("mouseenter",r.proxy(this.mouseenterHandler,this)).on("mouseleave",r.proxy(this.mouseleaveHandler,this));this.$target.find(".close").off("click").on("click",r.proxy(this.hide,this,!0))},getPlacement:function(n){var t,o=this.options.container,u=o.innerWidth(),i=o.innerHeight(),h=o.scrollTop(),c=o.scrollLeft(),f=Math.max(0,n.left-c),r=Math.max(0,n.top-h);t="function"==typeof this.options.placement?this.options.placement.call(this,this.getTarget()[0],this.$element[0]):this.$element.data("placement")||this.options.placement;var e="horizontal"===t,s="vertical"===t,l="auto"===t||e||s;return l?t=u/3>f?i/3>r?e?"right-bottom":"bottom-right":2*i/3>r?s?i/2>=r?"bottom-right":"top-right":"right":e?"right-top":"top-right":2*u/3>f?i/3>r?e?u/2>=f?"right-bottom":"left-bottom":"bottom":2*i/3>r?e?u/2>=f?"right":"left":i/2>=r?"bottom":"top":e?u/2>=f?"right-top":"left-top":"top":i/3>r?e?"left-bottom":"bottom-left":2*i/3>r?s?i/2>=r?"bottom-left":"top-left":"left":e?"left-top":"top-left":"auto-top"===t?t=u/3>f?"top-right":2*u/3>f?"top":"top-left":"auto-bottom"===t?t=u/3>f?"bottom-right":2*u/3>f?"bottom":"bottom-left":"auto-left"===t?t=i/3>r?"left-top":2*i/3>r?"left":"left-bottom":"auto-right"===t&&(t=i/3>r?"right-bottom":2*i/3>r?"right":"right-top"),t},getElementPosition:function(){var n=this.$element[0].getBoundingClientRect(),i=this.options.container,u=i.css("position"),f;return i.is(t.body)||"static"===u?r.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth||n.width,height:this.$element[0].offsetHeight||n.height}):"fixed"===u?(f=i[0].getBoundingClientRect(),{top:n.top-f.top+i.scrollTop(),left:n.left-f.left+i.scrollLeft(),width:n.width,height:n.height}):"relative"===u?{top:this.$element.offset().top-i.offset().top,left:this.$element.offset().left-i.offset().left,width:this.$element[0].offsetWidth||n.width,height:this.$element[0].offsetHeight||n.height}:void 0},getTargetPositin:function(n,i,r,u){var f=n,g=this.options.container,v=this.$element.outerWidth(),y=this.$element.outerHeight(),nt=t.documentElement.scrollTop+g.scrollTop(),tt=t.documentElement.scrollLeft+g.scrollLeft(),e={},l=null,p=this.options.arrow?20:0,s=10,h=p+s>v?p:0,c=p+s>y?p:0,a=0,it=t.documentElement.clientHeight+nt,rt=t.documentElement.clientWidth+tt,w=f.left+f.width/2-h>0,b=f.left+f.width/2+h<rt,k=f.top+f.height/2-c>0,d=f.top+f.height/2+c<it;switch(i){case"bottom":e={top:f.top+f.height,left:f.left+f.width/2-r/2};break;case"top":e={top:f.top-u,left:f.left+f.width/2-r/2};break;case"left":e={top:f.top+f.height/2-u/2,left:f.left-r};break;case"right":e={top:f.top+f.height/2-u/2,left:f.left+f.width};break;case"top-right":e={top:f.top-u,left:w?f.left-h:s};l={left:w?Math.min(v,r)/2+h:o};break;case"top-left":a=b?h:-s;e={top:f.top-u,left:f.left-r+f.width+a};l={left:b?r-Math.min(v,r)/2-h:o};break;case"bottom-right":e={top:f.top+f.height,left:w?f.left-h:s};l={left:w?Math.min(v,r)/2+h:o};break;case"bottom-left":a=b?h:-s;e={top:f.top+f.height,left:f.left-r+f.width+a};l={left:b?r-Math.min(v,r)/2-h:o};break;case"right-top":a=d?c:-s;e={top:f.top-u+f.height+a,left:f.left+f.width};l={top:d?u-Math.min(y,u)/2-c:o};break;case"right-bottom":e={top:k?f.top-c:s,left:f.left+f.width};l={top:k?Math.min(y,u)/2+c:o};break;case"left-top":a=d?c:-s;e={top:f.top-u+f.height+a,left:f.left-r};l={top:d?u-Math.min(y,u)/2-c:o};break;case"left-bottom":e={top:k?f.top-c:s,left:f.left-r};l={top:k?Math.min(y,u)/2+c:o}}return e.top+=this.getOffsetTop(),e.left+=this.getOffsetLeft(),{position:e,arrowOffset:l}}};r.fn[u]=function(n,t){var i=[],f=this.each(function(){var f=r.data(this,"plugin_"+u);f?"destroy"===n?f.destroy():"string"==typeof n&&i.push(f[n]()):(n?"string"==typeof n?"destroy"!==n&&(t||(f=new c(this,null),i.push(f[n]()))):"object"==typeof n&&(f=new c(this,n)):f=new c(this,null),r.data(this,"plugin_"+u,f))});return i.length?i:f};g=function(){var n=function(){p()},t=function(n,t){t=t||{};r(n).webuiPopover(t)},f=function(n){var t=!0;return r(n).each(function(n,f){t=t&&r(f).data("plugin_"+u)!==i}),t},e=function(n,t){t?r(n).webuiPopover(t).webuiPopover("show"):r(n).webuiPopover("show")},o=function(n){r(n).webuiPopover("hide")},s=function(n){l=r.extend({},l,n)},h=function(n,t){var i=r(n).data("plugin_"+u),f;i&&(f=i.getCache(),i.options.cache=!1,i.options.content=t,i._opened?(i._opened=!1,i.show()):i.isAsync()?i.setContentASync(t):i.setContent(t),i.options.cache=f)},c=function(n,t){var i=r(n).data("plugin_"+u),f,e;i&&(f=i.getCache(),e=i.options.type,i.options.cache=!1,i.options.url=t,i._opened?(i._opened=!1,i.show()):(i.options.type="async",i.setContentASync(i.content)),i.options.cache=f,i.options.type=e)};return{show:e,hide:o,create:t,isCreated:f,hideAll:n,updateContent:h,updateContentAsync:c,setDefaultOptions:s}}();n.WebuiPopovers=g})}(window,document);EncryptionKey="SynergyKey";window.OnPhotoError=n=>{n.onerror=null,n.src="/images/profile.jpg"};window.OnDocumentError=n=>{n.onerror=null,n.src="/images/document.png"};window.OnLogoError=n=>{console.log($(n).parent()),$(n).parent.css("padding-top","15px"),n.onerror=null,$(n).hide()};class Stack{constructor(){this.items=[]}push(n){this.items.push(n)}pop(){return this.items.length==0?null:this.items.pop()}peek(n){return((n===null||n===undefined)&&(n=0),this.items.length<=n)?null:this.items[this.items.length-n-1]}isEmpty(){return this.items.length==0}}