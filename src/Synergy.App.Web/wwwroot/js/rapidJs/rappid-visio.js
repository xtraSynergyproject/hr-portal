!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jointjs"),require("hot-formula-parser"),require("jszip")):"function"==typeof define&&define.amd?define(["exports","jointjs","hot-formula-parser","jszip"],t):t(((e=e||self).joint=e.joint||{},e.joint.format=e.joint.format||{},e.joint.format.Visio=e.joint.format.Visio||{}),e.joint,e.formulaParser,e.JSZip)}(this,function(p,N,d,C){"use strict";function Y(e){var t,n,r,i=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);i--;){if(n&&null!=(t=e[n]))return t.call(e);if(r&&null!=(t=e[r]))return new P(t.call(e));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function P(e){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return(P=function(e){this.s=e,this.n=e.next}).prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(e){var t=this.s.return;return void 0===t?Promise.resolve({value:e,done:!0}):n(t.apply(this.s,arguments))},throw:function(e){var t=this.s.return;return void 0===t?Promise.reject(e):n(t.apply(this.s,arguments))}},new P(e)}function _(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_(Object(n),!0).forEach(function(e){g(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(){A=function(e,t){return new r(e,void 0,t)};var i=RegExp.prototype,o=new WeakMap;function r(e,t,n){t=new RegExp(e,t);return o.set(t,n||o.get(e)),W(t,r.prototype)}function a(n,e){var r=o.get(e);return Object.keys(r).reduce(function(e,t){return e[t]=n[r[t]],e},Object.create(null))}return z(r,RegExp),r.prototype.exec=function(e){e=i.exec.call(this,e);return e&&(e.groups=a(e,this)),e},r.prototype[Symbol.replace]=function(e,t){var n,r;return"string"==typeof t?(n=o.get(this),i[Symbol.replace].call(this,e,t.replace(/\$<([^>]+)>/g,function(e,t){return"$"+n[t]}))):"function"==typeof t?(r=this,i[Symbol.replace].call(this,e,function(){var e=arguments;return"object"!=typeof e[e.length-1]&&(e=[].slice.call(e)).push(a(e,r)),t.apply(this,e)})):i[Symbol.replace].call(this,e,t)},A.apply(this,arguments)}function L(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function I(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){L(r,t,n,i,o,"next",e)}function o(e){L(r,t,n,i,o,"throw",e)}i(void 0)})}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t,n){t&&M(e.prototype,t),n&&M(e,n),Object.defineProperty(e,"prototype",{writable:!1})}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&W(e,t)}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e,t){if(null==e)return{};var n,r=function(e,t){if(null==e)return{};for(var n,r={},i=Object.keys(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols)for(var i=Object.getOwnPropertySymbols(e),o=0;o<i.length;o++)n=i[o],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n]);return r}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=U(n),t=(e=r?(e=U(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return J(t)}}function K(){return(K="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=U(e)););return e}(e,t);if(r)return r=Object.getOwnPropertyDescriptor(r,t),r.get?r.get.call(arguments.length<3?e:n):r.value}).apply(this,arguments)}function Q(e,t){return Z(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(e){s=!0,i=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||ee(e,t)||oe()}function ie(e){return Z(e)||$(e)||ee(e)||oe()}function F(e){return function(e){if(Array.isArray(e))return te(e)}(e)||$(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e){if(Array.isArray(e))return e}function $(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ee(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?te(e,t):void 0}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function oe(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ae(e,t){var n,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=ee(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}C=C&&C.hasOwnProperty("default")?C.default:C;var se="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function le(e,t){return e(t={exports:{}},t.exports),t.exports}function ue(e){return e&&e.Math==Math&&e}function v(e){try{return!!e()}catch(e){return!0}}function ce(e){if(null==e)throw $e("Can't call method on "+e);return e}function he(e){return Ze(ce(e))}function fe(e,t){return arguments.length<2?(n=V[e],k(n)?n:void 0):V[e]&&V[e][t];var n}function pe(t,n){try{dt(V,t,{value:n,configurable:!0,writable:!0})}catch(e){V[t]=n}return n}function de(e){return vt(ce(e))}function ge(e){return"Symbol("+(void 0===e?"":e)+")_"+bt(++mt+St,36)}function c(e){var t;return O(Ct,e)&&(rt||"string"==typeof Ct[e])||(t="Symbol."+e,rt&&O(kt,e)?Ct[e]=kt[e]:Ct[e]=(it&&xt?xt:wt)(t)),Ct[e]}function ve(e){return e=Tt(e,"string"),at(e)?e:e+""}function ye(e){return Ht[e]||(Ht[e]=ge(e))}function me(s){return function(e,t,n){var r,i=he(e),o=cn(i),a=sn(n,o);if(s&&t!=t){for(;a<o;)if((r=i[a++])!=r)return!0}else for(;a<o;a++)if((s||a in i)&&i[a]===t)return s||a||0;return!s&&-1}}function Se(e,t){var n,r=he(e),i=0,o=[];for(n in r)!O(Jt,n)&&O(r,n)&&fn(o,n);for(;t.length>i;)!O(r,n=t[i++])||~hn(o,n)||fn(o,n);return o}function be(e,t){return(e=Cn[bn(e)])==xn||e!=kn&&(k(t)?v(t):!!t)}function R(e,t){var n,r,i,o=e.target,a=e.global,s=e.stat,l=a?V:s?V[o]||pe(o,{}):(V[o]||{}).prototype;if(l)for(n in t){if(r=t[n],i=e.noTargetGet?(i=Pn(l,n))&&i.value:l[n],!wn(a?n:o+(s?".":"#")+n,e.forced)&&void 0!==i){if(typeof r==typeof i)continue;for(var u=r,c=i,h=v=g=d=p=f=void 0,f=mn(c),p=Yt.f,d=It.f,g=0;g<f.length;g++){var v=f[g];O(u,v)||h&&O(h,v)||p(u,v,d(c,v))}}(e.sham||i&&i.sham)&&zt(r,"sham",!0),en(l,n,r,e)}}function Ce(e,t){return ct(e),void 0===t?e:Be?_n(e,t):function(){return e.apply(t,arguments)}}function ke(){}function xe(e){if(!k(e))return!1;try{return In(ke,Vn,e),!0}catch(e){return!1}}function we(e){if(!k(e))return!1;switch(Rn(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return En||!!Dn(Fn,Wt(e))}catch(e){return!0}}function Pe(e,t){return new(Gn(e))(0===t?0:t)}function _e(f){var p=1==f,d=2==f,g=3==f,v=4==f,y=6==f,m=7==f,S=5==f||y;return function(e,t,n,r){for(var i,o,a=de(e),s=Ze(a),l=Ce(t,n),u=cn(s),c=0,t=r||Pe,h=p?t(e,u):d||m?t(e,0):void 0;c<u;c++)if((S||c in s)&&(o=l(i=s[c],c,a),f))if(p)h[c]=o;else if(o)switch(f){case 3:return!0;case 5:return i;case 6:return c;case 2:jn(h,i)}else switch(f){case 4:return!1;case 7:jn(h,i)}return y?-1:g||v?v:h}}function Te(t){return 51<=nt||!v(function(){var e=[];return(e.constructor={})[Yn]=function(){return{foo:1}},1!==e[t](Boolean).foo})}function Ae(e,t){var n=e.length,r=Kn(n/2);if(n<8){for(var i,o,a=e,s=t,l=a.length,u=1;u<l;){for(i=a[o=u];o&&0<s(a[o-1],i);)a[o]=a[--o];o!==u++&&(a[o]=i)}return a}for(var c=e,h=Ae(qn(e,0,r),t),f=Ae(qn(e,r),t),p=t,d=h.length,g=f.length,v=0,y=0;v<d||y<g;)c[v+y]=v<d&&y<g?p(h[v],f[y])<=0?h[v++]:f[y++]:v<d?h[v++]:f[y++];return c}function Le(e,t){var n=[][e];return!!n&&v(function(){n.call(null,t||function(){return 1},1)})}function Me(t){return function(e){e=w(ce(e));return 1&t&&(e=dr(e,gr,"")),e=2&t?dr(e,vr,""):e}}var Re,Ve,Ie,Fe,De,Ee,Oe,Ne,V=ue("object"==typeof globalThis&&globalThis)||ue("object"==typeof window&&window)||ue("object"==typeof self&&self)||ue("object"==typeof se&&se)||function(){return this}()||Function("return this")(),f=!v(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),Be=!v(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),Ge=Function.prototype.call,D=Be?Ge.bind(Ge):function(){return Ge.apply(Ge,arguments)},se={}.propertyIsEnumerable,je=Object.getOwnPropertyDescriptor,Xe={f:je&&!se.call({1:2},1)?function(e){e=je(this,e);return!!e&&e.enumerable}:se},Ye=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},se=Function.prototype,ze=se.bind,Ue=se.call,We=Be&&ze.bind(Ue,Ue),y=Be?function(e){return e&&We(e)}:function(e){return e&&function(){return Ue.apply(e,arguments)}},He=y({}.toString),Je=y("".slice),qe=function(e){return Je(He(e),8,-1)},Ke=V.Object,Qe=y("".split),Ze=v(function(){return!Ke("z").propertyIsEnumerable(0)})?function(e){return"String"==qe(e)?Qe(e,""):Ke(e)}:Ke,$e=V.TypeError,k=function(e){return"function"==typeof e},E=function(e){return"object"==typeof e?null!==e:k(e)},et=y({}.isPrototypeOf),se=fe("navigator","userAgent")||"",ze=V.process,tt=V.Deno,ze=ze&&ze.versions||tt&&tt.version,tt=ze&&ze.v8,nt=e=!(e=tt?0<(Ft=tt.split("."))[0]&&Ft[0]<4?1:+(Ft[0]+Ft[1]):e)&&se&&(!(Ft=se.match(/Edge\/(\d+)/))||74<=Ft[1])&&(Ft=se.match(/Chrome\/(\d+)/))?+Ft[1]:e,rt=!!Object.getOwnPropertySymbols&&!v(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&nt&&nt<41}),it=rt&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,ot=V.Object,at=it?function(e){return"symbol"==typeof e}:function(e){var t=fe("Symbol");return k(t)&&et(t.prototype,ot(e))},st=V.String,lt=function(e){try{return st(e)}catch(e){return"Object"}},ut=V.TypeError,ct=function(e){if(k(e))return e;throw ut(lt(e)+" is not a function")},ht=function(e,t){e=e[t];return null==e?void 0:ct(e)},ft=V.TypeError,pt=function(e,t){var n,r;if("string"===t&&k(n=e.toString)&&!E(r=D(n,e)))return r;if(k(n=e.valueOf)&&!E(r=D(n,e)))return r;if("string"!==t&&k(n=e.toString)&&!E(r=D(n,e)))return r;throw ft("Can't convert object to primitive value")},dt=Object.defineProperty,ze="__core-js_shared__",gt=V[ze]||pe(ze,{}),tt=le(function(e){(e.exports=function(e,t){return gt[e]||(gt[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.21.1",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.21.1/LICENSE",source:"https://github.com/zloirock/core-js"})}),vt=V.Object,yt=y({}.hasOwnProperty),O=Object.hasOwn||function(e,t){return yt(de(e),t)},mt=0,St=Math.random(),bt=y(1..toString),Ct=tt("wks"),kt=V.Symbol,xt=kt&&kt.for,wt=it?kt:kt&&kt.withoutSetter||ge,Pt=V.TypeError,_t=c("toPrimitive"),Tt=function(e,t){if(!E(e)||at(e))return e;var n=ht(e,_t);if(n){if(n=D(n,e,t=void 0===t?"default":t),!E(n)||at(n))return n;throw Pt("Can't convert object to primitive value")}return pt(e,t=void 0===t?"number":t)},At=V.document,Lt=E(At)&&E(At.createElement),Mt=function(e){return Lt?At.createElement(e):{}},Rt=!f&&!v(function(){return 7!=Object.defineProperty(Mt("div"),"a",{get:function(){return 7}}).a}),Vt=Object.getOwnPropertyDescriptor,It={f:f?Vt:function(e,t){if(e=he(e),t=ve(t),Rt)try{return Vt(e,t)}catch(e){}if(O(e,t))return Ye(!D(Xe.f,e,t),e[t])}},Ft=f&&v(function(){return 42!=Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),Dt=V.String,Et=V.TypeError,x=function(e){if(E(e))return e;throw Et(Dt(e)+" is not an object")},Ot=V.TypeError,Nt=Object.defineProperty,Bt=Object.getOwnPropertyDescriptor,Gt="enumerable",jt="configurable",Xt="writable",Yt={f:f?Ft?function(e,t,n){var r;return x(e),t=ve(t),x(n),"function"==typeof e&&"prototype"===t&&"value"in n&&Xt in n&&!n[Xt]&&((r=Bt(e,t))&&r[Xt]&&(e[t]=n.value,n={configurable:(jt in n?n:r)[jt],enumerable:(Gt in n?n:r)[Gt],writable:!1})),Nt(e,t,n)}:Nt:function(e,t,n){if(x(e),t=ve(t),x(n),Rt)try{return Nt(e,t,n)}catch(e){}if("get"in n||"set"in n)throw Ot("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},zt=f?function(e,t,n){return Yt.f(e,t,Ye(1,n))}:function(e,t,n){return e[t]=n,e},Ut=y(Function.toString),Wt=(k(gt.inspectSource)||(gt.inspectSource=function(e){return Ut(e)}),gt.inspectSource),e=V.WeakMap,ze=k(e)&&/native code/.test(Wt(e)),Ht=tt("keys"),Jt={},qt="Object already initialized",Kt=V.TypeError,e=V.WeakMap,Qt=(Oe=ze||gt.state?(Re=gt.state||(gt.state=new e),Ve=y(Re.get),Ie=y(Re.has),Fe=y(Re.set),De=function(e,t){if(Ie(Re,e))throw new Kt(qt);return t.facade=e,Fe(Re,e,t),t},Ee=function(e){return Ve(Re,e)||{}},function(e){return Ie(Re,e)}):(Ne=ye("state"),Jt[Ne]=!0,De=function(e,t){if(O(e,Ne))throw new Kt(qt);return t.facade=e,zt(e,Ne,t),t},Ee=function(e){return O(e,Ne)?e[Ne]:{}},function(e){return O(e,Ne)}),{set:De,get:Ee,has:Oe,enforce:function(e){return Oe(e)?Ee(e):De(e,{})},getterFor:function(t){return function(e){if(E(e)&&(e=Ee(e)).type===t)return e;throw Kt("Incompatible receiver, "+t+" required")}}}),ze=Function.prototype,e=f&&Object.getOwnPropertyDescriptor,Zt=O(ze,"name"),$t={EXISTS:Zt,PROPER:Zt&&"something"===function(){}.name,CONFIGURABLE:Zt&&(!f||e(ze,"name").configurable)},en=le(function(e){var l=$t.CONFIGURABLE,t=Qt.get,u=Qt.enforce,c=String(String).split("String");(e.exports=function(e,t,n,r){var i,o=!!r&&!!r.unsafe,a=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet,r=r&&void 0!==r.name?r.name:t;k(n)&&("Symbol("===String(r).slice(0,7)&&(r="["+String(r).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),(!O(n,"name")||l&&n.name!==r)&&zt(n,"name",r),(i=u(n)).source||(i.source=c.join("string"==typeof r?r:""))),e===V?a?e[t]=n:pe(t,n):(o?!s&&e[t]&&(a=!0):delete e[t],a?e[t]=n:zt(e,t,n))})(Function.prototype,"toString",function(){return k(this)&&t(this).source||Wt(this)})}),tn=Math.ceil,nn=Math.floor,rn=function(e){e=+e;return e!=e||0==e?0:(0<e?nn:tn)(e)},on=Math.max,an=Math.min,sn=function(e,t){e=rn(e);return e<0?on(e+t,0):an(e,t)},ln=Math.min,un=function(e){return 0<e?ln(rn(e),9007199254740991):0},cn=function(e){return un(e.length)},Zt={includes:me(!0),indexOf:me(!1)},hn=Zt.indexOf,fn=y([].push),pn=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],dn=pn.concat("length","prototype"),gn={f:Object.getOwnPropertyNames||function(e){return Se(e,dn)}},vn={f:Object.getOwnPropertySymbols},yn=y([].concat),mn=fe("Reflect","ownKeys")||function(e){var t=gn.f(x(e)),n=vn.f;return n?yn(t,n(e)):t},Sn=/#|\.prototype\./,bn=be.normalize=function(e){return String(e).replace(Sn,".").toLowerCase()},Cn=be.data={},kn=be.NATIVE="N",xn=be.POLYFILL="P",wn=be,Pn=It.f,_n=y(y.bind),Tn=Array.isArray||function(e){return"Array"==qe(e)},e={},ze=(e[c("toStringTag")]="z","[object z]"===String(e)),An=c("toStringTag"),Ln=V.Object,Mn="Arguments"==qe(function(){return arguments}()),Rn=ze?qe:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=Ln(e),An))?t:Mn?qe(e):"Object"==(t=qe(e))&&k(e.callee)?"Arguments":t},Vn=[],In=fe("Reflect","construct"),Fn=/^\s*(?:class|function)\b/,Dn=y(Fn.exec),En=!Fn.exec(ke),On=(we.sham=!0,!In||v(function(){var e;return xe(xe.call)||!xe(Object)||!xe(function(){e=!0})||e})?we:xe),Nn=c("species"),Bn=V.Array,Gn=function(e){var t;return Tn(e)&&(t=e.constructor,(On(t)&&(t===Bn||Tn(t.prototype))||E(t)&&null===(t=t[Nn]))&&(t=void 0)),void 0===t?Bn:t},jn=y([].push),Xn={forEach:_e(0),map:_e(1),filter:_e(2),some:_e(3),every:_e(4),find:_e(5),findIndex:_e(6),filterReject:_e(7)},Yn=c("species"),zn=Xn.map,e=Te("map"),Un=(R({target:"Array",proto:!0,forced:!e},{map:function(e){return zn(this,e,1<arguments.length?arguments[1]:void 0)}}),V.String),w=function(e){if("Symbol"===Rn(e))throw TypeError("Cannot convert a Symbol value to a string");return Un(e)},Wn=function(e,t,n){t=ve(t);t in e?Yt.f(e,t,Ye(0,n)):e[t]=n},Hn=V.Array,Jn=Math.max,qn=function(e,t,n){for(var r=cn(e),i=sn(t,r),o=sn(void 0===n?r:n,r),a=Hn(Jn(o-i,0)),s=0;i<o;i++,s++)Wn(a,s,e[i]);return a.length=s,a},Kn=Math.floor,Qn=Ae,e=se.match(/firefox\/(\d+)/i),Zn=!!e&&+e[1],$n=/MSIE|Trident/.test(se),e=se.match(/AppleWebKit\/(\d+)\./),er=!!e&&+e[1],tr=[],nr=y(tr.sort),rr=y(tr.push),e=v(function(){tr.sort(void 0)}),ir=v(function(){tr.sort(null)}),t=Le("sort"),or=!v(function(){if(nt)return nt<70;if(!(Zn&&3<Zn)){if($n)return 1;if(er)return er<603;for(var e,t,n,r="",i=65;i<76;i++){switch(e=String.fromCharCode(i),i){case 66:case 69:case 70:case 72:t=3;break;case 68:case 71:t=4;break;default:t=2}for(n=0;n<47;n++)tr.push({k:e+n,v:t})}for(tr.sort(function(e,t){return t.v-e.v}),n=0;n<tr.length;n++)e=tr[n].k.charAt(0),r.charAt(r.length-1)!==e&&(r+=e);return"DGBEFHACIJK"!==r}}),ar=(R({target:"Array",proto:!0,forced:e||!ir||!t||!or},{sort:function(e){void 0!==e&&ct(e);var t=de(this);if(or)return void 0===e?nr(t):nr(t,e);for(var n,r,i=[],o=cn(t),a=0;a<o;a++)a in t&&rr(i,t[a]);for(Qn(i,(r=e,function(e,t){return void 0===t?-1:void 0===e?1:void 0!==r?+r(e,t)||0:w(e)>w(t)?1:-1})),n=i.length,a=0;a<n;)t[a]=i[a++];for(;a<o;)delete t[a++];return t}}),Math.floor),sr=Number.isInteger||function(e){return!E(e)&&isFinite(e)&&ar(e)===e},lr=(R({target:"Number",stat:!0},{isInteger:sr}),V.String),ur=V.TypeError,cr=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,e={};try{(n=y(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(e,[]),r=e instanceof Array}catch(e){}return function(e,t){return x(e),function(e){if("object"==typeof e||k(e))return;throw ur("Can't set "+lr(e)+" as a prototype")}(t),r?n(e,t):e.__proto__=t,e}}():void 0),hr=function(e,t,n){return cr&&k(t=t.constructor)&&t!==n&&E(t=t.prototype)&&t!==n.prototype&&cr(e,t),e},fr=y(1..valueOf),pr="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff",dr=y("".replace),e="["+pr+"]",gr=RegExp("^"+e+e+"*"),vr=RegExp(e+e+"*$"),ir={start:Me(1),end:Me(2),trim:Me(3)},t=gn.f,yr=It.f,mr=Yt.f,Sr=ir.trim,e="Number",br=V[e],Cr=br.prototype,kr=V.TypeError,xr=y("".slice),wr=y("".charCodeAt),Pr=function(e){var t,n,r,i,o,a,s,l=Tt(e,"number");if(at(l))throw kr("Cannot convert a Symbol value to a number");if("string"==typeof l&&2<l.length)if(l=Sr(l),43===(e=wr(l,0))||45===e){if(88===(t=wr(l,2))||120===t)return NaN}else if(48===e){switch(wr(l,1)){case 66:case 98:n=2,r=49;break;case 79:case 111:n=8,r=55;break;default:return+l}for(o=(i=xr(l,2)).length,a=0;a<o;a++)if((s=wr(i,a))<48||r<s)return NaN;return parseInt(i,n)}return+l};if(wn(e,!br(" 0o1")||!br("0b1")||br("+0x1"))){for(var _r,Tr=function(e){var e=arguments.length<1?0:br(function(e){e=Tt(e,"number");return"bigint"==typeof e?e:Pr(e)}(e)),t=this;return et(Cr,t)&&v(function(){fr(t)})?hr(Object(e),t,Tr):e},Ar=f?t(br):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Lr=0;Ar.length>Lr;Lr++)O(br,_r=Ar[Lr])&&!O(Tr,_r)&&mr(Tr,_r,yr(br,_r));(Tr.prototype=Cr).constructor=Tr,en(V,e,Tr)}function Mr(){var e=x(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}function Rr(t){if(t&&t.forEach!==Gr)try{zt(t,"forEach",Gr)}catch(e){t.forEach=Gr}}var Vr,t=Date.prototype,Ir="Invalid Date",e="toString",Fr=y(t[e]),Dr=y(t.getTime),t=(String(new Date(NaN))!=Ir&&en(t,e,function(){var e=Dr(this);return e==e?Fr(this):Ir}),ze?{}.toString:function(){return"[object "+Rn(this)+"]"}),e=(ze||en(Object.prototype,"toString",t,{unsafe:!0}),$t.PROPER),ze="toString",Er=RegExp.prototype,Or=Er[ze],Nr=y(Mr),t=v(function(){return"/a/b"!=Or.call({source:"a",flags:"b"})}),e=e&&Or.name!=ze,Br=((t||e)&&en(RegExp.prototype,ze,function(){var e=x(this),t=w(e.source),n=e.flags;return"/"+t+"/"+w(void 0!==n||!et(Er,e)||"flags"in Er?n:Nr(e))},{unsafe:!0}),Xn.forEach),Gr=Le("forEach")?[].forEach:function(e){return Br(this,e,1<arguments.length?arguments[1]:void 0)},jr=(R({target:"Array",proto:!0,forced:[].forEach!=Gr},{forEach:Gr}),{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),t=Mt("span").classList,e=t&&t.constructor&&t.constructor.prototype,ze=e===Object.prototype?void 0:e;for(Vr in jr)jr[Vr]&&Rr(V[Vr]&&V[Vr].prototype);Rr(ze);function Xr(){}function Yr(e){e.write(ai("")),e.close();var t=e.parentWindow.Object;return e=null,t}function zr(e){ci[ui][e]=!0}function Ur(n,e,t,r){var a,i=c(n),s=!v(function(){var e={};return e[i]=function(){return 7},7!=""[n](e)}),o=s&&!v(function(){var e=!1,t=/a/;return"split"===n&&((t={constructor:{}}).constructor[eo]=function(){return t},t.flags="",t[i]=/./[i]),t.exec=function(){return e=!0,null},t[i](""),!e});s&&o&&!t||(a=y(/./[i]),o=e(i,""[n],function(e,t,n,r,i){var e=y(e),o=t.exec;return o===Ki||o===to.exec?s&&!i?{done:!0,value:a(t,n,r)}:{done:!0,value:e(n,t,r)}:{done:!1}}),en(String.prototype,n,o[0]),en(to,i,o[1])),r&&zt(to[i],"sham",!0)}function Wr(e){if(On(e))return e;throw no(lt(e)+" is not a constructor")}function Hr(i){return function(e,t){var n,e=w(ce(e)),t=rn(t),r=e.length;return t<0||r<=t?i?"":void 0:(n=ao(e,t))<55296||56319<n||t+1===r||(r=ao(e,t+1))<56320||57343<r?i?oo(e,t):n:i?so(e,t,t+2):r-56320+(n-55296<<10)+65536}}function Jr(e,t,n){return t+(n?lo(e,t).length:1)}function qr(e,t){var n=e.exec;if(k(n))return null!==(n=D(n,e,t))&&x(n),n;if("RegExp"===qe(e))return D(Ki,e,t);throw uo("RegExp#exec called on incompatible receiver")}var Kr,t=Te("splice"),Qr=V.TypeError,Zr=Math.max,$r=Math.min,ei=(R({target:"Array",proto:!0,forced:!t},{splice:function(e,t){var n,r,i,o,a,s,l=de(this),u=cn(l),c=sn(e,u),e=arguments.length;if(0===e?n=r=0:r=1===e?(n=0,u-c):(n=e-2,$r(Zr(rn(t),0),u-c)),9007199254740991<u+n-r)throw Qr("Maximum allowed length exceeded");for(i=Pe(l,r),o=0;o<r;o++)(a=c+o)in l&&Wn(i,o,l[a]);if(n<(i.length=r)){for(o=c;o<u-r;o++)s=o+n,(a=o+r)in l?l[s]=l[a]:delete l[s];for(o=u;u-r+n<o;o--)delete l[o-1]}else if(r<n)for(o=u-r;c<o;o--)s=o+n-1,(a=o+r-1)in l?l[s]=l[a]:delete l[s];for(o=0;o<n;o++)l[o+c]=arguments[o+2];return l.length=u-r+n,i}}),Object.keys||function(e){return Se(e,pn)}),ti={f:f&&!Ft?Object.defineProperties:function(e,t){x(e);for(var n,r=he(t),i=ei(t),o=i.length,a=0;a<o;)Yt.f(e,n=i[a++],r[n]);return e}},ni=fe("document","documentElement"),ri="prototype",ii="script",oi=ye("IE_PROTO"),ai=function(e){return"<"+ii+">"+e+"</"+ii+">"},si=function(){try{Kr=new ActiveXObject("htmlfile")}catch(e){}si="undefined"==typeof document||document.domain&&Kr?Yr(Kr):(e=Mt("iframe"),t="java"+ii+":",e.style.display="none",ni.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(ai("document.F=Object")),t.close(),t.F);for(var e,t,n=pn.length;n--;)delete si[ri][pn[n]];return si()},li=(Jt[oi]=!0,Object.create||function(e,t){var n;return null!==e?(Xr[ri]=x(e),n=new Xr,Xr[ri]=null,n[oi]=e):n=si(),void 0===t?n:ti.f(n,t)}),ui=c("unscopables"),ci=Array.prototype,hi=(null==ci[ui]&&Yt.f(ci,ui,{configurable:!0,value:li(null)}),Xn.find),e="find",fi=!0,t=(e in[]&&Array(1)[e](function(){fi=!1}),R({target:"Array",proto:!0,forced:fi},{find:function(e){return hi(this,e,1<arguments.length?arguments[1]:void 0)}}),zr(e),$t.EXISTS),Ft=Yt.f,e=Function.prototype,pi=y(e.toString),di=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,gi=y(di.exec),vi=(f&&!t&&Ft(e,"name",{configurable:!0,get:function(){try{return gi(di,pi(this))[1]}catch(e){return""}}}),Xn.findIndex),t="findIndex",yi=!0,mi=(t in[]&&Array(1)[t](function(){yi=!1}),R({target:"Array",proto:!0,forced:yi},{findIndex:function(e){return vi(this,e,1<arguments.length?arguments[1]:void 0)}}),zr(t),Xn.filter),Ft=Te("filter"),Si=(R({target:"Array",proto:!0,forced:!Ft},{filter:function(e){return mi(this,e,1<arguments.length?arguments[1]:void 0)}}),Zt.includes),bi=(R({target:"Array",proto:!0},{includes:function(e){return Si(this,e,1<arguments.length?arguments[1]:void 0)}}),zr("includes"),c("match")),Ci=function(e){var t;return E(e)&&(void 0!==(t=e[bi])?!!t:"RegExp"==qe(e))},ki=V.TypeError,xi=c("match"),wi=y("".indexOf),Pi=(R({target:"String",proto:!0,forced:!function(t){var n=/./;try{"/./"[t](n)}catch(e){try{return n[xi]=!1,"/./"[t](n)}catch(e){}}return!1}("includes")},{includes:function(e){return!!~wi(w(ce(this)),w(function(e){if(Ci(e))throw ki("The method doesn't accept regular expressions");return e}(e)),1<arguments.length?arguments[1]:void 0)}}),y([].join)),e=Ze!=Object,t=Le("join",","),_i=(R({target:"Array",proto:!0,forced:e||!t},{join:function(e){return Pi(he(this),void 0===e?",":e)}}),c("isConcatSpreadable")),Ti=9007199254740991,Ai="Maximum allowed index exceeded",Li=V.TypeError,Ft=51<=nt||!v(function(){var e=[];return e[_i]=!1,e.concat()[0]!==e}),e=Te("concat"),Mi=(R({target:"Array",proto:!0,forced:!Ft||!e},{concat:function(e){for(var t,n,r,i=de(this),o=Pe(i,0),a=0,s=-1,l=arguments.length;s<l;s++)if(function(e){if(!E(e))return!1;var t=e[_i];return void 0!==t?!!t:Tn(e)}(r=-1===s?i:arguments[s])){if(n=cn(r),Ti<a+n)throw Li(Ai);for(t=0;t<n;t++,a++)t in r&&Wn(o,a,r[t])}else{if(Ti<=a)throw Li(Ai);Wn(o,a++,r)}return o.length=a,o}}),y([].slice)),t=Te("slice"),Ri=c("species"),Vi=V.Array,Ii=Math.max,Fi=(R({target:"Array",proto:!0,forced:!t},{slice:function(e,t){var n,r,i,o=he(this),a=cn(o),s=sn(e,a),l=sn(void 0===t?a:t,a);if(Tn(o)&&(n=o.constructor,(n=On(n)&&(n===Vi||Tn(n.prototype))||E(n)&&null===(n=n[Ri])?void 0:n)===Vi||void 0===n))return Mi(o,s,l);for(r=new(void 0===n?Vi:n)(Ii(l-s,0)),i=0;s<l;s++,i++)s in o&&Wn(r,i,o[s]);return r.length=i,r}}),V.RegExp),Ft=v(function(){var e=Fi("a","y");return e.lastIndex=2,null!=e.exec("abcd")}),e=Ft||v(function(){return!Fi("a","y").sticky}),t={BROKEN_CARET:Ft||v(function(){var e=Fi("^r","gy");return e.lastIndex=2,null!=e.exec("str")}),MISSED_STICKY:e,UNSUPPORTED_Y:Ft},Di=V.RegExp,Ei=v(function(){var e=Di(".","s");return!e.dotAll||!e.exec("\n")||"s"!==e.flags}),Oi=V.RegExp,Ni=v(function(){var e=Oi("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}),Bi=Qt.get,Gi=tt("native-string-replace",String.prototype.replace),ji=RegExp.prototype.exec,Xi=ji,Yi=y("".charAt),zi=y("".indexOf),Ui=y("".replace),Wi=y("".slice),Hi=(e=/b*/g,D(ji,Ft=/a/,"a"),D(ji,e,"a"),0!==Ft.lastIndex||0!==e.lastIndex),Ji=t.BROKEN_CARET,qi=void 0!==/()??/.exec("")[1],Ki=Xi=Hi||qi||Ji||Ei||Ni?function(e){var t,n,r,i,o,a,s=this,l=Bi(s),e=w(e),u=l.raw;if(u)return u.lastIndex=s.lastIndex,h=D(Xi,u,e),s.lastIndex=u.lastIndex,h;var c=l.groups,u=Ji&&s.sticky,h=D(Mr,s),l=s.source,f=0,p=e;if(u&&(h=Ui(h,"y",""),-1===zi(h,"g")&&(h+="g"),p=Wi(e,s.lastIndex),0<s.lastIndex&&(!s.multiline||s.multiline&&"\n"!==Yi(e,s.lastIndex-1))&&(l="(?: "+l+")",p=" "+p,f++),t=new RegExp("^(?:"+l+")",h)),qi&&(t=new RegExp("^"+l+"$(?!\\s)",h)),Hi&&(n=s.lastIndex),r=D(ji,u?t:s,p),u?r?(r.input=Wi(r.input,f),r[0]=Wi(r[0],f),r.index=s.lastIndex,s.lastIndex+=r[0].length):s.lastIndex=0:Hi&&r&&(s.lastIndex=s.global?r.index+r[0].length:n),qi&&r&&1<r.length&&D(Gi,r[0],t,function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(r[i]=void 0)}),r&&c)for(r.groups=o=li(null),i=0;i<c.length;i++)o[(a=c[i])[0]]=r[a[1]];return r}:Xi,tt=(R({target:"RegExp",proto:!0,forced:/./.exec!==Ki},{exec:Ki}),Function.prototype),Qi=tt.apply,Zi=tt.call,$i="object"==typeof Reflect&&Reflect.apply||(Be?Zi.bind(Qi):function(){return Zi.apply(Qi,arguments)}),eo=c("species"),to=RegExp.prototype,no=V.TypeError,ro=c("species"),io=function(e,t){var e=x(e).constructor;return void 0===e||null==(e=x(e)[ro])?t:Wr(e)},oo=y("".charAt),ao=y("".charCodeAt),so=y("".slice),e={codeAt:Hr(!1),charAt:Hr(!0)},lo=e.charAt,uo=V.TypeError,co=t.UNSUPPORTED_Y,ho=4294967295,fo=Math.min,po=[].push,go=y(/./.exec),vo=y(po),yo=y("".slice),mo=(Ur("split",function(i,d,g){var v="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,t){var n=w(ce(this)),r=void 0===t?ho:t>>>0;if(0==r)return[];if(void 0===e)return[n];if(!Ci(e))return D(d,n,e,r);for(var i,o,a,s=[],t=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),l=0,u=new RegExp(e.source,t+"g");(i=D(Ki,u,n))&&!(l<(o=u.lastIndex)&&(vo(s,yo(n,l,i.index)),1<i.length&&i.index<n.length&&$i(po,s,qn(i,1)),a=i[0].length,l=o,r<=s.length));)u.lastIndex===i.index&&u.lastIndex++;return l===n.length?!a&&go(u,"")||vo(s,""):vo(s,yo(n,l)),r<s.length?qn(s,0,r):s}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:D(d,this,e,t)}:d;return[function(e,t){var n=ce(this),r=null==e?void 0:ht(e,i);return r?D(r,e,n,t):D(v,w(n),e,t)},function(e,t){var n=x(this),r=w(e),e=g(v,n,r,t,v!==d);if(e.done)return e.value;var e=io(n,RegExp),i=n.unicode,o=(n.ignoreCase?"i":"")+(n.multiline?"m":"")+(n.unicode?"u":"")+(co?"g":"y"),a=new e(co?"^(?:"+n.source+")":n,o),s=void 0===t?ho:t>>>0;if(0==s)return[];if(0===r.length)return null===qr(a,r)?[r]:[];for(var l=0,u=0,c=[];u<r.length;){a.lastIndex=co?0:u;var h,f=qr(a,co?yo(r,u):r);if(null===f||(h=fo(un(a.lastIndex+(co?u:0)),r.length))===l)u=Jr(r,u,i);else{if(vo(c,yo(r,l,u)),c.length===s)return c;for(var p=1;p<=f.length-1;p++)if(vo(c,f[p]),c.length===s)return c;u=l=h}}return vo(c,yo(r,l)),c}]},!!v(function(){var e=/(?:)/,t=e.exec,e=(e.exec=function(){return t.apply(this,arguments)},"ab".split(e));return 2!==e.length||"a"!==e[0]||"b"!==e[1]}),co),Math.floor),So=y("".charAt),bo=y("".replace),Co=y("".slice),ko=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,xo=/\$([$&'`]|\d{1,2})/g,wo=c("replace"),Po=Math.max,_o=Math.min,To=y([].concat),Ao=y([].push),Lo=y("".indexOf),Mo=y("".slice),tt="$0"==="a".replace(/./,"$0"),Ro=!!/./[wo]&&""===/./[wo]("a","$0");function ne(e,t){t=1<arguments.length&&void 0!==t?t:0;if("number"!=typeof e)throw"Not a number.";if(0===t)return Math.round(e);t=Math.pow(10,t);return Math.round(e*t)/t}function Vo(e,t,n,r,i){for(var o=4<arguments.length&&void 0!==i?i:.1,a=e,s=t,l=n,u=l.length,c=l[u-1];u<s.length+a+1;u++)l[u]=c;for(var h=[],f=0;f<=1;f+=o){var p=Q(function(e,t,n,r,i){var o,a,s,l,u=n.length,c=n[0].length;if(t<1)throw new Error("degree must be at least 1 (linear)");if(u-1<t)throw new Error("degree must be less than or equal to point count - 1");if(!i)for(i=[],o=0;o<u;o++)i[o]=1;if(r){if(r.length!==u+t+1)throw new Error("bad knot vector length")}else for(r=[],o=0;o<u+t+1;o++)r[o]=o;var h=[t,r.length-1-t],f=r[h[0]],p=r[h[1]];if((e=e*(p-f)+f)<f||p<e)throw new Error("out of bounds");for(s=h[0];s<h[1]&&!(e>=r[s]&&e<=r[s+1]);s++);var d,g=[];for(o=0;o<u;o++){for(g[o]=[],a=0;a<c;a++)g[o][a]=n[o][a]*i[o];g[o][c]=i[o]}for(l=1;l<=t+1;l++)for(o=s;s-t-1+l<o;o--)for(d=(e-r[o])/(r[o+t+1-l]-r[o]),a=0;a<c+1;a++)g[o][a]=(1-d)*g[o-1][a]+d*g[o][a];var v=[];for(o=0;o<c;o++)v[o]=g[s][o]/g[s][c];return v}(f,e,t,n,r),2),d=p[0],p=p[1];isNaN(d)||isNaN(p)||h.push(ne(d,2),ne(p,2))}return h}Ur("replace",function(e,S,b){var C=Ro?"$":"$0";return[function(e,t){var n=ce(this),r=null==e?void 0:ht(e,wo);return r?D(r,e,n,t):D(S,w(n),e,t)},function(e,t){var n=x(this),r=w(e);if("string"==typeof t&&-1===Lo(t,C)&&-1===Lo(t,"$<")){e=b(S,n,r,t);if(e.done)return e.value}for(var i,o=k(t),a=(o||(t=w(t)),n.global),s=(a&&(i=n.unicode,n.lastIndex=0),[]);null!==(f=qr(n,r))&&(Ao(s,f),a);)""===w(f[0])&&(n.lastIndex=Jr(r,un(n.lastIndex),i));for(var l,u="",c=0,h=0;h<s.length;h++){for(var f,p=w((f=s[h])[0]),d=Po(_o(rn(f.index),r.length),0),g=[],v=1;v<f.length;v++)Ao(g,void 0===(l=f[v])?l:String(l));var y=f.groups,m=o?(m=To([p],g,d,r),void 0!==y&&Ao(m,y),w($i(t,void 0,m))):function(o,a,s,l,u,e){var c=s+o.length,h=l.length,t=xo;return void 0!==u&&(u=de(u),t=ko),bo(e,t,function(e,t){var n;switch(So(t,0)){case"$":return"$";case"&":return o;case"`":return Co(a,0,s);case"'":return Co(a,c);case"<":n=u[Co(t,1,-1)];break;default:var r,i=+t;if(0==i)return e;if(h<i)return 0!==(r=mo(i/10))&&r<=h?void 0===l[r-1]?So(t,1):l[r-1]+So(t,1):e;n=l[i-1]}return void 0===n?"":n})}(p,r,d,g,y,t);c<=d&&(u+=Mo(r,c,d)+m,c=d+p.length)}return u+Mo(r,c)}]},!!v(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})||!tt||Ro);var Io={Main:"Main",Relationships:"Relationships",DrawingML:"DrawingML",Theme:"Theme"},Fo={Main:"http://schemas.microsoft.com/office/visio/2012/main",Relationships:"http://schemas.openxmlformats.org/package/2006/relationships",ContentTypes:"http://schemas.openxmlformats.org/package/2006/content-types",DocumentRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",VisioMasterRelationship:"http://schemas.microsoft.com/visio/2010/relationships/master",DocumentImageRelationships:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CustomProperties:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",DocPropsVTypes:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",DrawingML:"http://schemas.openxmlformats.org/drawingml/2006/main",Theme:"http://schemas.microsoft.com/office/visio/2012/theme"},S={Cell:"Cell",Row:"Row",Master:"Master",Section:"Section",Shape:"Shape",ShapeText:"ShapeText",PageSheet:"PageSheet",Page:"Page",Icon:"Icon",Image:"Image",Document:"Document",StyleSheet:"StyleSheet",ForeignData:"ForeignData",DocumentSettings:"DocumentSettings",DocumentSheet:"DocumentSheet",SchemeClr:"SchemeClr",Connect:"Connect",FaceName:"FaceName"},Do={Name:"@N",Value:"@V",Units:"@U",Formula:"@F"},Eo={name:Do.Name,value:Do.Value,units:Do.Units,formula:Do.Formula},Oo="@NameU",No={Relationship:"Relationship",Id:"@Id",Type:"@Type",Target:"@Target"},Bo={Document:"Document",Master:"Master",Masters:"Masters",Page:"Page",Pages:"Pages",Windows:"Windows",Theme:"Theme",Image:"Image",Solutions:"Solutions",coreProperties:"coreProperties",thumbnail:"thumbnail",document:"document",customProperties:"customProperties",extendedProperties:"extendedProperties"},Go={"http://schemas.microsoft.com/visio/2010/relationships/windows":Bo.Windows,"http://schemas.microsoft.com/visio/2010/relationships/pages":Bo.Pages,"http://schemas.microsoft.com/visio/2010/relationships/page":Bo.Page,"http://schemas.microsoft.com/visio/2010/relationships/master":Bo.Master,"http://schemas.microsoft.com/visio/2010/relationships/masters":Bo.Masters,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme":Bo.Theme,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image":Bo.Image,"http://schemas.microsoft.com/visio/2010/relationships/solutions":Bo.Solutions,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties":"coreProperties","http://schemas.openxmlformats.org/package/2006/relationships/metadata/thumbnail":"thumbnail","http://schemas.microsoft.com/visio/2010/relationships/document":"document","http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties":"customProperties","http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties":"extendedProperties"},jo={Name:"@N",Id:"@IX",Row:"Row"},Xo="@N",Yo="@IX",zo={Id:"@ID",Shapes:"Shapes",Section:"Section",Cell:"Cell",Text:"Text",Connect:"Connect",Connects:"Connects",MasterShapeId:"@MasterShape",MasterId:"@Master",Type:"@Type"},Uo={Shape:"Shape"},Wo={Id:"@ID",Cell:"Cell",Row:"Row",Section:"Section",Text:"Text",Rel:"Rel",PageSheet:"PageSheet",Icon:"Icon",ForeignData:"ForeignData",Type:"@Type",xmlns:"@xmlns",xmlnsR:"@xmlns:r",xmlSpace:"@xml:space"},Ho={DocumentSettings:"DocumentSettings",Colors:"Colors",FaceNames:"FaceNames",StyleSheets:"StyleSheets",DocumentSheet:"DocumentSheet",ColorEntry:"ColorEntry",Ix:"@IX",Rgb:"@RGB"},Jo={CharacterProperties:"cp",Content:"keyValue"},qo={Content:"keyValue"},Ko={RelId:"@r:id"},s={AC:"AC",AD:"AD",BOOL:"BOOL",C:"C",C_D:"C_D",CM:"CM",COLOR:"COLOR",CY:"CY",D:"D",DA:"DA",DATE:"DATE",DE:"DE",DEG:"DEG",DL:"DL",DP:"DP",DT:"DT",ED:"ED",EH:"EH",EM:"EM",ES:"ES",EW:"EW",F_I:"F_I",FT:"FT",HA:"HA",IN:"IN",IN_F:"IN_F",KM:"KM",M:"M",MI:"MI",MI_F:"MI_F",MM:"MM",NM:"NM",PER:"PER",P_PT:"P_PT",PT:"PT",P:"P",PNT:"PNT",RAD:"RAD",STR:"STR",YD:"YD"},B={A:"A",Action:"Action",Active:"Active",AddMarkup:"AddMarkup",Address:"Address",AlignBottom:"AlignBottom",AlignCenter:"AlignCenter",AlignLeft:"AlignLeft",Alignment:"Alignment",Alignment0:"Alignment0",AlignMiddle:"AlignMiddle",AlignRight:"AlignRight",AlignTop:"AlignTop",Angle:"Angle",AsianFont:"AsianFont",AutoGen:"AutoGen",AvenueSizeX:"AvenueSizeX",AvenueSizeY:"AvenueSizeY",AvoidPageBreaks:"AvoidPageBreaks",B:"B",BeginArrow:"BeginArrow",BeginArrowSize:"BeginArrowSize",BeginGroup:"BeginGroup",BeginX:"BeginX",BeginY:"BeginY",BegTrigger:"BegTrigger",BevelBottomHeight:"BevelBottomHeight",BevelBottomType:"BevelBottomType",BevelBottomWidth:"BevelBottomWidth",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",BevelDepthColor:"BevelDepthColor",BevelDepthSize:"BevelDepthSize",BevelLightingAngle:"BevelLightingAngle",BevelLightingType:"BevelLightingType",BevelMaterialType:"BevelMaterialType",BevelTopHeight:"BevelTopHeight",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BlockSizeX:"BlockSizeX",BlockSizeY:"BlockSizeY",Blur:"Blur",BottomMargin:"BottomMargin",Brightness:"Brightness",Bullet:"Bullet",BulletFont:"BulletFont",BulletFontSize:"BulletFontSize",BulletStr:"BulletStr",ButtonFace:"ButtonFace",C:"C",Calendar:"Calendar",CanGlue:"CanGlue",Case:"Case",CenterX:"CenterX",CenterY:"CenterY",Checked:"Checked",ClippingPath:"ClippingPath",Color:"Color",ColorSchemeIndex:"ColorSchemeIndex",ColorTrans:"ColorTrans",Comment:"Comment",ComplexScriptFont:"ComplexScriptFont",ComplexScriptSize:"ComplexScriptSize",CompoundType:"CompoundType",ConFixedCode:"ConFixedCode",ConLineJumpCode:"ConLineJumpCode",ConLineJumpDirX:"ConLineJumpDirX",ConLineJumpDirY:"ConLineJumpDirY",ConLineJumpStyle:"ConLineJumpStyle",ConLineRouteExt:"ConLineRouteExt",ConnectorSchemeIndex:"ConnectorSchemeIndex",Contrast:"Contrast",Copyright:"Copyright",CtrlAsInput:"CtrlAsInput",CurrentIndex:"CurrentIndex",D:"D",DataLinked:"DataLinked",DblUnderline:"DblUnderline",Default:"Default",DefaultTabStop:"DefaultTabStop",Denoise:"Denoise",Description:"Description",DirX:"DirX",DirY:"DirY",Disabled:"Disabled",DisplayLevel:"DisplayLevel",DisplayMode:"DisplayMode",DistanceFromGround:"DistanceFromGround",DocLangID:"DocLangID",DocLockDuplicatePage:"DocLockDuplicatePage",DocLockReplace:"DocLockReplace",DontMoveChildren:"DontMoveChildren",DoubleStrikethrough:"DoubleStrikethrough",DrawingResizeType:"DrawingResizeType",DrawingScale:"DrawingScale",DrawingScaleType:"DrawingScaleType",DrawingSizeType:"DrawingSizeType",DropOnPageScale:"DropOnPageScale",DynamicsOff:"DynamicsOff",DynFeedback:"DynFeedback",E:"E",EffectSchemeIndex:"EffectSchemeIndex",EmbellishmentIndex:"EmbellishmentIndex",EnableFillProps:"EnableFillProps",EnableGrid:"EnableGrid",EnableLineProps:"EnableLineProps",EnableTextProps:"EnableTextProps",EndArrow:"EndArrow",EndArrowSize:"EndArrowSize",EndTrigger:"EndTrigger",EndX:"EndX",EndY:"EndY",EventDblClick:"EventDblClick",EventDrop:"EventDrop",EventMultiDrop:"EventMultiDrop",EventXFMod:"EventXFMod",ExtraInfo:"ExtraInfo",FillBkgnd:"FillBkgnd",FillBkgndTrans:"FillBkgndTrans",FillForegnd:"FillForegnd",FillForegndTrans:"FillForegndTrans",FillGradientAngle:"FillGradientAngle",FillGradientDir:"FillGradientDir",FillGradientEnabled:"FillGradientEnabled",FillPattern:"FillPattern",Flags:"Flags",FlipX:"FlipX",FlipY:"FlipY",FlyoutChild:"FlyoutChild",Font:"Font",FontScale:"FontScale",FontSchemeIndex:"FontSchemeIndex",Format:"Format",Frame:"Frame",Gamma:"Gamma",GlowColor:"GlowColor",GlowColorTrans:"GlowColorTrans",GlowSize:"GlowSize",Glue:"Glue",GlueType:"GlueType",GradientStopColor:"GradientStopColor",GradientStopColorTrans:"GradientStopColorTrans",GradientStopPosition:"GradientStopPosition",Height:"Height",HelpTopic:"HelpTopic",HideForApply:"HideForApply",HideText:"HideText",HorzAlign:"HorzAlign",ImgHeight:"ImgHeight",ImgOffsetX:"ImgOffsetX",ImgOffsetY:"ImgOffsetY",ImgWidth:"ImgWidth",IndFirst:"IndFirst",IndLeft:"IndLeft",IndRight:"IndRight",InhibitSnap:"InhibitSnap",Initials:"Initials",Invisible:"Invisible",IsDropSource:"IsDropSource",IsDropTarget:"IsDropTarget",IsSnapTarget:"IsSnapTarget",IsTextEditTarget:"IsTextEditTarget",KeepTextFlat:"KeepTextFlat",Label:"Label",LangID:"LangID",LayerMember:"LayerMember",LeftMargin:"LeftMargin",Letterspace:"Letterspace",LineAdjustFrom:"LineAdjustFrom",LineAdjustTo:"LineAdjustTo",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineGradientAngle:"LineGradientAngle",LineGradientDir:"LineGradientDir",LineGradientEnabled:"LineGradientEnabled",LineJumpCode:"LineJumpCode",LineJumpFactorX:"LineJumpFactorX",LineJumpFactorY:"LineJumpFactorY",LineJumpStyle:"LineJumpStyle",LinePattern:"LinePattern",LineRouteExt:"LineRouteExt",LineToLineX:"LineToLineX",LineToLineY:"LineToLineY",LineToNodeX:"LineToNodeX",LineToNodeY:"LineToNodeY",LineWeight:"LineWeight",LocalizeMerge:"LocalizeMerge",Lock:"Lock",LockAspect:"LockAspect",LockBegin:"LockBegin",LockCalcWH:"LockCalcWH",LockCrop:"LockCrop",LockCustProp:"LockCustProp",LockDelete:"LockDelete",LockEnd:"LockEnd",LockFormat:"LockFormat",LockFromGroupFormat:"LockFromGroupFormat",LockGroup:"LockGroup",LockHeight:"LockHeight",LockMoveX:"LockMoveX",LockMoveY:"LockMoveY",LockPreview:"LockPreview",LockReplace:"LockReplace",LockRotate:"LockRotate",LockSelect:"LockSelect",LockTextEdit:"LockTextEdit",LockThemeColors:"LockThemeColors",LockThemeConnectors:"LockThemeConnectors",LockThemeEffects:"LockThemeEffects",LockThemeFonts:"LockThemeFonts",LockThemeIndex:"LockThemeIndex",LockVariation:"LockVariation",LockVtxEdit:"LockVtxEdit",LockWidth:"LockWidth",LocPinX:"LocPinX",LocPinY:"LocPinY",Menu:"Menu",Name:"Name",NameUniv:"NameUniv",NewWindow:"NewWindow",NoAlignBox:"NoAlignBox",NoCoauth:"NoCoauth",NoCtlHandles:"NoCtlHandles",NoFill:"NoFill",NoLine:"NoLine",NoLiveDynamics:"NoLiveDynamics",NonPrinting:"NonPrinting",NoObjHandles:"NoObjHandles",NoProofing:"NoProofing",NoQuickDrag:"NoQuickDrag",NoShow:"NoShow",NoSnap:"NoSnap",ObjectKind:"ObjectKind",ObjType:"ObjType",OnPage:"OnPage",OutputFormat:"OutputFormat",Overline:"Overline",PageBottomMargin:"PageBottomMargin",PageHeight:"PageHeight",PageLeftMargin:"PageLeftMargin",PageLineJumpDirX:"PageLineJumpDirX",PageLineJumpDirY:"PageLineJumpDirY",PageLockDuplicate:"PageLockDuplicate",PageLockReplace:"PageLockReplace",PageRightMargin:"PageRightMargin",PageScale:"PageScale",PageShapeSplit:"PageShapeSplit",PagesX:"PagesX",PagesY:"PagesY",PageTopMargin:"PageTopMargin",PageWidth:"PageWidth",PaperKind:"PaperKind",PaperSource:"PaperSource",Perspective:"Perspective",PinX:"PinX",PinY:"PinY",PlaceDepth:"PlaceDepth",PlaceFlip:"PlaceFlip",PlaceStyle:"PlaceStyle",PlowCode:"PlowCode",Pos:"Pos",Position:"Position",Position0:"Position0",PreviewQuality:"PreviewQuality",PreviewScope:"PreviewScope",Print:"Print",PrintGrid:"PrintGrid",PrintPageOrientation:"PrintPageOrientation",Prompt:"Prompt",QuickStyleEffectsMatrix:"QuickStyleEffectsMatrix",QuickStyleFillColor:"QuickStyleFillColor",QuickStyleFillMatrix:"QuickStyleFillMatrix",QuickStyleFontColor:"QuickStyleFontColor",QuickStyleFontMatrix:"QuickStyleFontMatrix",QuickStyleLineColor:"QuickStyleLineColor",QuickStyleLineMatrix:"QuickStyleLineMatrix",QuickStyleShadowColor:"QuickStyleShadowColor",QuickStyleType:"QuickStyleType",QuickStyleVariation:"QuickStyleVariation",ReadOnly:"ReadOnly",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",Relationships:"Relationships",ReplaceCopyCells:"ReplaceCopyCells",ReplaceLockFormat:"ReplaceLockFormat",ReplaceLockShapeData:"ReplaceLockShapeData",ReplaceLockText:"ReplaceLockText",ResizeMode:"ResizeMode",ResizePage:"ResizePage",ReviewerID:"ReviewerID",RightMargin:"RightMargin",RotateGradientWithShape:"RotateGradientWithShape",RotationType:"RotationType",RotationXAngle:"RotationXAngle",RotationYAngle:"RotationYAngle",RotationZAngle:"RotationZAngle",Rounding:"Rounding",RouteStyle:"RouteStyle",ScaleX:"ScaleX",ScaleY:"ScaleY",SelectMode:"SelectMode",ShapeFixedCode:"ShapeFixedCode",ShapeKeywords:"ShapeKeywords",ShapePermeablePlace:"ShapePermeablePlace",ShapePermeableX:"ShapePermeableX",ShapePermeableY:"ShapePermeableY",ShapePlaceFlip:"ShapePlaceFlip",ShapePlaceStyle:"ShapePlaceStyle",ShapePlowCode:"ShapePlowCode",ShapeRouteStyle:"ShapeRouteStyle",ShapeShdwBlur:"ShapeShdwBlur",ShapeShdwObliqueAngle:"ShapeShdwObliqueAngle",ShapeShdwOffsetX:"ShapeShdwOffsetX",ShapeShdwOffsetY:"ShapeShdwOffsetY",ShapeShdwScaleFactor:"ShapeShdwScaleFactor",ShapeShdwShow:"ShapeShdwShow",ShapeShdwType:"ShapeShdwType",ShapeSplit:"ShapeSplit",ShapeSplittable:"ShapeSplittable",Sharpen:"Sharpen",ShdwBkgnd:"ShdwBkgnd",ShdwBkgndTrans:"ShdwBkgndTrans",ShdwForegnd:"ShdwForegnd",ShdwForegndTrans:"ShdwForegndTrans",ShdwObliqueAngle:"ShdwObliqueAngle",ShdwOffsetX:"ShdwOffsetX",ShdwOffsetY:"ShdwOffsetY",ShdwPattern:"ShdwPattern",ShdwScaleFactor:"ShdwScaleFactor",ShdwType:"ShdwType",Size:"Size",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",SketchSeed:"SketchSeed",Snap:"Snap",SoftEdgesSize:"SoftEdgesSize",SortKey:"SortKey",SpAfter:"SpAfter",SpBefore:"SpBefore",SpLine:"SpLine",Status:"Status",Strikethru:"Strikethru",Style:"Style",SubAddress:"SubAddress",TagName:"TagName",TextBkgnd:"TextBkgnd",TextBkgndTrans:"TextBkgndTrans",TextDirection:"TextDirection",TextPosAfterBullet:"TextPosAfterBullet",TheData:"TheData",ThemeIndex:"ThemeIndex",TheText:"TheText",TopMargin:"TopMargin",Transparency:"Transparency",TxtAngle:"TxtAngle",TxtHeight:"TxtHeight",TxtLocPinX:"TxtLocPinX",TxtLocPinY:"TxtLocPinY",TxtPinX:"TxtPinX",TxtPinY:"TxtPinY",TxtWidth:"TxtWidth",Type:"Type",UICat:"UICat",UICod:"UICod",UIFmt:"UIFmt",UIVisibility:"UIVisibility",UpdateAlignBox:"UpdateAlignBox",UseGroupGradient:"UseGroupGradient",Value:"Value",VariationColorIndex:"VariationColorIndex",VariationStyleIndex:"VariationStyleIndex",Verify:"Verify",VerticalAlign:"VerticalAlign",ViewMarkup:"ViewMarkup",Visible:"Visible",WalkPreference:"WalkPreference",Width:"Width",X:"X",XCon:"XCon",XDyn:"XDyn",XGridDensity:"XGridDensity",XGridOrigin:"XGridOrigin",XGridSpacing:"XGridSpacing",XJustify:"XJustify",XRulerDensity:"XRulerDensity",XRulerOrigin:"XRulerOrigin",Y:"Y",YCon:"YCon",YDyn:"YDyn",YGridDensity:"YGridDensity",YGridOrigin:"YGridOrigin",YGridSpacing:"YGridSpacing",YJustify:"YJustify",YRulerDensity:"YRulerDensity",YRulerOrigin:"YRulerOrigin"},Qo={Shape:"Shape",Group:"Group",Foreign:"Foreign",Guide:"Guide",MasterShape1:"MasterShape1",MasterShape2:"MasterShape2",Dummy:"Dummy",LinkLabel:"LinkLabel"},G={Actions:"Actions",ActionTag:"ActionTag",Character:"Character",Connection:"Connection",Control:"Control",Field:"Field",FillGradient:"FillGradient",Geometry:"Geometry",Hyperlink:"Hyperlink",Layer:"Layer",LineGradient:"LineGradient",Paragraph:"Paragraph",User:"User",Property:"Property",Scratch:"Scratch",Tabs:"Tabs"},Zo={Type:"@T",Name:"@N",UniqueIndex:"@IX",Deleted:"@Del"},h={Indexed:"Indexed",Named:"Named"},re={ArcTo:"ArcTo",Ellipse:"Ellipse",EllipticalArcTo:"EllipticalArcTo",InfiniteLine:"InfiniteLine",LineTo:"LineTo",MoveTo:"MoveTo",NURBSTo:"NURBSTo",PolylineTo:"PolylineTo",RelCubBezTo:"RelCubBezTo",RelEllipticalArcTo:"RelEllipticalArcTo",RelLineTo:"RelLineTo",RelMoveTo:"RelMoveTo",RelQuadBezTo:"RelQuadBezTo",SplineStart:"SplineStart",SplineKnot:"SplineKnot"},$o={ShapeSimple:"ShapeSimple",ShapeGroupItem:"ShapeGroupItem",ShapeMaster:"ShapeMaster",ShapeGroup:"ShapeGroup",ShapeForeign:"ShapeForeign",ShapeGuide:"ShapeGuide",GeneralMaster:"GeneralMaster",ShapeDeleteOverride:"ShapeDeleteOverride"},b={archive:"archive",xmlPath:"xmlPath",shapeId:"shapeId",source:"source",target:"target",_rel:"_rel",alignName:"alignName",baseID:"baseID",base64:"base64",background:"background",backPage:"backPage",beginX:"beginX",beginY:"beginY",cells:"cells",colors:"colors",connects:"connects",deleted:"deleted",defaultLineStyle:"defaultLineStyle",defaultTextStyle:"defaultTextStyle",defaultFillStyle:"defaultFillStyle",defaultGuideStyle:"defaultGuideStyle",documentSheet:"documentSheet",documentSettings:"documentSettings",dynamicGridEnabled:"dynamicGridEnabled",endX:"endX",endY:"endY",faceNames:"faceNames",fillStyle:"fillStyle",foreignData:"foreignData",foreignShapes:"foreignShapes",fromSheet:"fromSheet",fromCell:"fromCell",fromPart:"fromPart",glueSettings:"glueSettings",hidden:"hidden",icon:"icon",iconSize:"iconSize",iconUpdate:"iconUpdate",id:"id",index:"index",isCustomNameU:"isCustomNameU",isCustomName:"isCustomName",lineStyle:"lineStyle",master:"master",masterId:"masterId",masterShapeId:"masterShapeId",masterShape:"masterShape",masterType:"masterType",matchByName:"matchByName",name:"name",nameU:"nameU",n:"n",originalId:"originalId",pages:"pages",pageSheet:"pageSheet",patternFlags:"patternFlags",prompt:"prompt",protectStyles:"protectStyles",protectShapes:"protectShapes",protectMasters:"protectMasters",protectBkgnds:"protectBkgnds",rels:"rels",relations:"relations",relMasterShape:"relMasterShape",rows:"rows",shapes:"shapes",shape:"shape",sections:"sections",snapSettings:"snapSettings",snapExtensions:"snapExtensions",snapAngles:"snapAngles",styleSheets:"styleSheets",text:"text",textStyle:"textStyle",topPage:"topPage",toSheet:"toSheet",toCell:"toCell",toPart:"toPart",type:"type",uniqueId:"uniqueId",val:"val",viewScale:"viewScale",viewCenterX:"viewCenterX",viewCenterY:"viewCenterY",xmlns:"xmlns","xmlns:r":"xmlns:r","xml:space":"xml:space",jxon:"jxon"},ea={ignore:"ignore",number:"number",booleanStrict:"booleanStrict",booleanTriState:"booleanTriState",color:"color",asIs:"asIs",byte:"byte",date:"date",percentage:"percentage",internalUnitsToPixels:"internalUnitsToPixels",internalUnitsToDegrees:"internalUnitsToDegrees",resolveByPath:"resolveByPath"},ta="Section_Type",na="Row_Type",ra="PtgNum",r="PtgByte",i="PtgBool",ia="PtgString",oa="PtgColorRGB",aa="PtgShort",sa="PtgDate",la="PtgInt",ua="PtgUnsShort",ca="PtgNumI",ha="vLanguageString",fa="vFont",pa="vAny",da="vAngle",o="vScalar",a="vLength",ga="vColor",va="vFormatString",ya="formulaExpression",ma={AccentColor:"AccentColor",AccentColor2:"AccentColor2",AccentColor3:"AccentColor3",AccentColor4:"AccentColor4",AccentColor5:"AccentColor5",AccentColor6:"AccentColor6",AsianFont:"AsianFont",BackgroundColor:"BackgroundColor",BevelTopType:"BevelTopType",BevelTopWidth:"BevelTopWidth",BevelTopHeight:"BevelTopHeight",BevelMaterial:"BevelMaterial",BevelLighting:"BevelLighting",BevelLightingAngle:"BevelLightingAngle",BevelContourColor:"BevelContourColor",BevelContourSize:"BevelContourSize",ComplexFont:"ComplexFont",ConnectorColor:"ConnectorColor",ConnectorPattern:"ConnectorPattern",ConnectorWeight:"ConnectorWeight",ConnectorTransparency:"ConnectorTransparency",ConnectorRounding:"ConnectorRounding",ConnectorBegin:"ConnectorBegin",ConnectorEnd:"ConnectorEnd",ConnectorBeginSize:"ConnectorBeginSize",ConnectorEndSize:"ConnectorEndSize",Dark:"Dark",FillColor:"FillColor",FillColor2:"FillColor2",FillGradientEnabled:"FillGradientEnabled",FillGradientDir:"FillGradientDir",FillGradientAngle:"FillGradientAngle",FillPattern:"FillPattern",FillTransparency:"FillTransparency",GlowSize:"GlowSize",GlowColor:"GlowColor",GlowTransparency:"GlowTransparency",LatinFont:"LatinFont",Light:"Light",LineCap:"LineCap",LineColor:"LineColor",LineColorTrans:"LineColorTrans",LineCompoundtype:"LineCompoundtype",LineGradientEnabled:"LineGradientEnabled",LineGradientDir:"LineGradientDir",LineGradientAngle:"LineGradientAngle",LinePattern:"LinePattern",LineWeight:"LineWeight",LineBegin:"LineBegin",LineEnd:"LineEnd",LineBeginSize:"LineBeginSize",LineEndSize:"LineEndSize",LineRounding:"LineRounding",RotateGradientWithShape:"RotateGradientWithShape",ReflectionBlur:"ReflectionBlur",ReflectionDist:"ReflectionDist",ReflectionSize:"ReflectionSize",ReflectionTrans:"ReflectionTrans",ShadowType:"ShadowType",ShadowColor:"ShadowColor",ShadowTransparency:"ShadowTransparency",ShadowMagnification:"ShadowMagnification",ShadowBlur:"ShadowBlur",ShadowXOffset:"ShadowXOffset",ShadowYOffset:"ShadowYOffset",ShadowDirection:"ShadowDirection",ShadowPattern:"ShadowPattern",SoftEdgesSize:"SoftEdgesSize",SketchAmount:"SketchAmount",SketchEnabled:"SketchEnabled",SketchFillChange:"SketchFillChange",SketchLineChange:"SketchLineChange",SketchLineWeight:"SketchLineWeight",TextColor:"TextColor",TextStyle:"TextStyle",UseGroupGradient:"UseGroupGradient",VariantColor1:"VariantColor1",VariantColor2:"VariantColor2",VariantColor3:"VariantColor3",VariantColor4:"VariantColor4",VariantColor5:"VariantColor5",VariantColor6:"VariantColor6",VariantColor7:"VariantColor7"},Sa={Actions:h.Named,Character:h.Indexed,Connection:h.Indexed,Control:h.Named,Field:h.Indexed,FillGradient:h.Indexed,Geometry:h.Indexed,Hyperlink:h.Named,Layer:h.Indexed,LineGradient:h.Indexed,Paragraph:h.Indexed,Property:h.Named,Reviewer:h.Indexed,Scratch:h.Indexed,ActionTag:h.Named,Tabs:h.Indexed,User:h.Named},ba=ir.trim,Ca=y("".charAt),ka=V.parseFloat,tt=V.Symbol,xa=tt&&tt.iterator,tt=1/ka(pr+"-0")!=-1/0||xa&&!v(function(){ka(Object(xa))})?function(e){var e=ba(w(e)),t=ka(e);return 0===t&&"-"==Ca(e,0)?-0:t}:ka,j=(R({target:"Number",stat:!0,forced:Number.parseFloat!=tt},{parseFloat:tt}),R({target:"Number",stat:!0},{isNaN:function(e){return e!=e}}),{CONSOLE:1,TOOLTIPS:4,TEXT_FRAMES:4,level:0,log:function(){var e;j.level&j.CONSOLE&&(e=console).log.apply(e,arguments)}});var wa=v(function(){ei(1)});function Pa(e){"string"!=typeof e&&j.log("Value to convert is not a string.",e)}function _a(e){return Pa(e),Number(e)}function Ta(e){return Pa(e),Number(e)}function Aa(e,t){t=(1<arguments.length&&void 0!==t?t:{}).triState;return void 0!==t&&!t||void 0!==e?La(e):(j.log("boolean as a null"),null)}function La(e){return"0"!==e&&"1"!==e&&j.log("Can't convert string to boolean",e),"1"===e}function Ma(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.IN;switch(void 0!==e&&t||j.log("Value and target unit type are required to convert to a pixel value."),t){case s.IN:case s.IN_F:case s.DL:case s.DP:return 96*e;case s.MM:return Ra(e);case s.CM:return Ra(10*e);case s.DT:case s.PT:return e/72*96;default:return j.log('Unsupported numeric unit type "'.concat(Fa(t),'" ("').concat(t,'")')),e}}function Ra(e){return 3.7795275591*e}function Va(e){return e/3.7795275591}function Ia(e){return e/96}function Fa(e){var t;if(s.hasOwnProperty(e))return g(t={},s.AC,"Acres"),g(t,s.DEG,"Degrees"),g(t,s.DA,"Radians"),g(t,s.AD,"Degrees-minutes-seconds"),g(t,s.RAD,"Radians"),g(t,s.BOOL,"Boolean"),g(t,s.COLOR,"RGB color value"),g(t,s.CY,"Currency"),g(t,s.DATE,"Days"),g(t,s.ED,"Days"),g(t,s.EH,"Hours"),g(t,s.EM,"Minutes"),g(t,s.ES,"Seconds"),g(t,s.EW,"Weeks"),g(t,s.HA,"Hectare"),g(t,s.CM,"Centimeters"),g(t,s.DL,"Inches"),g(t,s.FT,"Feet"),g(t,s.F_I,"Feet and inches"),g(t,s.IN,"Inches"),g(t,s.IN_F,"Inches"),g(t,s.KM,"Kilometers"),g(t,s.M,"Meters"),g(t,s.MI,"Miles"),g(t,s.MI_F,"Miles"),g(t,s.MM,"Millimeters"),g(t,s.NM,"Nautical miles"),g(t,s.PER,"Percentage"),g(t,s.YD,"Yards"),g(t,s.DP,"Inches"),g(t,s.PNT,"Coordinates of a two-dimensional point"),g(t,s.STR,"String"),g(t,s.DE,"Days"),g(t,s.C_D,"Ciceros and didots"),g(t,s.C,"Ciceros"),g(t,s.D,"Didots"),g(t,s.DT,"Points"),g(t,s.P,"Picas"),g(t,s.P_PT,"Picas and points"),g(t,s.PT,"Points"),t[e];throw'Unknown unit type "'.concat(e,'".')}R({target:"Object",stat:!0,forced:wa},{keys:function(e){return ei(de(e))}});var Da=Math.sqrt,Ea=Math.cos,Oa=Math.sin,Na=Math.atan2,Ba=Math.abs,Ga=0,ja=0,Xa=null;function Ya(E,e,t){switch(E){case re.MoveTo:return za(e);case re.LineTo:return n=void 0===(n=(r=e).x)?Ga:n,r=r.y,Ga=n,ja=r=void 0===r?ja:r," L ".concat(ne(n)," ").concat(ne(r));case re.ArcTo:var n=e,r=n.x,i=n.y;if(0===(n=n.a))return" L ".concat(r," ").concat(i);var o=ja,a=Ba(r-Ga),o=Ba(i-o),o=a=Ba(ne(.5*n+(a*a+o*o)/(8*n),2)),s=Ba(a),l=(r=ne(r,2),i=ne(i,2),0<(n=ne(n,2))?1:0),s=s<Ba(n)?1:0;return Ga=r,ja=i," A ".concat(a," ").concat(o," 0 ").concat(s," ").concat(l," ").concat(r," ").concat(i);case re.EllipticalArcTo:return Ua(e);case re.Ellipse:return o=(a=e).x,s=a.y,l=a.a,i=a.b,D=a.c,a=a.d,l=Ba(l-o),i=Ba(i-s),l=Da(l*l+i*i),i=Ba(D-o),D=Ba(a-s),a=Da(i*i+D*D)," M ".concat(o-l," ").concat(s," A ").concat(l," ").concat(a," 0 1 0 ").concat(o+l," ").concat(s," A ").concat(l," ").concat(a," 0 1 0 ").concat(o-l," ").concat(s);case re.InfiniteLine:return V=(D=e).x,I=e.y,F=e.a,D=e.b," L ".concat(V," ").concat(I," ").concat(F," ").concat(D);case re.SplineStart:I=void 0===(I=(V=e).x)?Ga:I,F=void 0===(F=V.y)?ja:F,I=ne(I,2),F=ne(F,2),Xa={points:[[Ga,ja],[I,F]],knots:[V.b,V.a,V.c],degree:V.d},Ga=I,ja=F;break;case re.SplineKnot:var u=void 0===(u=(h=e).x)?Ga:u,c=void 0===(c=h.y)?ja:c,h=h.a;Ga=u=ne(u,2),ja=c=ne(c,2),Xa&&(M=(R=Xa).points,R=R.knots,M.push([u,c]),R.splice(R.length-1,0,h));break;case re.RelMoveTo:return M=e,c=(u=t).width,u=t.height,R=void 0===(R=M.x)?Ga:R,M=M.y,Ga=R*=c,ja=c=(c=void 0===M?ja:M)*u," M ".concat(ne(R)," ").concat(ne(c));case re.RelLineTo:return h=e,A=(T=t).width,T=t.height,L=void 0===(L=h.x)?Ga:L,h=h.y,Ga=L*=A,ja=A=(A=void 0===h?ja:h)*T," L ".concat(ne(L)," ").concat(ne(A));case re.RelCubBezTo:return T=e,A=(L=t).width,L=L.height,x=e.x*A,w=e.y*L,P=e.a*A,_=e.b*L,A=e.c*A,T=e.d*L,Ga=x,ja=w," C ".concat(ne(P)," ").concat(ne(_)," ").concat(ne(A)," ").concat(ne(T)," ").concat(ne(x)," ").concat(ne(w));case re.RelQuadBezTo:return P=e,x=(_=t).width,_=_.height,w=e.x*x,k=e.y*_,x=e.a*x,P=e.b*_,Ga=w,ja=k," Q ".concat(ne(x)," ").concat(ne(P)," ").concat(ne(w)," ").concat(ne(k));case re.RelEllipticalArcTo:return k=e,v=(m=t).width,m=t.height,S=e.x,b=e.y,C=e.a,d=e.b,g=e.c,k=e.d,Ua({x:S*v,y:b*m,a:C*v,b:d*v,c:g,d:k});case re.PolylineTo:return S=t,m=(b=e).x,C=b.y,b=b.a,Z=S.width,$=S.height,S=ie(Ha(b)),ee=S[0],te=S[1],(b=S.slice(2).map(function(e,t){t=t%2==0?0===ee?e*Z:96*e:0===te?e*$:96*e;return ne(t,2)})).push(m,C),Ga=m,ja=C,"L ".concat(b.join(" "));case re.NURBSTo:for(var f,p,O,N,d=t,g=(v=e).x,B=v.y,G=v.a,j=v.b,X=v.c,Y=v.d,v=v.e,z=d.width,U=d.height,W=[[Ga,ja]],H=[X],J=[Y],X=(d=ie(Ha(v)))[0],Y=d[1],q=d[2],K=d[3],Q=d.slice(4);0<Q.length;){var y=ie(Q);f=y[0],p=y[1],O=y[2],N=y[3],Q=y.slice(4),f*=0===q?z:96,p*=0===K?U:96,W.push([f,p]),H.push(O),J.push(N)}return H.push(G,X),W.push([g,B]),J.push(j),Ga=g,ja=B,0===(v=Vo(Y,W,H,J).join(" ")).length?"":" L ".concat(v)}var Z,$,ee,te,m,v,S,b,C,d,g,k,x,w,P,_,T,A,L,M,R,V,I,F,D,r,n;return""}function za(e){var t=e.x,t=void 0===t?Ga:t,e=e.y,e=void 0===e?ja:e;return Ga=t,ja=e," M ".concat(ne(t)," ").concat(ne(e))}function Ua(e){var t=e.x,t=void 0===t?Ga:t,n=e.y,n=void 0===n?ja:n,r=e.a,r=void 0===r?0:r,i=e.b,i=void 0===i?0:i,o=e.c,e=e.d,e=void 0===e?0:e,a=Ga,s=ja,l=t,u=n,o=-(void 0===o?0:o),c=(Ga=t,ja=n,N.g.toRad(o)),h=Da(a*a+s*s)*Ea(Na(s,a)-c),f=Da(a*a+s*s)*Oa(Na(s,a)-c),p=Da(l*l+u*u)*Ea(Na(u,l)-c),d=Da(l*l+u*u)*Oa(Na(u,l)-c),g=Da(r*r+i*i)*Ea(Na(i,r)-c),c=Da(r*r+i*i)*Oa(Na(i,r)-c),v=(h-p)*(d-c)-(p-g)*(f-d),y=(p-g)*(f-d)-(h-p)*(d-c);if(0==y)return" L ".concat(l," ").concat(u);var v=((h-p)*(h+p)*(d-c)-(p-g)*(p+g)*(f-d)+e*e*(f-d)*(d-c)*(f-c))/(2*v),y=((h-p)*(p-g)*(h-g)/(e*e)+(p-g)*(f-d)*(f+d)-(h-p)*(d-c)*(d+c))/(2*y),m=h-v,S=f-y,m=Da(m*m+S*S*e*e),S=m/e,e=0<(l-a)*(i-s)-(u-s)*(r-a)?0:1,l=0;return function(e,t,n,r,i,o,a,s){n=(i-=n)*(s-=r)-(a-=n)*(o-=r),r=(e*(o-s)+t*(a-i)+i*s-a*o)/n,s=(e*s-t*a)/n,a=(t*i-e*o)/n;if(0<r&&r<1&&0<s&&s<1&&0<a&&a<1)return 1;return}(v,y,h,f,p,d,g,c)&&function(e,t,n,r,i,o,a,s){n-=e,r-=t,o-=t,i=a-e,s-=t,t=e=0;r=N.g.toDeg(Na(r,n)-Na(t,e)),n=N.g.toDeg(Na(o,i)-Na(t,e)),o=N.g.toDeg(Na(s,a)-Na(t,e));if(r=N.g.normalizeAngle(r-o),n=N.g.normalizeAngle(n-o),(0<r&&n<0||r<0&&0<n)&&180<Ba(r-n))return 1;return}(v,y,h,f,p,d,g,c)&&(l=1)," A ".concat(ne(m,2)," ").concat(ne(S,2)," ").concat(o," ").concat(l," ").concat(e," ").concat(ne(t,2)," ").concat(ne(n,2))}function Wa(e,t,n){return" L ".concat(Vo(n,e,t).join(" "))}function Ha(e){return e.replace(/[A-Z]|\(|\)/g,"").split(/\s*,\s*/).map(function(e){return Number(e)})}function Ja(e){return Array.isArray(e)?e:[e]}function qa(e,t){var r=t.width,i=t.height;return Ja(e).map(function(e){n=(t={width:r,height:i}).width,t=t.height;var t,e=e.rows.map(function(e){return{name:e.type,cells:e.cells}}),n={width:n,height:t},s={width:n.width,height:n.height},l="";return Ga=ja=0,Xa=null,e.forEach(function(e,t,n){var r=e.name,e=e.cells;if(0===t&&r!==re.MoveTo&&(l+=za({x:0,y:0})),Xa){var i=Xa,o=i.points,a=i.knots,i=i.degree;if(n.length===t+1)return Ya(r,e,s),void(l+=Wa(o,a,i));r!==re.SplineKnot&&(l+=Wa(o,a,i),Xa=null)}l+=Ya(r,e,s)}),l}).join(" ")}R({target:"Array",stat:!0},{isArray:Tn});function Ka(){return this}function Qa(e,t,n,r,i,o,a){function s(e){if(e===i&&v)return v;if(!vs&&e in d)return d[e];switch(e){case"keys":case ms:case Ss:return function(){return new n(this,e)}}return function(){return new n(this)}}var l,u,c=n,h=t,f=void 0,f=(h+=" Iterator",c.prototype=li(hs,{next:Ye(+!f,r)}),cs(c,h,!1),ns[h]=fs,t+" Iterator"),p=!1,d=e.prototype,g=d[ys]||d["@@iterator"]||i&&d[i],v=!vs&&g||s(i);if((r="Array"==t&&d.entries||g)&&(c=as(r.call(new e)))!==Object.prototype&&c.next&&(as(c)!==gs&&(cr?cr(c,gs):k(c[ys])||en(c,ys,Ka)),cs(c,f,!0)),ps&&i==ms&&g&&g.name!==ms&&(ds?zt(d,"name",ms):(p=!0,v=function(){return D(g,this)})),i)if(l={values:s(ms),keys:o?v:s("keys"),entries:s(Ss)},a)for(u in l)!vs&&!p&&u in d||en(d,u,l[u]);else R({target:t,proto:!0,forced:vs||p},l);return d[ys]!==v&&en(d,ys,v,{name:i}),ns[t]=v,l}var Za,$a=Object.assign,es=Object.defineProperty,ts=y([].concat),wa=!$a||v(function(){if(f&&1!==$a({b:1},$a(es({},"a",{enumerable:!0,get:function(){es(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return 1;var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=$a({},e)[n]||ei($a({},t)).join("")!=r})?function(e,t){for(var n=de(e),r=arguments.length,i=1,o=vn.f,a=Xe.f;i<r;)for(var s,l=Ze(arguments[i++]),u=o?ts(ei(l),o(l)):ei(l),c=u.length,h=0;h<c;)s=u[h++],f&&!D(a,l,s)||(n[s]=l[s]);return n}:$a,ns=(R({target:"Object",stat:!0,forced:Object.assign!==wa},{assign:wa}),{}),wa=!v(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),rs=ye("IE_PROTO"),is=V.Object,os=is.prototype,as=wa?is.getPrototypeOf:function(e){e=de(e);if(O(e,rs))return e[rs];var t=e.constructor;return k(t)&&e instanceof t?t.prototype:e instanceof is?os:null},ss=c("iterator"),wa=!1,n=([].keys&&("next"in(n=[].keys())?(n=as(as(n)))!==Object.prototype&&(Za=n):wa=!0),null==Za||v(function(){var e={};return Za[ss].call(e)!==e})),n=(k((Za=n?{}:Za)[ss])||en(Za,ss,function(){return this}),{IteratorPrototype:Za,BUGGY_SAFARI_ITERATORS:wa}),ls=Yt.f,us=c("toStringTag"),cs=function(e,t,n){(e=e&&!n?e.prototype:e)&&!O(e,us)&&ls(e,us,{configurable:!0,value:t})},hs=n.IteratorPrototype,fs=function(){return this},ps=$t.PROPER,ds=$t.CONFIGURABLE,gs=n.IteratorPrototype,vs=n.BUGGY_SAFARI_ITERATORS,ys=c("iterator"),ms="values",Ss="entries",wa=Yt.f,bs="Array Iterator",Cs=Qt.set,ks=Qt.getterFor(bs),xs=Qa(Array,"Array",function(e,t){Cs(this,{type:bs,target:he(e),index:0,kind:t})},function(){var e=ks(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?{value:e.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}},"values"),n=ns.Arguments=ns.Array;if(zr("keys"),zr("values"),zr("entries"),f&&"values"!==n.name)try{wa(n,"name",{value:"values"})}catch(e){}function ws(e){return void 0!==e&&(ns.Array===e||Ns[Os]===e)}function Ps(e,t){if(t=arguments.length<2?Gs(e):t,ct(t))return x(D(t,e));throw js(lt(e)+" is not iterable")}function _s(e,t){this.stopped=e,this.result=t}function Ts(e,t,n){function r(e){return o&&Xs(o,"normal",e),new _s(!0,e)}function i(e){return f?(x(e),d?g(e[0],e[1],r):g(e[0],e[1])):d?g(e,r):g(e)}var o,a,s,l,u,c,h=n&&n.that,f=!(!n||!n.AS_ENTRIES),p=!(!n||!n.IS_ITERATOR),d=!(!n||!n.INTERRUPTED),g=Ce(t,h);if(p)o=e;else{if(!(n=Gs(e)))throw Ys(lt(e)+" is not iterable");if(ws(n)){for(a=0,s=cn(e);a<s;a++)if((l=i(e[a]))&&et(zs,l))return;return}o=Ps(e,n)}for(u=o.next;!(c=D(u,o)).done;){try{l=i(c.value)}catch(e){Xs(o,"throw",e)}if("object"==typeof l&&l&&et(zs,l))return}}function As(e,t){if(!et(t,e))throw Us("Incorrect invocation")}var Ls=gn.f,Ms="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Rs={f:function(e){if(!Ms||"Window"!=qe(e))return Ls(he(e));try{return Ls(e)}catch(e){return qn(Ms)}}},Vs=v(function(){var e;"function"==typeof ArrayBuffer&&(e=new ArrayBuffer(8),Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8}))}),Is=Object.isExtensible,Fs=v(function(){Is(1)})||Vs?function(e){return!!E(e)&&((!Vs||"ArrayBuffer"!=qe(e))&&(!Is||Is(e)))}:Is,Ds=!v(function(){return Object.isExtensible(Object.preventExtensions({}))}),Es=le(function(e){function n(e){t(e,a,{value:{objectID:"O"+i++,weakData:{}}})}var t=Yt.f,r=!1,a=ge("meta"),i=0,s=e.exports={enable:function(){s.enable=function(){},r=!0;var i=gn.f,o=y([].splice),e={};e[a]=1,i(e).length&&(gn.f=function(e){for(var t=i(e),n=0,r=t.length;n<r;n++)if(t[n]===a){o(t,n,1);break}return t},R({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Rs.f}))},fastKey:function(e,t){if(!E(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!O(e,a)){if(!Fs(e))return"F";if(!t)return"E";n(e)}return e[a].objectID},getWeakData:function(e,t){if(!O(e,a)){if(!Fs(e))return!0;if(!t)return!1;n(e)}return e[a].weakData},onFreeze:function(e){return Ds&&r&&Fs(e)&&!O(e,a)&&n(e),e}};Jt[a]=!0}),Os=(Es.enable,Es.fastKey,Es.getWeakData,Es.onFreeze,c("iterator")),Ns=Array.prototype,Bs=c("iterator"),Gs=function(e){if(null!=e)return ht(e,Bs)||ht(e,"@@iterator")||ns[Rn(e)]},js=V.TypeError,Xs=function(e,t,n){var r,i;x(e);try{if(!(r=ht(e,"return"))){if("throw"===t)throw n;return n}r=D(r,e)}catch(e){i=!0,r=e}if("throw"===t)throw n;if(i)throw r;return x(r),n},Ys=V.TypeError,zs=_s.prototype,Us=V.TypeError,Ws=c("iterator"),Hs=!1;try{var Js=0,qs={next:function(){return{done:!!Js++}},return:function(){Hs=!0}};qs[Ws]=function(){return this},Array.from(qs,function(){throw 2})}catch(e){}function Ks(e,t){if(!t&&!Hs)return!1;var n=!1;try{var r={};r[Ws]=function(){return{next:function(){return{done:n=!0}}}},e(r)}catch(e){}return n}function Qs(e,t,n){function r(e){var n=y(p[e]);en(p,e,"add"==e?function(e){return n(this,0===e?0:e),this}:"delete"==e?function(e){return!(c&&!E(e))&&n(this,0===e?0:e)}:"get"==e?function(e){return c&&!E(e)?void 0:n(this,0===e?0:e)}:"has"==e?function(e){return!(c&&!E(e))&&n(this,0===e?0:e)}:function(e,t){return n(this,0===e?0:e,t),this})}var i,o,a,s,l,u=-1!==e.indexOf("Map"),c=-1!==e.indexOf("Weak"),h=u?"set":"add",f=V[e],p=f&&f.prototype,d=f,g={};wn(e,!k(f)||!(c||p.forEach&&!v(function(){(new f).entries().next()})))?(d=n.getConstructor(t,e,u,h),Es.enable()):wn(e,!0)&&(o=(i=new d)[h](c?{}:-0,1)!=i,a=v(function(){i.has(1)}),s=Ks(function(e){new f(e)}),l=!c&&v(function(){for(var e=new f,t=5;t--;)e[h](t,t);return!e.has(-0)}),s||(((d=t(function(e,t){As(e,p);e=hr(new f,e,d);return null!=t&&Ts(t,e[h],{that:e,AS_ENTRIES:u}),e})).prototype=p).constructor=d),(a||l)&&(r("delete"),r("has"),u&&r("get")),(l||o)&&r(h),c&&p.clear&&delete p.clear),g[e]=d,R({global:!0,forced:d!=f},g),cs(d,e),c||n.setStrong(d,e,u)}function Zs(e,t,n){for(var r in t)en(e,r,t[r],n);return e}function $s(e){var e=fe(e),t=Yt.f;f&&e&&!e[nl]&&t(e,nl,{configurable:!0,get:function(){return this}})}function el(t,e){if(t){if(t[hl]!==pl)try{zt(t,hl,pl)}catch(e){t[hl]=pl}if(t[fl]||zt(t,fl,e),jr[e])for(var n in xs)if(t[n]!==xs[n])try{zt(t,n,xs[n])}catch(e){t[n]=xs[n]}}}var tl,nl=c("species"),rl=Yt.f,il=Es.fastKey,ol=Qt.set,al=Qt.getterFor,wa={getConstructor:function(e,n,r,i){function o(e,t,n){var r,i=l(e),o=a(e,t);return o?o.value=n:(i.last=o={index:r=il(t,!0),key:t,value:n,previous:t=i.last,next:void 0,removed:!1},i.first||(i.first=o),t&&(t.next=o),f?i.size++:e.size++,"F"!==r&&(i.index[r]=o)),e}function a(e,t){var n,e=l(e),r=il(t);if("F"!==r)return e.index[r];for(n=e.first;n;n=n.next)if(n.key==t)return n}var e=e(function(e,t){As(e,s),ol(e,{type:n,index:li(null),first:void 0,last:void 0,size:0}),f||(e.size=0),null!=t&&Ts(t,e[i],{that:e,AS_ENTRIES:r})}),s=e.prototype,l=al(n);return Zs(s,{clear:function(){for(var e=l(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,f?e.size=0:this.size=0},delete:function(e){var t,n,r=l(this),e=a(this,e);return e&&(t=e.next,n=e.previous,delete r.index[e.index],e.removed=!0,n&&(n.next=t),t&&(t.previous=n),r.first==e&&(r.first=t),r.last==e&&(r.last=n),f?r.size--:this.size--),!!e},forEach:function(e){for(var t,n=l(this),r=Ce(e,1<arguments.length?arguments[1]:void 0);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!a(this,e)}}),Zs(s,r?{get:function(e){e=a(this,e);return e&&e.value},set:function(e,t){return o(this,0===e?0:e,t)}}:{add:function(e){return o(this,e=0===e?0:e,e)}}),f&&rl(s,"size",{get:function(){return l(this).size}}),e},setStrong:function(e,t,n){var r=t+" Iterator",i=al(t),o=al(r);Qa(e,t,function(e,t){ol(this,{type:r,target:e,state:i(e),kind:t,last:void 0})},function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:e.target=void 0,done:!0}},n?"entries":"values",!n,!0),$s(t)}},sl=(Qs("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wa),e.charAt),ll="String Iterator",ul=Qt.set,cl=Qt.getterFor(ll),hl=(Qa(String,"String",function(e){ul(this,{type:ll,string:w(e),index:0})},function(){var e=cl(this),t=e.string,n=e.index;return n>=t.length?{value:void 0,done:!0}:(t=sl(t,n),e.index+=t.length,{value:t,done:!1})}),c("iterator")),fl=c("toStringTag"),pl=xs.values;for(tl in jr)el(V[tl]&&V[tl].prototype,tl);el(ze,"DOMTokenList");function dl(s){return function(e){for(var t,n=he(e),r=ei(n),i=r.length,o=0,a=[];o<i;)t=r[o++],f&&!gl(n,t)||vl(a,s?[t,n[t]]:n[t]);return a}}var gl=y(Xe.f),vl=y([].push),yl={entries:dl(!0),values:dl(!1)}.entries,ml=(R({target:"Object",stat:!0},{entries:function(e){return yl(e)}}),Xn.some),n=Le("some"),Sl=(R({target:"Array",proto:!0,forced:!n},{some:function(e){return ml(this,e,1<arguments.length?arguments[1]:void 0)}}),function(){function n(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set,e=(l(this,n),this.assertArchiveDefined(e),m(m({},this.getDefaultAttributes()),e));t.add(b.archive),this._prefixList=t,this.setAttributes(e)}return u(n,[{key:"getDefaultAttributes",value:function(){return{archive:null}}},{key:"prefixList",get:function(){return this._prefixList}},{key:"setAttribute",value:function(e,t){this.prefixList.has(e)&&(e="_".concat(e)),this[e]=t}},{key:"setAttributes",value:function(e){var n=this;Object.entries(e).forEach(function(e){var e=Q(e,2),t=e[0],e=e[1];return n.setAttribute(t,e)}),"structurePath"in e&&this.setOwner(e.structurePath)}},{key:"setOwner",value:function(e){1===e.length?this.owner=e[0].jxonType:bl(e,S.StyleSheet)?this.owner="Document-Stylesheet":bl(e,S.DocumentSheet)?this.owner="Document-DocumentSheet":bl(e,S.PageSheet)?bl(e,S.Page)?this.owner="Page-PageSheet":bl(e,S.Master)?this.owner="Master-PageSheet":j.log("Unknown PageSheet owner"):bl(e,S.Shape)?bl(e,S.Page)?this.owner="Page-Shape":bl(e,S.Master)?this.owner="Master-Shape":j.log("Unknown Shape owner"):window.tests}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e}},{key:"archive",get:function(){return this._archive}},{key:"assertArchiveDefined",value:function(e){e.hasOwnProperty("archive")&&e.archive||j.log("Missing archive reference in constructor",this)}}]),n}());function bl(e,t){return e.some(function(e){return e.jxonType===t})}function Cl(e){return"string"!=typeof e?"":e.charAt(0).toLowerCase()+e.slice(1)}function kl(u){return function(e,t,n,r){ct(t);var i=de(e),o=Ze(i),a=cn(i),s=u?a-1:0,l=u?-1:1;if(n<2)for(;;){if(s in o){r=o[s],s+=l;break}if(s+=l,u?s<0:a<=s)throw _l("Reduce of empty array with no initial value")}for(;u?0<=s:s<a;s+=l)s in o&&(r=t(r,o[s],s,i));return r}}var xl=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};l(this,t),this._name=e.name,this._value=e.value,this._formula=e.formula,this._units=e.units,this._cells=e.cells}return u(t,[{key:"name",get:function(){return this._name}},{key:"value",get:function(){return this._value}},{key:"formula",get:function(){return this._formula}},{key:"units",get:function(){return this._units}},{key:"eval",value:function(){return this._cells[Cl(this.name)]}}]),t}(),wl=function(){z(t,Sl);var e=q(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"getOwnCellNames",value:function(){var e=this.cells;return e?e.getOwnNames():[]}},{key:"getCell",value:function(e){var t=this.cells;if(!t)return j.log("Visio object does not contain cells."),null;e=t.get(e);return e?new xl(m(m({},e),{},{cells:t})):null}},{key:"setCell",value:function(e,t){var n=this.cells,r=this.jxon;n?n.set(e,t,r):j.log("Visio object does not contain cells.")}},{key:"removeCell",value:function(e){var t=this.cells,n=this.jxon;t&&t.get(e)&&t.remove(e,n)}}]),t}(),Pl=Xn.every,qs=Le("every"),_l=(R({target:"Array",proto:!0,forced:!qs},{every:function(e){return Pl(this,e,1<arguments.length?arguments[1]:void 0)}}),V.TypeError),e={left:kl(!1),right:kl(!0)},Tl="process"==qe(V.process),Al=e.left,ze=Le("reduce");function Ll(e,t){var n=function(e){if(["pageBottomMargin","pageLeftMargin","pageRightMargin","pageTopMargin"].includes(e.name))return ea.internalUnitsToPixels;return null}(t);if(null!==n)return n;if(t.units===s.PER)return ea.percentage;switch(e){case o:case ra:case r:case aa:case ua:case la:case ca:return ea.number;case a:return ea.internalUnitsToPixels;case sa:return ea.date;case da:return ea.internalUnitsToDegrees;case i:return ea.booleanStrict;case oa:case ga:return ea.color;case pa:"STR"!==t.units&&"value"!==t.name&&j.log("resolve VisioValueType.vAny",t);case fa:case ha:case va:case ia:case ya:return ea.asIs}j.log("unresolved cell type")}R({target:"Array",proto:!0,forced:!ze||!Tl&&79<nt&&nt<83},{reduce:function(e){var t=arguments.length;return Al(this,e,t,1<t?arguments[1]:void 0)}});var Ml={evaluateFormulas:!1};function Rl(e){return e===ma.Light?"#ffffff":e===ma.Dark?"#000000":e===ma.AccentColor?"#c05046":e===ma.AccentColor2?"#9dbb61":e===ma.AccentColor3?"#ab9ac0":e===ma.AccentColor4?"#4bacc6":e===ma.AccentColor5?"#f59d56":e===ma.AccentColor6?"#ffc000":e===ma.VariantColor1?"#c05046":e===ma.VariantColor2?"#9dbb61":e===ma.VariantColor3?"#ab9ac0":e===ma.VariantColor4?"#4bacc6":e===ma.VariantColor5?"#f59d56":e===ma.VariantColor6?"#ffc000":e===ma.VariantColor7?"#000000":void j.log("Unknown themeVal")}function Vl(e,t){return b.hasOwnProperty(e)||j.log("Unknown VisioAttribute.".concat(e)),null===t?null:[b.id,b.masterId,b.masterShapeId,b.fromSheet,b.fromPart,b.toSheet,b.toPart,b.index].includes(e)?Ta(t):[b.patternFlags,b.masterType,b.alignName,b.iconSize,b.topPage,b.defaultTextStyle,b.defaultLineStyle,b.defaultFillStyle,b.defaultGuideStyle,b.glueSettings,b.snapSettings,b.snapExtensions,b.fillStyle,b.lineStyle,b.textStyle,b.backPage].includes(e)?_a(t):[b.isCustomNameU,b.isCustomName,b.hidden,b.iconUpdate,b.matchByName,b.protectStyles,b.protectShapes,b.protectMasters,b.protectBkgnds,b.dynamicGridEnabled,b.deleted,b.background].includes(e)?Aa(t):t}function Il(e,r,t){return t||j.log("Structure path not set.",{jxon:e,jxonType:r}),S.hasOwnProperty(r)||j.log('Unknown "VisioJXONType.'.concat(r,'"')),Object.entries(e).filter(function(e){var e=Q(e,2),t=e[0];e[1];return"@"===t[0]}).filter(function(e){var e=Q(e,2),t=e[0];e[1];return![Wo.xmlns,Wo.xmlnsR,Wo.xmlSpace].includes(t)}).reduce(function(e,t){var t=Q(t,2),n=t[0],t=t[1],n=Fl(n.substring(1),r);return e[n]=Vl(n,t),e},{})}function Fl(e,t){if("IX"===e)return"index";if("ID"===e)return"id";if("UniqueID"===e)return"uniqueId";if("OriginalID"===e)return"originalId";if(e===Zo.Deleted.substring(1))return b.deleted;if(t===S.ShapeText&&e===Jo.Content)return"content";if(t===S.Section&&e===jo.Name.substring(1))return"type";if(t===S.Row){if(e===Zo.Type.substring(1))return"type";if(e===Zo.Name.substring(1))return"name"}if(t===S.Shape){if(e===zo.MasterShapeId.substring(1))return b.masterShapeId;if(e===zo.MasterId.substring(1))return b.masterId}return Cl(e)}function Dl(e,t,n,r){var r=3<arguments.length&&void 0!==r?r:{},i=r.typeOverride,i=void 0===i?null:i,r=r.structurePathEnrichObject,r=void 0===r?null:r,o=(n&&t||j.log("Missing required attributes."),{jxonType:e,xsdType:"".concat(e,"_Type")}),a=Il(t,e,n);return[b.id,b.name,b.masterId,b.masterShapeId,b.type,b.index].forEach(function(e){a.hasOwnProperty(e)&&(o[e]=a[e])}),i&&(o.type=i),o=r?m(m({},o),r):o}function El(e){return v(function(){return pr[e]()||"\u200b\x85\u180e"!=="\u200b\x85\u180e"[e]()||Wl&&pr[e].name!==e})}var Ol=V.Function,Nl=y([].concat),Bl=y([].join),Gl={},n=Be?Ol.bind:function(a){var s=ct(this),e=s.prototype,l=Mi(arguments,1),u=function(){var e=Nl(l,Mi(arguments));if(this instanceof u){var t=s,n=e.length,r=e;if(!O(Gl,n)){for(var i=[],o=0;o<n;o++)i[o]="a["+o+"]";Gl[n]=Ol("C,a","return new C("+Bl(i,",")+")")}return Gl[n](t,r)}return s.apply(a,e)};return E(e)&&(u.prototype=e),u},jl=(R({target:"Function",proto:!0,forced:Function.bind!==n},{bind:n}),ir.trim),Xl=V.parseInt,qs=V.Symbol,Yl=qs&&qs.iterator,zl=/^[+-]?0x/i,Ul=y(zl.exec),ze=8!==Xl(pr+"08")||22!==Xl(pr+"0x16")||Yl&&!v(function(){Xl(Object(Yl))})?function(e,t){e=jl(w(e));return Xl(e,t>>>0||(Ul(zl,e)?16:10))}:Xl,Wl=(R({global:!0,forced:parseInt!=ze},{parseInt:ze}),$t.PROPER),Hl=ir.end,n=El("trimEnd"),qs=n?function(){return Hl(this)}:"".trimEnd;function Jl(e,t,n){if(0<=e)return e;var r,e=-e/96;return r=n.size,t.forEach(function(e){var t,e=e.characterProperties;e&&(t=e.values.size,void 0!==e.values.size&&(r=Math.max(r,t)))}),r*e}R({target:"String",proto:!0,name:"trimEnd",forced:n},{trimEnd:qs,trimRight:qs});var ql,Kl,n=V.Promise,Ql=V.TypeError,qs=/(?:ipad|iphone|ipod).*applewebkit/i.test(se),Zl=V.setImmediate,$l=V.clearImmediate,eu=V.process,tu=V.Dispatch,nu=V.Function,ru=V.MessageChannel,iu=V.String,ou=0,au={},su="onreadystatechange";try{ql=V.location}catch(e){}function lu(e){return function(){_u(e)}}function uu(e){_u(e.data)}function cu(e){V.postMessage(iu(e),ql.protocol+"//"+ql.host)}function hu(e){var n,r;this.promise=new e(function(e,t){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=e,r=t}),this.resolve=ct(n),this.reject=ct(r)}function fu(){this.head=null,this.tail=null}function pu(e,t){var n,r,i,o,a=t.value,s=t.state==ec,l=s?e.ok:e.fail,u=e.resolve,c=e.reject,h=e.domain;try{l?(s||(t.rejection===rc&&(o=t,D(Ou,V,function(){var e=o.facade;Tl?Hu.emit("rejectionHandled",e):sc($u,e,o.value)})),t.rejection=nc),!0===l?n=a:(h&&h.enter(),n=l(a),h&&(h.exit(),i=!0)),n===e.promise?c(Uu("Promise-chain cycle")):(r=oc(n))?D(r,n,u,c):u(n)):c(a)}catch(e){h&&!i&&h.exit(),c(e)}}var du,gu,vu,yu,mu,Su,bu,Cu,ku,xu,wu,Pu,_u=function(e){var t;O(au,e)&&(t=au[e],delete au[e],t())},ru=(Zl&&$l||(Zl=function(e){var t=arguments.length,n=1;if(t<n)throw Ql("Not enough arguments");var r=k(e)?e:nu(e),i=Mi(arguments,1);return au[++ou]=function(){$i(r,void 0,i)},Kl(ou),ou},$l=function(e){delete au[e]},Tl?Kl=function(e){eu.nextTick(lu(e))}:tu&&tu.now?Kl=function(e){tu.now(lu(e))}:ru&&!qs?(Tu=(ru=new ru).port2,ru.port1.onmessage=uu,Kl=Ce(Tu.postMessage,Tu)):V.addEventListener&&k(V.postMessage)&&!V.importScripts&&ql&&"file:"!==ql.protocol&&!v(cu)?(Kl=cu,V.addEventListener("message",uu,!1)):Kl=su in Mt("script")?function(e){ni.appendChild(Mt("script"))[su]=function(){ni.removeChild(this),_u(e)}}:function(e){setTimeout(lu(e),0)}),{set:Zl,clear:$l}),Tu=/ipad|iphone|ipod/i.test(se)&&void 0!==V.Pebble,Zl=/web0s(?!.*chrome)/i.test(se),$l=It.f,Au=ru.set,se=V.MutationObserver||V.WebKitMutationObserver,Lu=V.document,Mu=V.process,Ru=V.Promise,$l=$l(V,"queueMicrotask"),$l=$l&&$l.value,Vu=($l||(du=function(){var e,t;for(Tl&&(e=Mu.domain)&&e.exit();gu;){t=gu.fn,gu=gu.next;try{t()}catch(e){throw gu?yu():vu=void 0,e}}vu=void 0,e&&e.enter()},yu=qs||Tl||Zl||!se||!Lu?!Tu&&Ru&&Ru.resolve?((qs=Ru.resolve(void 0)).constructor=Ru,bu=Ce(qs.then,qs),function(){bu(du)}):Tl?function(){Mu.nextTick(du)}:(Au=Ce(Au,V),function(){Au(du)}):(mu=!0,Su=Lu.createTextNode(""),new se(du).observe(Su,{characterData:!0}),function(){Su.data=mu=!mu})),$l||function(e){e={fn:e,next:void 0};vu&&(vu.next=e),gu||(gu=e,yu()),vu=e}),Iu={f:function(e){return new hu(e)}},Fu=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}},Du=(fu.prototype={add:function(e){e={item:e,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}},fu),Eu="object"==typeof window,Ou=ru.set,Nu=c("species"),Bu="Promise",Gu=Qt.getterFor(Bu),ju=Qt.set,Xu=Qt.getterFor(Bu),Zl=n&&n.prototype,Yu=n,zu=Zl,Uu=V.TypeError,Wu=V.document,Hu=V.process,Ju=Iu.f,qu=Ju,Ku=!!(Wu&&Wu.createEvent&&V.dispatchEvent),Qu=k(V.PromiseRejectionEvent),Zu="unhandledrejection",$u="rejectionhandled",ec=1,tc=2,nc=1,rc=2,ic=!1,Tu=wn(Bu,function(){var e=Wt(Yu),t=e!==String(Yu);if(!t&&66===nt)return!0;if(51<=nt&&/native code/.test(e))return!1;function n(e){e(function(){},function(){})}e=new Yu(function(e){e(1)});return(e.constructor={})[Nu]=n,!(ic=e.then(function(){})instanceof n)||!t&&Eu&&!Qu}),Ru=Tu||!Ks(function(e){Yu.all(e).catch(function(){})}),oc=function(e){var t;return!(!E(e)||!k(t=e.then))&&t},ac=function(n,i){n.notified||(n.notified=!0,Vu(function(){for(var e,r,t=n.reactions;e=t.get();)pu(e,n);n.notified=!1,i&&!n.rejection&&(r=n,D(Ou,V,function(){var e=r.facade,t=r.value,n=lc(r);if(n&&(n=Fu(function(){Tl?Hu.emit("unhandledRejection",t,e):sc(Zu,e,t)}),r.rejection=Tl||lc(r)?rc:nc,n.error))throw n.value}))}))},sc=function(e,t,n){var r;Ku?((r=Wu.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),V.dispatchEvent(r)):r={promise:t,reason:n},!Qu&&(t=V["on"+e])?t(r):e===Zu&&function(e,t){var n=V.console;n&&n.error&&(1==arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},lc=function(e){return e.rejection!==nc&&!e.parent},uc=function(t,n,r){return function(e){t(n,e,r)}},cc=function(e,t,n){e.done||(e.done=!0,(e=n?n:e).value=t,e.state=tc,ac(e,!0))},hc=function(n,e,t){if(!n.done){n.done=!0,t&&(n=t);try{if(n.facade===e)throw Uu("Promise can't be resolved itself");var r=oc(e);r?Vu(function(){var t={done:!1};try{D(r,e,uc(hc,t,n),uc(cc,t,n))}catch(e){cc(t,e,n)}}):(n.value=e,n.state=ec,ac(n,!1))}catch(e){cc({done:!1},e,n)}}};if(Tu&&(zu=(Yu=function(e){As(this,zu),ct(e),D(Cu,this);var t=Gu(this);try{e(uc(hc,t),uc(cc,t))}catch(e){cc(t,e)}}).prototype,(Cu=function(e){ju(this,{type:Bu,done:!1,notified:!1,parent:!1,reactions:new Du,rejection:!1,state:0,value:void 0})}).prototype=Zs(zu,{then:function(e,t){var n=Xu(this),r=Ju(io(this,Yu));return n.parent=!0,r.ok=!k(e)||e,r.fail=k(t)&&t,r.domain=Tl?Hu.domain:void 0,0==n.state?n.reactions.add(r):Vu(function(){pu(r,n)}),r.promise},catch:function(e){return this.then(void 0,e)}}),ku=function(){var e=new Cu,t=Gu(e);this.promise=e,this.resolve=uc(hc,t),this.reject=uc(cc,t)},Iu.f=Ju=function(e){return e===Yu||e===xu?new ku:qu(e)},k(n)&&Zl!==Object.prototype)){wu=Zl.then,ic||(en(Zl,"then",function(e,t){var n=this;return new Yu(function(e,t){D(wu,n,e,t)}).then(e,t)},{unsafe:!0}),en(Zl,"catch",zu.catch,{unsafe:!0}));try{delete Zl.constructor}catch(e){}cr&&cr(Zl,zu)}function fc(e,t){var r,c,h,t=t||{},f=t.attributes,p=t.annotations,d=null==t.maxWidth?1e6:t.maxWidth,t=!!t.overflowAllowed,n=e.split("\n"),i=n.length,o=0,g=0,a="",v=0,s=N.util.merge([],p),n=(n.forEach(function(e){r=0,c=[],h=[];for(var t=m(e);t;)!function e(t){var n=!!c.length;var r=!!h.length;var i=!n&&!r;var o="";n&&(o=c[c.length-1].cumulativeText);r&&(o=h[h.length-1].cumulativeText);var a=o+t.text;var s=g-o.length;var l=g+t.text.length;s=N.V.findAnnotationsBetweenIndexes(p,s,l);var u=v-o.length;l=N.util.toArray(s).reduce(function(e,t){return e.push({start:t.start-u,end:t.end-u,attrs:t.attrs}),e},[]);o=pc(a,f,l).width;s="whitespace"===t.type;l=o<=d;if(!r&&(l||s))return S(t.text),void b(t,a);o="piece"===t.type;l=i;if(l)return S(t.text),void b(t,a);o&&0<t.pieceIndex&&S("-",!0);n&&C();r&&k();e(t)}(t),t=m(e);h.length&&k(),o<i-1&&S("\n"),o+=1}),a.split("\n")),l=n.length;if(t&&1===i&&2===n.length){var t=n[0],n=n[1],u=N.util.merge([],s),y=N.V.findAnnotationsBetweenIndexes(u,0,t.length),u=N.V.shiftAnnotations(N.V.findAnnotationsBetweenIndexes(u,t.length,t.length+n.length),t.length,-t.length-1),t=this.measureText(t,f,y).width;if(this.measureText(n,f,u).width<Math.min(.4*t,100))return{numLines:l,text:e,annotations:p}}return{numLines:l,text:a,annotations:s};function m(e){for(var t={type:null,startIndex:r,endIndex:r,text:""};r<e.length;){var n=e[r];if(/\s/.test(n))switch(t.type){case null:case"whitespace":t.type="whitespace",t.text+=n,t.endIndex+=1;break;default:return t}else{if("whitespace"===t.type)return t;t.type="word",t.text+=n,t.endIndex+=1}r+=1}return t.startIndex===t.endIndex?null:t}function S(e,t){a+=e,t&&N.V.shiftAnnotations(s,g,e.length),v+=e.length}function b(e,t){c.push({token:e,cumulativeText:t}),g+=e.text.length}function C(){var e=c[c.length-1];"whitespace"===e.type&&(e=e.text,N.V.shiftAnnotations(s,g,-e.length),v-=e.length),S("\n",!0),c=[]}function k(){var t="";h.forEach(function(e){t+=e.token.text,S(e.token.text),b(e.token,t),g-=e.token.text.length}),h=[]}}function pc(e,t,n,r){var t=t||{},r=r||{heightCompensation:!1},i=(Pu||(i=N.V("svg"),document.body.appendChild(i.node),(Pu=N.V("text")).attr("visibility","hidden"),i.append(Pu)),Pu.attr({"font-weight":t["font-weight"],"font-size":t["font-size"],"font-family":t["font-family"],"letter-spacing":t["letter-spacing"],style:"font-kerning: none"}),Pu.text(e,{lineHeight:N.util.isEmpty(n)?t["line-height"]||"1em":"auto",replaceNewLine:"\u2002",annotations:n}),Pu.node.removeAttribute("display"),Pu.bbox(!0));return r.heightCompensation&&(i.height-=i.y),i.y=0,i.x=0,i}function dc(e){var l,u=[],c=null,h=null,f=[],p=0,t=e.text,n=e.sections.get("Paragraph")[0].rows[0].cells,r=n.spLine,i=n.horzAlign,d=(t.forEach(function(e){e.paragraphProperties&&(void 0!==(e=e.paragraphProperties.values).spLine&&(r=e.spLine),void 0!==e.horzAlign&&(i=e.horzAlign))}),e.sections.get("Character")[0].rows[0].cells),n=Jl(r,t,d);return t.forEach(function(e){var t=e.content,n=(l=p,t.length),n=(p=l+n,d.uppercase),r=d.font,i=d.color,o=d.style,a=d.size,s=d.letterspace,e=(e.characterProperties&&(void 0!==(e=e.characterProperties.values).uppercase&&(n=e.uppercase),void 0!==e.font&&(r=e.font),void 0!==e.color&&(i=e.color),void 0!==e.style&&(o=e.style),void 0!==e.size&&(a=e.size),void 0!==e.letterspace&&(s=e.letterspace)),{}),n=(1===n&&(t=t.toUpperCase()),2===n&&(t="string"!=typeof(n=t)?"":n.charAt(0).toUpperCase()+n.slice(1),e["text-transform"]="capitalize"),s&&0!==s&&(e["letter-spacing"]=s),r&&(c=c||r,e["font-family"]=r),void 0!==a&&(h=h||a,e["font-size"]=a,e["font-size"]<1&&(e["font-size"]=12)),void 0!==i&&(e.fill=i),void 0!==o&&(4&o&&(e["text-decoration"]="underline"),2&o&&(e["font-style"]="italic"),1&o&&(e["font-weight"]="bold")),u.push(t),{start:l,end:p,attrs:e});f.push(n)}),{mergedText:u.join("").trimEnd(),annotations:f,lineHeight:n,firstFont:c,firstFontSize:h,horzAlign:i}}function gc(e,t){var n=t.markup,r=t.attrs,i=t.prefix,t=t.isRootGroupText,o=e.cells,a=e.width,s=e.height,l=o.angle,u=o.locPinX,u=void 0===u?a/2:u,c=o.locPinY,c=void 0===c?s/2:c,h=o.txtAngle,h=void 0===h?0:h,f=o.flipX,p=o.flipY,d=o.txtHeight,d=void 0===d?s:d,g=o.txtWidth,g=void 0===g?a:g,v=o.txtPinX,v=void 0===v?a/2:v,y=o.txtPinY,y=void 0===y?s/2:y,m=o.txtLocPinX,m=void 0===m?g/2:m,S=o.txtLocPinY,S=void 0===S?d/2:S,b=o.verticalAlign,C=o.leftMargin,C=void 0===C?0:C,k=o.rightMargin,k=void 0===k?0:k,x=o.topMargin,x=void 0===x?0:x,o=o.bottomMargin,o=void 0===o?0:o,i="".concat(i,"text"),w=f?-g+u-v+m:-u+v-m,P=p?s-c+y-S:s-d+c-y+S,_=f?g-u+v-m:u-v+m,T=p?c-y+S:d-c+y-S,h=(f?-1:1)*(p?-1:1)*h,f=f?m-g:m,p=p?S:d-S;t&&(w+=u,P-=c);t=["translate(".concat(w,", ").concat(P,")"),"rotate(".concat(l,", ").concat(_,", ").concat(T,")"),"rotate(".concat(h,", ").concat(f,", ").concat(p,")")].join(" "),u=[{tagName:"text",selector:i,attributes:{stroke:"none",fill:"#000000"}}],j.level&j.TEXT_FRAMES&&u.unshift({tagName:"rect",attributes:{width:g,height:d,fill:"transparent",stroke:"#ff0000",strokeWidth:1}}),n.push({tagName:"g",text:!0,attributes:{transform:t},children:u}),c=dc(e),w=c.mergedText,P=c.annotations,l=c.lineHeight,_=c.firstFont,T=c.firstFontSize,h=c.horzAlign,f=fc(w,{annotations:P,hyphenationAllowed:!1,maxWidth:g-C-k}),p=r[i]={text:f.text,lineHeight:l,fontFamily:_||"sans-serif",letterSpacing:0,firstFontSize:T,annotations:f.annotations};N.util.assign(p,function(e){var t=e.verticalAlign,n=e.height,r=e.topMargin,i=e.fontShoulder,o=e.bottomMargin,a=e.txtHeight,s=void 0===a?n:a,l=(e.txtLocPinY,(r+s-o)/2),u="middle";switch(t){case 1:break;case 2:l=s-o-i,u="bottom";break;default:l=r+i,u="top"}return{y:l,textVerticalAnchor:u}}({verticalAlign:b,height:s,topMargin:x,fontShoulder:(l-T)/2,bottomMargin:o,txtPinY:y,txtLocPinY:S,txtHeight:d}),function(e){var t=e.horzAlign,n=e.width,r=e.leftMargin,i=e.rightMargin,e=e.txtWidth,o=void 0===e?n:e,a=(r+o-i)/2,s="middle";switch(t){case 0:a=r,s="start";break;case 2:a=o-i,s="end"}return{x:a,textAnchor:s}}({horzAlign:h,width:a,leftMargin:C,rightMargin:k,txtPinX:v,txtLocPinX:m,txtWidth:g}))}function vc(e,t){var t=t.maxWidth,e=dc(e),n=e.mergedText,e=e.annotations;return pc(fc(n,{annotations:e,maxWidth:t}).text,{},e)}R({global:!0,wrap:!0,forced:Tu},{Promise:Yu}),cs(Yu,Bu,!1),$s(Bu),xu=fe(Bu),R({target:Bu,stat:!0,forced:Tu},{reject:function(e){var t=Ju(this);return D(t.reject,void 0,e),t.promise}}),R({target:Bu,stat:!0,forced:Tu},{resolve:function(e){var t=this;return x(t),E(e)&&e.constructor===t?e:((0,(t=Iu.f(t)).resolve)(e),t.promise)}}),R({target:Bu,stat:!0,forced:Ru},{all:function(e){var s=this,t=Ju(s),l=t.resolve,u=t.reject,n=Fu(function(){var r=ct(s.resolve),i=[],o=0,a=1;Ts(e,function(e){var t=o++,n=!1;a++,D(r,s,e).then(function(e){n||(n=!0,i[t]=e,--a||l(i))},u)}),--a||l(i)});return n.error&&u(n.value),t.promise},race:function(e){var n=this,r=Ju(n),i=r.reject,t=Fu(function(){var t=ct(n.resolve);Ts(e,function(e){D(t,n,e).then(r.resolve,i)})});return t.error&&i(t.value),r.promise}});function yc(e){var t=e[0]/239*360,n=e[1]/240,e=e[2]/240,n=(1-Math.abs(2*e-1))*n,r=n*(1-Math.abs(t/60%2-1)),e=e-n/2,i=0,o=0,a=0;return 0<=t&&t<60?(i=n,o=r,a=0):60<=t&&t<120?(i=r,o=n,a=0):120<=t&&t<180?(i=0,o=n,a=r):180<=t&&t<240?(i=0,o=r,a=n):240<=t&&t<300?(i=r,o=0,a=n):300<=t&&t<360&&(i=n,o=0,a=r),i=Math.round(255*(i+e)).toString(16),o=Math.round(255*(o+e)).toString(16),a=Math.round(255*(a+e)).toString(16),"#"+(i=1===i.length?"0"+i:i)+(o=1===o.length?"0"+o:o)+(a=1===a.length?"0"+a:a)}function mc(e){return e[0]}function Sc(e){return e[0]}function bc(e){return e.reduce(function(e,t){return Math.max(e,t)})}function Cc(e){var e=Q(e,2),t=e[0],e=e[1];return Math.atan2(t,e)}function kc(e){return Math.sqrt(e[0])}function xc(e){return"1"===e[0].toString()?e[1]:e[2]}function wc(e){var e=Q(e,2),t=e[0],e=e[1];if(isNaN(t)||isNaN(e))throw Error("#VALUE");if(t=parseInt(t),e=parseInt(e),t<0||e<0)throw Error("#NUM");return Math.floor(t)!==t||Math.floor(e)!==e||0xffffffffffff<t||0xffffffffffff<e?"#NUM!":((t^e)>>>0).toString(2)}var Pc=function(){z(i,d.Parser);var r=q(i);function i(e,t){var n;return l(this,i),(n=r.call(this)).registerFunctions(e,t),n.registerEvents(t),n}return u(i,[{key:"registerFunctions",value:function(e,t){this.setFunction("HSL",yc),this.setFunction("PAGENUMBER",function(e){return e.page.index+1}.bind(this,t)),this.setFunction("PAGECOUNT",function(e){return(e=e.pages.pages)?e.length:0}.bind(this,t.archive.document)),this.setFunction("GUARD",mc),this.setFunction("PAR",Sc),this.setFunction("PNT",function(e,t){switch(e.name[e.name.length-1]){case"X":return t[0];case"Y":return t[1];default:throw Error("#VALUE")}}.bind(this,e)),this.setFunction("ATAN2",Cc),this.setFunction("SQRT",kc),this.setFunction("IF",xc),this.setFunction("BITXOR",wc),this.setFunction("MAX",bc),this.setFunction("TEXTWIDTH",function(e,t){var t=Q(t,2)[1],t=isNaN(t)?1e6:96*t,n=e.cells,r=void 0===(r=n.leftMargin)?0:r,n=void 0===(n=n.rightMargin)?0:n;return Ia(vc(e,{maxWidth:t}).width+r+n)}.bind(this,t)),this.setFunction("TEXTHEIGHT",function(e,t){var t=Q(t,2)[1],t=isNaN(t)?1e6:96*t,n=e.cells,r=void 0===(r=n.topMargin)?0:r,n=void 0===(n=n.bottomMargin)?0:n;return Ia(vc(e,{maxWidth:t}).height+r+n)}.bind(this,t))}},{key:"registerEvents",value:function(e){var t=this;this.on("callFunction",function(e){t.getFunction(e)}),this.on("callVariable",function(e,t,n){if(t===_c.THE_TEXT)return r=dc(e).mergedText,n(r);var r=t.charAt(0).toLowerCase()+t.slice(1),t=e.cells.get(r);t=t||e.cells.getParentCell(r);{if(!(e=t?t.value:null)&&0!==e)throw Error("#N/A");n(e)}}.bind(this,e))}}]),i}(),_c={THE_TEXT:"TheText"};var Tc=Yt.f,qs=gn.f,Ac=Qt.enforce,Lc=c("match"),Mc=V.RegExp,Rc=Mc.prototype,Vc=V.SyntaxError,Ic=y(Mr),Fc=y(Rc.exec),Dc=y("".charAt),Ec=y("".replace),Oc=y("".indexOf),Nc=y("".slice),Bc=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,Gc=/a/g,jc=/a/g,Lu=new Mc(Gc)!==Gc,Xc=t.MISSED_STICKY,Yc=t.UNSUPPORTED_Y,se=f&&(!Lu||Xc||Ei||Ni||v(function(){return jc[Lc]=!1,Mc(Gc)!=Gc||Mc(jc)==jc||"/a/i"!=Mc(Gc,"i")})),zc=function(e){for(var t,n=e.length,r=0,i="",o=!1;r<=n;r++)"\\"===(t=Dc(e,r))?i+=t+Dc(e,++r):o||"."!==t?("["===t?o=!0:"]"===t&&(o=!1),i+=t):i+="[\\s\\S]";return i},Uc=function(e){for(var t,n=e.length,r=0,i="",o=[],a={},s=!1,l=!1,u=0,c="";r<=n;r++){if("\\"===(t=Dc(e,r)))t+=Dc(e,++r);else if("]"===t)s=!1;else if(!s)switch(!0){case"["===t:s=!0;break;case"("===t:Fc(Bc,Nc(e,r+1))&&(r+=2,l=!0),i+=t,u++;continue;case">"===t&&l:if(""===c||O(a,c))throw new Vc("Invalid capture group name");a[c]=!0,l=!(o[o.length]=[c,u]),c="";continue}l?c+=t:i+=t}return[i,o]};if(wn("RegExp",se)){for(var Wc=function(e,t){var n,r,i=et(Rc,this),o=Ci(e),a=void 0===t,s=[],l=e;if(!i&&o&&a&&e.constructor===Wc)return e;if((o||et(Rc,e))&&(e=e.source,a&&(t="flags"in l?l.flags:Ic(l))),e=void 0===e?"":w(e),t=void 0===t?"":w(t),l=e,o=t=Ei&&"dotAll"in Gc&&(n=!!t&&-1<Oc(t,"s"))?Ec(t,/s/g,""):t,Xc&&"sticky"in Gc&&(r=!!t&&-1<Oc(t,"y"))&&Yc&&(t=Ec(t,/y/g,"")),Ni&&(e=(a=Uc(e))[0],s=a[1]),a=hr(Mc(e,t),i?this:Rc,Wc),(n||r||s.length)&&(t=Ac(a),n&&(t.dotAll=!0,t.raw=Wc(zc(e),o)),r&&(t.sticky=!0),s.length&&(t.groups=s)),e!==l)try{zt(a,"source",""===l?"(?:)":l)}catch(e){}return a},Hc=qs(Mc),Jc=0;Hc.length>Jc;)!function(t){t in Wc||Tc(Wc,t,{configurable:!0,get:function(){return Mc[t]},set:function(e){Mc[t]=e}})}(Hc[Jc++]);(Rc.constructor=Wc).prototype=Rc,en(V,"RegExp",Wc)}$s("RegExp"),Ur("match",function(r,s,l){return[function(e){var t=ce(this),n=null==e?void 0:ht(e,r);return n?D(n,e,t):new RegExp(e)[r](w(t))},function(e){var t=x(this),n=w(e),e=l(s,t,n);if(e.done)return e.value;if(!t.global)return qr(t,n);for(var r=t.unicode,i=[],o=t.lastIndex=0;null!==(a=qr(t,n));){var a=w(a[0]);""===(i[o]=a)&&(t.lastIndex=Jr(n,un(t.lastIndex),r)),o++}return 0===o?null:i}]});$l=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1};function qc(e,t){var t=t.cells,n=t.pinX,r=t.pinY,i=t.locPinX,o=t.locPinY,t=t.angle,n=Ia((void 0===n?0:n)-(void 0===i?0:i)),i=Ia((void 0===r?0:r)-(void 0===o?0:o)),r=e.x,o=e.y;return n=r+=e=n,i=o+=r=i,o=void 0===t?0:t,o=Math.PI/180*o,t=Math.cos(o),o=Math.sin(o),{x:t*(n-e)+o*(i-r)+e,y:t*(i-r)-o*(n-e)+r}}function Kc(e,t){var n=e.formula;switch(n){case"Inh":n=function(e,t){if(t.masterShape){var n=t.masterShape.cells.get(e.name);if(n&&n.formula)return n.formula}n=t.archive.document.pageSheet.cells.get(e.name);return n&&n.formula?n.formula:null}(e,t);break;case"No Formula":n=void 0}return n}R({target:"Math",stat:!0},{sign:$l});var Qc={PAR:"PAR"},Zc={Actions:{alias:"Actions",default:"Menu"},Char:{alias:"Character"},Connections:{alias:"Connection"},Controls:{alias:"Control",default:"X"},Fields:{alias:"Field"},FillGradientStops:{alias:"FillGradient"},Geometry:{alias:"Geometry",indexedName:!0},Hyperlink:{alias:"Hyperlink",default:"Description"},Layers:{alias:"Layer"},LineGradientStops:{alias:"LineGradient"},Para:{alias:"Paragraph"},Prop:{alias:"Property",default:"Value"},Reviewer:{alias:"Reviewer"},Scratch:{alias:"Scratch"},SmartTags:{alias:"ActionTag",default:"X"},Tabs:{alias:"Tabs"},User:{alias:"User",default:"Value"}},$c={singleCharOperator:/([-+^*/&<>=])/,multiCharOperator:/(<>|<=|>=)/,parentheses:/([()])/,singleParentheses:/^[()]$/,unitValue:/([-])?([0-9]+)([A-Z]*)/,potentialFunc:/^[A-Z]{2,}$/g},eh={operatorSplit:new RegExp("(?:".concat($c.multiCharOperator.source,"|").concat($c.singleCharOperator.source,"|").concat($c.parentheses.source,")"),"gm"),skipEvaluation:new RegExp("^".concat($c.singleCharOperator.source,"|").concat($c.multiCharOperator.source,"|").concat($c.parentheses.source,"$")),referencedVariable:new RegExp("([\\w]+)\\.([\\d]+)(?:[!])","gm")};function th(o,e,t){for(var n=t||{},r=o.split(eh.operatorSplit).filter(function(e){return e}),i=0,a=[];i<r.length;){var s,l,u=r[i];u.match(eh.skipEvaluation)?(a.push(u),i++):u.match($c.potentialFunc)?(l=(s=function(e,t){var n,t=t+1,r=t,i=0;for(;r<e.length&&(e[r].match($c.singleParentheses)&&(i+="("===e[r]?1:-1,n=!0),r++,!n||0!==i););return e.slice(t,r)}(r,i)).join(""),u===Qc[u]&&(n.ctxType=n.ctxType||Qc[u]),l=th(l,e,n),a.push(u+l),i+=s.length+1):(l=function(e,s,t){var n,l;(t||{}).ctxType===Qc.PAR&&(t=function(e){if(!e)return j.log("[getReferenceIdFromFormula] No formula piece provided for id extraction."),null;var t=e.split(eh.referencedVariable),n=t.length;for(;0<=n;){var r;if("Sheet"===t[n])return r=t[n+1],Number.isNaN(r)?(j.log("[getReferenceIdFromFormula] Invalid reference ID",{refId:r}),null):parseInt(r);n--}return null}(e),n=c(s,t));t=e.replace(/(?:([a-zA-Z]+)\.([\d]+)!(?:([a-zA-Z]+)([\d]+)?)(?:\.(\w+))?(?:\.(\w+))?)|(?:(Actions|Char|Connections|Controls|Fields|FillGradientStops|Geometry(?=[\d]+)?|HyperLink|Layers|LineGradientStops|Para|Prop|Reviewer|Scratch|SmartTags|Tabs|User)(\d+)?(?:\.(\w+))?(?:\.(\w+))?)/gm,function(){var e=0<=(l=parseInt(arguments[2]))?arguments[3]:arguments[7],t=0<=l?arguments[4]:arguments[8],n=0<=l?arguments[5]:arguments[9],r=0<=l?arguments[6]:arguments[10];if(isNaN(l))return arguments[0];if(!(l=c(s,l)))return arguments[0];if(Zc[e]){var i,o=Zc[e],a=l.sections.get(o.alias);if(!a)return arguments[0];if(r=Sa[o.alias]===h.Named?(i=a[0].rows.find(function(e){return e.name===n}),r||o.default):(o=(r=n.match(/\d+/g))?parseInt(r[0])-1:0,i=a[0<=t?t-1:0].rows[o],n.match(/[a-zA-Z]+/)[0]),!i)return arguments[0];r=Cl(r),a=(a=i.cells.get(r))||i.cells.getParentCell(r)}else{t=Cl(e);a=(a=l.cells.get(t))||l.cells.getParentCell(t)}return a?a.value:arguments[0]});{var r,i;n&&(e=t.replace(/[()]/gm,"").split(",").map(function(e){return new Pc({},s).parse(e).result}),i=Q(e,2),r=i[0],i=i[1],2<e.length&&j.log("Potentially invalid PNT arguments",{formula:o,pntArguments:e}),e=qc({x:r,y:i},n),t="".concat(e.x,",").concat(e.y))}return t}(u,e,n),a.push(l),i++)}return a=a.join("");function c(e,t){t||0===t||j.log("no reference id provided",{shape:e,refId:t});for(var n,r=e.masterShape?e.masterShape.master:null,i=e.pageContent.shapes.values(),o=i.next();!o.done&&r;){if(o.value.masterId===r.id&&o.value.shapes.has(e.id)){n=o.value;break}o=i.next()}return n}}function nh(e,t,n,r,i,o,a,s){for(var l,u,c=i,h=0,f=!!a&&Ce(a,s);h<r;){if(h in n){if(l=f?f(n[h],h,t):n[h],0<o&&Tn(l))u=cn(l),c=nh(e,t,l,u,c,o-1)-1;else{if(9007199254740991<=c)throw gh("Exceed the acceptable array length");e[c]=l}c++}h++}return c}var rh={false:"0",true:"1"},ih=function(){z(n,Sl);var t=q(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l(this,n),t.call(this,e,new Set([b.shape,b.masterShape]))}return u(n,[{key:"setAttributes",value:function(e){var t=this;this._attributesSet=new Set,Object.keys(e).filter(function(e){return!["archive","structurePath"].includes(e)}).forEach(function(e){return t.attributeSet(e)}),K(U(n.prototype),"setAttributes",this).call(this,e)}},{key:"attributeSet",value:function(e){this._attributesSet.add(e)}},{key:"attributeUnset",value:function(e){this._attributesSet.delete(e)}},{key:"attributesSet",get:function(){return this._attributesSet}},{key:"has",value:function(e){return this.attributesSet.has(e)}},{key:"hasEvery",value:function(e){var t=this;return e.every(function(e){return void 0!==t[e]})}},{key:"getRowType",value:function(){if(this._rowType)return this._rowType;var e=this.structurePath.find(function(e){return e.xsdType===na});return e?e.type:null}},{key:"setRowType",value:function(e){this._rowType=e}},{key:"isDescendantOfSectionType",value:function(t){return this.structurePath.some(function(e){return e.xsdType===ta&&t.includes(e.type)})}},{key:"getDefaultCellValue",value:function(e){switch(e){case va:case ha:case ia:return"";case oa:case ga:return"#000000";case fa:return"0";case a:case pa:case da:case r:case la:case ra:case ca:case aa:case ua:case sa:case i:case o:return 0}j.log("No default Cell value for ".concat(e," type."))}},{key:"resolveCellValue",value:function(e,t){if(e){var n,r,i=e.value,o=e.formula,a=Ll(t,e);if("Themed"===(i=o&&Ml.evaluateFormulas?function(e,t){if(!t)return e.value;if(!(n=Kc(e,t))||!t)return e.value;var n=th(n,t);return(t=new Pc(e,t).parse(n)).error?e.value:(n=t.result.toString(),rh[n.toLowerCase()]?rh[n.toLowerCase()]:n)}(e,this.shape):i)){o=function(e,t){return"lineColor"===(e=e.name)?Rl(ma.Dark):"linePattern"===e?1:"lineColorTrans"!==e&&("fillForegnd"===e?Rl(ma.Light):"fillPattern"===e?1:"fillForegndTrans"===e||"style"===e?0:"lineWeight"===e?1:"font"!==e&&"asianFont"!==e&&"complexScriptFont"!==e?"color"===e?Rl(ma.Dark):"fillBkgnd"===e?Rl(ma.Light):"fillBkgndTrans"!==e&&void 0:void 0)}.call(this,e,t);if(null!==o)return o}switch(a){case ea.number:case ea.byte:i=_a(i);break;case ea.percentage:i=100*_a(i);break;case ea.booleanStrict:i=La(i);break;case ea.booleanTriState:i=Aa(i);break;case ea.internalUnitsToPixels:i=0===_a(i)?0:(n=i,r=s.IN,Ma(_a(n),r));break;case ea.internalUnitsToDegrees:i=function(e,t){var t=1<arguments.length&&void 0!==t?t:{},n=void 0===(n=t.round)||n,r=void 0===(r=t.decimalPlaces)?2:r,t=t.units,t=void 0===t?s.RAD:t,e=Number(e);return t===s.RAD||t===s.DA?e=360-180*e/Math.PI:t===s.DEG||t===s.AD&&0===e||j.log('Implement unit type "'.concat(Fa(t),'" ("VisioUnitType.').concat(t,'")')),e%=360,e=n?ne(e,r):e}(i,{units:s.RAD});break;case ea.color:i.includes("#")||(i="Themed"===i?"red":(n=_a(i),this.archive.document._colors.get(n)));break;case ea.asIs:break;default:j.log("Unknown VisioConvertType",{cell:e,convertType:a,valueType:t})}return i}}},{key:"themedResolver",value:function(){return null}},{key:"getOwnNames",value:function(){return this.hasOwnProperty("_attributesSet")?F(this._attributesSet.values()):[]}},{key:"get",value:function(e){e=Cl(e);return this.hasOwnProperty(e)?this[e]:this["_".concat(e)]}},{key:"set",value:function(e,t,n){if(!n)return null;var r,i=e.charAt(0).toLowerCase()+e.slice(1),e=e.charAt(0).toUpperCase()+e.slice(1),o=(void 0===B[e]&&j.log('Cell named "'.concat(e,'" is not supported.')),"object"===T(t)&&null!==t||j.log("Attributes are required to set a cell."),this.attributeSet(i),t=m(m({},t),{},{name:e}),m({},this["_".concat(i)]));return Object.keys(t).forEach(function(e){void 0!==t[e]&&(null===t[e]?delete o[e]:o[e]=t[e].toString())}),this["_".concat(i)]=o,n&&"string"==typeof e&&(n=(e=n.Cell).findIndex(function(e){return e.hasOwnProperty(Do.Name)&&e[Do.Name].toLowerCase()===i.toLowerCase()}),r={},-1<n&&(r=e[n]),Object.keys(o).forEach(function(e){Eo[e]&&void 0!==t[e]&&(null===t[e]?delete r[Eo[e]]:r[Eo[e]]=o[e])}),-1<n?e[n]=r:e.push(r)),o}},{key:"remove",value:function(t,e){var n;this.attributeUnset(t),delete this["_".concat(t)],e&&Array.isArray(e.Cell)&&(-1<(n=(e=e.Cell).findIndex(function(e){return e.hasOwnProperty(Do.Name)&&e[Do.Name].toLowerCase()===t.toLowerCase()}))&&e.splice(n,1))}},{key:"shape",get:function(){return this._shape},set:function(e){this._shape=e}},{key:"jxon",get:function(){return this._jxon},set:function(e){this._jxon=e}},{key:"masterShape",get:function(){return this._masterShape},set:function(e){this._masterShape=e}},{key:"resolveCellValueByType",value:function(e,t){return e.value}},{key:"getParentCell",value:function(e){var t=this.parent;if(t&&t.cells)return t.cells.get(e)}},{key:"getStylesheetFillStyleCell",value:function(e){return this.getStylesheetCell(e,b.fillStyle)}},{key:"getStylesheetLineStyleCell",value:function(e){return this.getStylesheetCell(e,b.lineStyle)}},{key:"getStylesheetTextStyleCell",value:function(e){return this.getStylesheetCell(e,b.textStyle)}},{key:"getStylesheetCell",value:function(e,t){var n,r=this.shape,i=this.masterShape;if(r||i){if(r?void 0===(n=r[t])&&(r=this.shape.masterShape)&&(n=r[t]):n=i[t],void 0!==n)return function e(t,n,r,i){n=t.get(n);if(!n)return null;var o=n.cells;return o.has(i)?o.get(i):r in n?e(t,n[r],r,i):null}(this.archive.document.styleSheets,n,t,e);j.log("styleSheetIndex undefined")}}},{key:"getSetValues",value:function(){var t=this,n={};return this.attributesSet.forEach(function(e){return n[e]=t[e]}),n}},{key:"getSetValuesMaster",value:function(){var e=this.shape.masterShape;if(!e)return null;i=this.structurePath,t=!1,n={},i.forEach(function(e){e.jxonType===S.Shape?t=!0:t&&(e.jxonType===S.Section&&(n.section=e),e.jxonType===S.Row&&(n.row=e))});var t,n,r=n;if(!r.section||!r.row)return null;var i=e.sections.get(r.section.type)[r.section.index].rows.find(function(e){return e.index===r.row.index});if(!i)return null;e=i.cells;return e?e===this?"exactly same":e.getSetValues():null}},{key:"directValues",get:function(){return this.debugGatherValues(F(this.attributesSet))}},{key:"clone",value:function(){var n=this,e=this.structurePath.slice(),r=(e.unshift({jxonType:"clone"}),new this.constructor({archive:this.archive,structurePath:e}));return this.attributesSet.forEach(function(e){var t=n.get(e);r[e]=m({},t),r.attributeSet(e)}),this.shape&&(r.shape=this.shape),this.masterShape&&(r.masterShape=this.masterShape),r}},{key:"debug",get:function(){var e={owner:this.owner,parent:this.parent,directValues:this.debugGatherValues(F(this.attributesSet))};return this.shape&&(e.ownerShape=this.shape),this.parent&&(e.extendedValues=this.debugGatherValues([].concat(F(this.attributesSet),F(this.parent.cells.attributesSet)))),this.masterShape&&(e.ownerMasterShape=this.masterShape),e.stylesheetFill=this.debugGatherValues(["fillForegnd","fillBkgnd","fillPattern","fillForegndTrans","fillBkgndTrans"]),e.stylesheetLine=this.debugGatherValues(["lineColor","lineColorTrans","linePattern","lineWeight"]),e.stylesheetText=this.debugGatherValues(["bottomMargin","defaultTabStop","leftMargin","rightMargin","textBkgnd","textBkgndTrans","topMargin","verticalAlign"]),e.structurePath=this.structurePath,e}},{key:"debugGatherValues",value:function(e){var n=this;return e.reduce(function(e,t){return e[t]=n[t],e},{})}}]),n}(),oh=function(){z(t,ih);var e=q(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"a",get:function(){var e;switch(this.getRowType()){case re.ArcTo:case re.Ellipse:case re.EllipticalArcTo:case re.InfiniteLine:e=a;break;case re.NURBSTo:case re.RelCubBezTo:case re.RelEllipticalArcTo:case re.RelQuadBezTo:case re.SplineStart:case re.SplineKnot:e=o;break;case re.PolylineTo:e=pa;break;default:j.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._a;return void 0===t&&(t=this.getParentCell("a")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("a"),this._a=e}},{key:"action",get:function(){var e=o,t=this._action;return void 0===t&&(t=this.getParentCell("action")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("action"),this._action=e}},{key:"active",get:function(){var e=i,t=this._active;return void 0===t&&(t=this.getParentCell("active")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("active"),this._active=e}},{key:"addMarkup",get:function(){var e=i,t=this._addMarkup;return void 0===t&&(t=this.getParentCell("addMarkup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("addMarkup"),this._addMarkup=e}},{key:"address",get:function(){var e=ia,t=this._address;return void 0===t&&(t=this.getParentCell("address")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("address"),this._address=e}},{key:"alignBottom",get:function(){var e=o,t=this._alignBottom;return void 0===t&&(t=this.getParentCell("alignBottom")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignBottom"),this._alignBottom=e}},{key:"alignCenter",get:function(){var e=o,t=this._alignCenter;return void 0===t&&(t=this.getParentCell("alignCenter")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignCenter"),this._alignCenter=e}},{key:"alignLeft",get:function(){var e=o,t=this._alignLeft;return void 0===t&&(t=this.getParentCell("alignLeft")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignLeft"),this._alignLeft=e}},{key:"alignment",get:function(){var e=o,t=this._alignment;return void 0===t&&(t=this.getParentCell("alignment")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignment"),this._alignment=e}},{key:"alignMiddle",get:function(){var e=o,t=this._alignMiddle;return void 0===t&&(t=this.getParentCell("alignMiddle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignMiddle"),this._alignMiddle=e}},{key:"alignRight",get:function(){var e=o,t=this._alignRight;return void 0===t&&(t=this.getParentCell("alignRight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignRight"),this._alignRight=e}},{key:"alignTop",get:function(){var e=o,t=this._alignTop;return void 0===t&&(t=this.getParentCell("alignTop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("alignTop"),this._alignTop=e}},{key:"angle",get:function(){var e=this._angle,t=(void 0===e&&(e=this.getParentCell("angle")),da);return e&&e.units&&e.units!==s.DEG&&"0"!==e.value&&j.log("vAngle unclear"),void 0===e?this.getDefaultCellValue(t):this.resolveCellValue(e,t)},set:function(e){this.attributeSet("angle"),this._angle=e}},{key:"asianFont",get:function(){var e=fa,t=this._asianFont;return void 0===t&&(t=this.getParentCell("asianFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("asianFont"),this._asianFont=e}},{key:"autoGen",get:function(){var e=i,t=this._autoGen;return void 0===t&&(t=this.getParentCell("autoGen")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("autoGen"),this._autoGen=e}},{key:"avenueSizeX",get:function(){var e=o,t=this._avenueSizeX;return void 0===t&&(t=this.getParentCell("avenueSizeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avenueSizeX"),this._avenueSizeX=e}},{key:"avenueSizeY",get:function(){var e=o,t=this._avenueSizeY;return void 0===t&&(t=this.getParentCell("avenueSizeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avenueSizeY"),this._avenueSizeY=e}},{key:"avoidPageBreaks",get:function(){var e=i,t=this._avoidPageBreaks;return void 0===t&&(t=this.getParentCell("avoidPageBreaks")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("avoidPageBreaks"),this._avoidPageBreaks=e}},{key:"b",get:function(){var e;if(this.isDescendantOfSectionType([G.Scratch]))e=pa;else switch(this.getRowType()){case re.Ellipse:case re.EllipticalArcTo:case re.InfiniteLine:e=a;break;case re.NURBSTo:case re.RelCubBezTo:case re.RelEllipticalArcTo:case re.RelQuadBezTo:case re.SplineStart:e=o;break;default:j.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._b;return void 0===t&&(t=this.getParentCell("b")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("b"),this._b=e}},{key:"beginArrow",get:function(){var e=r,t=this._beginArrow;return void 0===t&&(t=this.getParentCell("beginArrow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginArrow"),this._beginArrow=e}},{key:"beginArrowSize",get:function(){var e=r,t=this._beginArrowSize;return void 0===(t=void 0===t?this.getParentCell("beginArrowSize"):t)?2:this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginArrowSize"),this._beginArrowSize=e}},{key:"beginGroup",get:function(){var e=i,t=this._beginGroup;return void 0===t&&(t=this.getParentCell("beginGroup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginGroup"),this._beginGroup=e}},{key:"beginX",get:function(){var e=a,t=this._beginX;return void 0===t&&(t=this.getParentCell("beginX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginX"),this._beginX=e}},{key:"beginY",get:function(){var e=a,t=this._beginY;return void 0===t&&(t=this.getParentCell("beginY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("beginY"),this._beginY=e}},{key:"begTrigger",get:function(){var e=r,t=this._begTrigger;return void 0===t&&(t=this.getParentCell("begTrigger")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("begTrigger"),this._begTrigger=e}},{key:"bevelBottomHeight",get:function(){var e=a,t=this._bevelBottomHeight;return void 0===t&&(t=this.getParentCell("bevelBottomHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomHeight"),this._bevelBottomHeight=e}},{key:"bevelBottomType",get:function(){var e=r,t=this._bevelBottomType;return void 0===t&&(t=this.getParentCell("bevelBottomType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomType"),this._bevelBottomType=e}},{key:"bevelBottomWidth",get:function(){var e=a,t=this._bevelBottomWidth;return void 0===t&&(t=this.getParentCell("bevelBottomWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelBottomWidth"),this._bevelBottomWidth=e}},{key:"bevelContourColor",get:function(){var e=oa,t=this._bevelContourColor;return void 0===t&&(t=this.getParentCell("bevelContourColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelContourColor"),this._bevelContourColor=e}},{key:"bevelContourSize",get:function(){var e=a,t=this._bevelContourSize;return void 0===t&&(t=this.getParentCell("bevelContourSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelContourSize"),this._bevelContourSize=e}},{key:"bevelDepthColor",get:function(){var e=oa,t=this._bevelDepthColor;return void 0===t&&(t=this.getParentCell("bevelDepthColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelDepthColor"),this._bevelDepthColor=e}},{key:"bevelDepthSize",get:function(){var e=a,t=this._bevelDepthSize;return void 0===t&&(t=this.getParentCell("bevelDepthSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelDepthSize"),this._bevelDepthSize=e}},{key:"bevelLightingAngle",get:function(){var e=o,t=this._bevelLightingAngle;return void 0===t&&(t=this.getParentCell("bevelLightingAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelLightingAngle"),this._bevelLightingAngle=e}},{key:"bevelLightingType",get:function(){var e=r,t=this._bevelLightingType;return void 0===t&&(t=this.getParentCell("bevelLightingType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelLightingType"),this._bevelLightingType=e}},{key:"bevelMaterialType",get:function(){var e=r,t=this._bevelMaterialType;return void 0===t&&(t=this.getParentCell("bevelMaterialType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelMaterialType"),this._bevelMaterialType=e}},{key:"bevelTopHeight",get:function(){var e=a,t=this._bevelTopHeight;return void 0===t&&(t=this.getParentCell("bevelTopHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopHeight"),this._bevelTopHeight=e}},{key:"bevelTopType",get:function(){var e=r,t=this._bevelTopType;return void 0===t&&(t=this.getParentCell("bevelTopType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopType"),this._bevelTopType=e}},{key:"bevelTopWidth",get:function(){var e=a,t=this._bevelTopWidth;return void 0===t&&(t=this.getParentCell("bevelTopWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bevelTopWidth"),this._bevelTopWidth=e}},{key:"blockSizeX",get:function(){var e=o,t=this._blockSizeX;return void 0===t&&(t=this.getParentCell("blockSizeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blockSizeX"),this._blockSizeX=e}},{key:"blockSizeY",get:function(){var e=o,t=this._blockSizeY;return void 0===t&&(t=this.getParentCell("blockSizeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blockSizeY"),this._blockSizeY=e}},{key:"blur",get:function(){var e=o,t=this._blur;return void 0===t&&(t=this.getParentCell("blur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("blur"),this._blur=e}},{key:"bottomMargin",get:function(){var e=a,t=this._bottomMargin;return void 0===(t=void 0===t?this.getParentCell("bottomMargin"):t)&&(t=this.getStylesheetTextStyleCell("bottomMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bottomMargin"),this._bottomMargin=e}},{key:"brightness",get:function(){var e=o,t=this._brightness;return void 0===t&&(t=this.getParentCell("brightness")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("brightness"),this._brightness=e}},{key:"bullet",get:function(){var e=r,t=this._bullet;return void 0===t&&(t=this.getParentCell("bullet")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bullet"),this._bullet=e}},{key:"bulletFont",get:function(){var e=fa,t=this._bulletFont;return void 0===t&&(t=this.getParentCell("bulletFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletFont"),this._bulletFont=e}},{key:"bulletFontSize",get:function(){var e=a,t=this._bulletFontSize;return void 0===t&&(t=this.getParentCell("bulletFontSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletFontSize"),this._bulletFontSize=e}},{key:"bulletStr",get:function(){var e=ia,t=this._bulletStr;return void 0===t&&(t=this.getParentCell("bulletStr")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("bulletStr"),this._bulletStr=e}},{key:"buttonFace",get:function(){var e=ia,t=this._buttonFace;return void 0===t&&(t=this.getParentCell("buttonFace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("buttonFace"),this._buttonFace=e}},{key:"c",get:function(){var e;if(this.isDescendantOfSectionType([G.Scratch]))e=pa;else switch(this.getRowType()){case re.Ellipse:e=a;break;case re.EllipticalArcTo:case re.RelEllipticalArcTo:e=da;break;case re.NURBSTo:case re.RelCubBezTo:case re.SplineStart:e=o;break;default:j.log("Incorrect cell type",{attributeName:"c",cells:this})}var t=this._c;return void 0===t&&(t=this.getParentCell("c")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("c"),this._c=e}},{key:"calendar",get:function(){var e=o,t=this._calendar;return void 0===t&&(t=this.getParentCell("calendar")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("calendar"),this._calendar=e}},{key:"canGlue",get:function(){var e=i,t=this._canGlue;return void 0===t&&(t=this.getParentCell("canGlue")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("canGlue"),this._canGlue=e}},{key:"uppercase",get:function(){var e=r,t=this._uppercase;return void 0===t&&(t=this.getParentCell("uppercase")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uppercase"),this._uppercase=e}},{key:"centerX",get:function(){var e=i,t=this._centerX;return void 0===t&&(t=this.getParentCell("centerX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("centerX"),this._centerX=e}},{key:"centerY",get:function(){var e=i,t=this._centerY;return void 0===t&&(t=this.getParentCell("centerY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("centerY"),this._centerY=e}},{key:"checked",get:function(){var e=i,t=this._checked;return void 0===t&&(t=this.getParentCell("checked")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("checked"),this._checked=e}},{key:"clippingPath",get:function(){var e=ia,t=this._clippingPath;return void 0===t&&(t=this.getParentCell("clippingPath")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("clippingPath"),this._clippingPath=e}},{key:"color",get:function(){var e=oa,t=this._color;return void 0===t&&(t=this.getParentCell("color")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("color"),this._color=e}},{key:"colorSchemeIndex",get:function(){var e=r,t=this._colorSchemeIndex;return void 0===t&&(t=this.getParentCell("colorSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("colorSchemeIndex"),this._colorSchemeIndex=e}},{key:"colorTrans",get:function(){var e=o,t=this._colorTrans;return void 0===t&&(t=this.getParentCell("colorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("colorTrans"),this._colorTrans=e}},{key:"comment",get:function(){var e=ia,t=this._comment;return void 0===t&&(t=this.getParentCell("comment")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("comment"),this._comment=e}},{key:"complexScriptFont",get:function(){var e=fa,t=this._complexScriptFont;return void 0===t&&(t=this.getParentCell("complexScriptFont")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("complexScriptFont"),this._complexScriptFont=e}},{key:"complexScriptSize",get:function(){var e,t=a,n=this._complexScriptSize;if(void 0!==(n=void 0===n?this.getParentCell("complexScriptSize"):n))return e=_a(n.value),0===e?this.size:e<0?-e*this.size:this.resolveCellValue(n,t)},set:function(e){this.attributeSet("complexScriptSize"),this._complexScriptSize=e}},{key:"compoundType",get:function(){var e=r,t=this._compoundType;return void 0===t&&(t=this.getParentCell("compoundType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("compoundType"),this._compoundType=e}},{key:"conFixedCode",get:function(){var e=r,t=this._conFixedCode;return void 0===t&&(t=this.getParentCell("conFixedCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conFixedCode"),this._conFixedCode=e}},{key:"conLineJumpCode",get:function(){var e=r,t=this._conLineJumpCode;return void 0===t&&(t=this.getParentCell("conLineJumpCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpCode"),this._conLineJumpCode=e}},{key:"conLineJumpDirX",get:function(){var e=r,t=this._conLineJumpDirX;return void 0===t&&(t=this.getParentCell("conLineJumpDirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpDirX"),this._conLineJumpDirX=e}},{key:"conLineJumpDirY",get:function(){var e=r,t=this._conLineJumpDirY;return void 0===t&&(t=this.getParentCell("conLineJumpDirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpDirY"),this._conLineJumpDirY=e}},{key:"conLineJumpStyle",get:function(){var e=r,t=this._conLineJumpStyle;return void 0===t&&(t=this.getParentCell("conLineJumpStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineJumpStyle"),this._conLineJumpStyle=e}},{key:"conLineRouteExt",get:function(){var e=r,t=this._conLineRouteExt;return void 0===t&&(t=this.getParentCell("conLineRouteExt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("conLineRouteExt"),this._conLineRouteExt=e}},{key:"connectorSchemeIndex",get:function(){var e=r,t=this._connectorSchemeIndex;return void 0===t&&(t=this.getParentCell("connectorSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("connectorSchemeIndex"),this._connectorSchemeIndex=e}},{key:"contrast",get:function(){var e=o,t=this._contrast;return void 0===t&&(t=this.getParentCell("contrast")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("contrast"),this._contrast=e}},{key:"copyright",get:function(){var e=ia,t=this._copyright;return void 0===t&&(t=this.getParentCell("copyright")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("copyright"),this._copyright=e}},{key:"ctrlAsInput",get:function(){var e=i,t=this._ctrlAsInput;return void 0===t&&(t=this.getParentCell("ctrlAsInput")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("ctrlAsInput"),this._ctrlAsInput=e}},{key:"currentIndex",get:function(){var e=aa,t=this._currentIndex;return void 0===t&&(t=this.getParentCell("currentIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("currentIndex"),this._currentIndex=e}},{key:"d",get:function(){var e;if(this.isDescendantOfSectionType([G.Scratch]))e=pa;else switch(this.getRowType()){case re.Ellipse:e=a;break;case re.EllipticalArcTo:case re.RelCubBezTo:case re.RelEllipticalArcTo:case re.NURBSTo:case re.SplineStart:e=o;break;default:j.log("Incorrect cell type",{attributeName:"d",cells:this})}var t=this._d;return void 0===t&&(t=this.getParentCell("d")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("d"),this._d=e}},{key:"dataLinked",get:function(){var e=i,t=this._dataLinked;return void 0===t&&(t=this.getParentCell("dataLinked")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dataLinked"),this._dataLinked=e}},{key:"dblUnderline",get:function(){var e=i,t=this._dblUnderline;return void 0===t&&(t=this.getParentCell("dblUnderline")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dblUnderline"),this._dblUnderline=e}},{key:"__default",get:function(){var e=i,t=this.___default;return void 0===t&&(t=this.getParentCell("__default")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("__default"),this.___default=e}},{key:"defaultTabStop",get:function(){var e=a,t=this._defaultTabStop;return void 0===(t=void 0===t?this.getParentCell("defaultTabStop"):t)&&(t=this.getStylesheetTextStyleCell("defaultTabStop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("defaultTabStop"),this._defaultTabStop=e}},{key:"denoise",get:function(){var e=o,t=this._denoise;return void 0===t&&(t=this.getParentCell("denoise")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("denoise"),this._denoise=e}},{key:"description",get:function(){var e=ia,t=this._description;return void 0===t&&(t=this.getParentCell("description")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("description"),this._description=e}},{key:"dirX",get:function(){var e=a,t=this._dirX;return void 0===t&&(t=this.getParentCell("dirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dirX"),this._dirX=e}},{key:"dirY",get:function(){var e=a,t=this._dirY;return void 0===t&&(t=this.getParentCell("dirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dirY"),this._dirY=e}},{key:"disabled",get:function(){var e=i,t=this._disabled;return void 0===t&&(t=this.getParentCell("disabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("disabled"),this._disabled=e}},{key:"displayLevel",get:function(){var e=la,t=this._displayLevel;return void 0===t&&(t=this.getParentCell("displayLevel")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("displayLevel"),this._displayLevel=e}},{key:"displayMode",get:function(){var e=r,t=this._displayMode;return void 0===t&&(t=this.getParentCell("displayMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("displayMode"),this._displayMode=e}},{key:"distanceFromGround",get:function(){var e=a,t=this._distanceFromGround;return void 0===t&&(t=this.getParentCell("distanceFromGround")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("distanceFromGround"),this._distanceFromGround=e}},{key:"docLangID",get:function(){var e=ha,t=this._docLangID;return void 0===t&&(t=this.getParentCell("docLangID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLangID"),this._docLangID=e}},{key:"docLockDuplicatePage",get:function(){var e=i,t=this._docLockDuplicatePage;return void 0===t&&(t=this.getParentCell("docLockDuplicatePage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLockDuplicatePage"),this._docLockDuplicatePage=e}},{key:"docLockReplace",get:function(){var e=i,t=this._docLockReplace;return void 0===t&&(t=this.getParentCell("docLockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("docLockReplace"),this._docLockReplace=e}},{key:"dontMoveChildren",get:function(){var e=i,t=this._dontMoveChildren;return void 0===t&&(t=this.getParentCell("dontMoveChildren")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dontMoveChildren"),this._dontMoveChildren=e}},{key:"doubleStrikethrough",get:function(){var e=i,t=this._doubleStrikethrough;return void 0===t&&(t=this.getParentCell("doubleStrikethrough")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("doubleStrikethrough"),this._doubleStrikethrough=e}},{key:"drawingResizeType",get:function(){var e=r,t=this._drawingResizeType;return void 0===t&&(t=this.getParentCell("drawingResizeType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingResizeType"),this._drawingResizeType=e}},{key:"drawingScale",get:function(){var e=a,t=this._drawingScale;return void 0===t&&(t=this.getParentCell("drawingScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingScale"),this._drawingScale=e}},{key:"drawingScaleType",get:function(){var e=r,t=this._drawingScaleType;return void 0===t&&(t=this.getParentCell("drawingScaleType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingScaleType"),this._drawingScaleType=e}},{key:"drawingSizeType",get:function(){var e=r,t=this._drawingSizeType;return void 0===t&&(t=this.getParentCell("drawingSizeType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("drawingSizeType"),this._drawingSizeType=e}},{key:"dropOnPageScale",get:function(){var e=o,t=this._dropOnPageScale;return void 0===t&&(t=this.getParentCell("dropOnPageScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dropOnPageScale"),this._dropOnPageScale=e}},{key:"dynamicsOff",get:function(){var e=i,t=this._dynamicsOff;return void 0===t&&(t=this.getParentCell("dynamicsOff")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dynamicsOff"),this._dynamicsOff=e}},{key:"dynFeedback",get:function(){var e=r,t=this._dynFeedback;return void 0===t&&(t=this.getParentCell("dynFeedback")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("dynFeedback"),this._dynFeedback=e}},{key:"e",get:function(){var e=ya,t=this._e;return void 0===t&&(t=this.getParentCell("e")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("e"),this._e=e}},{key:"effectSchemeIndex",get:function(){var e=r,t=this._effectSchemeIndex;return void 0===t&&(t=this.getParentCell("effectSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("effectSchemeIndex"),this._effectSchemeIndex=e}},{key:"embellishmentIndex",get:function(){var e=la,t=this._embellishmentIndex;return void 0===t&&(t=this.getParentCell("embellishmentIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("embellishmentIndex"),this._embellishmentIndex=e}},{key:"enableFillProps",get:function(){var e=i,t=this._enableFillProps;return void 0===t&&(t=this.getParentCell("enableFillProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableFillProps"),this._enableFillProps=e}},{key:"enableGrid",get:function(){var e=i,t=this._enableGrid;return void 0===t&&(t=this.getParentCell("enableGrid")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableGrid"),this._enableGrid=e}},{key:"enableLineProps",get:function(){var e=i,t=this._enableLineProps;return void 0===t&&(t=this.getParentCell("enableLineProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableLineProps"),this._enableLineProps=e}},{key:"enableTextProps",get:function(){var e=i,t=this._enableTextProps;return void 0===t&&(t=this.getParentCell("enableTextProps")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("enableTextProps"),this._enableTextProps=e}},{key:"endArrow",get:function(){var e=r,t=this._endArrow;return void 0===t&&(t=this.getParentCell("endArrow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endArrow"),this._endArrow=e}},{key:"endArrowSize",get:function(){var e=r,t=this._endArrowSize;return void 0===t&&(t=this.getParentCell("endArrowSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endArrowSize"),this._endArrowSize=e}},{key:"endTrigger",get:function(){var e=r,t=this._endTrigger;return void 0===t&&(t=this.getParentCell("endTrigger")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endTrigger"),this._endTrigger=e}},{key:"endX",get:function(){var e=a,t=this._endX;return void 0===t&&(t=this.getParentCell("endX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endX"),this._endX=e}},{key:"endY",get:function(){var e=a,t=this._endY;return void 0===t&&(t=this.getParentCell("endY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("endY"),this._endY=e}},{key:"eventDblClick",get:function(){var e=o,t=this._eventDblClick;return void 0===t&&(t=this.getParentCell("eventDblClick")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventDblClick"),this._eventDblClick=e}},{key:"eventDrop",get:function(){var e=o,t=this._eventDrop;return void 0===t&&(t=this.getParentCell("eventDrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventDrop"),this._eventDrop=e}},{key:"eventMultiDrop",get:function(){var e=o,t=this._eventMultiDrop;return void 0===t&&(t=this.getParentCell("eventMultiDrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventMultiDrop"),this._eventMultiDrop=e}},{key:"eventXFMod",get:function(){var e=o,t=this._eventXFMod;return void 0===t&&(t=this.getParentCell("eventXFMod")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("eventXFMod"),this._eventXFMod=e}},{key:"extraInfo",get:function(){var e=ia,t=this._extraInfo;return void 0===t&&(t=this.getParentCell("extraInfo")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("extraInfo"),this._extraInfo=e}},{key:"fillBkgnd",get:function(){var e=ga,t=this._fillBkgnd;return void 0===(t=void 0===t?this.getParentCell("fillBkgnd"):t)&&(t=this.getStylesheetFillStyleCell("fillBkgnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillBkgnd"),this._fillBkgnd=e}},{key:"fillBkgndTrans",get:function(){var e=o,t=this._fillBkgndTrans;return void 0===(t=void 0===t?this.getParentCell("fillBkgndTrans"):t)&&(t=this.getStylesheetFillStyleCell("fillBkgndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillBkgndTrans"),this._fillBkgndTrans=e}},{key:"fillForegnd",get:function(){var e=ga,t=this._fillForegnd;return void 0===(t=void 0===t?this.getParentCell("fillForegnd"):t)&&(t=this.getStylesheetFillStyleCell("fillForegnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillForegnd"),this._fillForegnd=e}},{key:"fillForegndTrans",get:function(){var e=o,t=this._fillForegndTrans;return void 0===(t=void 0===t?this.getParentCell("fillForegndTrans"):t)&&(t=this.getStylesheetFillStyleCell("fillForegndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillForegndTrans"),this._fillForegndTrans=e}},{key:"fillGradientAngle",get:function(){var e=da,t=this._fillGradientAngle;return void 0===t&&(t=this.getParentCell("fillGradientAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientAngle"),this._fillGradientAngle=e}},{key:"fillGradientDir",get:function(){var e=r,t=this._fillGradientDir;return void 0===t&&(t=this.getParentCell("fillGradientDir")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientDir"),this._fillGradientDir=e}},{key:"fillGradientEnabled",get:function(){var e=i,t=this._fillGradientEnabled;return void 0===t&&(t=this.getParentCell("fillGradientEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillGradientEnabled"),this._fillGradientEnabled=e}},{key:"fillPattern",get:function(){var e=r,t=this._fillPattern;return void 0===(t=void 0===t?this.getParentCell("fillPattern"):t)&&(t=this.getStylesheetFillStyleCell("fillPattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fillPattern"),this._fillPattern=e}},{key:"flags",get:function(){var e=r,t=this._flags;return void 0===t&&(t=this.getParentCell("flags")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flags"),this._flags=e}},{key:"flipX",get:function(){var e=o,t=this._flipX;return void 0===t&&(t=this.getParentCell("flipX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flipX"),this._flipX=e}},{key:"flipY",get:function(){var e=o,t=this._flipY;return void 0===t&&(t=this.getParentCell("flipY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flipY"),this._flipY=e}},{key:"flyoutChild",get:function(){var e=i,t=this._flyoutChild;return void 0===t&&(t=this.getParentCell("flyoutChild")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("flyoutChild"),this._flyoutChild=e}},{key:"font",get:function(){var e=fa,t=this._font;return void 0===t&&(t=this.getParentCell("font")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("font"),this._font=e}},{key:"fontScale",get:function(){var e=o,t=this._fontScale;return void 0===t&&(t=this.getParentCell("fontScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fontScale"),this._fontScale=e}},{key:"fontSchemeIndex",get:function(){var e=r,t=this._fontSchemeIndex;return void 0===t&&(t=this.getParentCell("fontSchemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("fontSchemeIndex"),this._fontSchemeIndex=e}},{key:"format",get:function(){var e=va,t=this._format;return void 0===t&&(t=this.getParentCell("format")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("format"),this._format=e}},{key:"frame",get:function(){var e=ia,t=this._frame;return void 0===t&&(t=this.getParentCell("frame")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("frame"),this._frame=e}},{key:"gamma",get:function(){var e=o,t=this._gamma;return void 0===t&&(t=this.getParentCell("gamma")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gamma"),this._gamma=e}},{key:"glowColor",get:function(){var e=ga,t=this._glowColor;return void 0===t&&(t=this.getParentCell("glowColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowColor"),this._glowColor=e}},{key:"glowColorTrans",get:function(){var e=o,t=this._glowColorTrans;return void 0===t&&(t=this.getParentCell("glowColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowColorTrans"),this._glowColorTrans=e}},{key:"glowSize",get:function(){var e=a,t=this._glowSize;return void 0===t&&(t=this.getParentCell("glowSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glowSize"),this._glowSize=e}},{key:"glue",get:function(){var e=i,t=this._glue;return void 0===t&&(t=this.getParentCell("glue")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glue"),this._glue=e}},{key:"glueType",get:function(){var e=r,t=this._glueType;return void 0===t&&(t=this.getParentCell("glueType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("glueType"),this._glueType=e}},{key:"gradientStopColor",get:function(){var e=ga,t=this._gradientStopColor;return void 0===t&&(t=this.getParentCell("gradientStopColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopColor"),this._gradientStopColor=e}},{key:"gradientStopColorTrans",get:function(){var e=o,t=this._gradientStopColorTrans;return void 0===t&&(t=this.getParentCell("gradientStopColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopColorTrans"),this._gradientStopColorTrans=e}},{key:"gradientStopPosition",get:function(){var e=o,t=this._gradientStopPosition;return void 0===t&&(t=this.getParentCell("gradientStopPosition")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("gradientStopPosition"),this._gradientStopPosition=e}},{key:"height",get:function(){var e=a,t=this._height;return void 0===t&&(t=this.getParentCell("height")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("height"),this._height=e}},{key:"helpTopic",get:function(){var e=ia,t=this._helpTopic;return void 0===t&&(t=this.getParentCell("helpTopic")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("helpTopic"),this._helpTopic=e}},{key:"hideForApply",get:function(){var e=i,t=this._hideForApply;return void 0===t&&(t=this.getParentCell("hideForApply")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("hideForApply"),this._hideForApply=e}},{key:"hideText",get:function(){var e=o,t=this._hideText;return void 0===t&&(t=this.getParentCell("hideText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("hideText"),this._hideText=e}},{key:"horzAlign",get:function(){var e=r,t=this._horzAlign;return void 0===t&&(t=this.getParentCell("horzAlign")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("horzAlign"),this._horzAlign=e}},{key:"imgHeight",get:function(){var e=a,t=this._imgHeight;return void 0===t&&(t=this.getParentCell("imgHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgHeight"),this._imgHeight=e}},{key:"imgOffsetX",get:function(){var e=a,t=this._imgOffsetX;return void 0===t&&(t=this.getParentCell("imgOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgOffsetX"),this._imgOffsetX=e}},{key:"imgOffsetY",get:function(){var e=a,t=this._imgOffsetY;return void 0===t&&(t=this.getParentCell("imgOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgOffsetY"),this._imgOffsetY=e}},{key:"imgWidth",get:function(){var e=a,t=this._imgWidth;return void 0===t&&(t=this.getParentCell("imgWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("imgWidth"),this._imgWidth=e}},{key:"indFirst",get:function(){var e=a,t=this._indFirst;return void 0===t&&(t=this.getParentCell("indFirst")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indFirst"),this._indFirst=e}},{key:"indLeft",get:function(){var e=a,t=this._indLeft;return void 0===t&&(t=this.getParentCell("indLeft")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indLeft"),this._indLeft=e}},{key:"indRight",get:function(){var e=a,t=this._indRight;return void 0===t&&(t=this.getParentCell("indRight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("indRight"),this._indRight=e}},{key:"inhibitSnap",get:function(){var e=i,t=this._inhibitSnap;return void 0===t&&(t=this.getParentCell("inhibitSnap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("inhibitSnap"),this._inhibitSnap=e}},{key:"initials",get:function(){var e=ia,t=this._initials;return void 0===t&&(t=this.getParentCell("initials")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("initials"),this._initials=e}},{key:"invisible",get:function(){var e=i,t=this._invisible;return void 0===t&&(t=this.getParentCell("invisible")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("invisible"),this._invisible=e}},{key:"isDropSource",get:function(){var e=i,t=this._isDropSource;return void 0===t&&(t=this.getParentCell("isDropSource")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isDropSource"),this._isDropSource=e}},{key:"isDropTarget",get:function(){var e=i,t=this._isDropTarget;return void 0===t&&(t=this.getParentCell("isDropTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isDropTarget"),this._isDropTarget=e}},{key:"isSnapTarget",get:function(){var e=i,t=this._isSnapTarget;return void 0===t&&(t=this.getParentCell("isSnapTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isSnapTarget"),this._isSnapTarget=e}},{key:"isTextEditTarget",get:function(){var e=i,t=this._isTextEditTarget;return void 0===t&&(t=this.getParentCell("isTextEditTarget")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("isTextEditTarget"),this._isTextEditTarget=e}},{key:"keepTextFlat",get:function(){var e=i,t=this._keepTextFlat;return void 0===t&&(t=this.getParentCell("keepTextFlat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("keepTextFlat"),this._keepTextFlat=e}},{key:"label",get:function(){var e=ia,t=this._label;return void 0===t&&(t=this.getParentCell("label")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("label"),this._label=e}},{key:"langID",get:function(){var e=ha,t=this._langID;return void 0===t&&(t=this.getParentCell("langID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("langID"),this._langID=e}},{key:"layerMember",get:function(){var e=ia,t=this._layerMember;return void 0===t&&(t=this.getParentCell("layerMember")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("layerMember"),this._layerMember=e}},{key:"leftMargin",get:function(){var e=a,t=this._leftMargin;return void 0===(t=void 0===t?this.getParentCell("leftMargin"):t)&&(t=this.getStylesheetTextStyleCell("leftMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("leftMargin"),this._leftMargin=e}},{key:"letterspace",get:function(){var e=a,t=this._letterspace;return void 0===t&&(t=this.getParentCell("letterspace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("letterspace"),this._letterspace=e}},{key:"lineAdjustFrom",get:function(){var e=r,t=this._lineAdjustFrom;return void 0===t&&(t=this.getParentCell("lineAdjustFrom")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineAdjustFrom"),this._lineAdjustFrom=e}},{key:"lineAdjustTo",get:function(){var e=r,t=this._lineAdjustTo;return void 0===t&&(t=this.getParentCell("lineAdjustTo")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineAdjustTo"),this._lineAdjustTo=e}},{key:"lineCap",get:function(){var e=r,t=this._lineCap;return void 0===t&&(t=this.getParentCell("lineCap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineCap"),this._lineCap=e}},{key:"lineColor",get:function(){var e=ga,t=this._lineColor;return void 0===(t=void 0===t?this.getParentCell("lineColor"):t)&&(t=this.getStylesheetLineStyleCell("lineColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineColor"),this._lineColor=e}},{key:"lineColorTrans",get:function(){var e=o,t=this._lineColorTrans;return void 0===(t=void 0===t?this.getParentCell("lineColorTrans"):t)&&(t=this.getStylesheetLineStyleCell("lineColorTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineColorTrans"),this._lineColorTrans=e}},{key:"lineGradientAngle",get:function(){var e=da,t=this._lineGradientAngle;return void 0===t&&(t=this.getParentCell("lineGradientAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientAngle"),this._lineGradientAngle=e}},{key:"lineGradientDir",get:function(){var e=r,t=this._lineGradientDir;return void 0===t&&(t=this.getParentCell("lineGradientDir")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientDir"),this._lineGradientDir=e}},{key:"lineGradientEnabled",get:function(){var e=i,t=this._lineGradientEnabled;return void 0===t&&(t=this.getParentCell("lineGradientEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineGradientEnabled"),this._lineGradientEnabled=e}},{key:"lineJumpCode",get:function(){var e=r,t=this._lineJumpCode;return void 0===t&&(t=this.getParentCell("lineJumpCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpCode"),this._lineJumpCode=e}},{key:"lineJumpFactorX",get:function(){var e=o,t=this._lineJumpFactorX;return void 0===t&&(t=this.getParentCell("lineJumpFactorX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpFactorX"),this._lineJumpFactorX=e}},{key:"lineJumpFactorY",get:function(){var e=o,t=this._lineJumpFactorY;return void 0===t&&(t=this.getParentCell("lineJumpFactorY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpFactorY"),this._lineJumpFactorY=e}},{key:"lineJumpStyle",get:function(){var e=r,t=this._lineJumpStyle;return void 0===t&&(t=this.getParentCell("lineJumpStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineJumpStyle"),this._lineJumpStyle=e}},{key:"linePattern",get:function(){var e=r,t=this._linePattern;return void 0===(t=void 0===t?this.getParentCell("linePattern"):t)&&(t=this.getStylesheetLineStyleCell("linePattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("linePattern"),this._linePattern=e}},{key:"lineRouteExt",get:function(){var e=r,t=this._lineRouteExt;return void 0===t&&(t=this.getParentCell("lineRouteExt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineRouteExt"),this._lineRouteExt=e}},{key:"lineToLineX",get:function(){var e=o,t=this._lineToLineX;return void 0===t&&(t=this.getParentCell("lineToLineX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToLineX"),this._lineToLineX=e}},{key:"lineToLineY",get:function(){var e=o,t=this._lineToLineY;return void 0===t&&(t=this.getParentCell("lineToLineY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToLineY"),this._lineToLineY=e}},{key:"lineToNodeX",get:function(){var e=o,t=this._lineToNodeX;return void 0===t&&(t=this.getParentCell("lineToNodeX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToNodeX"),this._lineToNodeX=e}},{key:"lineToNodeY",get:function(){var e=o,t=this._lineToNodeY;return void 0===t&&(t=this.getParentCell("lineToNodeY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineToNodeY"),this._lineToNodeY=e}},{key:"lineWeight",get:function(){var e=a,t=this._lineWeight;return void 0===(t=void 0===t?this.getParentCell("lineWeight"):t)&&(t=this.getStylesheetLineStyleCell("lineWeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lineWeight"),this._lineWeight=e}},{key:"localizeMerge",get:function(){var e=i,t=this._localizeMerge;return void 0===t&&(t=this.getParentCell("localizeMerge")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("localizeMerge"),this._localizeMerge=e}},{key:"lock",get:function(){var e=i,t=this._lock;return void 0===t&&(t=this.getParentCell("lock")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lock"),this._lock=e}},{key:"lockAspect",get:function(){var e=i,t=this._lockAspect;return void 0===t&&(t=this.getParentCell("lockAspect")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockAspect"),this._lockAspect=e}},{key:"lockBegin",get:function(){var e=i,t=this._lockBegin;return void 0===t&&(t=this.getParentCell("lockBegin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockBegin"),this._lockBegin=e}},{key:"lockCalcWH",get:function(){var e=i,t=this._lockCalcWH;return void 0===t&&(t=this.getParentCell("lockCalcWH")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCalcWH"),this._lockCalcWH=e}},{key:"lockCrop",get:function(){var e=i,t=this._lockCrop;return void 0===t&&(t=this.getParentCell("lockCrop")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCrop"),this._lockCrop=e}},{key:"lockCustProp",get:function(){var e=i,t=this._lockCustProp;return void 0===t&&(t=this.getParentCell("lockCustProp")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockCustProp"),this._lockCustProp=e}},{key:"lockDelete",get:function(){var e=i,t=this._lockDelete;return void 0===t&&(t=this.getParentCell("lockDelete")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockDelete"),this._lockDelete=e}},{key:"lockEnd",get:function(){var e=i,t=this._lockEnd;return void 0===t&&(t=this.getParentCell("lockEnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockEnd"),this._lockEnd=e}},{key:"lockFormat",get:function(){var e=i,t=this._lockFormat;return void 0===t&&(t=this.getParentCell("lockFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockFormat"),this._lockFormat=e}},{key:"lockFromGroupFormat",get:function(){var e=i,t=this._lockFromGroupFormat;return void 0===t&&(t=this.getParentCell("lockFromGroupFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockFromGroupFormat"),this._lockFromGroupFormat=e}},{key:"lockGroup",get:function(){var e=i,t=this._lockGroup;return void 0===t&&(t=this.getParentCell("lockGroup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockGroup"),this._lockGroup=e}},{key:"lockHeight",get:function(){var e=i,t=this._lockHeight;return void 0===t&&(t=this.getParentCell("lockHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockHeight"),this._lockHeight=e}},{key:"lockMoveX",get:function(){var e=i,t=this._lockMoveX;return void 0===t&&(t=this.getParentCell("lockMoveX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockMoveX"),this._lockMoveX=e}},{key:"lockMoveY",get:function(){var e=i,t=this._lockMoveY;return void 0===t&&(t=this.getParentCell("lockMoveY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockMoveY"),this._lockMoveY=e}},{key:"lockPreview",get:function(){var e=i,t=this._lockPreview;return void 0===t&&(t=this.getParentCell("lockPreview")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockPreview"),this._lockPreview=e}},{key:"lockReplace",get:function(){var e=i,t=this._lockReplace;return void 0===t&&(t=this.getParentCell("lockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockReplace"),this._lockReplace=e}},{key:"lockRotate",get:function(){var e=i,t=this._lockRotate;return void 0===t&&(t=this.getParentCell("lockRotate")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockRotate"),this._lockRotate=e}},{key:"lockSelect",get:function(){var e=i,t=this._lockSelect;return void 0===t&&(t=this.getParentCell("lockSelect")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockSelect"),this._lockSelect=e}},{key:"lockTextEdit",get:function(){var e=i,t=this._lockTextEdit;return void 0===t&&(t=this.getParentCell("lockTextEdit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockTextEdit"),this._lockTextEdit=e}},{key:"lockThemeColors",get:function(){var e=i,t=this._lockThemeColors;return void 0===t&&(t=this.getParentCell("lockThemeColors")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeColors"),this._lockThemeColors=e}},{key:"lockThemeConnectors",get:function(){var e=i,t=this._lockThemeConnectors;return void 0===t&&(t=this.getParentCell("lockThemeConnectors")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeConnectors"),this._lockThemeConnectors=e}},{key:"lockThemeEffects",get:function(){var e=i,t=this._lockThemeEffects;return void 0===t&&(t=this.getParentCell("lockThemeEffects")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeEffects"),this._lockThemeEffects=e}},{key:"lockThemeFonts",get:function(){var e=i,t=this._lockThemeFonts;return void 0===t&&(t=this.getParentCell("lockThemeFonts")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeFonts"),this._lockThemeFonts=e}},{key:"lockThemeIndex",get:function(){var e=i,t=this._lockThemeIndex;return void 0===t&&(t=this.getParentCell("lockThemeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockThemeIndex"),this._lockThemeIndex=e}},{key:"lockVariation",get:function(){var e=i,t=this._lockVariation;return void 0===t&&(t=this.getParentCell("lockVariation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockVariation"),this._lockVariation=e}},{key:"lockVtxEdit",get:function(){var e=i,t=this._lockVtxEdit;return void 0===t&&(t=this.getParentCell("lockVtxEdit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockVtxEdit"),this._lockVtxEdit=e}},{key:"lockWidth",get:function(){var e=i,t=this._lockWidth;return void 0===t&&(t=this.getParentCell("lockWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("lockWidth"),this._lockWidth=e}},{key:"locPinX",get:function(){var e=a,t=this._locPinX;return void 0===t&&(t=this.getParentCell("locPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("locPinX"),this._locPinX=e}},{key:"locPinY",get:function(){var e=a,t=this._locPinY;return void 0===t&&(t=this.getParentCell("locPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("locPinY"),this._locPinY=e}},{key:"menu",get:function(){var e=ia,t=this._menu;return void 0===t&&(t=this.getParentCell("menu")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("menu"),this._menu=e}},{key:"name",get:function(){var e=ia,t=this._name;return void 0===t&&(t=this.getParentCell("name")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("name"),this._name=e}},{key:"nameUniv",get:function(){var e=ia,t=this._nameUniv;return void 0===t&&(t=this.getParentCell("nameUniv")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("nameUniv"),this._nameUniv=e}},{key:"newWindow",get:function(){var e=i,t=this._newWindow;return void 0===t&&(t=this.getParentCell("newWindow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("newWindow"),this._newWindow=e}},{key:"noAlignBox",get:function(){var e=i,t=this._noAlignBox;return void 0===t&&(t=this.getParentCell("noAlignBox")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noAlignBox"),this._noAlignBox=e}},{key:"noCoauth",get:function(){var e=i,t=this._noCoauth;return void 0===t&&(t=this.getParentCell("noCoauth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noCoauth"),this._noCoauth=e}},{key:"noCtlHandles",get:function(){var e=i,t=this._noCtlHandles;return void 0===t&&(t=this.getParentCell("noCtlHandles")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noCtlHandles"),this._noCtlHandles=e}},{key:"noFill",get:function(){var e=i,t=this._noFill;return void 0===t&&(t=this.getParentCell("noFill")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noFill"),this._noFill=e}},{key:"noLine",get:function(){var e=i,t=this._noLine;return void 0===t&&(t=this.getParentCell("noLine")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noLine"),this._noLine=e}},{key:"noLiveDynamics",get:function(){var e=i,t=this._noLiveDynamics;return void 0===t&&(t=this.getParentCell("noLiveDynamics")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noLiveDynamics"),this._noLiveDynamics=e}},{key:"nonPrinting",get:function(){var e=i,t=this._nonPrinting;return void 0===t&&(t=this.getParentCell("nonPrinting")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("nonPrinting"),this._nonPrinting=e}},{key:"noObjHandles",get:function(){var e=i,t=this._noObjHandles;return void 0===t&&(t=this.getParentCell("noObjHandles")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noObjHandles"),this._noObjHandles=e}},{key:"noProofing",get:function(){var e=i,t=this._noProofing;return void 0===t&&(t=this.getParentCell("noProofing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noProofing"),this._noProofing=e}},{key:"noQuickDrag",get:function(){var e=i,t=this._noQuickDrag;return void 0===t&&(t=this.getParentCell("noQuickDrag")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noQuickDrag"),this._noQuickDrag=e}},{key:"noShow",get:function(){var e=i,t=this._noShow;return void 0===t&&(t=this.getParentCell("noShow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noShow"),this._noShow=e}},{key:"noSnap",get:function(){var e=i,t=this._noSnap;return void 0===t&&(t=this.getParentCell("noSnap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("noSnap"),this._noSnap=e}},{key:"objectKind",get:function(){var e=r,t=this._objectKind;return void 0===t&&(t=this.getParentCell("objectKind")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("objectKind"),this._objectKind=e}},{key:"objType",get:function(){var e=r,t=this._objType;return void 0===t&&(t=this.getParentCell("objType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("objType"),this._objType=e}},{key:"onPage",get:function(){var e=i,t=this._onPage;return void 0===t&&(t=this.getParentCell("onPage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("onPage"),this._onPage=e}},{key:"outputFormat",get:function(){var e=r,t=this._outputFormat;return void 0===t&&(t=this.getParentCell("outputFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("outputFormat"),this._outputFormat=e}},{key:"overline",get:function(){var e=i,t=this._overline;return void 0===t&&(t=this.getParentCell("overline")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("overline"),this._overline=e}},{key:"pageBottomMargin",get:function(){var e=o,t=this._pageBottomMargin;return void 0===(t=void 0===t?this.getParentCell("pageBottomMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageBottomMargin"),this._pageBottomMargin=e}},{key:"pageHeight",get:function(){var e=a,t=this._pageHeight;return void 0===t&&(t=this.getParentCell("pageHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageHeight"),this._pageHeight=e}},{key:"pageLeftMargin",get:function(){var e=o,t=this._pageLeftMargin;return void 0===(t=void 0===t?this.getParentCell("pageLeftMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLeftMargin"),this._pageLeftMargin=e}},{key:"pageLineJumpDirX",get:function(){var e=r,t=this._pageLineJumpDirX;return void 0===t&&(t=this.getParentCell("pageLineJumpDirX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLineJumpDirX"),this._pageLineJumpDirX=e}},{key:"pageLineJumpDirY",get:function(){var e=r,t=this._pageLineJumpDirY;return void 0===t&&(t=this.getParentCell("pageLineJumpDirY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLineJumpDirY"),this._pageLineJumpDirY=e}},{key:"pageLockDuplicate",get:function(){var e=i,t=this._pageLockDuplicate;return void 0===t&&(t=this.getParentCell("pageLockDuplicate")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLockDuplicate"),this._pageLockDuplicate=e}},{key:"pageLockReplace",get:function(){var e=i,t=this._pageLockReplace;return void 0===t&&(t=this.getParentCell("pageLockReplace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageLockReplace"),this._pageLockReplace=e}},{key:"pageRightMargin",get:function(){var e=o,t=this._pageRightMargin;return void 0===(t=void 0===t?this.getParentCell("pageRightMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageRightMargin"),this._pageRightMargin=e}},{key:"pageScale",get:function(){var e=a,t=this._pageScale;return void 0===t&&(t=this.getParentCell("pageScale")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageScale"),this._pageScale=e}},{key:"pageShapeSplit",get:function(){var e=r,t=this._pageShapeSplit;return void 0===t&&(t=this.getParentCell("pageShapeSplit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageShapeSplit"),this._pageShapeSplit=e}},{key:"pagesX",get:function(){var e=ua,t=this._pagesX;return void 0===t&&(t=this.getParentCell("pagesX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pagesX"),this._pagesX=e}},{key:"pagesY",get:function(){var e=ua,t=this._pagesY;return void 0===t&&(t=this.getParentCell("pagesY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pagesY"),this._pagesY=e}},{key:"pageTopMargin",get:function(){var e=o,t=this._pageTopMargin;return void 0===(t=void 0===t?this.getParentCell("pageTopMargin"):t)?this.getDefaultCellValue(e):this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageTopMargin"),this._pageTopMargin=e}},{key:"pageWidth",get:function(){var e=a,t=this._pageWidth;return void 0===t&&(t=this.getParentCell("pageWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pageWidth"),this._pageWidth=e}},{key:"paperKind",get:function(){var e=ua,t=this._paperKind;return void 0===t&&(t=this.getParentCell("paperKind")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("paperKind"),this._paperKind=e}},{key:"paperSource",get:function(){var e=ua,t=this._paperSource;return void 0===t&&(t=this.getParentCell("paperSource")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("paperSource"),this._paperSource=e}},{key:"perspective",get:function(){var e=this._perspective,t=(void 0===e&&(e=this.getParentCell("perspective")),da);return j.log('resolve cell type "perspective"'),e.units&&j.log("vScalar unclear"),this.resolveCellValue(e,t)},set:function(e){this.attributeSet("perspective"),this._perspective=e}},{key:"pinX",get:function(){var e=a,t=this._pinX;return void 0===t&&(t=this.getParentCell("pinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pinX"),this._pinX=e}},{key:"pinY",get:function(){var e=a,t=this._pinY;return void 0===t&&(t=this.getParentCell("pinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pinY"),this._pinY=e}},{key:"placeDepth",get:function(){var e=r,t=this._placeDepth;return void 0===t&&(t=this.getParentCell("placeDepth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeDepth"),this._placeDepth=e}},{key:"placeFlip",get:function(){var e=r,t=this._placeFlip;return void 0===t&&(t=this.getParentCell("placeFlip")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeFlip"),this._placeFlip=e}},{key:"placeStyle",get:function(){var e=r,t=this._placeStyle;return void 0===t&&(t=this.getParentCell("placeStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("placeStyle"),this._placeStyle=e}},{key:"plowCode",get:function(){var e=r,t=this._plowCode;return void 0===t&&(t=this.getParentCell("plowCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("plowCode"),this._plowCode=e}},{key:"pos",get:function(){var e=r,t=this._pos;return void 0===t&&(t=this.getParentCell("pos")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("pos"),this._pos=e}},{key:"position",get:function(){var e=a,t=this._position;return void 0===t&&(t=this.getParentCell("position")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("position"),this._position=e}},{key:"previewQuality",get:function(){var e=r,t=this._previewQuality;return void 0===t&&(t=this.getParentCell("previewQuality")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("previewQuality"),this._previewQuality=e}},{key:"previewScope",get:function(){var e=r,t=this._previewScope;return void 0===t&&(t=this.getParentCell("previewScope")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("previewScope"),this._previewScope=e}},{key:"print",get:function(){var e=i,t=this._print;return void 0===t&&(t=this.getParentCell("print")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("print"),this._print=e}},{key:"printGrid",get:function(){var e=i,t=this._printGrid;return void 0===t&&(t=this.getParentCell("printGrid")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("printGrid"),this._printGrid=e}},{key:"printPageOrientation",get:function(){var e=r,t=this._printPageOrientation;return void 0===t&&(t=this.getParentCell("printPageOrientation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("printPageOrientation"),this._printPageOrientation=e}},{key:"prompt",get:function(){var e=ia,t=this._prompt;return void 0===t&&(t=this.getParentCell("prompt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("prompt"),this._prompt=e}},{key:"quickStyleEffectsMatrix",get:function(){var e=r,t=this._quickStyleEffectsMatrix;return void 0===t&&(t=this.getParentCell("quickStyleEffectsMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleEffectsMatrix"),this._quickStyleEffectsMatrix=e}},{key:"quickStyleFillColor",get:function(){var e=r,t=this._quickStyleFillColor;return void 0===t&&(t=this.getParentCell("quickStyleFillColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFillColor"),this._quickStyleFillColor=e}},{key:"quickStyleFillMatrix",get:function(){var e=r,t=this._quickStyleFillMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFillMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFillMatrix"),this._quickStyleFillMatrix=e}},{key:"quickStyleFontColor",get:function(){var e=r,t=this._quickStyleFontColor;return void 0===t&&(t=this.getParentCell("quickStyleFontColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFontColor"),this._quickStyleFontColor=e}},{key:"quickStyleFontMatrix",get:function(){var e=r,t=this._quickStyleFontMatrix;return void 0===t&&(t=this.getParentCell("quickStyleFontMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleFontMatrix"),this._quickStyleFontMatrix=e}},{key:"quickStyleLineColor",get:function(){var e=r,t=this._quickStyleLineColor;return void 0===t&&(t=this.getParentCell("quickStyleLineColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleLineColor"),this._quickStyleLineColor=e}},{key:"quickStyleLineMatrix",get:function(){var e=r,t=this._quickStyleLineMatrix;return void 0===t&&(t=this.getParentCell("quickStyleLineMatrix")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleLineMatrix"),this._quickStyleLineMatrix=e}},{key:"quickStyleShadowColor",get:function(){var e=r,t=this._quickStyleShadowColor;return void 0===t&&(t=this.getParentCell("quickStyleShadowColor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleShadowColor"),this._quickStyleShadowColor=e}},{key:"quickStyleType",get:function(){var e=la,t=this._quickStyleType;return void 0===t&&(t=this.getParentCell("quickStyleType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleType"),this._quickStyleType=e}},{key:"quickStyleVariation",get:function(){var e=r,t=this._quickStyleVariation;return void 0===t&&(t=this.getParentCell("quickStyleVariation")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("quickStyleVariation"),this._quickStyleVariation=e}},{key:"readOnly",get:function(){var e=i,t=this._readOnly;return void 0===t&&(t=this.getParentCell("readOnly")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("readOnly"),this._readOnly=e}},{key:"reflectionBlur",get:function(){var e=a,t=this._reflectionBlur;return void 0===t&&(t=this.getParentCell("reflectionBlur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionBlur"),this._reflectionBlur=e}},{key:"reflectionDist",get:function(){var e=a,t=this._reflectionDist;return void 0===t&&(t=this.getParentCell("reflectionDist")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionDist"),this._reflectionDist=e}},{key:"reflectionSize",get:function(){var e=o,t=this._reflectionSize;return void 0===t&&(t=this.getParentCell("reflectionSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionSize"),this._reflectionSize=e}},{key:"reflectionTrans",get:function(){var e=o,t=this._reflectionTrans;return void 0===t&&(t=this.getParentCell("reflectionTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reflectionTrans"),this._reflectionTrans=e}},{key:"relationships",get:function(){var e=i,t=this._relationships;return void 0===t&&(t=this.getParentCell("relationships")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("relationships"),this._relationships=e}},{key:"replaceCopyCells",get:function(){var e=r,t=this._replaceCopyCells;return void 0===t&&(t=this.getParentCell("replaceCopyCells")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceCopyCells"),this._replaceCopyCells=e}},{key:"replaceLockFormat",get:function(){var e=r,t=this._replaceLockFormat;return void 0===t&&(t=this.getParentCell("replaceLockFormat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockFormat"),this._replaceLockFormat=e}},{key:"replaceLockShapeData",get:function(){var e=r,t=this._replaceLockShapeData;return void 0===t&&(t=this.getParentCell("replaceLockShapeData")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockShapeData"),this._replaceLockShapeData=e}},{key:"replaceLockText",get:function(){var e=r,t=this._replaceLockText;return void 0===t&&(t=this.getParentCell("replaceLockText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("replaceLockText"),this._replaceLockText=e}},{key:"resizeMode",get:function(){var e=r,t=this._resizeMode;return void 0===t&&(t=this.getParentCell("resizeMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("resizeMode"),this._resizeMode=e}},{key:"resizePage",get:function(){var e=i,t=this._resizePage;return void 0===t&&(t=this.getParentCell("resizePage")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("resizePage"),this._resizePage=e}},{key:"reviewerID",get:function(){var e=aa,t=this._reviewerID;return void 0===t&&(t=this.getParentCell("reviewerID")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("reviewerID"),this._reviewerID=e}},{key:"rightMargin",get:function(){var e=a,t=this._rightMargin;return void 0===(t=void 0===t?this.getParentCell("rightMargin"):t)&&(t=this.getStylesheetTextStyleCell("rightMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rightMargin"),this._rightMargin=e}},{key:"rotateGradientWithShape",get:function(){var e=i,t=this._rotateGradientWithShape;return void 0===t&&(t=this.getParentCell("rotateGradientWithShape")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotateGradientWithShape"),this._rotateGradientWithShape=e}},{key:"rotationType",get:function(){var e=r,t=this._rotationType;return void 0===t&&(t=this.getParentCell("rotationType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationType"),this._rotationType=e}},{key:"rotationXAngle",get:function(){var e=da,t=this._rotationXAngle;return void 0===t&&(t=this.getParentCell("rotationXAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationXAngle"),this._rotationXAngle=e}},{key:"rotationYAngle",get:function(){var e=da,t=this._rotationYAngle;return void 0===t&&(t=this.getParentCell("rotationYAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationYAngle"),this._rotationYAngle=e}},{key:"rotationZAngle",get:function(){var e=da,t=this._rotationZAngle;return void 0===t&&(t=this.getParentCell("rotationZAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rotationZAngle"),this._rotationZAngle=e}},{key:"rounding",get:function(){var e=a,t=this._rounding;return void 0===t&&(t=this.getParentCell("rounding")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("rounding"),this._rounding=e}},{key:"routeStyle",get:function(){var e=r,t=this._routeStyle;return void 0===t&&(t=this.getParentCell("routeStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("routeStyle"),this._routeStyle=e}},{key:"scaleX",get:function(){var e=o,t=this._scaleX;return void 0===t&&(t=this.getParentCell("scaleX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("scaleX"),this._scaleX=e}},{key:"scaleY",get:function(){var e=o,t=this._scaleY;return void 0===t&&(t=this.getParentCell("scaleY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("scaleY"),this._scaleY=e}},{key:"selectMode",get:function(){var e=r,t=this._selectMode;return void 0===t&&(t=this.getParentCell("selectMode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("selectMode"),this._selectMode=e}},{key:"shapeFixedCode",get:function(){var e=r,t=this._shapeFixedCode;return void 0===t&&(t=this.getParentCell("shapeFixedCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeFixedCode"),this._shapeFixedCode=e}},{key:"shapeKeywords",get:function(){var e=ia,t=this._shapeKeywords;return void 0===t&&(t=this.getParentCell("shapeKeywords")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeKeywords"),this._shapeKeywords=e}},{key:"shapePermeablePlace",get:function(){var e=i,t=this._shapePermeablePlace;return void 0===t&&(t=this.getParentCell("shapePermeablePlace")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeablePlace"),this._shapePermeablePlace=e}},{key:"shapePermeableX",get:function(){var e=i,t=this._shapePermeableX;return void 0===t&&(t=this.getParentCell("shapePermeableX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeableX"),this._shapePermeableX=e}},{key:"shapePermeableY",get:function(){var e=i,t=this._shapePermeableY;return void 0===t&&(t=this.getParentCell("shapePermeableY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePermeableY"),this._shapePermeableY=e}},{key:"shapePlaceFlip",get:function(){var e=r,t=this._shapePlaceFlip;return void 0===t&&(t=this.getParentCell("shapePlaceFlip")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlaceFlip"),this._shapePlaceFlip=e}},{key:"shapePlaceStyle",get:function(){var e=r,t=this._shapePlaceStyle;return void 0===t&&(t=this.getParentCell("shapePlaceStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlaceStyle"),this._shapePlaceStyle=e}},{key:"shapePlowCode",get:function(){var e=r,t=this._shapePlowCode;return void 0===t&&(t=this.getParentCell("shapePlowCode")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapePlowCode"),this._shapePlowCode=e}},{key:"shapeRouteStyle",get:function(){var e=r,t=this._shapeRouteStyle;return void 0===t&&(t=this.getParentCell("shapeRouteStyle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeRouteStyle"),this._shapeRouteStyle=e}},{key:"shapeShdwBlur",get:function(){var e=a,t=this._shapeShdwBlur;return void 0===t&&(t=this.getParentCell("shapeShdwBlur")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwBlur"),this._shapeShdwBlur=e}},{key:"shapeShdwObliqueAngle",get:function(){var e=da,t=this._shapeShdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shapeShdwObliqueAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwObliqueAngle"),this._shapeShdwObliqueAngle=e}},{key:"shapeShdwOffsetX",get:function(){var e=a,t=this._shapeShdwOffsetX;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwOffsetX"),this._shapeShdwOffsetX=e}},{key:"shapeShdwOffsetY",get:function(){var e=a,t=this._shapeShdwOffsetY;return void 0===t&&(t=this.getParentCell("shapeShdwOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwOffsetY"),this._shapeShdwOffsetY=e}},{key:"shapeShdwScaleFactor",get:function(){var e=o,t=this._shapeShdwScaleFactor;return void 0===t&&(t=this.getParentCell("shapeShdwScaleFactor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwScaleFactor"),this._shapeShdwScaleFactor=e}},{key:"shapeShdwShow",get:function(){var e=r,t=this._shapeShdwShow;return void 0===t&&(t=this.getParentCell("shapeShdwShow")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwShow"),this._shapeShdwShow=e}},{key:"shapeShdwType",get:function(){var e=r,t=this._shapeShdwType;return void 0===t&&(t=this.getParentCell("shapeShdwType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeShdwType"),this._shapeShdwType=e}},{key:"shapeSplit",get:function(){var e=r,t=this._shapeSplit;return void 0===t&&(t=this.getParentCell("shapeSplit")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeSplit"),this._shapeSplit=e}},{key:"shapeSplittable",get:function(){var e=r,t=this._shapeSplittable;return void 0===t&&(t=this.getParentCell("shapeSplittable")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shapeSplittable"),this._shapeSplittable=e}},{key:"sharpen",get:function(){var e=o,t=this._sharpen;return void 0===t&&(t=this.getParentCell("sharpen")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sharpen"),this._sharpen=e}},{key:"shdwForegnd",get:function(){var e=ga,t=this._shdwForegnd;return void 0===t&&(t=this.getParentCell("shdwForegnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwForegnd"),this._shdwForegnd=e}},{key:"shdwForegndTrans",get:function(){var e=o,t=this._shdwForegndTrans;return void 0===t&&(t=this.getParentCell("shdwForegndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwForegndTrans"),this._shdwForegndTrans=e}},{key:"shdwObliqueAngle",get:function(){var e=o,t=this._shdwObliqueAngle;return void 0===t&&(t=this.getParentCell("shdwObliqueAngle")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwObliqueAngle"),this._shdwObliqueAngle=e}},{key:"shdwOffsetX",get:function(){var e=a,t=this._shdwOffsetX;return void 0===t&&(t=this.getParentCell("shdwOffsetX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwOffsetX"),this._shdwOffsetX=e}},{key:"shdwOffsetY",get:function(){var e=a,t=this._shdwOffsetY;return void 0===t&&(t=this.getParentCell("shdwOffsetY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwOffsetY"),this._shdwOffsetY=e}},{key:"shdwPattern",get:function(){var e=r,t=this._shdwPattern;return void 0===t&&(t=this.getParentCell("shdwPattern")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwPattern"),this._shdwPattern=e}},{key:"shdwScaleFactor",get:function(){var e=o,t=this._shdwScaleFactor;return void 0===t&&(t=this.getParentCell("shdwScaleFactor")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwScaleFactor"),this._shdwScaleFactor=e}},{key:"shdwType",get:function(){var e=r,t=this._shdwType;return void 0===t&&(t=this.getParentCell("shdwType")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("shdwType"),this._shdwType=e}},{key:"size",get:function(){var e=a,t=this._size;return void 0===t&&(t=this.getParentCell("size")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("size"),this._size=e}},{key:"sketchAmount",get:function(){var e=la,t=this._sketchAmount;return void 0===t&&(t=this.getParentCell("sketchAmount")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchAmount"),this._sketchAmount=e}},{key:"sketchEnabled",get:function(){var e=i,t=this._sketchEnabled;return void 0===t&&(t=this.getParentCell("sketchEnabled")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchEnabled"),this._sketchEnabled=e}},{key:"sketchFillChange",get:function(){var e=o,t=this._sketchFillChange;return void 0===t&&(t=this.getParentCell("sketchFillChange")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchFillChange"),this._sketchFillChange=e}},{key:"sketchLineChange",get:function(){var e=o,t=this._sketchLineChange;return void 0===t&&(t=this.getParentCell("sketchLineChange")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchLineChange"),this._sketchLineChange=e}},{key:"sketchLineWeight",get:function(){var e=a,t=this._sketchLineWeight;return void 0===t&&(t=this.getParentCell("sketchLineWeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchLineWeight"),this._sketchLineWeight=e}},{key:"sketchSeed",get:function(){var e=la,t=this._sketchSeed;return void 0===t&&(t=this.getParentCell("sketchSeed")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sketchSeed"),this._sketchSeed=e}},{key:"snap",get:function(){var e=i,t=this._snap;return void 0===t&&(t=this.getParentCell("snap")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("snap"),this._snap=e}},{key:"softEdgesSize",get:function(){var e=a,t=this._softEdgesSize;return void 0===t&&(t=this.getParentCell("softEdgesSize")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("softEdgesSize"),this._softEdgesSize=e}},{key:"sortKey",get:function(){var e=ia,t=this._sortKey;return void 0===t&&(t=this.getParentCell("sortKey")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("sortKey"),this._sortKey=e}},{key:"spAfter",get:function(){var e=a,t=this._spAfter;return void 0===t&&(t=this.getParentCell("spAfter")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spAfter"),this._spAfter=e}},{key:"spBefore",get:function(){var e=a,t=this._spBefore;return void 0===t&&(t=this.getParentCell("spBefore")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spBefore"),this._spBefore=e}},{key:"spLine",get:function(){var e=a,t=this._spLine;return void 0===t&&(t=this.getParentCell("spLine")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("spLine"),this._spLine=e}},{key:"status",get:function(){var e=r,t=this._status;return void 0===t&&(t=this.getParentCell("status")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("status"),this._status=e}},{key:"strikethru",get:function(){var e=i,t=this._strikethru;return void 0===t&&(t=this.getParentCell("strikethru")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("strikethru"),this._strikethru=e}},{key:"style",get:function(){var e=r,t=this._style;return void 0===t&&(t=this.getParentCell("style")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("style"),this._style=e}},{key:"subAddress",get:function(){var e=ia,t=this._subAddress;return void 0===t&&(t=this.getParentCell("subAddress")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("subAddress"),this._subAddress=e}},{key:"tagName",get:function(){var e=ia,t=this._tagName;return void 0===t&&(t=this.getParentCell("tagName")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("tagName"),this._tagName=e}},{key:"textBkgnd",get:function(){var e=oa,t=this._textBkgnd;return void 0===(t=void 0===t?this.getParentCell("textBkgnd"):t)&&(t=this.getStylesheetTextStyleCell("textBkgnd")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textBkgnd"),this._textBkgnd=e}},{key:"textBkgndTrans",get:function(){var e=o,t=this._textBkgndTrans;return void 0===(t=void 0===t?this.getParentCell("textBkgndTrans"):t)&&(t=this.getStylesheetTextStyleCell("textBkgndTrans")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textBkgndTrans"),this._textBkgndTrans=e}},{key:"textDirection",get:function(){var e=o,t=this._textDirection;return void 0===t&&(t=this.getParentCell("textDirection")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textDirection"),this._textDirection=e}},{key:"textPosAfterBullet",get:function(){var e=a,t=this._textPosAfterBullet;return void 0===t&&(t=this.getParentCell("textPosAfterBullet")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("textPosAfterBullet"),this._textPosAfterBullet=e}},{key:"theData",get:function(){var e=o,t=this._theData;return void 0===t&&(t=this.getParentCell("theData")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("theData"),this._theData=e}},{key:"themeIndex",get:function(){var e=la,t=this._themeIndex;return void 0===t&&(t=this.getParentCell("themeIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("themeIndex"),this._themeIndex=e}},{key:"theText",get:function(){var e=o,t=this._theText;return void 0===t&&(t=this.getParentCell("theText")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("theText"),this._theText=e}},{key:"topMargin",get:function(){var e=a,t=this._topMargin;return void 0===(t=void 0===t?this.getParentCell("topMargin"):t)&&(t=this.getStylesheetTextStyleCell("topMargin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("topMargin"),this._topMargin=e}},{key:"transparency",get:function(){var e=o,t=this._transparency;return void 0===t&&(t=this.getParentCell("transparency")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("transparency"),this._transparency=e}},{key:"txtAngle",get:function(){var e=this._txtAngle,t=(void 0===e&&(e=this.getParentCell("txtAngle")),da);return j.log('resolve cell type "txtAngle"'),e&&"0"!==e.value&&e.units&&e.units!==s.DEG&&j.log("txtAngle unclear"),this.resolveCellValue(e,t)},set:function(e){this.attributeSet("txtAngle"),this._txtAngle=e}},{key:"txtHeight",get:function(){var e=a,t=this._txtHeight;return void 0===t&&(t=this.getParentCell("txtHeight")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtHeight"),this._txtHeight=e}},{key:"txtLocPinX",get:function(){var e=a,t=this._txtLocPinX;return void 0===t&&(t=this.getParentCell("txtLocPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtLocPinX"),this._txtLocPinX=e}},{key:"txtLocPinY",get:function(){var e=a,t=this._txtLocPinY;return void 0===t&&(t=this.getParentCell("txtLocPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtLocPinY"),this._txtLocPinY=e}},{key:"txtPinX",get:function(){var e=a,t=this._txtPinX;return void 0===t&&(t=this.getParentCell("txtPinX")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtPinX"),this._txtPinX=e}},{key:"txtPinY",get:function(){var e=a,t=this._txtPinY;return void 0===t&&(t=this.getParentCell("txtPinY")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtPinY"),this._txtPinY=e}},{key:"txtWidth",get:function(){var e=a,t=this._txtWidth;return void 0===t&&(t=this.getParentCell("txtWidth")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("txtWidth"),this._txtWidth=e}},{key:"type",get:function(){var e=o,t=this._type;return void 0===t&&(t=this.getParentCell("type")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("type"),this._type=e}},{key:"uICat",get:function(){var e=o,t=this._uICat;return void 0===t&&(t=this.getParentCell("uICat")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uICat"),this._uICat=e}},{key:"uICod",get:function(){var e=o,t=this._uICod;return void 0===t&&(t=this.getParentCell("uICod")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uICod"),this._uICod=e}},{key:"uIFmt",get:function(){var e=o,t=this._uIFmt;return void 0===t&&(t=this.getParentCell("uIFmt")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uIFmt"),this._uIFmt=e}},{key:"uIVisibility",get:function(){var e=i,t=this._uIVisibility;return void 0===t&&(t=this.getParentCell("uIVisibility")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("uIVisibility"),this._uIVisibility=e}},{key:"updateAlignBox",get:function(){var e=i,t=this._updateAlignBox;return void 0===t&&(t=this.getParentCell("updateAlignBox")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("updateAlignBox"),this._updateAlignBox=e}},{key:"useGroupGradient",get:function(){var e=i,t=this._useGroupGradient;return void 0===t&&(t=this.getParentCell("useGroupGradient")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("useGroupGradient"),this._useGroupGradient=e}},{key:"value",get:function(){var e=pa,t=this._value;return void 0===t&&(t=this.getParentCell("value")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("value"),this._value=e}},{key:"variationColorIndex",get:function(){var e=la,t=this._variationColorIndex;return void 0===t&&(t=this.getParentCell("variationColorIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("variationColorIndex"),this._variationColorIndex=e}},{key:"variationStyleIndex",get:function(){var e=la,t=this._variationStyleIndex;return void 0===t&&(t=this.getParentCell("variationStyleIndex")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("variationStyleIndex"),this._variationStyleIndex=e}},{key:"verify",get:function(){var e=i,t=this._verify;return void 0===t&&(t=this.getParentCell("verify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("verify"),this._verify=e}},{key:"verticalAlign",get:function(){var e=o,t=this._verticalAlign;return void 0===(t=void 0===t?this.getParentCell("verticalAlign"):t)&&(t=this.getStylesheetTextStyleCell("verticalAlign")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("verticalAlign"),this._verticalAlign=e}},{key:"viewMarkup",get:function(){var e=i,t=this._viewMarkup;return void 0===t&&(t=this.getParentCell("viewMarkup")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("viewMarkup"),this._viewMarkup=e}},{key:"visible",get:function(){var e=i,t=this._visible;return void 0===t&&(t=this.getParentCell("visible")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("visible"),this._visible=e}},{key:"walkPreference",get:function(){var e=r,t=this._walkPreference;return void 0===t&&(t=this.getParentCell("walkPreference")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("walkPreference"),this._walkPreference=e}},{key:"width",get:function(){var e=a,t=this._width;return void 0===t&&(t=this.getParentCell("width")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("width"),this._width=e}},{key:"x",get:function(){var e;if(this.isDescendantOfSectionType([G.Control,G.Scratch,G.ActionTag,G.Connection]))e=a;else switch(this.getRowType()){case re.ArcTo:case re.Ellipse:case re.EllipticalArcTo:case re.InfiniteLine:case re.LineTo:case re.MoveTo:case re.NURBSTo:case re.PolylineTo:case re.SplineKnot:case re.SplineStart:e=a;break;case re.RelCubBezTo:case re.RelEllipticalArcTo:case re.RelLineTo:case re.RelMoveTo:case re.RelQuadBezTo:e=o;break;default:j.log("Incorrect cell type",{attributeName:"x",cells:this,rowType:this.getRowType()})}var t=this._x;return void 0===t&&(t=this.getParentCell("x")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("x"),this._x=e}},{key:"xCon",get:function(){var e=r,t=this._xCon;return void 0===t&&(t=this.getParentCell("xCon")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xCon"),this._xCon=e}},{key:"xDyn",get:function(){var e=a,t=this._xDyn;return void 0===t&&(t=this.getParentCell("xDyn")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xDyn"),this._xDyn=e}},{key:"xGridDensity",get:function(){var e=r,t=this._xGridDensity;return void 0===t&&(t=this.getParentCell("xGridDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridDensity"),this._xGridDensity=e}},{key:"xGridOrigin",get:function(){var e=a,t=this._xGridOrigin;return void 0===t&&(t=this.getParentCell("xGridOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridOrigin"),this._xGridOrigin=e}},{key:"xGridSpacing",get:function(){var e=a,t=this._xGridSpacing;return void 0===t&&(t=this.getParentCell("xGridSpacing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xGridSpacing"),this._xGridSpacing=e}},{key:"xJustify",get:function(){var e=r,t=this._xJustify;return void 0===t&&(t=this.getParentCell("xJustify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xJustify"),this._xJustify=e}},{key:"xRulerDensity",get:function(){var e=r,t=this._xRulerDensity;return void 0===t&&(t=this.getParentCell("xRulerDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xRulerDensity"),this._xRulerDensity=e}},{key:"xRulerOrigin",get:function(){var e=a,t=this._xRulerOrigin;return void 0===t&&(t=this.getParentCell("xRulerOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("xRulerOrigin"),this._xRulerOrigin=e}},{key:"y",get:function(){var e;if(this.isDescendantOfSectionType([G.Control,G.Scratch,G.ActionTag,G.Connection]))e=a;else switch(this.getRowType()){case re.ArcTo:case re.Ellipse:case re.EllipticalArcTo:case re.InfiniteLine:case re.LineTo:case re.MoveTo:case re.NURBSTo:case re.PolylineTo:case re.SplineKnot:case re.SplineStart:e=a;break;case re.RelCubBezTo:case re.RelEllipticalArcTo:case re.RelLineTo:case re.RelMoveTo:case re.RelQuadBezTo:e=o;break;default:j.log("Incorrect cell type",{attributeName:"a",cells:this})}var t=this._y;return void 0===t&&(t=this.getParentCell("y")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("y"),this._y=e}},{key:"yCon",get:function(){var e=r,t=this._yCon;return void 0===t&&(t=this.getParentCell("yCon")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yCon"),this._yCon=e}},{key:"yDyn",get:function(){var e=a,t=this._yDyn;return void 0===t&&(t=this.getParentCell("yDyn")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yDyn"),this._yDyn=e}},{key:"yGridDensity",get:function(){var e=r,t=this._yGridDensity;return void 0===t&&(t=this.getParentCell("yGridDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridDensity"),this._yGridDensity=e}},{key:"yGridOrigin",get:function(){var e=a,t=this._yGridOrigin;return void 0===t&&(t=this.getParentCell("yGridOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridOrigin"),this._yGridOrigin=e}},{key:"yGridSpacing",get:function(){var e=a,t=this._yGridSpacing;return void 0===t&&(t=this.getParentCell("yGridSpacing")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yGridSpacing"),this._yGridSpacing=e}},{key:"yJustify",get:function(){var e=r,t=this._yJustify;return void 0===t&&(t=this.getParentCell("yJustify")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yJustify"),this._yJustify=e}},{key:"yRulerDensity",get:function(){var e=r,t=this._yRulerDensity;return void 0===t&&(t=this.getParentCell("yRulerDensity")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yRulerDensity"),this._yRulerDensity=e}},{key:"yRulerOrigin",get:function(){var e=a,t=this._yRulerOrigin;return void 0===t&&(t=this.getParentCell("yRulerOrigin")),this.resolveCellValue(t,e)},set:function(e){this.attributeSet("yRulerOrigin"),this._yRulerOrigin=e}}]),t}(),ah=["MoveTo","RelMoveTo","LineTo","RelLineTo","ArcTo","InfiniteLine","Ellipse","EllipticalArcTo","RelEllipticalArcTo","SplineStart","SplineKnow","PolylineTo","NURBSTo","RelCubBezTo","RelQuadBezTo"],sh=function(){z(i,wl);var r=q(i);function i(e){var t,e=Object.assign({},e),n=(l(this,i),t=r.call(this,e),e.cells),n=void 0===n?new oh({archive:t.archive}):n;return t.cells=n,t.debugType=e.debugType,t.jxon=e.jxon,e.type&&(t.type=e.type),e.debugType===h.Named?t.name=e.name:t.index=e.index,t}return u(i,[{key:"type",get:function(){return this._type},set:function(e){ah.includes(e)&&this.jxon&&(this.jxon[Zo.Type]=e),this._type=e}}]),i}(),lh={Geometry:["NoFill","NoLine","NoShow","NoSnap","NoQuickDrag"]},uh={Actions:["Menu","Action","Checked","Disabled","ReadOnly","Invisible","BeginGroup","FlyoutChild","TagName","ButtonFace","SortKey"],Character:["Font","Color","Style","Case","Pos","FontScale","Size","DblUnderline","Overline","Strikethru","DoubleStrikethrough","Letterspace","ColorTrans","AsianFont","ComplexScriptFont","ComplexScriptSize","LangID"],Connection:["X","Y","DirX","DirY","Type","AutoGen","Prompt"],Control:["X","Y","XDyn","YDyn","XCon","YCon","CanGlue","Prompt"],Field:["Value","Format","Type","UICat","UICod","UIFmt","Calendar","ObjectKind"],FillGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Geometry:["X","Y","A","B","C","D","E"],Hyperlink:["Description","Address","SubAddress","ExtraInfo","Frame","NewWindow","Default","Invisible","SortKey"],Layer:["Name","Color","Status","Visible","Print","Active","Lock","Snap","Glue","NameUniv","ColorTrans"],LineGradient:["GradientStopColor","GradientStopColorTrans","GradientStopPosition"],Paragraph:["IndFirst","IndLeft","IndRight","SpLine","SpBefore","SpAfter","HorzAlign","Bullet","BulletStr","BulletFont","BulletFontSize","TextPosAfterBullet","Flags"],Property:["Value","Prompt","Label","Format","SortKey","Type","Invisible","Verify","DataLinked","LangID","Calendar"],Reviewer:["Name","Initials","Color","ReviewerID","CurrentIndex"],Scratch:["X","Y","A","B","C","D"],ActionTag:["X","Y","TagName","XJustify","YJustify","DisplayMode","ButtonFace","Disabled","Description"],Tabs:["Position","Alignment"],User:["Value","Prompt"]},ch=function(){z(o,Sl);var i=q(o);function o(t){l(this,o),e=i.call(this,t);var e,n=t.rows,n=void 0===n?[]:n,r=t.cells,r=void 0===r?new oh({archive:e.archive}):r;return e.cells=r,e.rows=n.map(function(e){return new sh(m(m({},e),{},{archive:t.archive}))}),e}return u(o,[{key:"getRows",value:function(){var e=this.rows;return e||[]}},{key:"getRow",value:function(){}},{key:"addRow",value:function(){}},{key:"removeRow",value:function(){}}],[{key:"from",value:function(e){return new(e.type===G.Geometry?dh:e.type===G.Property||e.type===G.User?ph:Sa[e.type]===h.Indexed?hh:fh)(e)}}]),o}(),hh=function(){z(t,ch);var e=q(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"getRow",value:function(e){e=this.rows[e];return e||null}},{key:"addRow",value:function(){var e,t=this.rows.map(function(e){return e.index}).sort().pop(),t=Number.isInteger(t)?t+1:1,n=(g(e={},Yo,t.toString()),g(e,"Cell",[]),new sh({debugType:h.Indexed,index:t,jxon:e,archive:this.archive}));return uh[this.type].forEach(function(e){return n.setCell(e,{value:""})}),this.jxon.Row.push(n.jxon),this.rows.push(n),n}},{key:"removeRow",value:function(e){return this.rows.splice(e,1),this.jxon.Row.splice(e,1),this.rows}}]),t}(),fh=function(){z(t,ch);var e=q(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"getRow",value:function(t){var e=this.rows.find(function(e){return e.name===t});return e||null}},{key:"addRow",value:function(t){var e;if(-1<this.rows.findIndex(function(e){return e.name===t}))throw new Error('Row named "'.concat(t,'" already exists.'));g(e={},Xo,t),g(e,"Cell",[]);var n=new sh({name:t,jxon:e,debugType:h.Named,archive:this.archive});return uh[this.type].forEach(function(e){return n.setCell(e,{value:""})}),this.jxon.Row.push(n.jxon),this.rows.push(n),n}},{key:"removeRow",value:function(t){return this.rows=this.rows.filter(function(e){return e.name!==t}),this.jxon.Row=this.jxon.Row.filter(function(e){return e["@N"]!==t}),this.rows}}]),t}(),ph=function(){z(t,fh);var e=q(t);function t(){return l(this,t),e.apply(this,arguments)}return u(t,[{key:"getProperty",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"value",e=this.getRow(e);return e?e.cells[t]:null}},{key:"getPropertyNames",value:function(){return this.rows.map(function(e){return e.name})}}]),t}(),dh=function(){z(r,hh);var t=q(r);function r(e){var n;return l(this,r),n=t.call(this,e),e.cells?n.cells=e.cells:(n.cells=new oh({archive:n.archive}),n.jxon.Cell=[],lh.Geometry.forEach(function(e){var t=Cl(e);n.cells.has(t)||n.cells["_".concat(t)]||n.setCell(e,{value:""})})),n}return u(r,[{key:"getOwnCellNames",value:function(){return wl.prototype.getOwnCellNames.call(this)}},{key:"getCell",value:function(e){return wl.prototype.getCell.call(this,e)}},{key:"setCell",value:function(e,t){lh.Geometry.includes(e)?wl.prototype.setCell.call(this,e,t):j.log("Cannot add ".concat(e," cell to Geometry section."))}},{key:"removeCell",value:function(e){wl.prototype.removeCell.call(this,e)}},{key:"toPath",value:function(e,t){for(var n=this.rows,n=qa({rows:void 0===n?[]:n},{width:e,height:t}),n=N.V.normalizePathData(n),r=new N.g.Path(n),i=r.segments.length;2<i&&r.segments[i-1].end.equals(r.segments[i-2].end);)r.removeSegment(i-2),i--;return r.translate(0,-t).scale(1,-1),r}},{key:"addRow",value:function(e){var t=K(U(r.prototype),"addRow",this).call(this),e=(e=e)||(1===this.getRows().length?re.RelMoveTo:re.RelLineTo);return t.type=e,t}}]),r}(),gh=(le(function(t){t=function(a){var l,e=Object.prototype,u=e.hasOwnProperty,t="function"==typeof Symbol?Symbol:{},r=t.iterator||"@@iterator",n=t.asyncIterator||"@@asyncIterator",i=t.toStringTag||"@@toStringTag";function o(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{o({},"")}catch(e){o=function(e,t,n){return e[t]=n}}function s(e,t,n,r){var i,o,a,s,t=t&&t.prototype instanceof v?t:v,t=Object.create(t.prototype),r=new P(r||[]);return t._invoke=(i=e,o=n,a=r,s=h,function(e,t){if(s===p)throw new Error("Generator is already running");if(s===d){if("throw"===e)throw t;return T()}for(a.method=e,a.arg=t;;){var n=a.delegate;if(n){n=function e(t,n){var r=t.iterator[n.method];if(r===l){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=l,e(t,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}r=c(r,t.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;r=r.arg;if(!r)return n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g;{if(!r.done)return r;n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=l)}n.delegate=null;return g}(n,a);if(n){if(n===g)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(s===h)throw s=d,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);s=p;n=c(i,o,a);if("normal"===n.type){if(s=a.done?d:f,n.arg!==g)return{value:n.arg,done:a.done}}else"throw"===n.type&&(s=d,a.method="throw",a.arg=n.arg)}}),t}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}a.wrap=s;var h="suspendedStart",f="suspendedYield",p="executing",d="completed",g={};function v(){}function y(){}function m(){}var t={},S=(o(t,r,function(){return this}),Object.getPrototypeOf),S=S&&S(S(_([]))),b=(S&&S!==e&&u.call(S,r)&&(t=S),m.prototype=v.prototype=Object.create(t));function C(e){["next","throw","return"].forEach(function(t){o(e,t,function(e){return this._invoke(t,e)})})}function k(a,s){var t;this._invoke=function(n,r){function e(){return new s(function(e,t){!function t(e,n,r,i){var o,e=c(a[e],a,n);if("throw"!==e.type)return(n=(o=e.arg).value)&&"object"==typeof n&&u.call(n,"__await")?s.resolve(n.__await).then(function(e){t("next",e,r,i)},function(e){t("throw",e,r,i)}):s.resolve(n).then(function(e){o.value=e,r(o)},function(e){return t("throw",e,r,i)});i(e.arg)}(n,r,e,t)})}return t=t?t.then(e,e):e()}}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function P(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function _(t){if(t){var n,e=t[r];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return n=-1,(e=function e(){for(;++n<t.length;)if(u.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=l,e.done=!0,e}).next=e}return{next:T}}function T(){return{value:l,done:!0}}return o(b,"constructor",y.prototype=m),o(m,"constructor",y),y.displayName=o(m,i,"GeneratorFunction"),a.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},a.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,o(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},a.awrap=function(e){return{__await:e}},C(k.prototype),o(k.prototype,n,function(){return this}),a.AsyncIterator=k,a.async=function(e,t,n,r,i){void 0===i&&(i=Promise);var o=new k(s(e,t,n,r),i);return a.isGeneratorFunction(t)?o:o.next().then(function(e){return e.done?e.value:o.next()})},C(b),o(b,i,"Generator"),o(b,r,function(){return this}),o(b,"toString",function(){return"[object Generator]"}),a.keys=function(n){var e,r=[];for(e in n)r.push(e);return r.reverse(),function e(){for(;r.length;){var t=r.pop();if(t in n)return e.value=t,e.done=!1,e}return e.done=!0,e}},a.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=l,this.done=!1,this.delegate=null,this.method="next",this.arg=l,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&u.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=l)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var r=this;function e(e,t){return o.type="throw",o.arg=n,r.next=e,t&&(r.method="next",r.arg=l),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var i=this.tryEntries[t],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=u.call(i,"catchLoc"),s=u.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;0<=n;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&u.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}var o=(i=i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc?null:i)?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var n,r,i=this.tryEntries[t];if(i.tryLoc===e)return"throw"===(n=i.completion).type&&(r=n.arg,w(i)),r}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:_(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=l),g}},a}(t.exports);try{regeneratorRuntime=t}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}}),Qs("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},wa),V.TypeError),vh=nh;function yh(e){var t=/^rId(\d+)$/;return t.test(e)||j.log("incorrect format of relationship to master",e),Ta(e.match(t)[1])}function mh(e){var t;return t=e,1!==Object.keys(t).length&&j.log("Rel should have one attribute",t),yh(e[Ko.RelId])}function Sh(e,t){var n,t=Il(e,S.ShapeText,t),r=e.orderedNodes,r=void 0===r?[]:r,i=[],o=null,a=null,s=null,l=kh(i,{characterPropertiesIndex:o,paragraphPropertiesIndex:a,tabsPropertiesIndex:s}),u=ae(r);try{for(u.s();!(n=u.n()).done;){var c,h,f=n.value;"string"==typeof f?bh(l,f):(c=f._tagName,h=_a(f["@IX"]),["cp","pp","tp"].includes(c)?(Ch(l)&&(l=kh(i,{characterPropertiesIndex:o,paragraphPropertiesIndex:a,tabsPropertiesIndex:s})),"cp"===c&&(o=h,l.characterPropertiesIndex=h),"pp"===c&&(a=h,l.paragraphPropertiesIndex=h),"tp"===c&&(s=h,l.tabsPropertiesIndex=h)):"fld"===c?bh(l,{fieldIndex:h,defaultValue:f.keyValue}):j.log("Unknown text tag.",{tagName:c,textJxon:e}))}}catch(e){u.e(e)}finally{u.f()}return void 0===i[i.length-1].content&&i.pop(),t.structure=i,t}function bh(e,t){Ch(e)||(e.content=[]),e.content.push(t)}function Ch(e){return Array.isArray(e.content)}function kh(e,t){var n=t.characterPropertiesIndex,r=t.paragraphPropertiesIndex,t=t.tabsPropertiesIndex,i={};return null!==n&&(i.characterPropertiesIndex=n),null!==r&&(i.paragraphPropertiesIndex=r),null!==t&&(i.tabsPropertiesIndex=t),e.push(i),i}function xh(e,r){var i=this;return r||j.log("path not defined"),Ja(e).reduce(function(e,t){"object"!==T(n=t)&&j.log("Cell is not object.",n),[Do.Name].forEach(function(e){n.hasOwnProperty(e)||j.log('Cell required key "${key}" missing.',n)});var n,t=function(e,t){var n=function(e){return e[Do.Name]}(e);B.hasOwnProperty(n)||j.log("unknown cell attribute name",n);return{name:function(e){return"Case"===e?"uppercase":Cl(e)}(n),value:function(e){var t=Do.Value;return t in e?e[t]:e.keyValue}(e),formula:function(e){return e[Do.Formula]}(e)||null,units:function(e){return e[Do.Units]}(e)}}.call(i,t,r);return e[t.name]=t,e},{})}function wh(e,t){return function(r,e,t){var e=1<arguments.length&&void 0!==e?e:{},i=2<arguments.length&&void 0!==t?t:null;return Object.entries(r).filter(function(e){var e=Q(e,2),t=e[0];e[1];return"@"!==t[0]}).reduce(function(e,t){var t=Q(t,2),n=t[0],t=t[1],n=Fl(n,i),t=(e.hasOwnProperty(n)&&j.log("keys collision ".concat(n),r),t.hasOwnProperty("keyValue")?t.keyValue:null);return e[n]=Vl(n,t),e},e)}(e,Il(e,S.DocumentSettings,t))}function Ph(r,e){t=r,1!==Object.keys(t).length&&j.log("DocumentColor should have one attribute",{documentColorJxon:t}),(t=new Map).set(0,"#000000"),t.set(1,"#FFFFFF"),t.set(2,"#FF0000"),t.set(3,"#00FF00"),t.set(4,"#0000FF"),t.set(5,"#FFFF00"),t.set(6,"#FF00FF"),t.set(7,"#00FFFF"),t.set(8,"#800000"),t.set(9,"#008000"),t.set(10,"#000080"),t.set(11,"#808000"),t.set(12,"#800080"),t.set(13,"#008080"),t.set(14,"#C0C0C0"),t.set(15,"#E6E6E6"),t.set(16,"#CDCDCD"),t.set(17,"#B3B3B3"),t.set(18,"#9A9A9A"),t.set(19,"#808080"),t.set(20,"#666666"),t.set(21,"#4D4D4D"),t.set(22,"#333333"),t.set(23,"#1A1A1A");var t;return Ja(r[Ho.ColorEntry]).reduce(function(e,t){n=t,2!==Object.keys(n).length&&j.log("documentColorEntryRgbJxon should have two attributes",{documentColorEntryRgbJxon:n});var n=t[Ho.Ix],t=t[Ho.Rgb];return e.has(n)&&j.log("Color override",{colorsJxon:r}),e.set(n,t),e},t)}R({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,t=de(this),n=cn(t),r=Pe(t,0);return r.length=vh(r,t,t,n,0,void 0===e?1:rn(e)),r}}),zr("flat");ru=v(function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})});function _h(e){var t=e.endArrow,n=e.endArrowSize,r=e.beginArrow,i=e.beginArrowSize,e=e.lineWeight,o={};return o.sourceMarker=r?Th(r,i,e):null,o.targetMarker=t?Th(t,n,e):null,o}function Th(e,t,n){var t=1<arguments.length&&void 0!==t?t:0,n=2<arguments.length?n:void 0,r="#000000",i="#000000",e=function(e){switch(e){case 0:return null;case 1:return{d:"M 1 -1 L 0 0 L 1 1",type:"stroke"};case 2:return{d:"M 1 1 L 0 0 L 1 -1 L 1 1",type:"fill"};case 3:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 4:return{d:"M 2 -1 0 0 2 1 Z",type:"fill"};case 5:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67173 -0.364515 1.67301 0.372641 1.98465 1.00043",type:"fill"};case 6:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"fill"};case 7:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452",type:"stroke"};case 8:return{d:"M 1.84309 -0.959455 C 1.43792 -0.3808 0.784502 -0.0260248 0.0785258 -0.00137083 L 0.0785228 0.00137063 C 0.784499 0.0260235 1.43791 0.380798 1.84309 0.959452 C 1.67173 0.364515 1.67301 -0.372641 1.84309 -0.959455",type:"fill"};case 9:return{d:"M -1 -1 0 0 1 1",type:"stroke"};case 10:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"fill"};case 11:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"fill"};case 12:return{d:"M 2 -1 0 0 2 1",type:"stroke"};case 13:return{d:"M 3 -1 0 0 3 1 Z",type:"fill"};case 14:return{d:"M 3 -1 0 0 3 1 Z",type:"stroke-empty"};case 15:return{d:"M 1 -1 0 0 1 1 Z",type:"stroke-empty"};case 16:return{d:"M 2 -1 0 0 2 1 Z",type:"stroke-empty"};case 17:return{d:"M 2 1 L 0 0 L 1.98117 -0.993387 C 1.67051 -0.362037 1.67309 0.378293 1.98815 1.00746",type:"stroke-empty"};case 18:return{d:"M 2 1 L 0 0 L 2.01237 -1.00641 C 2.32921 -0.372874 2.32921 0.37287 2.01238 1.0064",type:"stroke-empty"};case 19:return{d:"M 1.95144 1.125 C 1.55653 0.440984 1.54919 -0.400016 1.93211 -1.09082 L 1.92863 -1.09117 C 1.52903 -0.42613 0.815004 -0.013884 0.0392696 -0.000342899 L 0.0392671 0.000342659 C 0.815002 0.0138829 1.52903 0.426128 1.92863 1.09116",type:"stroke-empty"};case 20:return{d:"M -1 0 a 1 1 0 1 0 2 0 a 1 1 0 1 0 -2 0",type:"stroke-empty"};case 21:return{d:"M -1 -1 1 -1 1 1 -1 1 z",type:"stroke-empty"};case 22:return{d:"M 0 0 2 -1 4 0 2 1 z",type:"stroke-empty"};case 23:return{d:"M 2.5 -1 1.5 1",type:"stroke"};case 24:return{d:"M 1.5 -0.75 L 1.5 0.75",type:"stroke"};case 25:return{d:"M 1.5 -0.75 1.5 0.75 M 2.25 -0.75 2.25 0.75",type:"stroke"};case 26:return{d:"M 1.5 -0.75 L 1.5 0.75 M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke"};case 27:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75",type:"stroke"};case 28:return{d:"M 0 -0.75 L 1.5 0 L 0 0.75 M 2 -0.75 L 2 0.75",type:"stroke"};case 29:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0 -0.75 L 1.5 0 L 0 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 30:return{d:"M 2.25 0.75 C 1.83579 0.75 1.5 0.414214 1.5 0 1.5 -0.414214 1.83579 -0.75 2.25 -0.75 2.66421 -0.75 3 -0.414214 3 0 3 0.414214 2.66421 0.75 2.25 0.75 Z M 0.75 -0.75 L 0.75 0.75 M 1.5 0 L 0 0",type:"stroke-empty"};case 31:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke-empty"};case 32:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"stroke-empty"};case 33:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75 M 3.75 -0.75 L 3.75 0.75",type:"stroke-empty"};case 34:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 L 6 0 L 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 35:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75",type:"stroke"};case 36:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 37:return{d:"",type:"fill"};case 38:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 1.5 0 L 3.75 -1.15 M 3.75 -1.15 L 6 0 M 6 0 L 3.75 1.15 M 3.75 1.15 L 1.5 0",type:"stroke-empty"};case 39:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"fill"};case 40:return{d:"M 0 0 L 2 -1 L 2 1 L 0 0 M 2 0 L 4 -1 L 4 1 L 2 0",type:"stroke-empty"};case 41:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z",type:"stroke-empty"};case 42:return{d:"M 0.75 0.75 C 0.335786 0.75 0 0.414214 0 0 0 -0.414214 0.335786 -0.75 0.75 -0.75 1.16421 -0.75 1.5 -0.414214 1.5 0 1.5 0.414214 1.16421 0.75 0.75 0.75 Z M 2.25 -0.75 L 2.25 0.75 M 3 -0.75 L 3 0.75",type:"fill"};case 43:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1",type:"stroke"};case 44:return{d:"M 2 -1 L 0 0 L 2 1 M 3 0.75 L 3 -0.75",type:"stroke"};case 45:return{d:"M 2 -1 L 0 0 L 2 1 M 4 -1 L 2 0 L 4 1 M 5 0.75 L 5 -0.75",type:"stroke"}}}(e);if(!e)return null;var o=e.d,e=e.type,o=((o.includes("A")||o.includes("a"))&&(o=N.V.normalizePathData(o)),new N.g.Path(o)),t=function(e){switch(e){case 0:return 3.253333333333325;case 1:return 3.7333333333333236;case 2:return 4.693333333333321;case 3:return 5.653333333333319;case 4:return 6.613333333333316;case 5:return 13.3333333333333;case 6:return 25.333333333333268;default:return 4.693333333333321}}(t);return o.scale(t,t),"stroke"===e&&(r="none"),"fill"===e&&(i="none"),"stroke-empty"===e&&(r="#ffffff"),{type:"path",d:o.serialize(),"stroke-width":n,fill:r,stroke:i}}function Ah(e){switch(e){case 1:default:return"none";case 2:return"7 5";case 3:return"0 5";case 4:return"7 5 0 5";case 5:return"7 5 0 5 0 5";case 6:return"7 5 7 5 0 5";case 7:return"19 5 7 5";case 8:return"19 5 7 5 7 5";case 9:return"3 3";case 10:return"0 5";case 11:return"3 3 0 3";case 12:return"3 3 0 3 0 3";case 13:return"3 3 3 3 0 3";case 14:return"9 3 3 3";case 15:return"9 3 3 3 3 3";case 16:return"15 9";case 17:return"0 9";case 18:return"15 9 0 9";case 19:return"15 9 0 9 0 9";case 20:return"15 9 15 9 0 9";case 21:return"39 9 15 9";case 22:return"39 9 15 9 15 9";case 23:return"1 2"}}function Lh(e,t,n){var r=e.getShape(),i=function(e){if(!(c=Q(e.getComputedGeometry(),1)[0]))return null;var t=e.width,r=e.height,n=e.pageContent,i=(l=e.cells).locPinX,o=l.locPinY,a=l.angle,s=l.flipX,l=l.flipY,t=((c=Q(c.toPath(t,r).toPolylines(),1)[0]).simplify(),c.points),u=s&&!l||l&&!s;t.forEach(function(e){var t=i,n=o;e.translate(0,-r).scale(1,-1),a&&e.rotate({x:t,y:n},u?-a:a)}),c.scale(s?-1:1,l?-1:1,{x:i,y:o});var c,h=(c=e.getPageMatrix()).e,f=n.page.height-c.f;return t.map(function(e){var t=e.x,e=e.y;return{x:h+t,y:f-e}})}(r);if(!Array.isArray(i)||i.length<2)return null;var o={},a=_h(r.cells),s=a.sourceMarker,a=a.targetMarker,l=r.cells,u=l.lineWeight,c=l.lineColor,l=l.linePattern,l=void 0===l?"none":l,s={line:{sourceMarker:void 0===s?null:s,targetMarker:void 0===a?null:a,stroke:void 0===c?"#000000":c,strokeWidth:Math.max(void 0===u?1:u,1),strokeDasharray:Ah(l)}},a=(r.getComputedGeometry().every(function(e){return e.cells.noShow})&&(s.line.visibility="hidden"),j.level&j.TOOLTIPS&&(s.root={title:"".concat(e.tooltip)}),o.attrs=s,i.shift());if(t){c=Rh(t,a),u=c.dx,l=c.dy;o.source={id:t.id,anchor:{name:"modelCenter",args:{dx:u,dy:l,rotate:!0}}}}else{if(e.getSource())return null;o.source=new N.g.Point(a.x,a.y).toJSON()}r=i.pop();if(n){s=Rh(n,r),c=s.dx,t=s.dy;o.target={id:n.id,anchor:{name:"modelCenter",args:{dx:c,dy:t,rotate:!0}}}}else{if(e.getTarget())return null;o.target=new N.g.Point(r.x,r.y).toJSON()}return o.vertices=i,o}function Mh(e,t){e=function e(t,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;var o=n.id;if(t.has(o))return{shapeId:o,offsetX:r,offsetY:i};if(n.parent)return e(t,n.parent,r,i);return null}(t,e);if(!e)return j.log("no nearestElement source"),null;e=e.shapeId;return t.get(e)}function Rh(e,t){var t=1<arguments.length&&void 0!==t?t:{x:0,y:0},n=e.get("position"),r=n.x,n=n.y,e=e.get("size"),i=e.width,e=e.height;return{dx:t.x-r-i/2,dy:t.y-n-e/2}}function Vh(e){if(!N.util.isObject(e))throw new TypeError("dia.Paper: defineGradient() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+N.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n=e.type;switch(e.type){case"linearGradient":case"radialGradient":var r=function(e,t,n){var r=e.stops,i=e.rotate,i=void 0===i?0:i,o=e.scale,o=void 0===o?"1 1":o,a=e.viewBox;if(!r)throw new TypeError('dia.Paper: definePattern() requires "stops" attribute not empty.');r="<".concat(n,">\n                ").concat(Ja(r).map(function(e){var t=e.offset,n=e.color,e=e.opacity;return'\n                    <stop\n                    offset="'.concat(t,'"\n                    stop-color="').concat(n,'"\n                    stop-opacity="').concat(e,'"/>')}).join(""),"\n                </").concat(n,">"),n={id:t,gradientTransform:"rotate(".concat(i,") scale(").concat(o,")")};a&&(n.viewBox=a);return{gradientSVGString:r,gradientAttrs:N.util.assign(n,e.attrs)}}(e,t,n),i=r.gradientSVGString,o=r.gradientAttrs;break;default:j.log("Unknown Gradient",e)}return N.V(i,o).appendTo(this.defs),t}R({target:"Date",proto:!0,forced:ru},{toJSON:function(e){var t=de(this),n=Tt(t,"number");return"number"!=typeof n||isFinite(n)?t.toISOString():null}}),R({target:"URL",proto:!0,enumerable:!0},{toJSON:function(){return D(URL.prototype.toString,this)}});var Ih=N.dia.Element.define("visio.Element",{},{},{attributes:{filter:{qualify:N.util.isPlainObject,set:function(e){return"url(#".concat(function(e){if(!N.util.isObject(e))throw new TypeError("dia.Paper: defineFilter() requires 1. argument to be an object.");var t=e.id,n=e.name,t=t||n+this.svg.id+N.util.hashCode(JSON.stringify(e));if(!this.isDefined(t)){var r=N.util.filter,r=r[n]&&r[n](e.args||{});if(!r)throw new Error("Non-existing filter "+n);n=N.util.assign({filterUnits:"userSpaceOnUse"},e.attrs,{id:t});N.V(r,n).appendTo(this.defs)}return t}.call(this.paper,e),")")}},fill:{qualify:N.util.isPlainObject,set:function(e){switch(e.type){case"linearGradient":case"radialGradient":return"url(#"+Vh.call(this.paper,e)+")";case"pattern":return"url(#"+function(e){if(!N.util.isObject(e))throw new TypeError("dia.Paper: definePattern() requires 1. argument to be an object.");var t=e.id||e.type+this.svg.id+N.util.hashCode(JSON.stringify(e));if(this.isDefined(t))return t;var n=e.d,r=void 0===(r=e.backgroundColor)?"#ffffff":r,i=void 0===(i=e.color)?"#000000":i,o=void 0===(o=e.strokeWidth)?1:o,a=void 0===(a=e.x)?0:a,s=void 0===(s=e.y)?0:s,l=void 0===(l=e.width)?10:l,u=void 0===(u=e.height)?10:u,c=void 0===(c=e.patternUnits)?"userSpaceOnUse":c,h=void 0===(h=e.strokeOpacity)?1:h,f=void 0===(f=e.fillOpacity)?1:f,p=void 0===(p=e.rotate)?0:p,d=void 0===(d=e.scale)?"1 1":d,g=void 0===(g=e.viewBox)?"0 0 10 10":g;if(n)return r='<pattern>\n             <rect\n                width="100%"\n                height="100%"\n                fill-opacity="1"\n                fill="'.concat(r,'"\n                ></rect>\n            <path\n                d="').concat(n,'"\n                stroke="').concat(i,'"\n                stroke-width="').concat(o,'"\n                stroke-opacity="').concat(h,'"\n                fill="').concat(i,'"\n                fill-opacity="').concat(f,'"\n                ></path>\n                </pattern>'),n=N.util.assign({id:t,patternUnits:c,x:a,y:s,width:l,height:u,patternTransform:"rotate(".concat(p,") scale(").concat(d,")"),viewBox:g},e.attrs),N.V(r,n).appendTo(this.defs),t;throw new TypeError('dia.Paper: definePattern() requires "d" attribute not empty.')}.call(this.paper,e)+")"}}}}}),Fh=N.dia.Link.define("visio.Link",{attrs:{line:{connection:!0},wrapper:{connection:!0}}},{markup:[{tagName:"path",selector:"wrapper",attributes:{fill:"none",cursor:"pointer",stroke:"transparent","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":10}},{tagName:"path",selector:"line",attributes:{fill:"none","pointer-events":"none","stroke-linejoin":"round","stroke-linecap":"round",stroke:"#333333"}}]},{});function Dh(e,t){e=e.toElementAttributes(t);return e?new Ih(e):null}function Eh(e,t,n,r){t=e.toLinkAttributes(t,n);return t?new Fh(t):Dh(e.getShape(),r)}function Oh(e,t){e=e.toElementAttributes({noGeometry:!0});return[new Ih(e)]}var Nh=["emf"];function Bh(e,t,n){var r,i=n.extension,o=n.base64,n=n.selector,a={};return!o||Nh.includes(i)?(r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mN0qwcAAREAx9X+/mIAAAAASUVORK5CYII=",a.preserveAspectRatio="none"):r=o,a.xlinkHref=r,t.attr([n],a),r}var Gh=function(){z(n,Sl);var t=q(n);function n(e){return l(this,n),t.call(this,e,new Set([b.source,b.target]))}return u(n,[{key:"referencePageContent",value:function(e){this.pageContent=e}},{key:"getShape",value:function(){return this.pageContent.getShape(this.shapeId)}},{key:"getSource",value:function(){var e=this._source;return e?this.pageContent.getShape(e.shapeId):(e=this.getShape()).isRootShape()?null:e.getRootShape()}},{key:"getTarget",value:function(){var e=this._target;return e?this.pageContent.getShape(e.shapeId):null}},{key:"tooltip",get:function(){var e=this.getShape();return"connectId: ".concat(e.id," (shapeId)\n")+"type: ".concat(e.type)}},{key:"toLinkAttributes",value:function(e,t){e=Lh(this,e,t);if(!e)return null;t=this.getShape();return e.z=t.getPageZIndex(),e}},{key:"toLink",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=t.importConnect,n=void 0===n?Eh:n,t=t.ignoreNonPrinting,t=void 0===t||t;if("function"!=typeof n)return null;var r=this.getShape();if(t&&!r.isPrintable())return null;var r={ignoreNonPrinting:t},t=this.getSource(),i=this.getTarget();return n(this,t?Mh(t,e):null,i?Mh(i,e):null,r)}},{key:"toLinkLabels",value:function(e){var t=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).importLabels;return(void 0===t?Oh:t)(this.getShape(),e)}}]),n}();function jh(e){var n=this,r=new Map;return e.forEach(function(e,t){return r.set(t,new Gh(m({archive:n},e)))}),r}function Xh(e,t){var r,e=Ja(e[zo.Connect]).map(function(e){return Il(e,zo.Connect,t)});return e=e,r=new Map,function(e){var n=new Map;return e.forEach(function(e){var t=e.fromSheet,t=(n.has(t)||n.set(t,{source:null,target:null}),n.get(t));"BeginX"===e.fromCell?(t.source&&j.log("source already set"),t.source={shapeId:e.toSheet,cell:e.toCell,part:e.toPart}):(t.target&&j.log("target already set"),t.target={shapeId:e.toSheet,cell:e.toCell,part:e.toPart})}),n}(e).forEach(function(e,t){var n=e.source,e=e.target;r.set(t,{shapeId:t,source:n||null,target:e||null})}),r}var Yh=function(){function t(e){l(this,t),this._attributes={},void 0!==e&&this.setAttributes(e)}return u(t,[{key:"set",value:function(e,t){"archive"!==e&&(this._attributes[e]=t)}},{key:"setAttributes",value:function(e){var n=this;Object.entries(e).forEach(function(e){var e=Q(e,2),t=e[0],e=e[1];return n.set(t,e)})}},{key:"attributes",get:function(){return this._attributes}},{key:"isDummyResult",get:function(){return!0}}]),t}(),zh=V.Array,n=!Ks(function(e){Array.from(e)}),Uh=(R({target:"Array",stat:!0,forced:n},{from:function(e){var t,n,r,i,o,a,s=de(e),e=On(this),l=arguments.length,u=1<l?arguments[1]:void 0,c=void 0!==u,l=(c&&(u=Ce(u,2<l?arguments[2]:void 0)),Gs(s)),h=0;if(!l||this==zh&&ws(l))for(t=cn(s),n=e?new this(t):zh(t);h<t;h++)a=c?u(s[h],h):s[h],Wn(n,h,a);else for(o=(i=Ps(s,l)).next,n=e?new this:[];!(r=D(o,i)).done;h++)a=c?function(t,e,n,r){try{return r?e(x(n)[0],n[1]):e(n)}catch(e){Xs(t,"throw",e)}}(i,u,[r.value,h],!0):r.value,Wn(n,h,a);return n.length=h,n}}),ir.trim),Wh=(R({target:"String",proto:!0,forced:El("trim")},{trim:function(){return Uh(this)}}),Zt.indexOf),Hh=y([].indexOf),Jh=!!Hh&&1/Hh([1],1,-0)<0,Zl=Le("indexOf"),qh=(R({target:"Array",proto:!0,forced:Jh||!Zl},{indexOf:function(e){var t=1<arguments.length?arguments[1]:void 0;return Jh?Hh(this,e,t)||0:Wh(this,e,t)}}),{"http://schemas.iaresearch.com/JCVGantt":!0}),Kh={ElementNode:1,TextNode:3,CdataSectionNode:4,ProcessingInstructionNode:7,CommentNode:8,DocumentNode:9,DocumentTypeNode:10,DocumentFragmentNode:11};function Qh(e,t){var n=t&&t.name,t=qh[t&&t.namespaceURI];return/^(?:true|false)$/i.test(e)&&"PlainText"!==n&&!t?"true"===e.toLowerCase():e}function Zh(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];e.hasChildNodes()&&(this.orderedNodes=Array.from(e.childNodes).filter(function(e){return[Kh.TextNode,Kh.CdataSectionNode,Kh.ElementNode].includes(e.nodeType)}).map(function(e){if((t=e).nodeType===Kh.TextNode||t.nodeType===Kh.CdataSectionNode)return e.nodeValue;if(t=e,"undefined"!=typeof HTMLHtmlElement&&t.constructor===HTMLHtmlElement)return e;if(n.includes(e.nodeName))return new Zh(e);var t=new $h(e);return t._tagName=e.tagName,t})),((e=e).hasAttributes&&e.hasAttributes()?e.attributes:[]).forEach(function(e){return t["@"+e.name]=Qh(e.value,e)})}function $h(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];if(t.includes(e.nodeName))this[e.nodeName]=new Zh(e,t);else if(e.hasChildNodes()){for(var n,r,i="",o=0;o<e.childNodes.length;o++)(r=e.childNodes.item(o)).nodeType===Kh.TextNode?i+=r.nodeValue.trim():r.nodeType===Kh.CdataSectionNode?i+=r.nodeValue:r.nodeType===Kh.ElementNode&&(n=r.nodeName,t.includes(n)?this[n]=new Zh(r,t):"undefined"!=typeof HTMLHtmlElement&&r.constructor===HTMLHtmlElement?this[n]=r:(r=new $h(r,t),this.hasOwnProperty(n)?(this[n].constructor!==Array&&(this[n]=[this[n]]),this[n].push(r)):this[n]=r));i&&(this.keyValue=Qh(i))}if(e.hasAttributes&&e.hasAttributes())for(var a,s=0;s<e.attributes.length;s++)this["@"+(a=e.attributes.item(s)).name]=Qh(a.value,a)}function ef(e){var t=e.knownNameSpaces,n=e.element,r=e.qualifiedName,e=e.namespaceURI;return tf({knownNameSpaces:t,qualifiedName:r,namespaceURI:e}),n.createElementNS(e,r)}function tf(e){var t=e.knownNameSpaces,n=e.qualifiedName,e=e.namespaceURI;t[n]=e}function nf(e,m,S){var b={"xmlns:xs":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"};return function e(t,n){var r;if(n.constructor===String||n.constructor===Number||n.constructor===Boolean){if(t.appendChild(m.createTextNode(n.toString())),n===n.valueOf())return}else n.constructor===Date&&t.appendChild(m.createTextNode(n.toGMTString()));var i=Object.keys(n);0<i.indexOf("@N")&&(i.splice(i.indexOf("@N"),1),i.unshift("@N"));for(var o,a,s,l,u,c=0,h=i.length;c<h;c++){var f=i[c];if(!isFinite(f))if(r=n[f],"keyValue"===f)null!==r&&!0!==r&&t.appendChild(m.createTextNode(r.constructor===Date?r.toGMTString():String(r)));else if("keyAttributes"===f)for(var p in r)t.setAttribute(p,r[p]);else if("@"===f.charAt(0))t.namespaceURI!==r&&(o={oParentEl:t,knownNameSpaces:b,slicedSName:f.slice(1),vValue:r},u=l=y=s=a=void 0,s=o.oParentEl,y=o.knownNameSpaces,l=o.slicedSName,o=o.vValue,(u=l.split(":")).length<2?s.setAttribute(l,o):(String(o).match(/^http/)&&tf({knownNameSpaces:y,qualifiedName:l,namespaceURI:o}),u=u[0],a=Object.keys(y).filter(function(e){return"xmlns"===e.split(":")[0]}).map(function(e){return e.split(":")[1]}),"xmlns"===u?s.setAttributeNS("http://www.w3.org/2000/xmlns/",l,o):a.includes(u)?(a=y["xmlns:"+u],s.setAttributeNS(a,l,o)):"r:id"===l&&s.setAttribute(l,o)));else if(r.constructor===HTMLHtmlElement)t.appendChild(r);else if(r.constructor===Array)for(var d=0;d<r.length;d++){var g,v=(v=S[f.split(":")[0]])||t.namespaceURI;e(g=ef({knownNameSpaces:b,element:m,namespaceURI:v,qualifiedName:f}),r[d]),t.appendChild(g)}else{var y=(y=S[f.split(":")[0]])||t.namespaceURI;g=ef({knownNameSpaces:b,element:m,namespaceURI:y,qualifiedName:f}),r instanceof Object?e(g,r):null!==r&&!0!==r&&g.appendChild(m.createTextNode(r.toString())),t.appendChild(g)}}}(m.documentElement,e),m}function rf(e,t,n){return of.apply(this,arguments)}function of(){return(of=I(regeneratorRuntime.mark(function e(t,n,r){var i,o,a,s,l,u,c,h,f,p,d,g,v,y=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((o=3<y.length&&void 0!==y[3]?y[3]:{}).base,o=o.structurePathEnrichObject,o=void 0===o?null:o,t&&n&&r||j.log("Missing required param."),(i=r.slice()).push(Dl(n,t,i,{structurePathEnrichObject:o})),(o=new Yh).set("jxon",t),o.setAttributes(Il(t,n,i)),this&&(a=t[Wo.Cell]||[],o.set(b.cells,new oh(m({archive:this,structurePath:i},xh.call(this,a,i))))),a=t[Wo.Row])return e.t0=o,e.t1=b.rows,e.next=14,ff.call(this,a,i);e.next=16;break;case 14:e.t2=e.sent,e.t0.set.call(e.t0,e.t1,e.t2);case 16:if(s=t[Wo.Section])return e.t3=o,e.t4=b.sections,e.next=22,kf.call(this,s,i);e.next=24;break;case 22:e.t5=e.sent,e.t3.set.call(e.t3,e.t4,e.t5);case 24:if((s=t[Wo.Text])&&o.set(b.text,Sh.call(this,s,i)),(l=t[Wo.Rel])&&o.set(b._rel,mh.call(this,l,i)),l=t[Wo.PageSheet])return e.t6=o,e.t7=b.pageSheet,e.next=34,af.call(this,l,i);e.next=36;break;case 34:e.t8=e.sent,e.t6.set.call(e.t6,e.t7,e.t8);case 36:if(l=t[Wo.Icon])return e.t9=o,e.t10=b.icon,e.next=42,lf.call(this,l,i);e.next=44;break;case 42:e.t11=e.sent,e.t9.set.call(e.t9,e.t10,e.t11);case 44:if(u=t[Wo.ForeignData])return e.t12=o,e.t13=b.foreignData,e.next=50,cf.call(this,u,i);e.next=52;break;case 50:e.t14=e.sent,e.t12.set.call(e.t12,e.t13,e.t14);case 52:if((u=t[Ho.DocumentSettings])&&o.set(b.documentSettings,wh.call(this,u,i)),(c=t[Ho.Colors])&&o.set(b.colors,Ph.call(this,c,i)),c=t[Ho.FaceNames])return e.t15=o,e.t16=b.faceNames,e.next=62,vf.call(this,c,i);e.next=64;break;case 62:e.t17=e.sent,e.t15.set.call(e.t15,e.t16,e.t17);case 64:if(c=t[Ho.StyleSheets])return e.t18=o,e.t19=b.styleSheets,e.next=70,mf.call(this,c,i);e.next=72;break;case 70:e.t20=e.sent,e.t18.set.call(e.t18,e.t19,e.t20);case 72:if((f=t[Ho.DocumentSheet])&&o.set(b.documentSheet,bf.call(this,f,i)),h=t[zo.Shapes])return e.next=78,_f.call(this,h,i);e.next=82;break;case 78:f=e.sent,p=new Map,f.forEach(function(e,t){null!==e?p.set(t,e):j.log("Skipped shape === null",{shapesJxon:h})}),o.set(b.shapes,p);case 82:if(d=t[Uo.Shape])return e.next=86,_f.call(this,d,i);e.next=90;break;case 86:v=e.sent,g=new Map,v.forEach(function(e,t){null!==e?g.set(t,e):j.log("Skipped shape === null",{shapeJxon:d})}),o.set(b.shape,g);case 90:if((v=t[zo.Connects])&&0!==Object.keys(v).length&&o.set(b.connects,jh.call(this,Xh.call(this,v,i))),o.isDummyResult)return e.abrupt("return",o.attributes);e.next=94;break;case 94:return e.abrupt("return",o);case 95:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function af(e,t){return sf.apply(this,arguments)}function sf(){return(sf=I(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rf.call(this,t,S.PageSheet,n));case 2:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function lf(e,t){return uf.apply(this,arguments)}function uf(){return(uf=I(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,rf.call(this,t,S.Icon,n);case 3:return r=e.sent,t.hasOwnProperty(qo.Content)&&(r[b.base64]=t[qo.Content]),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function cf(e,t){return hf.apply(this,arguments)}function hf(){return(hf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o,a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rf(t,S.ForeignData,n);case 2:if(r=e.sent,(o=n[0].jxonType)===S.Page)return a=this.document.pages.get(n[0].pageId),e.next=8,a.getRelsMapCachedAsync();e.next=11;break;case 8:i=e.sent,e.next=20;break;case 11:if(o===S.Master)return a=n[0].masterId,l=this.document.masters.get(a),e.next=16,l.getRelsMapCachedAsync();e.next=19;break;case 16:i=e.sent,e.next=20;break;case 19:j.log("Unhandled ForeignData Type",t);case 20:if(i.has(S.Image)){e.next=23;break}return j.log("missing foreign object relation"),e.abrupt("return",null);case 23:if((s=i.get(S.Image)).has(r._rel)){e.next=27;break}return j.log("missing foreign object relation"),e.abrupt("return",null);case 27:return l=s.get(r._rel),e.abrupt("return",l);case 29:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function ff(e,t){return pf.apply(this,arguments)}function pf(){return(pf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=Ja(t),r=[],i=ae(i),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=13;break}return o=o.value,e.next=9,df.call(this,o,n);case 9:null!==(o=e.sent)&&r.push(o);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i.e(e.t0);case 18:return e.prev=18,i.f(),e.finish(18);case 21:return e.abrupt("return",r);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function df(e,t){return gf.apply(this,arguments)}function gf(){return(gf=I(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rf.call(this,t,S.Row,n,{type:name});case 2:if(void 0===(r=e.sent).index&&void 0===r.name)return j.log("row skipped - invalid XML (no required field)",{parsedRow:r,rowJxon:t,cellsDebug:r.cells?r.cells.debug:"no cells"}),e.abrupt("return",null);e.next=6;break;case 6:return r.debugType=void 0!==r.index?h.Indexed:h.Named,e.abrupt("return",r);case 8:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function vf(e,t){return yf.apply(this,arguments)}function yf(){return(yf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=Ja(t.FaceName),r=[],i=ae(i),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=13;break}return o=o.value,e.next=9,rf.call(this,o,S.FaceName,n);case 9:o=e.sent,r.push(o);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i.e(e.t0);case 18:return e.prev=18,i.f(),e.finish(18);case 21:return e.abrupt("return",r);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function mf(e,t){return Sf.apply(this,arguments)}function Sf(){return(Sf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=Ja(t.StyleSheet),r=new Map,i=ae(i),e.prev=3,i.s();case 5:if((o=i.n()).done){e.next=13;break}return o=o.value,e.next=9,rf.call(this,o,S.StyleSheet,n);case 9:o=e.sent,r.set(o.id,o);case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),i.e(e.t0);case 18:return e.prev=18,i.f(),e.finish(18);case 21:return e.abrupt("return",r);case 22:case"end":return e.stop()}},e,this,[[3,15,18,21]])}))).apply(this,arguments)}function bf(e,t){return Cf.apply(this,arguments)}function Cf(){return(Cf=I(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",rf.call(this,t,S.DocumentSheet,n));case 1:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function kf(e,t){return xf.apply(this,arguments)}function xf(){return(xf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t||j.log("Empty section"),i=Ja(t),r=[],i=ae(i),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=14;break}return o=o.value,e.next=10,rf.call(this,o,S.Section,n);case 10:o=e.sent,r.push(o);case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return a=r.filter(function(e){return null!==e}),e.abrupt("return",wf.call(this,a));case 24:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function wf(e){var r=this;return e.reduce(function(e,t){var t=ch.from(m(m({},t),{},{archive:r})),n=t.type;return e.has(n)||e.set(n,[]),e.get(n).push(t),e},new Map)}var Pf=0;function _f(e,t){return Tf.apply(this,arguments)}function Tf(){return(Tf=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&n||j.log("Missing required parameter."),i=Ja(t[Uo.Shape]),r=new Map,i=ae(i),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=14;break}return o=o.value,e.next=10,Af.call(this,o,n);case 10:o=e.sent,r.set(o.id,m({structurePath:n},o));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return e.abrupt("return",r);case 23:case"end":return e.stop()}},e,this,[[4,16,19,22]])}))).apply(this,arguments)}function Af(e,t){return Lf.apply(this,arguments)}function Lf(){return(Lf=I(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,rf.call(this,t,S.Shape,n);case 3:if(4294967295===(r=e.sent).id&&(r.id="deleted-"+Pf++),r.structurePath=n,(i=r[b.type])!==Qo.Shape){e.next=12;break}g({},zo.Type,Qo.Shape),r.debugType=$o.ShapeSimple,e.next=33;break;case 12:if(i!==Qo.Group){e.next=18;break}g({},zo.Type,Qo.Group),r.debugType=$o.ShapeGroup,r.shapes||j.log("property shapes undefined"),e.next=33;break;case 18:if(i!==Qo.Foreign){e.next=22;break}r.debugType=$o.ShapeForeign,e.next=33;break;case 22:if(i!==Qo.Guide){e.next=27;break}r.debugType=$o.ShapeGuide,j.log("VisioShapeType.Guide investigate"),e.next=33;break;case 27:if(void 0!==i||!r.hasOwnProperty(b.deleted)){e.next=31;break}r.debugType=$o.ShapeDeleteOverride,e.next=33;break;case 31:return j.log('Implement VisioShapeType "'.concat(i,'"'),{shape:t}),e.abrupt("return",null);case 33:return e.abrupt("return",r);case 34:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var Mf=["type","rows","index","cells","jxon","_prefixList","_archive"],Rf=["type","index","name","cells","deleted","debugType","jxon"],Vf=["type","index","name","cells","debugType","jxon","_prefixList","_archive"];function If(e,t,r){e=e,n=new Map,e.forEach(function(e,t){return n.set(t,e.map(Of))});var n,i=n;return t.forEach(function(e,t){if(!i.get(t))return i.set(t,e);var n=i.get(t);i.set(t,function(i){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=2<arguments.length?arguments[2]:void 0,o=t._type,a=t.shape;return e.forEach(function(e){var t=e.index,n=e.deleted,r=i.findIndex(function(e){return e.index===t});n?i.splice(r,1):-1===r?i.push(e):function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=n._type,n=n.shape;Df(e)!==Df(t)&&(j.log(),j.log("Indexes are not same"));var i=e.rows,o=t.rows,i=(Ff(i),Ff(o),{type:t.type,rows:function(s){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],t=2<arguments.length?arguments[2]:void 0;t._type,t.shape;return e.forEach(function(e){var t=e.index,n=e.name,r=e.debugType,i=e.deleted,o=s.findIndex(function(e){return r===h.Indexed?e.index===t:e.name===n}),a=Boolean(s[o]);i?a&&s.splice(o,1):-1===o?s.push(e):s[o]=function(e,t){!function(e,t){e.type;var n=e.index,r=e.name,i=(e.cells,e.deleted,e.debugType),e=(e.jxon,H(e,Rf)),o=(t.type,t.index),a=t.name,s=(t.cells,t.debugType),t=(t.jxon,t._prefixList,t._archive,H(t,Vf));i!==s&&j.log("Rows are different");Object.keys(e).length&&j.log("Unexpected attribute");Object.keys(t).length&&j.log("Unexpected attribute");n!==o&&j.log("Rows are different");r!==a&&j.log("Rows are different");void 0!==n&&void 0!==r&&(j.log(),j.log("Row name and index can't be present together.",{indexMaster:n,nameMaster:r}));void 0===n&&void 0===r&&j.log("A missing index and name of the row. One is required.")}(e,t);var n=Ef(e.cells,t.cells);n.setRowType(t.type),t.jxon?r=t.jxon:e.jxon;var r={type:t.type,debugType:t.debugType,jxon:r,cells:n};t.name&&(r.name=e.name);void 0!==t.index&&(r.index=e.index);return r}(s[o],e)}),s}(i,o,{_type:r,shape:n})});(e.cells||t.cells)&&(i.cells=Ef(e.cells,t.cells))}(i[r],e,{_type:o,shape:a})}),i}(n,e,{_type:t,shape:r}))}),i}function Ff(e){Array.isArray(e)||void 0===e||j.log("Is not array")}function Df(e){var t=e.type,n=e.rows,r=e.index,e=(e.cells,e.jxon,e._prefixList,e._archive,H(e,Mf));return G.hasOwnProperty(t)||j.log("Unknown type",t),Array.isArray(n)||void 0===n||j.log("Unexpected row type"),Object.keys(e).length&&j.log("Unexpected attribute"),r}function Ef(t,n){return t?(n&&n.attributesSet.forEach(function(e){return t[e]=n.get(e)}),t):n.clone()}function Of(e){var t=e.type,n=e.rows,r=e.index,e=e.cells,i={};return t&&(i.type=t),void 0!==r&&(i.index=r),n&&(i.rows=n.map(Nf)),e&&(i.cells=e.clone()),i}function Nf(e){var t=e.type,n=e.index,r=e.name,i=e.cells,e=e.debugType,o={};return t&&(o.type=t),r&&(o.name=r),void 0!==n&&(o.index=n),e&&(o.debugType=e),i&&(o.cells=i.clone()),o}function Bf(e,o){if(e&&e.structure)return e=e.structure.reduce(function(t,r){var i={};return[{parsedIndexName:"characterPropertiesIndex",sectionType:G.Character,propertyName:"characterProperties"},{parsedIndexName:"paragraphPropertiesIndex",sectionType:G.Paragraph,propertyName:"paragraphProperties"},{parsedIndexName:"tabsPropertiesIndex",sectionType:G.Tabs,propertyName:"tabsProperties"}].forEach(function(e){var t=e.parsedIndexName,n=e.sectionType,e=e.propertyName,t=r[t];void 0!==t&&(t=t,void 0!==(n=o.get(n)[0].rows[t].cells)&&(i[e]={cells:n,values:n.directValues}))}),r.content.map(function(e){if("string"==typeof e)return e;e=e.fieldIndex,e=o.get(G.Field)[0].rows[e].cells;return void 0===e&&j.log("fieldCells undefined"),e.value}).filter(function(e){return""!==e}).forEach(function(e){t.push(m({content:e},i))}),t},[]),e.some(function(e){return void 0===e.content})&&j.log("contentArray some undefined"),e}function Gf(e){for(var t=de(this),n=cn(t),r=arguments.length,i=sn(1<r?arguments[1]:void 0,n),o=void 0===(r=2<r?arguments[2]:void 0)?n:sn(r,n);i<o;)t[i++]=e;return t}R({target:"Array",proto:!0},{fill:Gf}),zr("fill");var jf={linear:"linear",radial:"radial",rectangle:"rectangle",path:"path"};function Xf(e){var t,n=e.fillGradientDir,r=e.fillGradientSection,e=(e.fillGradientAngle,function(e){switch(e){case 0:return{type:jf.linear};case 1:return{type:jf.radial,base:zf.Shape,vertical:Yf.bottom,horizontal:Yf.right};case 2:return{type:jf.radial,base:zf.Shape,vertical:Yf.bottom,horizontal:Yf.left};case 3:return{type:jf.radial,base:zf.Shape,vertical:Yf.center,horizontal:Yf.center};case 4:return{type:jf.radial,base:zf.Shape,vertical:Yf.bottom,horizontal:Yf.center};case 5:return{type:jf.radial,base:zf.Shape,vertical:Yf.top,horizontal:Yf.center};case 6:case 7:return{type:jf.radial,base:zf.BoundingBox,vertical:Yf.bottom,horizontal:Yf.right};case 8:return{type:jf.rectangle,base:zf.Shape,vertical:Yf.bottom,horizontal:Yf.right};case 9:return{type:jf.rectangle,base:zf.Shape,vertical:Yf.bottom,horizontal:Yf.left};case 10:return{type:jf.rectangle,base:zf.Shape,vertical:Yf.center,horizontal:Yf.center};case 11:return{type:jf.rectangle,base:zf.Shape,vertical:Yf.top,horizontal:Yf.right};case 12:return{type:jf.rectangle,base:zf.Shape,vertical:Yf.top,horizontal:Yf.left};case 13:return{type:jf.path}}}(n)),n=r.rows.map(function(e){return e.cells}).map(function(e){return{offset:e.gradientStopPosition,color:e.gradientStopColor,opacity:1-e.gradientStopColorTrans}});switch(e.type){case jf.linear:t="linearGradient";break;default:case jf.radial:t="radialGradient"}return{type:t,stops:n,attrs:{}}}var Yf={left:"left",right:"right",top:"top",bottom:"bottom",center:"center"},zf={Shape:"Shape",BoundingBox:"BoundingBox"};function Uf(e){switch(e){case 2:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2,scale:"1 1"};case 3:return{d:"M 0 5 L 10 5 M 5 0 L 5 10"};case 4:return{d:"M 0 0 L 10 10 M 0 10 L 10 0"};case 5:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2,scale:"1 1"};case 6:return{d:"M 0 5 L 10 5"};case 7:return{d:"M 5 0 L 5 10"};case 8:case 9:case 10:return Wf(e);case 11:return{d:"M 0 1 L 2 1 M 2 3 L 4 3",width:3,height:3,viewBox:"0 0 4 4"};case 12:return Wf(e);case 13:return{d:"M 0 2.5 L 1 2.5",width:1,height:3};case 14:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 15:return{d:"M 2.5 0 L 2.5 1",rotate:45,width:5,height:1};case 16:return{d:"M 2.5 0 L 2.5 1",rotate:315,width:5,height:1};case 17:case 18:return Wf(e);case 19:return{d:"M 0 2.5 L 1 2.5",width:1,height:5};case 20:return{d:"M 2.5 0 L 2.5 1",width:5,height:1};case 21:return{d:"M 2 0 L 2 2",rotate:45,width:4,height:2};case 22:return{d:"M 2 0 L 2 2",rotate:315,width:4,height:2};case 23:return{d:"M 0 2.5 L 5 2.5 M 2.5 0 L 2.5 5",width:5,height:5};case 24:return Wf(e)}}function Wf(e){return j.log("unimplemented fill pattern ".concat(e,", ")+"using pattern ".concat(2," instead")),Uf(2)}function Hf(e,t,n){var t=1<arguments.length&&void 0!==t?t:{},r=t.origin,r=void 0===r?{x:0,y:0}:r,i=t.prefix,i=void 0===i?"":i,t=t.isRoot,t=void 0!==t&&t,n=2<arguments.length&&void 0!==n?n:{};if(n.ignoreNonPrinting&&!e.isPrintable())return null;var o=e.text,a=e.cells,a=void 0===a?{}:a,s=e.foreignData,l=a.angle,l=void 0===l?0:l,u=a.locPinX,u=void 0===u?0:u,c=a.locPinY,c=void 0===c?0:c,h=a.pinX,f=a.pinY,p=a.width,d=a.height,g=a.flipX,v=a.flipY,y=a.fillForegnd,y=void 0===y?"white":y,m=a.fillBkgnd,m=void 0===m?"#ff0000":m,S=a.lineColor,S=void 0===S?"black":S,D=a.lineWeight,b=a.lineColorTrans,b=void 0===b?0:b,C=a.fillForegndTrans,C=void 0===C?0:C,k=a.linePattern,k=void 0===k?1:k,x=a.fillPattern,x=void 0===x?1:x,w=a.fillGradientDir,w=void 0===w?0:w,E=a.fillGradientAngle,P=a.fillGradientEnabled,P=void 0!==P&&P,_=[],T={},h=(j.level&j.TOOLTIPS&&(T.root={title:"".concat(e.tooltip)}),{x:r.x+h,y:r.y-d-f}),r={width:p,height:d},f=g?-1:1,A=v?-1:1,L=-u,M=v?-2*d+c:c,l=f*A*l,R=u,V=d-c;t&&(L+=g?-p+u:u,M-=v?-d+c:c);var I,F,O,g=["scale(".concat(f,", ").concat(A,")"),"translate(".concat(L,", ").concat(M,")"),"rotate(".concat(l,", ").concat(R,", ").concat(V,")")].join(" "),u=n.noGeometry?[]:e.getComputedGeometry(),g=(0<u.length&&(v="".concat(i,"foreground"),_.push({tagName:"g",selector:v,children:(c=u,I=(f={width:p,height:d,prefix:i}).width,F=f.height,f=f.prefix,O=void 0===f?"":f,c.map(function(e,t){var n={d:e.toPath(I,F).toString(),"stroke-linecap":"round","stroke-linejoin":"round"},e=e.cells,e=void 0===e?{}:e;return e.noFill&&(n.fill="none"),e.noLine&&(n.stroke="none"),e.noShow&&(n.visibility="hidden"),{tagName:"path",selector:"".concat(O,"geometry-").concat(t),attributes:n}})),attributes:{transform:g,"stroke-width":Math.max(D,1)}}),A=T[v]={},0===x?A.fill="none":(A.fill=1===x?y:function(e,t,n){if(!(e=Uf(e)))return t;var r=e.d,i=e.strokeWidth,o=e.x,a=e.y,s=e.width,l=e.height,u=e.patternUnits,c=e.strokeOpacity,h=e.fillOpacity,f=e.rotate,p=void 0===(p=e.viewBox)?void 0:p,e=e.scale,t={type:"pattern",color:t,backgroundColor:n,strokeWidth:void 0===i?1:i,d:r,x:void 0===o?0:o,y:void 0===a?0:a,width:void 0===s?10:s,height:void 0===l?10:l,patternUnits:void 0===u?"userSpaceOnUse":u,strokeOpacity:void 0===c?1:c,fillOpacity:void 0===h?1:h,rotate:void 0===f?0:f,scale:void 0===e?"1 1":e,viewBox:p};return p&&(t.viewBox=p),t}(x,y,m),A.fillOpacity=1-C),P&&(A.fillOpacity=1-C,(L=e.getComputedSection(G.FillGradient))&&(A.fill=Xf({fillGradientAngle:E,fillGradientDir:w,fillGradientSection:L,fillBkgnd:m}))),0<k?(A.stroke=S,A.strokeOpacity=1-b,A.strokeDasharray=Ah(k)):A.stroke="none",e.isOneDimensional()&&N.util.assign(A,_h(a)),M=a.shapeShdwType,l=a.shapeShdwOffsetX,R=a.shapeShdwOffsetY,V=a.shapeShdwBlur,n=a.shdwForegnd,u=a.shdwForegndTrans,M&&(A.filter={name:"dropShadow",args:{dx:l,dy:-R,color:void 0===n?"#000":n,opacity:1-(void 0===u?0:u),blur:void 0===V?0:V}})),s&&(f="".concat(i,"image"),c="image".concat(s.id),_.push({tagName:"image",selector:f,groupSelector:c,attributes:{x:-p/2,y:d/2,width:p,height:d}})),o&&o.length&&gc(e,{markup:_,attrs:T,prefix:i,isRootGroupText:t}),{markup:_,attrs:T,position:h,size:r});return 2===e.cells.objType&&N.util.setByPath(g,["attrs","foreground","fill"],"none"),g}var Jf=["shapes"],qf=0,Kf=function(){z(a,wl);var n,e,r=q(a);function a(e){var t=e.shapes,e=H(e,Jf);return l(this,a),e.type||!0===e.deleted||j.log("Missing type, could not instantiate a VisioShape."),void 0!==(e=r.call(this,e,new Set([b.name,b.type,b.cells,b.sections,b.master,b.shapes,b.textStyle]))).masterId&&(e._master=e.masters.get(e.masterId)),t&&e.initShapes(t),e.pageContent.referenceShape(J(e)),e}return u(a,[{key:"getDefaultAttributes",value:function(){return m(m({},K(U(a.prototype),"getDefaultAttributes",this).call(this)),{},{name:null,type:null,cells:null,sections:new Map,shapes:[],pageContent:null})}},{key:"initShapes",value:function(e){var t=this._master,n=this.masters&&this.masters.get(this.parentMasterId);t||n?t?this.shapes=this.traverseShapes(e,t.masterShapes):n&&(t=n.masterShapesMap.get(this.masterShapeId),this.shapes=this.traverseShapes(e,t.masterShapes)):this.shapes=this.instantiateShapes(e)}},{key:"traverseShapes",value:function(e){var n=this,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Map,r=void 0!==this.masterId?this.masterId:this.parentMasterId,i=this.shapesByMasterShapeId(e),o=0,a=new Map;return t.forEach(function(e,t){t=i.get(t);(t=t||{id:"dummy-"+qf++,type:e.type}).deleted||a.set(t.id,n.factory(m({masterShape:e,parentMasterId:r,xmlGroupOrder:o++},t)))}),a}},{key:"factory",value:function(e){return new a(m({archive:this.archive,parent:this,pageContent:this.pageContent,masters:this.masters},e))}},{key:"getRootShape",value:function(){for(var e=this,t=e.parent;t;)t=(e=t).parent;return e}},{key:"isRootShape",value:function(){return!this.parent}},{key:"shapesByMasterShapeId",value:function(e){var t=new Map;return e.forEach(function(e){e.masterShapeId||j.log("masterShapeId undefined"),t.set(e.masterShapeId,e)}),t}},{key:"getComputedForeignData",value:function(){var e=this.foreignData,t=this.masterShape;return e||(t&&t.foreignData?t.foreignData:null)}},{key:"hasImage",value:function(){return Boolean(this.getComputedForeignData())}},{key:"getImage",value:(e=I(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getComputedForeignData()){e.next=3;break}return e.abrupt("return",null);case 3:return r=t.targetFile,n=t.id,e.next=6,this.archive.getImageAsync(r.absolutePath);case 6:return r=e.sent,e.abrupt("return",m(m({},r),{},{selector:"image".concat(n)}));case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"referenceMasters",value:function(){var e,t,n=void 0!==this.masterId?this.masterId:this.parentMasterId;void 0!==n&&(e=this.archive.document.masters,this.master=e.get(n),this.masterShapeId?(t=this.master.masterShapesMap,this._masterShape=t.get(this.masterShapeId)):this._masterSubShape=e.getSubShape(n))}},{key:"masterShape",get:function(){return this._masterShape||this._master},set:function(e){this._masterShape=e}},{key:"instantiateShapes",value:function(e){var n=this,r=void 0!==this.masterId?this.masterId:this.parentMasterId,i=new Map;return e.forEach(function(e,t){return i.set(t,n.factory(m({parentMasterId:r},e)))}),i}},{key:"x",get:function(){return this.cells.pinX-this.cells.locPinX}},{key:"y",get:function(){return this.cells.pinY-this.cells.locPinY}},{key:"angle",get:function(){return this.cells.angle}},{key:"height",get:function(){return this.cells.height}},{key:"width",get:function(){return this.cells.width}},{key:"matrix",get:function(){var e=this.x,t=this.y,n=this.angle,e=N.V.createSVGMatrix().translate(e,t);return e=n?e.rotate(n):e}},{key:"getPageMatrix",value:function(){var t=N.V.createSVGMatrix();return[].concat(F(this.getAncestorShapes()),[this]).forEach(function(e){t=t.multiply(e.matrix)}),t}},{key:"getPageOrigin",value:function(){var e=this.parent,t=this.pageContent,t=new N.g.Point(0,t.page.height);return e&&(e=e.getPageMatrix(),t.offset(e.e,-e.f)),t}},{key:"getPageZIndex",value:function(){return this.getRootShape().xmlOrder}},{key:"getPageAngle",value:function(){return this.getAncestorShapes().reduce(function(e,t){return e+t.angle},this.angle)}},{key:"getPagePosition",value:function(){return this.getPageBBox().origin()}},{key:"getPageBBox",value:function(){var e=this.getPageMatrix(),t=this.width,n=this.height,r=this.pageContent,i=e.e,r=r.page.height-e.f-n;return new N.g.Rect(i,r,t,n).normalize()}},{key:"name",get:function(){var e=this.archive.document.languageDependent?this._name:this.nameU;return"string"==typeof e?e:null}},{key:"type",get:function(){return this._type},set:function(e){this._type=e}},{key:"cells",get:function(){if(!this._cells){var e=this.masterShape;if(e&&e.cells)return e.cells}return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._cachedSections||this.cacheSections(),this._cachedSections},set:function(e){this._sections=e}},{key:"cacheSections",value:function(){var n=this,r=new Map;this.mergeSections().forEach(function(e,t){e=e.map(function(e){e=ch.from(m(m({},e),{},{archive:n.archive}));return n._sections.has(t)&&(e.jxon=n._sections.get(t)[0].jxon),e});r.set(t,e)}),this._cachedSections=r}},{key:"mergeSections",value:function(){var e=this.getDefaultSections(),t=Boolean(this._sections),n=Boolean(this.masterShape&&this.masterShape.sections);if(!t&&!n)return e;if(t&&!n)return If(e,this._sections,this);if(!t&&n)return If(e,this.masterShape.sections,this);t=this._sections,n=If(e,this.masterShape.sections,this);return If(n,t,this)}},{key:"shapes",get:function(){return this._shapes},set:function(e){this._shapes=e}},{key:"text",get:function(){if(null!==this._cachedText)return this._cachedText||(this._cachedText=this.calculateTextContent()),this._cachedText},set:function(e){this._text=e}},{key:"getSubShapes",value:function(){return F(this._shapes.values())}},{key:"getAncestorShapes",value:function(){for(var e=[],t=this.parent;t;)e.unshift(t),t=t.parent;return e}},{key:"getSectionNames",value:function(){return F(this.sections.keys())}},{key:"getOwnSectionNames",value:function(){return F(this._sections.keys())}},{key:"getSection",value:function(e){if(e===G.Geometry)throw new Error("Use getGeometry instead.");if(!G[e])throw new Error("Wrong section name: ".concat(e));e=this._sections.get(e);return Array.isArray(e)&&0!==e.length?e[0]:null}},{key:"getComputedSection",value:function(e){if(e===G.Geometry)throw new Error("Use getGeometry instead.");if(!G[e])throw new Error("Wrong section name: ".concat(e));e=this.sections.get(e);return Array.isArray(e)&&0!==e.length?e[0]:null}},{key:"getGeometry",value:function(){var e=this._sections.get(G.Geometry);return e||[]}},{key:"getComputedGeometry",value:function(){var e=this.sections.get(G.Geometry);return e||[]}},{key:"addSection",value:function(e){var t=Sa[e];if(void 0===t)return j.log("Unhandled section name: ".concat(e)),null;if(this.getSection(e)&&t!==Sa.Geometry)return j.log('Can not add a section "'.concat(e,'" as it already exists.')),this.getSection(e);g(t={},jo.Name,e),g(t,"Row",[]);var n,r,i=ch.from({type:e,jxon:t,archive:this.archive});return e===G.Geometry?(r=(n=this.getComputedGeometry()).map(function(e){return e.index}).sort().pop(),i.index=Number.isInteger(r)?r+1:0,this._sections.set(e,[].concat(F(n),[i])),t[jo.Id]=i.index.toString()):this._sections.set(e,[i]),this.jxon.Section.push(t),this.cacheSections(),i}},{key:"removeSection",value:function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=Sa[t];if(void 0!==e)if(e===h.Named){this.sections.delete(t);e=this.jxon.Section.findIndex(function(e){return e[jo.Name]===t});this.jxon.Section[e]&&this.jxon.Section.splice(e,1)}else{if(!Number.isInteger(n))throw new Error("Index has to be an integer.");e=this.sections.get(t)||[];if(Array.isArray(e)&&!e[n])throw new Error("Index out of range.");e.splice(n,1),this.sections.set(t,e);e=this.jxon.Section.findIndex(function(e){return e[jo.Name]===t&&e[jo.Id]===n.toString()});this.jxon.Section[e]&&this.jxon.Section.splice(e,1)}}},{key:"getText",value:function(){var e=this.text;return Array.isArray(e)&&0!==e.length?e[0].content.trim():""}},{key:"setText",value:function(e){e&&0<e.length&&(this.text=[{content:e}],this.jxon.Text=[{cp:{"@IX":"0"}},e])}},{key:"calculateTextContent",value:function(){var e=this.sections,t=Bf(this._text,e);if(t)return t;t=this.masterShape;return t?Bf(t.text,e):null}},{key:"getDefaultSections",value:function(){var e=this.textStyle,t=this.archive.document.styleSheets,n=t.get(e),n=(void 0===n&&j.log("styleSheet undefined"),n.sections||new Map);return 0===e?n:If(t.get(0).sections,n,this)}},{key:"master",get:function(){return this._master||(this._masterShape?this._masterShape.master:null)}},{key:"getMaster",value:function(){return this.getRootShape().master}},{key:"tooltip",get:function(){var e="shapeId: ".concat(this.id)+"\nwidth: ".concat(this.cells.width)+"\nheight: ".concat(this.cells.height)+"\ntype: ".concat(this.type),t=this.masterShape,t=(t&&(e+="\nmasterShapeId: ".concat(t.id),t.shapeId&&(e+=" (shapeId: ".concat(t.shapeId,")"))),this.master);return t&&(e+="\nmasterXml: ".concat(t.xmlPath.split("/").pop())),e+="\nshapeXml: ".concat(this.pageContent.page.xmlPath.split("/").pop()),this.isOneDimensional()&&(e+="\nisOneDimensional"),e}},{key:"textStyle",get:function(){if(void 0!==this._textStyle)return this._textStyle;if(this.masterShape&&void 0!==this.masterShape.textStyle)return this.masterShape.textStyle;var e=this.archive.document.documentSettings.defaultTextStyle;return void 0===e&&j.log("defaultTextStyle undefined"),e},set:function(e){this._textStyle=e}},{key:"fillStyle",get:function(){if(void 0!==this._fillStyle)return this._fillStyle;if(this.masterShape&&void 0!==this.masterShape.fillStyle)return this.masterShape.fillStyle;var e=this.archive.document.documentSettings.defaultFillStyle;return void 0===e&&j.log("defaultFillStyle undefined"),e},set:function(e){this._fillStyle=e}},{key:"lineStyle",get:function(){if(void 0!==this._lineStyle)return this._lineStyle;if(this.masterShape&&void 0!==this.masterShape.lineStyle)return this.masterShape.lineStyle;var e=this.archive.document.documentSettings.defaultLineStyle;return void 0===e&&j.log("defaultLineStyle undefined"),e},set:function(e){this._lineStyle=e}},{key:"isOneDimensional",value:function(){return this.cells.hasEvery([b.beginX,b.beginY,b.endX,b.endY])}},{key:"isPrintable",value:function(){return!this.cells.nonPrinting}},{key:"getConnect",value:function(){return this.pageContent.connects.get(this.id)||null}},{key:"toElementAttributes",value:function(e){var t,n=this.getPageOrigin();switch(this.type){case Qo.Group:t=function i(e,t,n){var t=1<arguments.length&&void 0!==t?t:{},r=t.origin,r=void 0===r?{x:0,y:0}:r,o=t.prefix,a=void 0===o?"group":o,o=t.isRoot,t=void 0!==o&&o,s=2<arguments.length&&void 0!==n?n:{};if(s.ignoreNonPrinting&&!e.isPrintable())return null;var o=e.cells,n=e.shapes,l=o.width,u=o.height,c=o.locPinX,h=o.locPinY,f=o.pinX,p=o.pinY,d=o.angle,g=o.flipX,o=o.flipY,e=Hf(e,{origin:{x:0,y:u},prefix:a,isRoot:t},s);if(!e)return null;var v=e.markup,t=[],y=v.findIndex(function(e){return e.text}),m=(-1<y&&t.push.apply(t,F(v.splice(y,1))),e.attrs),y={x:r.x+f-c,y:r.y-p+h-u},S=N.V.createSVGMatrix(),e=(d&&(S=S.translate(c,h).rotate(d).translate(-c,-h)),g&&(S=S.flipX().translate(-l,0)),o&&(S=S.flipY().translate(0,-u)),{width:l,height:u});return n.forEach(function(e,t){var n,r;!e||s.ignoreSubShapeConnects&&e.getConnect()||(t="".concat(a).concat(t),(e=("Group"===e.type?i:Hf)(e,{origin:{x:0,y:u},prefix:"".concat(t,"-")},s))&&(n=e.markup,r=e.position,e=e.attrs,v.push({tagName:"g",selector:t,children:n,attributes:{transform:N.V.matrixToTransformString(S.translate(r.x,r.y))}}),"root"in e&&(e[t]=e.root,delete e.root),N.util.assign(m,e)))}),{markup:[].concat(F(v),t),attrs:m,position:y,size:e}}(this,{origin:n,isRoot:!0},e);break;case Qo.Shape:case Qo.Foreign:t=Hf(this,{origin:n},e);break;default:return null}return t.z=this.getPageZIndex(),t}},{key:"toElement",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.importShape,t=void 0===t?Dh:t,n=e.ignoreNonPrinting,n=void 0===n||n,e=e.ignoreSubShapeConnects,e=void 0===e||e;return"function"!=typeof t||n&&!this.isPrintable()?null:t(this,{ignoreNonPrinting:n,ignoreSubShapeConnects:e})}}],[{key:"fromMaster",value:(n=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.archive,e.next=3,r.getJxonAsync(t.xmlPath);case 3:return o=e.sent,function t(e,n){if(!e)return;n?(e[zo.MasterId]=n.id.toString(),e[Oo]=n.nameU):e[zo.MasterShapeId]=e[zo.Id];e[Wo.Id]=N.util.uniqueId();e.Cell=Zf(e.Cell);e.Section=Qf(e.Section);e.Shapes&&(Array.isArray(e.Shapes.Shape)?e.Shapes.Shape.forEach(function(e){return t(e)}):t(e.Shapes.Shape))}(o=N.util.cloneDeep(o.Shapes.Shape),t),e.next=8,rf.call(r,o,S.Master,[]);case 8:return i=e.sent,e.next=11,n.getContent({overrideRels:!0});case 11:return o=e.sent,i.master=t,e.abrupt("return",new a(m({archive:r,pageContent:o},i)));case 14:case"end":return e.stop()}},e)})),function(e,t){return n.apply(this,arguments)})}]),a}();function Qf(e){return Array.isArray(e)?e.map(function(e){var t;return e.Cell=Zf(e.Cell),e.Row=(t=e.Row,Array.isArray(t)?t.map(function(e){return e.Cell=Zf(e.Cell),e}):void 0!==t?[t]:[]),e}):void 0!==e?[e]:[]}function Zf(e){return Array.isArray(e)?e.filter(function(e){return e[Do.Formula]&&-1===e[Do.Formula].indexOf("!")}):void 0!==e?[e]:[]}function $f(e){var t=e instanceof Array,n=(t||(e=[e]),document.createElement("div")),o=document.createElement("span"),a=(n.style.visibility="hidden",n.style.position="absolute",n.style.left="-9999px",n.style.top="0px",n.style.fontWeight="bold",n.style.fontSize="200px !important",o.appendChild(document.createTextNode("~iomwIOMW")),n.appendChild(o),document.body.appendChild(n),[]);return e.forEach(function(e,t){o.style.fontFamily="".concat(e,",").concat("monospace, monospace");var n=o.offsetWidth,r=o.offsetHeight,e=(o.style.fontFamily="".concat(e,",").concat("sans-serif"),o.offsetWidth),i=o.offsetHeight;a[t]=n==e&&r==i}),document.body.removeChild(n),a=t||1!=a.length?a:a[0]}function ep(e){if(void 0===e)return 0;var e=rn(e),t=un(e);if(e!==t)throw hp("Wrong length or index");return t}function tp(e){return[255&e]}function np(e){return[255&e,e>>8&255]}function rp(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function ip(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function op(e){return Vp(e,23,4)}function ap(e){return Vp(e,52,8)}function sp(e,t){mp(e[kp],t,{get:function(){return bp(this)[t]}})}function lp(e,t,n,r){if(n=ep(n),e=bp(e),n+t>e.byteLength)throw Lp(xp);var i=bp(e.buffer).bytes,n=n+e.byteOffset,e=qn(i,n,n+t);return r?e:Rp(e)}function up(e,t,n,r,i,o){if(n=ep(n),e=bp(e),n+t>e.byteLength)throw Lp(xp);for(var a=bp(e.buffer).bytes,s=n+e.byteOffset,l=r(+i),u=0;u<t;u++)a[s+u]=l[o?u:t-u-1]}var cp=function(){function t(e){l(this,t),e||j.log("VisioPageContent can only be created using an instance of a Page.",{page:e}),this.page=e,this.rootShapes=new Map,this.shapes=new Map,this.connects=new Map,this.foreignShapes=new Map,this.linkShapes=new Map,this.elementShapes=new Map}var n;return u(t,[{key:"loadAsync",value:(n=I(regeneratorRuntime.mark(function e(t){var n,r,i,o,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.page,e.next=3,n.archive.getJxonAsync(n.xmlPath);case 3:return r=e.sent,e.next=6,rf.call(n.archive,r,S.Page,[],{structurePathEnrichObject:{pageId:n.id}});case 6:return r=e.sent,i=r.shapes,i=void 0===i?[]:i,o=r.connects,o=void 0===o?[]:o,e.next=10,n.getRelsMapCachedAsync(t);case 10:return e.next=12,n.getMastersFromRelsAsync();case 12:o.forEach(function(e){e.referencePageContent(a),a.connects.set(e.shapeId,e)}),F(i.values()).forEach(function(e,t){t=new Kf(m({archive:n.archive,masters:n.archive.document.masters,pageContent:a,xmlOrder:t},e));a.rootShapes.set(e.id,t),t.getConnect()||a.elementShapes.set(e.id,t)}),this.connects.forEach(function(e){e=e.getShape();e&&a.linkShapes.set(e.id,e)});case 16:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"referenceShape",value:function(e){var t;this.shapes.set(e.id,e),e.foreignData&&this.setForeignShape(e.foreignData,e),e.masterShape&&e.masterShape.foreignData&&(t=e.masterShape,this.setForeignShape(t.foreignData,e,t)),this.referenceShapeInsideCellsDeep(e)}},{key:"setForeignShape",value:function(e,t,n){var r=e.targetFile.absolutePath;this.foreignShapes.has(r)||this.foreignShapes.set(r,[]),this.foreignShapes.get(r).push({foreignData:e,shape:t,master:n})}},{key:"referenceShapeInsideCellsDeep",value:function(t){var n=this;this.referenceShapeInsideCells(t._cells,t),t._sections.forEach(function(e){e.forEach(function(e){e&&e.rows&&e.rows.forEach(function(e){n.referenceShapeInsideCells(e.cells,t)})})})}},{key:"referenceShapeInsideCells",value:function(e,t){e&&(t instanceof Kf||j.log("shape must be instance of Shape"),(e.shape=t).masterShape&&(e.parent=t.masterShape))}},{key:"toGraphCells",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=e.importShape,n=void 0===t?Dh:t,t=e.importConnect,r=void 0===t?Eh:t,t=e.importLabels,i=void 0===t?Oh:t,t=e.importImage,o=void 0===t?Bh:t,t=e.ignoreNonPrinting,a=void 0===t||t,t=e.ignoreSubShapeConnects,s=void 0===t||t,t=e.onImagesLoad,l=void 0===t?null:t,u=new Map,c=new Map,h=new Map;this.getElementShapes().forEach(function(e){var t=e.toElement({importShape:n,ignoreNonPrinting:a,ignoreSubShapeConnects:s});t&&u.set(e.id,t)}),this.getLinkShapes().forEach(function(e){var t=e.getConnect().toLink(u,{importShape:n,importConnect:r,ignoreNonPrinting:a});t&&(c.set(e.id,t),t.isLink()&&(t=e.getConnect().toLinkLabels(t,{importLabels:i}))&&h.set(e.id,t))});e=this.getForeignShapes().map(function(e){return e.map(function(e){return e.shape})}).flat().map(function(r){return I(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=u.get(r.getRootShape().id)){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,r.getImage();case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return e.abrupt("return",o(r,t,n));case 9:case"end":return e.stop()}},e)}))});return Promise.all(e.map(function(e){return e()})).then(function(e){"function"==typeof l&&l(e.filter(function(e){return null!==e}))}),[].concat(F(u.values()),F(c.values()),F(h.values())).flat()}},{key:"getRootShapes",value:function(){return F(this.rootShapes.values())}},{key:"getRootShape",value:function(e){return this.rootShapes.get(e)||null}},{key:"getShapes",value:function(){return F(this.shapes.values())}},{key:"getShape",value:function(e){return this.shapes.get(e)||null}},{key:"getConnects",value:function(){return F(this.connects.values())}},{key:"getConnect",value:function(e){return this.connects.get(e)||null}},{key:"getForeignShapes",value:function(){return F(this.foreignShapes.values())}},{key:"getForeignShape",value:function(e){return this.foreignShapes.get(e)||null}},{key:"getLinkShapes",value:function(){return F(this.linkShapes.values())}},{key:"getElementShapes",value:function(){return F(this.elementShapes.values())}},{key:"getFonts",value:function(){var t=new Set;return this.shapes.forEach(function(e){var e=e.getComputedSection(G.Character);(e=e&&e.getRow(0))&&void 0!==(e=e.getCell(B.Font).value)&&"Themed"!==e&&!t.has(e)&&t.add(e)}),F(t.values())}},{key:"getUnsupportedFonts",value:function(){return this.getFonts().filter(function(e){return!$f(e)})}}]),t}(),Tu="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,hp=V.RangeError,fp=V.Array,pp=Math.abs,dp=Math.pow,gp=Math.floor,vp=Math.log,yp=Math.LN2,Ru=function(e,t,n){var r,i,o,a=fp(n),s=8*n-t-1,n=(1<<s)-1,l=n>>1,u=23===t?dp(2,-24)-dp(2,-77):0,c=e<0||0===e&&1/e<0?1:0,h=0;for((e=pp(e))!=e||e===1/0?(i=e!=e?1:0,r=n):(r=gp(vp(e)/yp),e*(o=dp(2,-r))<1&&(r--,o*=2),2<=(e+=1<=r+l?u/o:u*dp(2,1-l))*o&&(r++,o/=2),n<=r+l?(i=0,r=n):1<=r+l?(i=(e*o-1)*dp(2,t),r+=l):(i=e*dp(2,l-1)*dp(2,t),r=0));8<=t;)a[h++]=255&i,i/=256,t-=8;for(r=r<<t|i,s+=t;0<s;)a[h++]=255&r,r/=256,s-=8;return a[--h]|=128*c,a},t=function(e,t){var n,r=e.length,i=8*r-t-1,o=(1<<i)-1,a=o>>1,s=i-7,l=r-1,i=e[l--],u=127&i;for(i>>=7;0<s;)u=256*u+e[l--],s-=8;for(n=u&(1<<-s)-1,u>>=-s,s+=t;0<s;)n=256*n+e[l--],s-=8;if(0===u)u=1-a;else{if(u===o)return n?NaN:i?-1/0:1/0;n+=dp(2,t),u-=a}return(i?-1:1)*n*dp(2,u-t)},Lu=gn.f,mp=Yt.f,se=$t.PROPER,Sp=$t.CONFIGURABLE,bp=Qt.get,Cp=Qt.set,qs="ArrayBuffer",$l="DataView",kp="prototype",xp="Wrong index",wp=V[qs],Pp=wp,_p=Pp&&Pp[kp],wa=V[$l],Tp=wa&&wa[kp],ru=Object.prototype,Ap=V.Array,Lp=V.RangeError,Mp=y(Gf),Rp=y([].reverse),Vp=Ru,Ip=t;if(Tu){var Fp=se&&wp.name!==qs;if(v(function(){wp(1)})&&v(function(){new wp(-1)})&&!v(function(){return new wp,new wp(1.5),new wp(NaN),Fp&&!Sp}))Fp&&Sp&&zt(wp,"name",qs);else{(Pp=function(e){return As(this,_p),new wp(ep(e))})[kp]=_p;for(var Dp,Ep=Lu(wp),Op=0;Ep.length>Op;)(Dp=Ep[Op++])in Pp||zt(Pp,Dp,wp[Dp]);_p.constructor=Pp}cr&&as(Tp)!==ru&&cr(Tp,ru);var n=new wa(new Pp(2)),Np=y(Tp.setInt8);n.setInt8(0,2147483648),n.setInt8(1,2147483649),!n.getInt8(0)&&n.getInt8(1)||Zs(Tp,{setInt8:function(e,t){Np(this,e,t<<24>>24)},setUint8:function(e,t){Np(this,e,t<<24>>24)}},{unsafe:!0})}else _p=(Pp=function(e){As(this,_p);e=ep(e);Cp(this,{bytes:Mp(Ap(e),0),byteLength:e}),f||(this.byteLength=e)})[kp],Tp=(wa=function(e,t,n){As(this,Tp),As(e,_p);var r=bp(e).byteLength,t=rn(t);if(t<0||r<t)throw Lp("Wrong offset");if(r<t+(n=void 0===n?r-t:un(n)))throw Lp("Wrong length");Cp(this,{buffer:e,byteLength:n,byteOffset:t}),f||(this.buffer=e,this.byteLength=n,this.byteOffset=t)})[kp],f&&(sp(Pp,"byteLength"),sp(wa,"buffer"),sp(wa,"byteLength"),sp(wa,"byteOffset")),Zs(Tp,{getInt8:function(e){return lp(this,1,e)[0]<<24>>24},getUint8:function(e){return lp(this,1,e)[0]},getInt16:function(e){e=lp(this,2,e,1<arguments.length?arguments[1]:void 0);return(e[1]<<8|e[0])<<16>>16},getUint16:function(e){e=lp(this,2,e,1<arguments.length?arguments[1]:void 0);return e[1]<<8|e[0]},getInt32:function(e){return ip(lp(this,4,e,1<arguments.length?arguments[1]:void 0))},getUint32:function(e){return ip(lp(this,4,e,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(e){return Ip(lp(this,4,e,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(e){return Ip(lp(this,8,e,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(e,t){up(this,1,e,tp,t)},setUint8:function(e,t){up(this,1,e,tp,t)},setInt16:function(e,t){up(this,2,e,np,t,2<arguments.length?arguments[2]:void 0)},setUint16:function(e,t){up(this,2,e,np,t,2<arguments.length?arguments[2]:void 0)},setInt32:function(e,t){up(this,4,e,rp,t,2<arguments.length?arguments[2]:void 0)},setUint32:function(e,t){up(this,4,e,rp,t,2<arguments.length?arguments[2]:void 0)},setFloat32:function(e,t){up(this,4,e,op,t,2<arguments.length?arguments[2]:void 0)},setFloat64:function(e,t){up(this,8,e,ap,t,2<arguments.length?arguments[2]:void 0)}});cs(Pp,qs),cs(wa,$l);function Bp(e){return!!E(e)&&(e=Rn(e),O(nd,e)||O(rd,e))}var Gp,jp,Xp,Yp={ArrayBuffer:Pp,DataView:wa},ir="ArrayBuffer",Zl=Yp[ir],Ru=V[ir],zp=(R({global:!0,forced:Ru!==Zl},{ArrayBuffer:Zl}),$s(ir),Yp.ArrayBuffer),Up=Yp.DataView,t=Up.prototype,Wp=y(zp.prototype.slice),Hp=y(t.getUint8),Jp=y(t.setUint8),se=v(function(){return!new zp(2).slice(1,void 0).byteLength}),Lu=(R({target:"ArrayBuffer",proto:!0,unsafe:!0,forced:se},{slice:function(e,t){if(Wp&&void 0===t)return Wp(x(this),e);for(var n=x(this).byteLength,r=sn(e,n),i=sn(void 0===t?n:t,n),e=new(io(this,zp))(un(i-r)),o=new Up(this),a=new Up(e),s=0;r<i;)Jp(a,s++,Hp(o,r++));return e}}),Yt.f),ru=V.Int8Array,qp=ru&&ru.prototype,n=V.Uint8ClampedArray,qs=n&&n.prototype,Kp=ru&&as(ru),Qp=qp&&as(qp),$l=Object.prototype,Zp=V.TypeError,wa=c("toStringTag"),$p=ge("TYPED_ARRAY_TAG"),ed=ge("TYPED_ARRAY_CONSTRUCTOR"),td=Tu&&!!cr&&"Opera"!==Rn(V.opera),Ru=!1,nd={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},rd={BigInt64Array:8,BigUint64Array:8};for(Gp in nd)(Xp=(jp=V[Gp])&&jp.prototype)?zt(Xp,ed,jp):td=!1;for(Gp in rd)(Xp=(jp=V[Gp])&&jp.prototype)&&zt(Xp,ed,jp);if((!td||!k(Kp)||Kp===Function.prototype)&&(Kp=function(){throw Zp("Incorrect invocation")},td))for(Gp in nd)V[Gp]&&cr(V[Gp],Kp);if((!td||!Qp||Qp===$l)&&(Qp=Kp.prototype,td))for(Gp in nd)V[Gp]&&cr(V[Gp].prototype,Qp);if(td&&as(qs)!==Qp&&cr(qs,Qp),f&&!O(Qp,wa))for(Gp in Ru=!0,Lu(Qp,wa,{get:function(){return E(this)?this[$p]:void 0}}),nd)V[Gp]&&zt(V[Gp],$p,Gp);function id(e,t){if((e=function(e){e=rn(e);if(e<0)throw fd("The argument can't be less than 0");return e}(e))%t)throw pd("Wrong offset");return e}function od(e){var t,n,r,i,o,a,s=Wr(this),l=de(e),e=arguments.length,u=1<e?arguments[1]:void 0,c=void 0!==u,h=Gs(l);if(h&&!ws(h))for(a=(o=Ps(l,h)).next,l=[];!(i=D(a,o)).done;)l.push(i.value);for(c&&2<e&&(u=Ce(u,arguments[2])),n=cn(l),r=new(dd(s))(n),t=0;t<n;t++)r[t]=c?u(l[t],t):l[t];return r}function ad(e){return kd(io(e,e[Cd]))}function sd(e,t){for(var e=ad(e),n=t,r=0,i=cn(n),o=new e(i);r<i;)o[r]=n[r++];return o}function ld(){return Ed(Bd(this))}var X={NATIVE_ARRAY_BUFFER_VIEWS:td,TYPED_ARRAY_CONSTRUCTOR:ed,TYPED_ARRAY_TAG:Ru&&$p,aTypedArray:function(e){if(Bp(e))return e;throw Zp("Target is not a typed array")},aTypedArrayConstructor:function(e){if(!k(e)||cr&&!et(Kp,e))throw Zp(lt(e)+" is not a typed array constructor");return e},exportTypedArrayMethod:function(t,n,e,r){if(f){if(e)for(var i in nd){i=V[i];if(i&&O(i.prototype,t))try{delete i.prototype[t]}catch(e){try{i.prototype[t]=n}catch(e){}}}Qp[t]&&!e||en(Qp,t,!e&&td&&qp[t]||n,r)}},exportTypedArrayStaticMethod:function(e,t,n){var r,i;if(f){if(cr){if(n)for(r in nd)if((i=V[r])&&O(i,e))try{delete i[e]}catch(e){}if(Kp[e]&&!n)return;try{return en(Kp,e,!n&&td&&Kp[e]||t)}catch(e){}}for(r in nd)!(i=V[r])||i[e]&&!n||en(i,e,t)}},isView:function(e){if(!E(e))return!1;e=Rn(e);return"DataView"===e||O(nd,e)||O(rd,e)},isTypedArray:Bp,TypedArray:Kp,TypedArrayPrototype:Qp},ud=V.ArrayBuffer,cd=V.Int8Array,hd=!X.NATIVE_ARRAY_BUFFER_VIEWS||!v(function(){cd(1)})||!v(function(){new cd(-1)})||!Ks(function(e){new cd,new cd(null),new cd(1.5),new cd(e)},!0)||v(function(){return 1!==new cd(new ud(2),1,void 0).length}),fd=V.RangeError,pd=V.RangeError,dd=X.aTypedArrayConstructor,gd=(le(function(e){function p(e,t){s(e);for(var n=0,r=t.length,i=new e(r);n<r;)i[n]=t[n++];return i}function t(e,t){m(e,t,{get:function(){return v(this)[t]}})}function d(e){return et(a,e)||"ArrayBuffer"==(e=Rn(e))||"SharedArrayBuffer"==e}function r(e,t){return A(e)&&!at(t)&&t in e&&sr(+t)&&0<=t}function n(e,t){return t=ve(t),r(e,t)?Ye(2,e[t]):o(e,t)}function i(e,t,n){return t=ve(t),!(r(e,t)&&E(n)&&O(n,"value"))||O(n,"get")||O(n,"set")||n.configurable||O(n,"writable")&&!n.writable||O(n,"enumerable")&&!n.enumerable?m(e,t,n):(e[t]=n.value,e)}var l=gn.f,g=Xn.forEach,v=Qt.get,y=Qt.set,m=Yt.f,o=It.f,S=Math.round,b=V.RangeError,C=Yp.ArrayBuffer,a=C.prototype,k=Yp.DataView,x=X.NATIVE_ARRAY_BUFFER_VIEWS,w=X.TYPED_ARRAY_CONSTRUCTOR,P=X.TYPED_ARRAY_TAG,_=X.TypedArray,T=X.TypedArrayPrototype,s=X.aTypedArrayConstructor,A=X.isTypedArray,L="BYTES_PER_ELEMENT",M="Wrong length";f?(x||(It.f=n,Yt.f=i,t(T,"buffer"),t(T,"byteOffset"),t(T,"byteLength"),t(T,"length")),R({target:"Object",stat:!0,forced:!x},{getOwnPropertyDescriptor:n,defineProperty:i}),e.exports=function(e,t,i){function u(e,r){m(e,r,{get:function(){var e=this,t=r;return(e=v(e)).view[o](t*c+e.byteOffset,!0)},set:function(e){var t=this,n=r;t=v(t),i&&(e=(e=S(e))<0?0:255<e?255:255&e),t.view[a](n*c+t.byteOffset,e,!0)},enumerable:!0})}var c=e.match(/\d+$/)[0]/8,n=e+(i?"Clamped":"")+"Array",o="get"+e,a="set"+e,s=V[n],h=s,f=h&&h.prototype,e={};x?hd&&(h=t(function(e,t,n,r){return As(e,f),hr(E(t)?d(t)?void 0!==r?new s(t,id(n,c),r):void 0!==n?new s(t,id(n,c)):new s(t):A(t)?p(h,t):D(od,h,t):new s(ep(t)),e,h)}),cr&&cr(h,_),g(l(s),function(e){e in h||zt(h,e,s[e])}),h.prototype=f):(h=t(function(e,t,n,r){As(e,f);var i,o,a=0,s=0;if(E(t)){if(!d(t))return A(t)?p(h,t):D(od,h,t);var l=t,s=id(n,c),n=t.byteLength;if(void 0===r){if(n%c)throw b(M);if((i=n-s)<0)throw b(M)}else if(n<(i=un(r)*c)+s)throw b(M);o=i/c}else o=ep(t),l=new C(i=o*c);for(y(e,{buffer:l,byteOffset:s,byteLength:i,length:o,view:new k(l)});a<o;)u(e,a++)}),cr&&cr(h,_),f=h.prototype=li(T)),f.constructor!==h&&zt(f,"constructor",h),zt(f,w,h),P&&zt(f,P,n),e[n]=h,R({global:!0,forced:h!=s,sham:!x},e),L in h||zt(h,L,c),L in f||zt(f,L,c),$s(n)}):e.exports=function(){}})("Uint8",function(r){return function(e,t,n){return r(this,e,t,n)}}),Math.min),vd=y([].copyWithin||function(e,t){var n=de(this),r=cn(n),i=sn(e,r),o=sn(t,r),e=2<arguments.length?arguments[2]:void 0,a=gd((void 0===e?r:sn(e,r))-o,r-i),s=1;for(o<i&&i<o+a&&(s=-1,o+=a-1,i+=a-1);0<a--;)o in n?n[i]=n[o]:delete n[i],i+=s,o+=s;return n}),yd=X.aTypedArray,md=((0,X.exportTypedArrayMethod)("copyWithin",function(e,t){return vd(yd(this),e,t,2<arguments.length?arguments[2]:void 0)}),Xn.every),Sd=X.aTypedArray,bd=((0,X.exportTypedArrayMethod)("every",function(e){return md(Sd(this),e,1<arguments.length?arguments[1]:void 0)}),X.aTypedArray),Cd=((0,X.exportTypedArrayMethod)("fill",function(e){var t=arguments.length;return D(Gf,bd(this),e,1<t?arguments[1]:void 0,2<t?arguments[2]:void 0)}),X.TYPED_ARRAY_CONSTRUCTOR),kd=X.aTypedArrayConstructor,xd=Xn.filter,wd=X.aTypedArray,Pd=((0,X.exportTypedArrayMethod)("filter",function(e){e=xd(wd(this),e,1<arguments.length?arguments[1]:void 0);return sd(this,e)}),Xn.find),_d=X.aTypedArray,Td=((0,X.exportTypedArrayMethod)("find",function(e){return Pd(_d(this),e,1<arguments.length?arguments[1]:void 0)}),Xn.findIndex),Ad=X.aTypedArray,Ld=((0,X.exportTypedArrayMethod)("findIndex",function(e){return Td(Ad(this),e,1<arguments.length?arguments[1]:void 0)}),Xn.forEach),Md=X.aTypedArray,Rd=((0,X.exportTypedArrayMethod)("forEach",function(e){Ld(Md(this),e,1<arguments.length?arguments[1]:void 0)}),Zt.includes),Vd=X.aTypedArray,Id=((0,X.exportTypedArrayMethod)("includes",function(e){return Rd(Vd(this),e,1<arguments.length?arguments[1]:void 0)}),Zt.indexOf),Fd=X.aTypedArray,Dd=((0,X.exportTypedArrayMethod)("indexOf",function(e){return Id(Fd(this),e,1<arguments.length?arguments[1]:void 0)}),c("iterator")),Zl=V.Uint8Array,Ed=y(xs.values),Od=y(xs.keys),Nd=y(xs.entries),Bd=X.aTypedArray,ir=X.exportTypedArrayMethod,Gd=Zl&&Zl.prototype,t=!v(function(){Gd[Dd].call([1])}),se=!!Gd&&Gd.values&&Gd[Dd]===Gd.values&&"values"===Gd.values.name,jd=(ir("entries",function(){return Nd(Bd(this))},t),ir("keys",function(){return Od(Bd(this))},t),ir("values",ld,t||!se,{name:"values"}),ir(Dd,ld,t||!se,{name:"values"}),X.aTypedArray),n=X.exportTypedArrayMethod,Xd=y([].join),Yd=(n("join",function(e){return Xd(jd(this),e)}),Math.min),zd=[].lastIndexOf,Ud=!!zd&&1/[1].lastIndexOf(1,-0)<0,ru=Le("lastIndexOf"),Wd=Ud||!ru?function(e){if(Ud)return $i(zd,this,arguments)||0;var t=he(this),n=cn(t),r=n-1;for((r=1<arguments.length?Yd(r,rn(arguments[1])):r)<0&&(r=n+r);0<=r;r--)if(r in t&&t[r]===e)return r||0;return-1}:zd,Hd=X.aTypedArray,Jd=((0,X.exportTypedArrayMethod)("lastIndexOf",function(e){var t=arguments.length;return $i(Wd,Hd(this),1<t?[e,arguments[1]]:[e])}),Xn.map),qd=X.aTypedArray,Kd=((0,X.exportTypedArrayMethod)("map",function(e){return Jd(qd(this),e,1<arguments.length?arguments[1]:void 0,function(e,t){return new(ad(e))(t)})}),e.left),Qd=X.aTypedArray,Zd=((0,X.exportTypedArrayMethod)("reduce",function(e){var t=arguments.length;return Kd(Qd(this),e,t,1<t?arguments[1]:void 0)}),e.right),$d=X.aTypedArray,eg=((0,X.exportTypedArrayMethod)("reduceRight",function(e){var t=arguments.length;return Zd($d(this),e,t,1<t?arguments[1]:void 0)}),X.aTypedArray),Tu=X.exportTypedArrayMethod,tg=Math.floor,ng=(Tu("reverse",function(){for(var e,t=eg(this).length,n=tg(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this}),V.RangeError),rg=V.Int8Array,$l=rg&&rg.prototype,ig=$l&&$l.set,og=X.aTypedArray,qs=X.exportTypedArrayMethod,ag=!v(function(){var e=new Uint8ClampedArray(2);return D(ig,e,{length:1,0:3},1),3!==e[1]}),Lu=ag&&X.NATIVE_ARRAY_BUFFER_VIEWS&&v(function(){var e=new rg(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}),sg=(qs("set",function(e){og(this);var t=id(1<arguments.length?arguments[1]:void 0,1),n=de(e);if(ag)return D(ig,this,n,t);var e=this.length,r=cn(n),i=0;if(e<r+t)throw ng("Wrong length");for(;i<r;)this[t+i]=n[i++]},!ag||Lu),X.aTypedArray),lg=((0,X.exportTypedArrayMethod)("slice",function(e,t){for(var n=Mi(sg(this),e,t),e=ad(this),r=0,i=n.length,o=new e(i);r<i;)o[r]=n[r++];return o},v(function(){new Int8Array(1).slice()})),Xn.some),ug=X.aTypedArray,cg=((0,X.exportTypedArrayMethod)("some",function(e){return lg(ug(this),e,1<arguments.length?arguments[1]:void 0)}),V.Array),hg=X.aTypedArray,wa=X.exportTypedArrayMethod,fg=V.Uint16Array,pg=fg&&y(fg.prototype.sort),Ru=!(!pg||v(function(){pg(new fg(2),null)})&&v(function(){pg(new fg(2),{})})),dg=!!pg&&!v(function(){if(nt)return nt<74;if(Zn)return Zn<67;if($n)return 1;if(er)return er<602;for(var e,t=new fg(516),n=cg(516),r=0;r<516;r++)e=r%4,t[r]=515-r,n[r]=r-2*e+3;for(pg(t,function(e,t){return(e/4|0)-(t/4|0)}),r=0;r<516;r++)if(t[r]!==n[r])return 1}),gg=(wa("sort",function(e){return void 0!==e&&ct(e),dg?pg(this,e):Qn(hg(this),(n=e,function(e,t){return void 0!==n?+n(e,t)||0:t!=t?-1:e!=e?1:0===e&&0===t?0<1/e&&1/t<0?1:-1:t<e}));var n},!dg||Ru),X.aTypedArray),vg=((0,X.exportTypedArrayMethod)("subarray",function(e,t){var n=gg(this),r=n.length,e=sn(e,r);return new(ad(n))(n.buffer,n.byteOffset+e*n.BYTES_PER_ELEMENT,un((void 0===t?r:sn(t,r))-e))}),V.Int8Array),yg=X.aTypedArray,Zt=X.exportTypedArrayMethod,mg=[].toLocaleString,Sg=!!vg&&v(function(){mg.call(new vg(1))}),Zl=(Zt("toLocaleString",function(){return $i(mg,Sg?Mi(yg(this)):yg(this),Mi(arguments))},v(function(){return[1,2].toLocaleString()!=new vg([1,2]).toLocaleString()})||!v(function(){vg.prototype.toLocaleString.call([1,2])})),X.exportTypedArrayMethod),ir=V.Uint8Array,t=ir&&ir.prototype||{},bg=[].toString,Cg=y([].join),se=(v(function(){bg.call({})})&&(bg=function(){return Cg(this)}),t.toString!=bg),kg=(Zl("toString",bg,se),function(){function t(e){l(this,t),this._zipApi=e,this._index=Object.entries(this._zipApi.files).reduce(function(e,t){var t=Q(t,2),n=t[0],t=t[1];return e.set(n,t)},new Map),this.cache={jxons:new Map,images:new Map}}var n,r;return u(t,[{key:"getFileReference",value:function(e){return this._index.get(e)}},{key:"getJxonAsync",value:(r=I(regeneratorRuntime.mark(function e(n){var r,i,o,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.cache.jxons.get(n))return j.log("used cached copy of JXON: "+"%c".concat(n," "),"color: orange;"),e.abrupt("return",o);e.next=4;break;case 4:if(r=(new Date).getTime(),(t=n)&&/(\.xml|\.rels)$/.test(t)||j.log("Can't convert to JXON (file extension doesn't match)",t),i=this.getFileReference(n)){e.next=9;break}return e.abrupt("return",null);case 9:return e.next=11,i.async("string");case 11:return o=e.sent,t=o,a=new $h((new DOMParser).parseFromString(t,"application/xml").documentElement,[zo.Text]),this.cache.jxons.set(n,a),j.log("read XML and parse to JXON took: "+"".concat((new Date).getTime()-r,"ms %c").concat(n," "),"color: orange;"),e.abrupt("return",a);case 16:case"end":return e.stop()}var t},e,this)})),function(e){return r.apply(this,arguments)})},{key:"getImageAsync",value:(n=I(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.cache.images.get(t))return j.log("used cached copy of image: "+"%c".concat(t," "),"color: orange;"),e.abrupt("return",i);e.next=4;break;case 4:if(n=(new Date).getTime(),r=this.getFileReference(t)){e.next=8;break}return e.abrupt("return",null);case 8:return e.next=10,r.async("base64");case 10:return i=e.sent,o=/([^/]+\.(jpeg|png|[a-zA-Z]*))$/,o=t.match(o),o=Q(o,3),s=o[1],o=o[2],a="data:image/".concat(o,";base64,")+i,s={absolutePath:t,file:s,extension:o,base64:a},this.cache.images.set(t,s),j.log("read image and encode to base64 took: "+"".concat((new Date).getTime()-n,"ms %c").concat(t," "),"color: orange;"),e.abrupt("return",s);case 18:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})}]),t}());function xg(e){var t=e.relationshipOrArrayOfJxons,o=e.basePath,e=Ja(t);return e.forEach(function(e){}),e.reduce(function(e,t){var n=t[No.Type];if(!Go.hasOwnProperty(n))return j.log('Unknown Relation Type "'.concat(n,'"'),{relationshipJxon:t}),e;var r=t[No.Target],i=function(e,t,n){for(var t="/"===t?e:t.match({0:/^(.*\/)[^/]?/,1:/^(.*\/)(.*\/)[^/]+$/,2:/^(.*\/)(.*\/)(.*\/)[^/]+$/}[2<arguments.length&&void 0!==n?n:0])[1]+e,r=t.split("/"),i=r.length-1;0<=i;i--)".."===r[i]&&(r.splice(i-1,2),i--);return r.join("/")}(r,o),t=yh(t[No.Id]),n=Go[n],r={id:t,targetFile:{relativePath:r,absolutePath:i},debugType:n};return e.has(n)||e.set(n,new Map),e.get(n).set(t,r),e},new Map)}function wg(e,t){e=e.get(t);return e?function(e){1!==e.size&&j.log("Is not single record JXON",{singleRecordRelationMap:e});return e.values().next().value}(e).targetFile.absolutePath:null}function Pg(){return _g.apply(this,arguments)}function _g(){return(_g=I(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("_rels/.rels");case 2:return t=e.sent,e.abrupt("return",xg({relationshipOrArrayOfJxons:t.Relationship,basePath:"/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}function Tg(){return Ag.apply(this,arguments)}function Ag(){return(Ag=I(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getJxonAsync("visio/_rels/document.xml.rels");case 2:return t=e.sent,e.abrupt("return",xg({relationshipOrArrayOfJxons:t.Relationship,basePath:"visio/"}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}R({target:"Object",stat:!0},{fromEntries:function(e){var n={};return Ts(e,function(e,t){Wn(n,e,t)},{AS_ENTRIES:!0}),n}});var Lg=function(){z(r,Sl);var t,e,n=q(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return l(this,r),t.add(b.rels),t.add(b.xmlPath),n.call(this,e,t)}return u(r,[{key:"getDefaultAttributes",value:function(){return m(m({},K(U(r.prototype),"getDefaultAttributes",this).call(this)),{},{rels:null,xmlPath:null})}},{key:"getRelsMapCachedAsync",value:(e=I(regeneratorRuntime.mark(function e(){var t,n=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<n.length&&void 0!==n[0]?n[0]:{},this.xmlPath||j.log("no xml path"),this.rels)return e.abrupt("return",this.rels);e.next=4;break;case 4:return e.next=6,this.getRelsMapAsync.call(this.archive,this.xmlPath,t);case 6:return this.rels=e.sent,e.abrupt("return",this.rels);case 8:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"getRelsMapAsync",value:(t=I(regeneratorRuntime.mark(function e(t){var n,r,i,o=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(1<o.length&&void 0!==o[1]?o[1]:{}).overrideRels,n=t.replace(A(/^(.*?)([^/]*?)$/,{basePath:1,filename:2}),"$<basePath>_rels/$<filename>.rels"),!i){e.next=11;break}if((i=this.document)&&i.masters&&i.masters.map){e.next=7;break}return e.abrupt("return",null);case 7:r={"@xmlns":Fo.Relationships,Relationship:[]},i.masters.map.forEach(function(e,t){r.Relationship.push({"@Id":"rId".concat(t+1),"@Type":Fo.VisioMasterRelationship,"@Target":e._xmlPath.replace("visio","..")})}),e.next=14;break;case 11:return e.next=13,this.getJxonAsync(n);case 13:r=e.sent;case 14:if(r){e.next=16;break}return e.abrupt("return",null);case 16:return e.abrupt("return",xg({relationshipOrArrayOfJxons:r.Relationship,basePath:t}));case 17:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"rels",get:function(){return this._rels},set:function(e){this._rels=e}},{key:"xmlPath",get:function(){return this._xmlPath},set:function(e){this._xmlPath=e}}]),r}(),Mg=function(){z(n,Lg);var t=q(n);function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l(this,n),t.call(this,e,new Set([b.colors,b.relations,b.pages]))}return u(n,[{key:"getDefaultAttributes",value:function(){return m(m({},K(U(n.prototype),"getDefaultAttributes",this).call(this)),{},{_colors:null,_relations:null,_pages:null,documentSettings:null,faceNames:null,styleSheets:null,documentSheet:null,languageDependent:!0,masterShapesMap:new Map})}},{key:"getMasters",value:function(){return F(this.masters.map.values())}},{key:"getMastersIdMap",value:function(){return Object.fromEntries(this.masters.map)}},{key:"getMastersNameMap",value:function(){return this.getMasters().reduce(function(e,t){return e[t.name]=t,e},{})}},{key:"getPages",value:function(){return this.pages.toArray()}},{key:"getPage",value:function(e){return this.pages.get(e)}},{key:"name",get:function(){var e=this.documentSheet;return this.languageDependent?e.name:e.nameU}},{key:"colors",get:function(){return this._colors},set:function(e){this._colors=e}},{key:"pages",get:function(){return this._pages},set:function(e){this._pages=e}},{key:"documentSettings",get:function(){return this._documentSettings},set:function(e){this._documentSettings=e}},{key:"faceNames",set:function(e){this._faceNames=e}},{key:"styleSheets",get:function(){return this._styleSheets},set:function(e){this._styleSheets=e}},{key:"documentSheet",get:function(){return this._documentSheet},set:function(e){this._documentSheet=e}}]),n}(),Rg=function(){z(r,Lg);var t=q(r);function r(e){var n;return l(this,r),n=t.call(this,e,new Set([b.pages])),Object.entries(e).forEach(function(e){var e=Q(e,2),t=e[0],e=e[1],t="_".concat(t);return n[t]=e}),n}return u(r,[{key:"getDefaultAttributes",value:function(){return m(m({},K(U(r.prototype),"getDefaultAttributes",this).call(this)),{},{pages:new Map})}},{key:"get",value:function(e){return this._pages.get(e)||null}},{key:"add",value:function(e){var t=this._pages.size;e.index=t,this._pages.set(e.id,e)}},{key:"toArray",value:function(){return F(this._pages.values())}}]),r}();function Vg(){return(Vg=I(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,t){var n=new Image;n.onload=function(){e(n)},n.onerror=function(){t("Could not load image with given URL.",r)},n.src=r}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ig(e){if("none"===e||"transparent"===e)return e;var t=document.createElement("canvas").getContext("2d");return t.fillStyle=e,t.fillStyle}R({target:"Number",stat:!0,forced:Number.parseInt!=ze},{parseInt:ze}),R({global:!0,forced:parseFloat!=tt},{parseFloat:tt});var Fg=/^rgba\(.*,(.+)\)/;function Dg(e){if("string"!=typeof e)return!1;if("transparent"===e)return!0;e=Fg.exec(e);if(!e)return!1;e=Q(e,2)[1];return 0===parseFloat(e)}function Eg(e,r){var i=[];return e.segments.forEach(function(e){var t,n=[N.V.transformPoint(e.end,r)];switch(e.type){case"M":t="MoveTo";break;case"L":case"Z":t="LineTo";break;case"C":t="LineTo",(n=e.toPoints()).forEach(function(e,t){n[t]=N.V.transformPoint(e,r)})}n.forEach(function(e){i.push({"@IX":(i.length+1).toString(),"@T":t,Cell:[{"@N":B.X,"@V":(e.x/96).toString()},{"@N":B.Y,"@V":(e.y/96).toString()}]})})}),i}var Og={G:!0,TITLE:!0,TSPAN:!0,TEXTPATH:!0};function Ng(){return Bg.apply(this,arguments)}function Bg(){return(Bg=I(regeneratorRuntime.mark(function e(c,h,f,p,d){var g;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("TEXT"!==(g=c.tagName())){e.next=5;break}a=h,u=l=s=void 0,u=(o=c).node,0!==(u=Array.from(u.childNodes).map(function(e){return e.textContent}).join("\n")).length&&(a.Text={cp:{"@IX":"0","@textPlaceholder":u}},u={"@N":G.Character,Row:[{"@IX":"0",Cell:[]}]},s=u.Row[0].Cell,(l=o.attr("font-size"))&&s.push({"@N":B.Size,"@V":(l/96).toString()}),(l=o.attr("font-family"))&&s.push({"@N":B.Font,"@V":l}),(l=o.attr("fill"))&&"transparent"!==l&&s.push({"@N":B.Color,"@V":Ig(l)}),a.Section.push(u),a.Cell.push({"@N":B.LeftMargin,"@V":"0"},{"@N":B.RightMargin,"@V":"0"},{"@N":B.TopMargin,"@V":"0"},{"@N":B.BottomMargin,"@V":"0"})),e.next=11;break;case 5:if("IMAGE"===g)return e.next=8,function(){return jg.apply(this,arguments)}(c,h,d);e.next=10;break;case 8:e.next=11;break;case 10:g in Og||(i=n=a=u=l=s=o=void 0,o=c,s=h,u=p,l=(a=f).model,n=o.node,l=(i=l.isElement()&&a.el===n)?new N.g.Rect(l.attributes.size):a.getNodeBoundingRect(n),a=u.scaleX,n=u.scaleY,u=N.V.createSVGMatrix().scale(a,n).translate(0,l.height).flipY(),i||(u=u.translate(-l.x,-l.y)),a=N.V.normalizePathData(o.convertToPathData()),n=new N.g.Path(a),i={"@IX":1..toString(),"@N":G.Geometry,Cell:[],Row:Eg(n,u)},r=t=n=void 0,t=o,r=i,n=(t=window.getComputedStyle(t.node)).stroke,t=t.fill,r=r.Cell,t&&r.push({"@N":"NoFill","@V":"none"===t?"1":"0"}),n&&r.push({"@N":"NoLine","@V":"0"}),s.Section.push(i));case 11:n=t=i=r=t=n=t=void 0;var t=c,n=h,r=(t=window.getComputedStyle(t.node)).stroke,i=t.fill,t=t.strokeWidth,n=n.Cell;return"none"===i||i===Dg(i)?n.push({"@N":"FillForegndTrans","@V":"1"}):n.push({"@N":"FillForegnd","@V":Ig(i)}),"none"===r||Dg(r)?n.push({"@N":"LineColorTrans","@V":"1"}):n.push({"@N":"LineColor","@V":Ig(r)}),t&&n.push({"@N":"LineWeight","@V":String(parseFloat(t)/96)}),e.abrupt("return",h);case 13:case"end":return e.stop()}var o,a,s,l,u},e)}))).apply(this,arguments)}function Gg(e){var e=e.node.getBoundingClientRect(),t=e.width,e=e.height;return 0!==t||0!==e}function jg(){return(jg=I(regeneratorRuntime.mark(function e(t,n,r){var i,o,a,s,l,u,c,h,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.attr("xlink:href")||t.attr("href")){e.next=3;break}return e.abrupt("return");case 3:return o=i,a="png",e.next=7,function(){return Vg.apply(this,arguments)}(i);case 7:s=e.sent,(l=document.createElement("canvas")).width=s.width,l.height=s.height,l.getContext("2d").drawImage(s,0,0,s.width,s.height),e.prev=13,o=l.toDataURL("image/png"),e.next=25;break;case 17:if(e.prev=17,e.t0=e.catch(13),j.log("Can not convert an image (".concat(i,") to data URI:"),e.t0),/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/.test(i)){e.next=23;break}return e.abrupt("return",n);case 23:"image/svg+xml"===i.split(",")[0].split(":")[1].split(";")[0]&&(a="svg");case 25:l=r.jxon.Relationship.length+1,u="image".concat(l,".").concat(a),n.ForeignData={"@ForeignType":"Bitmap","@CompressionType":a.toUpperCase(),Rel:{"@r:id":"rId".concat(l.toString())}},n["@Type"]=Qo.Foreign,c=t.getBBox(),"none"!==t.attr("preserveAspectRatio")&&(f=c.width/s.width,h=c.height/s.height,f=f<=h?f:h,h=s.width*f,f=s.height*f,c=new N.g.Rect({x:(c.width-h)/2,y:(c.height-f)/2,width:h,height:f})),n.Cell.push({"@N":B.ImgOffsetX,"@V":(c.x/96).toString()},{"@N":B.ImgOffsetY,"@V":(c.y/96).toString()},{"@N":B.ImgWidth,"@V":(c.width/96).toString()},{"@N":B.ImgHeight,"@V":(c.height/96).toString()}),r.jxon.Relationship.push({"@Id":"rId".concat(l),"@Type":Fo.DocumentImageRelationships,"@Target":"../media/".concat(u)}),r.data.push({name:u,url:o});case 34:case"end":return e.stop()}},e,null,[[13,17]])}))).apply(this,arguments)}function Xg(){return(Xg=I(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.children();case 1:if(0<r.length)return i=r.shift(),e.next=5,n(i);e.next=9;break;case 5:if(!e.sent){e.next=7;break}r.unshift.apply(r,F(i.children()));case 7:e.next=1;break;case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Yg(){return(Yg=I(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Gg(t.vel)){e.next=2;break}return e.abrupt("return",null);case 2:if(t.model.isLink())return e.next=6,function(){return Ug.apply(this,arguments)}(t,n);e.next=9;break;case 6:return e.abrupt("return",e.sent);case 9:return e.next=11,function(){return zg.apply(this,arguments)}(t,n);case 11:return e.abrupt("return",e.sent);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function zg(){return(zg=I(regeneratorRuntime.mark(function e(t,n){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.model,r=o.getBBox(),i=r.center(),o=t.rotatableNode?0:o.angle(),o=N.V.createSVGMatrix().rotate(o),e.abrupt("return",Wg(t,n,r,o,i));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Ug(){return(Ug=I(regeneratorRuntime.mark(function e(t,n){var r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.getConnection().bbox(),i=N.V.createSVGMatrix().translate(-r.x,-r.y),e.abrupt("return",Wg(t,n,r,i));case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Wg(){return Hg.apply(this,arguments)}function Hg(){return(Hg=I(regeneratorRuntime.mark(function e(c,h,t,n,r){var i,o,a,s,f,p,d;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.paper,i=c.vel,s=s.getArea(),o=N.V.decomposeMatrix(n),s=Kg(i,t,s,{transformation:o,origin:r}),e.next=6,Ng(i,s,c,o,h);case 6:return a=e.sent,s=i.id,f=g({},s,a),p=g({},s,t),d={},e.next=13,function(){return Xg.apply(this,arguments)}(i,function(){var t=I(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(Gg(t)){e.next=2;break}return e.abrupt("return",!1);case 2:if(n=t.node,r=N.V.ensureId(t),a=n.parentNode,s=a.id,i=p[s],o=f[s],s=d[s],a=t.getTransformToElement(a),s&&(a=s.multiply(a)),s=0===t.children().length,"G"!==t.tagName()){e.next=20;break}if(s)return e.abrupt("return",!1);e.next=16;break;case 16:return p[r]=i,f[r]=o,d[r]=a,e.abrupt("return",!0);case 20:return u=p[n.id]=c.getNodeBoundingRect(n),l=N.V.decomposeMatrix(a),u=Kg(t,u,i,{transformation:l}),e.next=25,Ng(t,u,c,l,h);case 25:return o.Shapes.Shape.push(u),s||(f[r]=u),e.abrupt("return",s);case 28:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}());case 13:return e.abrupt("return",a);case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jg(e){var t=e.model,n=e.paper;if(!t.isLink())throw new Error("Can not export dia.Element as a connection.");if(!Gg(e.vel))return null;t=e.getConnection();if(!t)return null;n.getArea();var r,i,n=t.bbox(),e=(r=n,i=(e=e).vel,a=e.sourcePoint,o=e.targetPoint,e=e.paper,i=qg(i),e=e.getArea().height,(a=new N.g.Point(a)).y=e-a.y,(o=new N.g.Point(o)).y=e-o.y,i.Cell.unshift({"@N":B.BeginX,"@V":"".concat(a.x/96),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":B.BeginY,"@V":"".concat(a.y/96),"@F":"_WALKGLUE(BegTrigger,EndTrigger,WalkPreference)"},{"@N":B.EndX,"@V":"".concat(o.x/96),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":B.EndY,"@V":"".concat(o.y/96),"@F":"_WALKGLUE(EndTrigger,BegTrigger,WalkPreference)"},{"@N":B.Width,"@V":"".concat(Ia(o.x-a.x)),"@F":"GUARD(EndX-BeginX)"},{"@N":B.Height,"@V":"".concat(r.height/96),"@F":"GUARD(".concat(r.height/96,")")},{"@N":B.Angle,"@V":"0","@F":"GUARD(0 deg)"},{"@N":B.PinX,"@V":"".concat((a.x+o.x)/2/96),"@F":"GUARD((BeginX+EndX)/2))"},{"@N":B.PinY,"@V":"".concat((a.y+o.y)/2/96),"@F":"GUARD((BeginY+EndY)/2)"},{"@N":B.LocPinX,"@V":"".concat((o.x-a.x)/2/96),"@F":"GUARD(Width*0.5)"},{"@N":B.LocPinY,"@V":"".concat(r.height/2/96),"@F":"GUARD(Height*0.5)"},{"@N":B.FlipX,"@V":"0","@F":"GUARD(FALSE)"},{"@N":B.FlipY,"@V":"0","@F":"GUARD(FALSE)"}),i),o=N.V.createSVGMatrix().translate(0,n.height).flipY().translate(-n.x,-n.y),a={"@IX":"0","@N":G.Geometry,Cell:[{"@N":B.NoFill,"@V":"1"},{"@N":B.NoLine,"@V":"0"},{"@N":B.NoShow,"@V":"0"},{"@N":B.NoSnap,"@V":"0"},{"@N":B.NoQuickDrag,"@V":"0"}],Row:Eg(t,o)};return e.Section.push(a),e}function qg(e){e="G"===e.tagName()?Qo.Group:Qo.Shape;return{"@ID":N.util.uniqueId(),"@LineStyle":"3","@Type":e,Cell:[{"@N":B.ResizeMode,"@V":"0"}],Section:[],Shapes:{Shape:[]}}}function Kg(e,t,n,r){var i=r.transformation,i=void 0===i?{}:i,r=r.origin,r=void 0===r?new N.g.Point(0,0):r,o=i.translateX,o=void 0===o?0:o,a=i.translateY,a=void 0===a?0:a,s=i.rotation,s=void 0===s?0:s,l=i.scaleX,l=void 0===l?1:l,i=i.scaleY,i=void 0===i?1:i,u=t.width,c=t.height,t=t.center(),l=(1===l&&1===i||(t.scale(l,i),u*=l,c*=i),0!==s&&t.rotate(r,-s),new N.g.Point(u/2,c/2)),i=new N.g.Point(o+t.x,n.height-(t.y+a)),r=qg(e);return r.Cell.unshift({"@N":B.PinX,"@V":"".concat(i.x/96)},{"@N":B.PinY,"@V":"".concat(i.y/96)},{"@N":B.Width,"@V":"".concat(u/96)},{"@N":B.Height,"@V":"".concat(c/96)},{"@N":B.LocPinX,"@V":"".concat(l.x/96)},{"@N":B.LocPinY,"@V":"".concat(l.y/96)},{"@N":B.Angle,"@V":"".concat(N.g.toRad(-s))}),r}function Qg(){return(Qg=I(regeneratorRuntime.mark(function e(o,a,s,l,u,c){var h,f,p,d,g,v,y,m,S,b,C,k,x,w,P,_,T,A,L,M,R,V;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:h=o.model,f=new Map,m=h.getElements(),p="function"==typeof u,d={fromConnection:function(){var t=I(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",nv(t,f));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}(),fromNodes:function(){var t=I(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$g(t,l));case 1:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()},v=g=!1,e.prev=7,m=Y(m);case 9:return e.next=11,m.next();case 11:if(!(g=!(S=e.sent).done)){e.next=30;break}if(S=S.value,b=S.findView(o),C=void 0,p)return e.next=18,function(){return Zg.apply(this,arguments)}(b,s,u,d);e.next=21;break;case 18:C=e.sent,e.next=24;break;case 21:return e.next=23,$g(b,l);case 23:C=e.sent;case 24:if(C){e.next=26;break}return e.abrupt("continue",27);case 26:f.set(S.id,C);case 27:g=!1,e.next=9;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(7),v=!0,y=e.t0;case 36:if(e.prev=36,e.prev=37,g&&null!=m.return)return e.next=41,m.return();e.next=41;break;case 41:if(e.prev=41,v)throw y;e.next=44;break;case 44:return e.finish(41);case 45:return e.finish(36);case 46:k=[],x=[],A=h.getLinks(),w="function"==typeof c,_=P=!1,e.prev=52,A=Y(A);case 54:return e.next=56,A.next();case 56:if(!(P=!(L=e.sent).done)){e.next=75;break}if(L=L.value,M=L.findView(o),R=void 0,w)return e.next=63,function(){return tv.apply(this,arguments)}(M,s,c,d);e.next=66;break;case 63:R=e.sent,e.next=67;break;case 66:R=nv(M,f);case 67:if(R){e.next=69;break}return e.abrupt("continue",72);case 69:t=L,r=f,i=void 0,n=(n=R)["@ID"].toString(),i=t.source(),i=r.get(i.id),t=t.target(),r=r.get(t.id),V=[{"@FromSheet":n,"@FromCell":B.BeginX,"@FromPart":"3","@ToSheet":i?i["@ID"].toString():n,"@ToCell":i?B.PinX:B.EndX,"@ToPart":i?"3":"9"},{"@FromSheet":n,"@FromCell":B.EndX,"@FromPart":"3","@ToSheet":r?r["@ID"].toString():n,"@ToCell":r?B.PinX:B.BeginX,"@ToPart":r?"3":"9"}],x.push.apply(x,F(V)),k.push(R);case 72:P=!1,e.next=54;break;case 75:e.next=81;break;case 77:e.prev=77,e.t1=e.catch(52),_=!0,T=e.t1;case 81:if(e.prev=81,e.prev=82,P&&null!=A.return)return e.next=86,A.return();e.next=86;break;case 86:if(e.prev=86,_)throw T;e.next=89;break;case 89:return e.finish(86);case 90:return e.finish(81);case 91:return a.Shapes={Shape:[].concat(F(f.values()),k)},a.Connects={Connect:[].concat(x)},e.abrupt("return",a);case 94:case"end":return e.stop()}var t,n,r,i},e,null,[[7,32,36,46],[37,,41,45],[52,77,81,91],[82,,86,90]])}))).apply(this,arguments)}function Zg(){return(Zg=I(regeneratorRuntime.mark(function e(t,n,r,i){var o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n,i);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return e.abrupt("return",o.jxon);case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)}function $g(){return ev.apply(this,arguments)}function ev(){return(ev=I(regeneratorRuntime.mark(function e(t,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",function(){return Yg.apply(this,arguments)}(t,n));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function tv(){return(tv=I(regeneratorRuntime.mark(function e(t,n,r,i){var o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t,n,i);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",null);case 5:return a=o.jxon,s=Jg(t),["BeginX","BeginY","EndX","EndY"].forEach(function(t){var e,n=s.Cell.find(function(e){return e["@N"]===t});n&&(-1<(e=a.Cell.findIndex(function(e){return e["@N"]===t}))?a.Cell.splice(e,1,n):a.Cell.push(n))}),e.abrupt("return",a);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function nv(e,t){var n=e.model,e=Jg(e),r=(e["@Type"]=Qo.Shape,n.source()),n=n.target(),r=t.get(r.id),t=t.get(n.id),n="".concat(r?"Sheet":"Dynamic connector",".").concat((r||e)["@ID"]),i="".concat(t?"Sheet":"Dynamic connector",".").concat((t||e)["@ID"]);return e.Cell.push({"@N":B.BegTrigger,"@V":r?"2":"1","@F":"_XFTRIGGER(".concat(n,"!EventXFMod)")},{"@N":B.EndTrigger,"@V":t?"2":"1","@F":"_XFTRIGGER(".concat(i,"!EventXFMod)")},{"@N":B.ObjType,"@V":"2"}),e}var rv={XML:"xml",IMAGE:"image"};function iv(){return(iv=I(regeneratorRuntime.mark(function e(r,i){var o,a,s,l,u,c,h,f,p,d,g,v=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(a=2<v.length&&void 0!==v[2]?v[2]:{}).exportElement,a=a.exportLink,s={},l=i.archive,u={data:[],jxon:{Relationship:[]}},e.t0=rv.XML,e.next=7,function(){return ov.apply(this,arguments)}(l);case 7:return e.t1=e.sent,s["docProps/custom.xml"]={type:e.t0,content:e.t1},c=i.fileName,e.t2=rv.XML,e.next=13,function(){return lv.apply(this,arguments)}(r,i,u,o,a);case 13:return e.t3=e.sent,s["visio/pages/".concat(c,".xml")]={type:e.t2,content:e.t3},e.t4=rv.XML,e.next=18,function(){return sv.apply(this,arguments)}(r,i,l);case 18:return e.t5=e.sent,s["visio/pages/pages.xml"]={type:e.t4,content:e.t5},e.t6=rv.XML,e.next=23,t=u.jxon,n=void 0,n=document.implementation.createDocument(Fo.Relationships,"Relationships",null),t=nf(t,n,{xmlns:Fo.Relationships}),'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+(new XMLSerializer).serializeToString(t);case 23:return e.t7=e.sent,s["visio/pages/_rels/".concat(c,".xml.rels")]={type:e.t6,content:e.t7},e.next=27,l.getJxonAsync("[Content_Types].xml");case 27:h=e.sent,s["[Content_Types].xml"]={type:rv.XML,content:function(){return av.apply(this,arguments)}(h)},f=[],p=ae(u.data);try{for(g=function(){var o=d.value;f.push(new Promise(function(r,i){N.util.imageToDataUri(o.url,function(e,t){var n;e&&i();try{n=N.util.dataUriToBlob(t)}catch(e){j.log("Can not convert an image to blob: ".concat(e))}n&&(s["visio/media/".concat(o.name)]={type:rv.IMAGE,content:n}),r()})}))},p.s();!(d=p.n()).done;)g()}catch(e){p.e(e)}finally{p.f()}return e.abrupt("return",Promise.all(f).then(function(){return s}));case 33:case"end":return e.stop()}var t,n},e)}))).apply(this,arguments)}function ov(){return(ov=I(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getJxonAsync("docProps/custom.xml");case 2:return n=e.sent,r=Math.max.apply(Math,n.property.map(function(e){return Number.parseInt(e["@pid"])})),r={"@fmtid":"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}","@pid":(r+1).toString(),"@name":"RecalcDocument","vt:bool":{keyValue:"true"}},n.property.push(r),r=document.implementation.createDocument(Fo.CustomProperties,"Properties",null),n=nf(n,r,{vt:Fo.DocPropsVTypes}),r=(new XMLSerializer).serializeToString(n),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+r);case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}function av(){return(av=I(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.Default.map(function(e){return e["@Extension"]}),[{name:"emf",type:"image/x-emf"},{name:"png",type:"image/png"},{name:"gif",type:"image/gif"},{name:"jpeg",type:"image/jpeg"},{name:"svg",type:"image/svg+xml"}].forEach(function(e){-1===n.indexOf(e.name)&&t.Default.unshift({"@Extension":e.name,"@ContentType":e.type})}),r=document.implementation.createDocument(Fo.ContentTypes,"Types",null),r=nf(t,r,{xmlns:Fo.ContentTypes}),r=(new XMLSerializer).serializeToString(r),e.abrupt("return",'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>'+r);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function sv(){return(sv=I(regeneratorRuntime.mark(function e(t,n,r){var i,o,a,s,l,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.getJxonAsync("visio/pages/pages.xml");case 2:return i=e.sent,s=t.getArea(),Array.isArray(i.Page)||(i.Page=[i.Page]),(l=i.Page.find(function(e){return e["@ID"]===n.id.toString()}))?(l=l.PageSheet.Cell,o=l.findIndex(function(e){return e["@N"]===B.PageWidth}),u=l.findIndex(function(e){return e["@N"]===B.PageHeight}),a={"@N":B.PageWidth,"@V":(s.width/96).toString()},Number.isNaN(o)?l.push(a):l[o]=a,o={"@N":B.PageHeight,"@V":(s.height/96).toString()},Number.isNaN(u)?l.push(o):l[u]=o):j.log("Page with id ".concat(n.id," was not found.")),a=document.implementation.createDocument(Fo.Main,"Pages",null),s=nf(i,a,{xmlns:Fo.Main,r:Fo.DocumentRelationships}),l=new XMLSerializer,u=l.serializeToString(s),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+u);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function lv(){return(lv=I(regeneratorRuntime.mark(function e(t,n,r,i,o){var a,s,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.archive.getJxonAsync(n.xmlPath);case 2:return a=e.sent,e.next=5,function(){return Qg.apply(this,arguments)}(t,a,n,r,i,o);case 5:return a=e.sent,s=document.implementation.createDocument(Fo.Main,"PageContents",null),s=nf(a,s,{xmlns:Fo.Main,r:Fo.DocumentRelationships}),l=new XMLSerializer,l=l.serializeToString(s).replace(/(<cp IX="0")(?: textPlaceholder="(.*?)")(\/>)/gm,function(){var e=Array.prototype.slice.call(arguments),t=e[1],n=e[2];return t+e[3]+n}),e.abrupt("return",'<?xml version="1.0" encoding="utf-8"?>'+l);case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}var uv=["pageSheet"],cv=function(){z(i,Lg);var t,e,n,r=q(i);function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return l(this,i),r.call(this,e,new Set([b.pages,b.shapes,b.connects,b.foreignShapes,b.background,b.backPage]))}return u(i,[{key:"getDefaultAttributes",value:function(){return m(m({},K(U(i.prototype),"getDefaultAttributes",this).call(this)),{},{shapes:new Map,connects:new Map,pages:null,foreignShapes:new Map,allShapes:new Map,cache:new Map})}},{key:"setAttributes",value:function(e){var t=e.pageSheet,e=H(e,uv);K(U(i.prototype),"setAttributes",this).call(this,m({pageSheet:t},e)),t&&this.referenceInCells()}},{key:"referenceInCells",value:function(){var e=this.pageSheet,t=this.archive;e&&e.cells&&(e.cells.parent=t.document.pageSheet)}},{key:"getContent",value:(n=I(regeneratorRuntime.mark(function e(){var t,n,r=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=0<r.length&&void 0!==r[0]?r[0]:{},n=new cp(this),e.next=4,n.loadAsync(t);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"getMastersFromRelsAsync",value:(e=I(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.archive,t=t.document,t=t.masters,this.rels){e.next=5;break}return e.abrupt("return",null);case 5:if(n=this.rels.get(Bo.Master))return e.next=9,t.loadMasters(n);e.next=9;break;case 9:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"background",get:function(){return Boolean(this._background)}},{key:"backPage",get:function(){var e=this._backPage;return void 0===e?null:e}},{key:"width",get:function(){return this.pageSheet.cells.pageWidth}},{key:"height",get:function(){return this.pageSheet.cells.pageHeight}},{key:"pages",get:function(){return this._pages}},{key:"fileName",get:function(){return Q(/^visio\/pages\/(.*)\.xml$/gm.exec(this.xmlPath),2)[1]}},{key:"fromPaper",value:(t=I(regeneratorRuntime.mark(function e(t){var n,r,i=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=1<i.length&&void 0!==i[1]?i[1]:{}).exportElement,r=void 0===r?null:r,n=n.exportLink,n=void 0===n?null:n,e.next=3,function(){return iv.apply(this,arguments)}(t,this,{exportElement:r,exportLink:n});case 3:r=e.sent,this.archive.addEntries(r);case 5:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"printerPaperSize",get:function(){var e=this.pageSheet.cells,t=e.paperKind,e=e.printPageOrientation,t=this.constructor.getPrinterPaperSize(t),n=t.width,t=t.height;return 2===e?{width:t,height:n}:{width:n,height:t}}}],[{key:"getPrinterPaperSize",value:function(e){function t(e){return Ma(e,s.MM)}function n(e){return Ma(e,s.IN)}switch(e){default:case 0:case 1:case 2:return{width:n(8.5),height:n(11)};case 3:return{width:n(11),height:n(17)};case 4:return{width:n(17),height:n(11)};case 5:return{width:n(8.5),height:n(14)};case 6:return{width:n(5.5),height:n(8.5)};case 7:return{width:n(7.25),height:n(10.5)};case 8:return{width:t(297),height:t(420)};case 9:case 10:return{width:t(210),height:t(297)};case 11:return{width:t(148),height:t(210)};case 12:return{width:t(250),height:t(354)};case 13:return{width:t(182),height:t(257)};case 14:return{width:n(8.5),height:n(13)};case 15:return{width:t(215),height:t(275)};case 16:return{width:n(10),height:n(14)};case 17:return{width:n(11),height:n(17)};case 18:return{width:n(2),height:n(11)};case 19:return{width:n(3.875),height:n(8.875)};case 20:return{width:n(4.125),height:n(9.5)};case 21:return{width:n(4.5),height:n(10.375)};case 22:return{width:n(4),height:n(11)};case 23:return{width:n(5),height:n(11.5)};case 24:return{width:t(917),height:t(1297)};case 25:return{width:t(771),height:t(1090)};case 26:return{width:t(878),height:t(1242)};case 27:return{width:t(110),height:t(220)};case 28:return{width:t(162),height:t(229)};case 29:return{width:t(324),height:t(458)};case 30:return{width:t(229),height:t(324)};case 31:return{width:t(114),height:t(162)};case 32:return{width:t(114),height:t(229)};case 33:return{width:t(250),height:t(353)};case 34:return{width:t(176),height:t(250)};case 35:return{width:t(176),height:t(125)};case 36:return{width:t(110),height:t(230)};case 37:return{width:n(3.875),height:n(7.5)};case 38:return{width:n(3.625),height:n(6.5)};case 39:return{width:n(14.875),height:n(11)};case 40:return{width:n(8.5),height:n(12)};case 41:return{width:n(8.5),height:n(13)};case 42:return{width:t(250),height:t(353)};case 43:return{width:t(100),height:t(148)};case 44:return{width:n(9),height:n(11)};case 45:return{width:n(10),height:n(11)};case 46:return{width:n(15),height:n(11)};case 47:return{width:n(220),height:n(220)};case 50:return{width:n(9),height:n(12)};case 51:return{width:n(9),height:n(15)};case 52:return{width:n(11.69),height:n(18)};case 53:return{width:n(9.27),height:n(12.69)};case 54:return{width:n(8),height:n(11)};case 55:return{width:t(210),height:t(297)};case 56:return{width:n(9),height:n(12)};case 57:return{width:t(227),height:t(356)};case 58:return{width:t(305),height:t(487)};case 59:return{width:n(8.5),height:n(12.69)};case 60:return{width:t(210),height:t(330)};case 61:return{width:t(148),height:t(210)};case 62:return{width:t(182),height:t(257)};case 63:return{width:t(322),height:t(445)};case 64:return{width:t(174),height:t(235)};case 65:return{width:t(201),height:t(276)};case 66:return{width:t(420),height:t(594)};case 67:return{width:t(297),height:t(420)};case 68:return{width:t(322),height:t(445)}}}}]),i}();function hv(e,t){return fv.apply(this,arguments)}function fv(){return(fv=I(regeneratorRuntime.mark(function e(t,n){var r,i,o,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=2<a.length&&void 0!==a[2]?a[2]:[],r=S.Page,i=i.concat(Dl(r,t,i)),e.next=5,rf.call(this,t,r,i);case 5:return r=e.sent,i=n.rels.get(S.Page),o=r._rel,o=i.get(o).targetFile.absolutePath,o=new cv(m({archive:this,pages:n,xmlPath:o},r)),e.abrupt("return",o);case 11:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var pv=["shapes"],dv=function(){z(r,Sl);var n=q(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return l(this,r),t.add("cells"),t.add("sections"),n.call(this,e,t)}return u(r,[{key:"setAttributes",value:function(e){var t=e.shapes,e=H(e,pv);K(U(r.prototype),"setAttributes",this).call(this,e),t&&this.master.initMasterSubshapes(t,this)}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}}]),r}(),gv=["shapes"],vv=["id"],yv=function(){z(r,Lg);var n=q(r);function r(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Set;return l(this,r),t.add("cells"),t.add("sections"),t.add("id"),t.add("name"),t.add("icon"),n.call(this,e,t)}return u(r,[{key:"setAttributes",value:function(e){var t=e.shapes,e=H(e,gv);K(U(r.prototype),"setAttributes",this).call(this,e),e.cells&&this.referenceMasterShapeInsideCellsDeep(this),t&&this.initMasterSubshapes(t,this)}},{key:"setMasterContents",value:function(e){var t,e=e.shapes;1<e.size?this.initMasterSubshapes(e,this):(t=(e=F(e.values())[0]).id,e=H(e,vv),this.setAttributes(m({masterAndShape:!0,shapeId:t},e)),this.masterContentsSet=!0)}},{key:"initMasterSubshapes",value:function(e,n){var r=this;n.masterShapes||(n.masterShapes=new Map),this.masterShapesMap||(this.masterShapesMap=new Map),e.forEach(function(e,t){e=new dv(m({archive:r.archive,master:r,masterId:r.id},e));r.referenceMasterShapeInsideCellsDeep(e),n.masterShapes.set(t,e),r.masterShapesMap.set(t,e)})}},{key:"referenceMasterShapeInsideCellsDeep",value:function(t){var n=this;t._cells&&this.referenceMasterShapeInsideCells(t._cells,t),this._sections&&this._sections.forEach(function(e){e.forEach(function(e){e.rows&&e.rows.forEach(function(e){e.cells&&n.referenceMasterShapeInsideCells(e.cells,t)})})})}},{key:"referenceMasterShapeInsideCells",value:function(e,t){e.masterShape=t}},{key:"cells",get:function(){return this._cells},set:function(e){this._cells=e}},{key:"sections",get:function(){return this._sections},set:function(e){this._sections=e}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"getIconBase64",value:function(){return this._icon&&this._icon.base64?"data:image/png;base64,".concat(this._icon.base64):null}}]),r}(),mv=function(){z(r,Lg);var t,n=q(r);function r(e,t){return l(this,r),(e=n.call(this,e,t)).map=new Map,e}return u(r,[{key:"add",value:function(e){var t=e.id,n=e._rel,n=this.getRelById(n),n=(n.masterId=t,n.targetFile.absolutePath),n=new yv(m({archive:this.archive,masters:this,xmlPath:n,masterContentsSet:!1},e));return this.map.set(t,n),n}},{key:"getRelById",value:function(e){return this.rels.get(S.Master).get(e)}},{key:"addIntoById",value:function(e,t){this.map.get(e).setMasterContents(m({},t))}},{key:"getIdByPath",value:function(t){var e=F(this.rels.get(S.Master).values()).find(function(e){return e.targetFile.absolutePath===t});return e||j.log("Unknown master"),e.masterId}},{key:"get",value:function(e){return this.map.get(e)}},{key:"loadMasters",value:(t=I(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.archive,r=ae(t.entries()),e.prev=2,r.s();case 4:if((i=r.n()).done){e.next=20;break}if(i=Q(i.value,2),i=i[1],i=i.targetFile.absolutePath,o=this.getIdByPath(i),(a=this.get(o)).masterContentsSet)return e.abrupt("continue",18);e.next=11;break;case 11:return e.next=13,n.getJxonAsync(i);case 13:return s=e.sent,e.next=16,rf.call(n,s,S.Master,[],{structurePathEnrichObject:{masterId:o}});case 16:s=e.sent,a.setMasterContents(s);case 18:e.next=4;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(2),r.e(e.t0);case 25:return e.prev=25,r.f(),e.finish(25);case 28:case"end":return e.stop()}},e,this,[[2,22,25,28]])})),function(e){return t.apply(this,arguments)})}]),r}();function Sv(){return bv.apply(this,arguments)}function bv(){return(bv=I(regeneratorRuntime.mark(function e(){var r,i,o,a,s,l,u,c,h,f,p,d=this,g=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=(i=0<g.length&&void 0!==g[0]?g[0]:{}).topRelationsMap,o=void 0===o?this.topRelationsMap:o,r=i.documentRelationsMap,r=void 0===r?this.documentRelationsMap:r,i=i.getJxonAsync,i=void 0===i?function(){return d.getJxonAsync.apply(d,arguments)}:i,e.next=3,i(wg(o,Bo.document));case 3:return o=e.sent,t=o,n=Io.Main,Fo.hasOwnProperty(n)||j.log('Unknown xmlSchemaKey "'.concat(n,'"'),{jxonTree:t}),n===Io.DrawingML&&t["@xmlns:a"]===Fo.DrawingML||n===Io.Theme&&t["@xmlns:vt"]===Fo.Theme||(t.hasOwnProperty("@xmlns")&&t["@xmlns"]||j.log('"@xmlns" attribute not found',{jxonTree:t}),t["@xmlns"]!==Fo[n]&&j.log('Unexpected schema actual: "'.concat(t["@xmlns"],'" ')+'(expected "'.concat(Fo[n],'")'))),Dl(S.Document,o,[]),this.document=new Mg({archive:this}),(a=o[Ho.Colors])&&this.document.setAttributes({colors:Ph(a)},new Set([b.colors])),e.next=11,rf.call(this,o,S.Document,[]);case 11:return a=e.sent,this.document.setAttributes(a),this.document.pageSheet={debug:"dummyPageSheet",cells:this.document.styleSheets.get(0).cells},s=wg(r,Bo.Pages),this.document.pages=new Rg({archive:this,xmlPath:s}),e.next=18,this.document.pages.getRelsMapCachedAsync();case 18:return e.next=20,i(s);case 20:l=e.sent,l=Ja(l.Page),l=ae(l),e.prev=23,l.s();case 25:if((u=l.n()).done){e.next=33;break}return u=u.value,e.next=29,hv.call(this,u,this.document.pages);case 29:u=e.sent,this.document.pages.add(u);case 31:e.next=25;break;case 33:e.next=38;break;case 35:e.prev=35,e.t0=e.catch(23),l.e(e.t0);case 38:return e.prev=38,l.f(),e.finish(38);case 41:if(c=wg(r,Bo.Masters))return h=this.document.masters=new mv({archive:this,xmlPath:c}),e.next=46,this.document.masters.getRelsMapCachedAsync();e.next=69;break;case 46:return e.next=48,i(c);case 48:f=e.sent,f=Ja(f.Master),f=ae(f),e.prev=51,f.s();case 53:if((p=f.n()).done){e.next=61;break}return p=p.value,e.next=57,rf.call(this,p,S.Master,[]);case 57:p=e.sent,h.add(p);case 59:e.next=53;break;case 61:e.next=66;break;case 63:e.prev=63,e.t1=e.catch(51),f.e(e.t1);case 66:return e.prev=66,f.f(),e.finish(66);case 69:return e.abrupt("return",this.document);case 70:case"end":return e.stop()}var t,n},e,this,[[23,35,38,41],[51,63,66,69]])}))).apply(this,arguments)}var Cv={array:"array",arraybuffer:"arraybuffer",base64:"base64",binarystring:"binarystring",blob:"blob",uint8array:"uint8array"},n=function(){function e(){l(this,e),this.document=null,this.source=null,this.zip=null,this.jxonAsync=null,this.topRelationsMap=null,this.documentRelationsMap=null}var t,n,r,i,o,a,s;return u(e,[{key:"load",value:(s=I(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof ArrayBuffer)return n=new C,e.next=4,n.loadAsync(t);e.next=18;break;case 4:return n=e.sent,this.source=t,this.zip=n,this.jxonAsync=new kg(n),e.next=10,Pg.call(this);case 10:return this.topRelationsMap=e.sent,e.next=13,Tg.call(this);case 13:return this.documentRelationsMap=e.sent,e.next=16,Sv.call(this);case 16:e.next=19;break;case 18:throw new Error("Not an instance of ArrayBuffer.");case 19:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"getJxonAsync",value:(a=I(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getJxonAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return a.apply(this,arguments)})},{key:"getImageAsync",value:(o=I(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jxonAsync.getImageAsync(t));case 1:case"end":return e.stop()}},e,this)})),function(e){return o.apply(this,arguments)})},{key:"toVSDX",value:(i=I(regeneratorRuntime.mark(function e(){var t,n,r,i,o,a=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=0<a.length&&void 0!==a[0]?a[0]:{}).type,(r=n=void 0===n?"blob":n)&&Cv[n]&&(i=C.support,(o=i.hasOwnProperty(n))&&i[n]||!o?r=Cv[n]:j.log('Browser does not support export type: "'.concat(n,'", using Blob as fallback.'))),e.abrupt("return",this.zip.generateAsync(m(m({},t),{},{type:r})));case 5:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)})},{key:"addEntries",value:function(e){for(var t in e)e.hasOwnProperty(t)&&this.zip.file(t,e[t].content)}}],[{key:"fromURL",value:(r=I(regeneratorRuntime.mark(function e(i){var o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof i||""===i)throw new Error("Missing parameter");e.next=2;break;case 2:return e.abrupt("return",new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",i,!0),r.setRequestHeader("Content-Type","application/vnd-ms-visio.drawing;charset=utf-8"),r.responseType="blob",r.onerror=function(){n(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.onload=function(){var e;200===r.status?((e=new FileReader).onload=function(e){e=e.target.result;t(o.fromArrayBuffer(e))},e.onerror=function(){n(new Error("Error occurred reading file: ".concat(i)))},e.readAsArrayBuffer(r.response)):n(new Error("Failed to load file ".concat(i,", status: ").concat(r.status," (").concat(r.statusText,")")))},r.send()}));case 3:case"end":return e.stop()}},e)})),function(e){return r.apply(this,arguments)})},{key:"fromArrayBuffer",value:(n=I(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new this,e.next=3,n.load(t);case 3:return e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)})),function(e){return n.apply(this,arguments)})},{key:"fromBase64",value:(t=I(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.fromArrayBuffer(new Uint8Array(F(atob(t)).map(function(e){return e.charCodeAt(0)}))));case 1:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),e}();for(var ru={fromPixels:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:s.IN;switch(void 0!==e&&t||j.log("Value and target unit type are required to convert a pixel value."),e=Number.parseFloat(e),Number.isNaN(e)&&j.log("fromPixels requires a numeric value."),t){case s.IN:case s.IN_F:case s.DL:case s.DP:return e/96;case s.DT:case s.PT:return e/96*72;case s.MM:return Va(e);case s.CM:return Va(e)/10;default:return j.log('Unsupported numeric unit type "'.concat(Fa(t),'" ("').concat(t,'")')),e}},toPixels:Ma,isFontAvailable:$f},e={VisioRowType:re,VisioSectionType:G,VisioCellName:B,VisioUnitType:s},kv=(p.VisioArchive=n,p.VisioConnect=Gh,p.VisioDocument=Mg,p.VisioElement=Ih,p.VisioIndexedSection=hh,p.VisioLink=Fh,p.VisioNamedSection=fh,p.VisioPage=cv,p.VisioPageContent=cp,p.VisioPages=Rg,p.VisioRow=sh,p.VisioSection=ch,p.VisioShape=Kf,p.VisioSheetObject=wl,p.config=Ml,p.debug=j,p.types=e,p.util=ru,Object.defineProperty(p,"__esModule",{value:!0}),["LQHCusKFwqs=","dMOqwqfCvsKWKkg=","wqPDoTfDqRbCvEs=","wpPDtsK4TyAAOQ==","MCvDtW0yNcOfw7/DucO9wrDDvMK6","CcOXBU5BAx1qw5c=","JsKqwp/DkjcNVsOGw4c4","XsOww4/CjnN3NcOdw5dcwrbDu8KTw4zDkUPClUQgwoBgwqhWw7ZCQhcqw68PSXDCi8OECHHDgMKewrjChwoACVLCscOpw6jDpkXCocOPw5/CqsKqwp7DvMOswq7CnMOdwqQECxvDs3/CmWbDrkhkQ8Obw4dNKcKSNRksdj3Dh1sww7jCiMOPK03DssK+wrjCp3o="]),xv=kv,wv=444;--wv;)xv.push(xv.shift());function Pv(e,t){var n=kv[e=+e],r=(void 0===Pv.GqHSgy&&((r=function(){var t;try{t=Function('return (function() {}.constructor("return this")( ));')()}catch(e){t=window}return t}()).atob||(r.atob=function(e){for(var t,n,r=String(e).replace(/=+$/,""),i="",o=0,a=0;n=r.charAt(a++);~n&&(t=o%4?64*t+n:n,o++%4)&&(i+=String.fromCharCode(255&t>>(-2*o&6))))n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(n);return i}),Pv.sEVwZE=function(e,t){for(var n,r=[],i=0,o="",a="",s=0,l=(e=atob(e)).length;s<l;s++)a+="%"+("00"+e.charCodeAt(s).toString(16)).slice(-2);for(e=decodeURIComponent(a),u=0;u<256;u++)r[u]=u;for(u=0;u<256;u++)i=(i+r[u]+t.charCodeAt(u%t.length))%256,n=r[u],r[u]=r[i],r[i]=n;for(var u=0,i=0,c=0;c<e.length;c++)i=(i+r[u=(u+1)%256])%256,n=r[u],r[u]=r[i],r[i]=n,o+=String.fromCharCode(e.charCodeAt(c)^r[(r[u]+r[i])%256]);return o},Pv.MbndRh={},Pv.GqHSgy=!0),Pv.MbndRh[e]);return void 0===r?(void 0===Pv.XRCUYd&&(Pv.XRCUYd=!0),n=Pv.sEVwZE(n,t),Pv.MbndRh[e]=n):n=r,n}Tu=new Date(parseInt(Pv("0x1","CO53"))),$l=parseInt(Pv("0x3","9J%G")),qs=Pv("0x4","9J%G"),Pv("0x2","AUqB")!=typeof window&&$l&&!isNaN($l)&&Tu&&!isNaN(Tu[Pv("0x7","[gU(")]())&&Tu[Pv("0x0","X&W4")]()+$l-(new Date)[Pv("0x6","7T(e")]()<=0&&window[Pv("0x5","@]6T")](qs)});