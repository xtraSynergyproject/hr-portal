@using Syncfusion.EJ2
@using Syncfusion.EJ2.Navigations

@using Synergy.App.ViewModel
@using Synergy.App.Business
@using Newtonsoft.Json;

@{
    ViewData["Title"] = "Member Group";
    Layout = "/Views/Shared/_PopupLayout.cshtml";
}

@model Synergy.App.ViewModel.MemberGroupViewModel



<div>

    <form asp-controller="MemberGroup" asp-action="ManageMemberGroup" method="post" class="form-horizontal">
        <div class="text-danger" asp-validation-summary="All"></div>
        <div class="row" style="padding:40px;">
            <div class="col-12 pad-15">
                <input asp-for="Name" type="text" class="form-control" placeholder="Group Name" required="required" autocomplete="off" width="300" />
            </div>
            <div class="col-12">Group Status</div>
            <div class="col-12 pad-15">

                @(Html.Kendo().SwitchFor(x=>x.Status)
                    .Messages(c => c.Checked("Active").Unchecked("Inactive"))
                )
            </div>

            <div class="col-12">Group Portals</div>
            <div class="col-12 pad-15">
                @*@(Html.Kendo().MultiSelectFor(x => x.GroupPortals)
                    .AutoClose(false)
                    .DataSource(source =>
                    {
                        source.Read(read =>
                        {
                            read.Action("GetPortalList", "MemberGroup");
                        });
                    })
                    .DataTextField("Name")
                    .DataValueField("Id")
                    .AutoBind(true)
                    .HtmlAttributes(new { @class = "hr-xx-large", @style = "width:300px" })
                    //.Value(Model.MemberPortals)
                    .Height(300)
                    )*@

                <select asp-for="GroupPortals" id="GroupPortals" data-placeholder="Select Group Portals..." style="width:80%"></select>

            </div>
            <div class="col-12 pad-15">


            </div>

            <div class="cms-slidebar-footer">
                <input type="button" class="btn btn-link" value="Close" onclick="closeNavMemberGroup()" />
                <input type="submit" class="btn btn-primary" value="Save" />
            </div>

        </div>
        @Html.HiddenFor(x => x.Id)
        @Html.HiddenFor(x => x.DataAction)
    </form>
</div>

<script type="text/javascript">
    $(document).ready(function () {
        if ('@ViewBag.Success' == "True") {
            closeNavMemberGroup();
            window.parent.getMemberGroupData();
            //window.parent.$("#MemberGroupgrid").data("kendoGrid").dataSource.read();
        }

        $("#GroupPortals").kendoMultiSelect({
            dataTextField: "Name",
            dataValueField: "Id",
            dataSource: new kendo.data.DataSource({
                transport: {
                    read: {
                        url: "/MemberGroup/GetPortalList",
                        dataType: "json"
                    }
                },
            }),
            autoClose: false,
            placeholder: "Select group portals...",
            value: @Html.Raw(JsonConvert.SerializeObject(Model.GroupPortals)),
            valuePrimitive: true,
            serverFiltering: true,
            filter: '@FilterType.Contains',
        });
    });

    function closeNavMemberGroup() {
       
        var win = GetMainWindow();
        win.CloseWindow();
        return false;
    }
</script>

