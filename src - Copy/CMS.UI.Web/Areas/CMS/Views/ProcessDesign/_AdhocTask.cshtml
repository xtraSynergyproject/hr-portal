@using CMS.UI.ViewModel;
@using CMS.Common;

@{
    ViewData["Title"] = "Portal";
    Layout = null;
}
@inject CMS.Common.IUserContext _userContext
@model AdhocTaskComponentViewModel

<style>
    .form-label-group {
        position: relative;
        margin-bottom: 0px;
    }

    .cms-manageportal-footer {
        /*        position: absolute;*/
        left: 0;
        bottom: 0;
        padding: 10px;
        padding-right: 20px;
        width: 100%;
        background-color: #F8F8F8 !important;
        color: white;
        text-align: right;
    }

    .slidenav-flow {
        overflow-x: hidden;
        overflow-y: auto !important;
        height: 75%;
    }

    .style-mylogoimage {
        /*border-radius: 50%;*/
        height: 100px;
        width: 100px;
    }

    .style-mybannerimage {
        /*border-radius: 50%;*/
        height: 100px;
        width: 100px;
    }

    .style-image {
        width: 30%;
        float: left;
    }

    .style-upload {
        width: 70%;
        float: left;
    }

    .style-pickerleft {
        width: 50%;
        float: left;
        padding-bottom: 15px;
    }
    /*    k-colorpicker {
        width: 100px;
    }

    .k-colorpicker .k-selected-color {
            width: 100px;
    }*/

</style>
<script type="text/javascript">
   
    function OnSave(e)
    {
        debugger
        var userId = $("#AssignedToUserId").data("kendoDropDownList").value();
        if (userId == null || userId == "" || userId == undefined) {
            $(".text-danger").removeClass("validation-summary-valid");
            $(".text-danger").addClass("validation-summary-errors");
            $(".text-danger").html("User is required");
            e.preventDefault();
            return false;
        }
    }

    function OnCancel(args) {

    }
    $(document).ready(function () {
        //alert($('#EnableDeletebtn').val());
        $('#EnableDeletebtn').change(function () {
            debugger
            if (this.checked) {

                $('#confirmationdel').show();
            }
            else {
                $('#confirmationdel').hide();
            }

        });
        if ($('#EnableDeletebtn').val() == 'true')
        {
            $('#confirmationdel').show();
        }
    });

    function closeNavPortal() {
        var win = GetMainWindow();
        win.CloseWindow();
        return false;
    }
  

    var onAjaxSuccess = function (res) {
        if (res.success) {
            if ('@Model.DataAction'=='@DataActionEnum.Create')
            {
                ShowNotification("Saved Successfully", "success");
            }
            if ('@Model.DataAction'=='@DataActionEnum.Edit')
            {
                ShowNotification("Updated Successfully", "success");
            }
           // window.parent.parent.$("#documentTypeTreeView").data("kendoTreeView").dataSource.read();
            var Id = res.Id;
            CloseSideNav();
           // LoadPartailView('@Url.Action("ManageIndex", "Template", new { @area = "Cms" })?templateId=' + TemplateId, $('#index'));
        }
        else {
            alert(res)
            showError(res.error);
        }
    };



</script>

<div class="pad-15">
    <form asp-controller="ProcessDesign" asp-action="ManageAdhocTask"  class="form-horizontal" id="myForm" data-ajax-begin="onAjaxBegin" data-ajax-complete="onAjaxComplete"
              data-ajax-failure="onAjaxFailed" data-ajax-success="onAjaxSuccess"
              data-ajax="true" data-ajax-method="POST">
        <div class="text-danger" asp-validation-summary="All" ></div>
        <div class="row" style="padding:10px;">

            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <input asp-for="Name" type="text" class="form-control" placeholder="Name" required="required" autocomplete="off" />
                    <label for="Name">Name <span class="required">*</span></label>
                </div>
            </div>

         @{
             await Html.RenderPartialAsync("_TaskAssignee", Model);
         } 
          

            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <input asp-for="Subject" type="text" class="form-control" placeholder="Subject" required="required" autocomplete="off" />
                    <label for="Subject">Subject</label>
                </div>
            </div>
            <div class="col-12 pad-10">
                <div class="form-label-group">
                    <textarea asp-for="Description" class="form-control" required="required" autocomplete="off"></textarea>
                    <label for="Description">Description</label>
                </div>
            </div>
            <div class="cms-slidebar-footer">
                <input type="button" class="btn btn-light" value="Close" onclick="CloseSideNav()" />
                <input type="submit" class="btn btn-primary" value="Save"  onclick="OnSave(event)" />
            </div>

        </div>

                @Html.HiddenFor(x => x.Id)
                @Html.HiddenFor(x => x.DataAction)
</form>

</div>
